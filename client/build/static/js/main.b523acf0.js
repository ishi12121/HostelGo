/*! For license information please see main.b523acf0.js.LICENSE.txt */
!function(){var g={25:function(g){"use strict";function I(g){this._maxSize=g,this.clear()}I.prototype.clear=function(){this._size=0,this._values=Object.create(null)},I.prototype.get=function(g){return this._values[g]},I.prototype.set=function(g,I){return this._size>=this._maxSize&&this.clear(),g in this._values||this._size++,this._values[g]=I};var e=/[^.^\]^[]+|(?=\[\]|\.\.)/g,C=/^\d+$/,l=/^\d/,n=/[~`!#$%\^&*+=\-\[\]\\';,/{}|\\":<>\?]/g,t=/^\s*(['"]?)(.*?)(\1)\s*$/,a=new I(512),o=new I(512),A=new I(512);function r(g){return a.get(g)||a.set(g,c(g).map((function(g){return g.replace(t,"$2")})))}function c(g){return g.match(e)||[""]}function i(g){return"string"===typeof g&&g&&-1!==["'",'"'].indexOf(g.charAt(0))}function d(g){return!i(g)&&(function(g){return g.match(l)&&!g.match(C)}(g)||function(g){return n.test(g)}(g))}g.exports={Cache:I,split:c,normalizePath:r,setter:function(g){var I=r(g);return o.get(g)||o.set(g,(function(g,e){for(var C=0,l=I.length,n=g;C<l-1;){var t=I[C];if("__proto__"===t||"constructor"===t||"prototype"===t)return g;n=n[I[C++]]}n[I[C]]=e}))},getter:function(g,I){var e=r(g);return A.get(g)||A.set(g,(function(g){for(var C=0,l=e.length;C<l;){if(null==g&&I)return;g=g[e[C++]]}return g}))},join:function(g){return g.reduce((function(g,I){return g+(i(I)||C.test(I)?"["+I+"]":(g?".":"")+I)}),"")},forEach:function(g,I,e){!function(g,I,e){var C,l,n,t,a=g.length;for(l=0;l<a;l++)(C=g[l])&&(d(C)&&(C='"'+C+'"'),n=!(t=i(C))&&/^\d+$/.test(C),I.call(e,C,t,n,l,g))}(Array.isArray(g)?g:c(g),I,e)}}},597:function(g,I,e){"use strict";var C=e(784),l=e(969);function n(g){for(var I="https://reactjs.org/docs/error-decoder.html?invariant="+g,e=1;e<arguments.length;e++)I+="&args[]="+encodeURIComponent(arguments[e]);return"Minified React error #"+g+"; visit "+I+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var t=new Set,a={};function o(g,I){A(g,I),A(g+"Capture",I)}function A(g,I){for(a[g]=I,g=0;g<I.length;g++)t.add(I[g])}var r=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),c=Object.prototype.hasOwnProperty,i=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,d={},u={};function s(g,I,e,C,l,n,t){this.acceptsBooleans=2===I||3===I||4===I,this.attributeName=C,this.attributeNamespace=l,this.mustUseProperty=e,this.propertyName=g,this.type=I,this.sanitizeURL=n,this.removeEmptyString=t}var m={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach((function(g){m[g]=new s(g,0,!1,g,null,!1,!1)})),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach((function(g){var I=g[0];m[I]=new s(I,1,!1,g[1],null,!1,!1)})),["contentEditable","draggable","spellCheck","value"].forEach((function(g){m[g]=new s(g,2,!1,g.toLowerCase(),null,!1,!1)})),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach((function(g){m[g]=new s(g,2,!1,g,null,!1,!1)})),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach((function(g){m[g]=new s(g,3,!1,g.toLowerCase(),null,!1,!1)})),["checked","multiple","muted","selected"].forEach((function(g){m[g]=new s(g,3,!0,g,null,!1,!1)})),["capture","download"].forEach((function(g){m[g]=new s(g,4,!1,g,null,!1,!1)})),["cols","rows","size","span"].forEach((function(g){m[g]=new s(g,6,!1,g,null,!1,!1)})),["rowSpan","start"].forEach((function(g){m[g]=new s(g,5,!1,g.toLowerCase(),null,!1,!1)}));var b=/[\-:]([a-z])/g;function Z(g){return g[1].toUpperCase()}function G(g,I,e,C){var l=m.hasOwnProperty(I)?m[I]:null;(null!==l?0!==l.type:C||!(2<I.length)||"o"!==I[0]&&"O"!==I[0]||"n"!==I[1]&&"N"!==I[1])&&(function(g,I,e,C){if(null===I||"undefined"===typeof I||function(g,I,e,C){if(null!==e&&0===e.type)return!1;switch(typeof I){case"function":case"symbol":return!0;case"boolean":return!C&&(null!==e?!e.acceptsBooleans:"data-"!==(g=g.toLowerCase().slice(0,5))&&"aria-"!==g);default:return!1}}(g,I,e,C))return!0;if(C)return!1;if(null!==e)switch(e.type){case 3:return!I;case 4:return!1===I;case 5:return isNaN(I);case 6:return isNaN(I)||1>I}return!1}(I,e,l,C)&&(e=null),C||null===l?function(g){return!!c.call(u,g)||!c.call(d,g)&&(i.test(g)?u[g]=!0:(d[g]=!0,!1))}(I)&&(null===e?g.removeAttribute(I):g.setAttribute(I,""+e)):l.mustUseProperty?g[l.propertyName]=null===e?3!==l.type&&"":e:(I=l.attributeName,C=l.attributeNamespace,null===e?g.removeAttribute(I):(e=3===(l=l.type)||4===l&&!0===e?"":""+e,C?g.setAttributeNS(C,I,e):g.setAttribute(I,e))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach((function(g){var I=g.replace(b,Z);m[I]=new s(I,1,!1,g,null,!1,!1)})),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach((function(g){var I=g.replace(b,Z);m[I]=new s(I,1,!1,g,"http://www.w3.org/1999/xlink",!1,!1)})),["xml:base","xml:lang","xml:space"].forEach((function(g){var I=g.replace(b,Z);m[I]=new s(I,1,!1,g,"http://www.w3.org/XML/1998/namespace",!1,!1)})),["tabIndex","crossOrigin"].forEach((function(g){m[g]=new s(g,1,!1,g.toLowerCase(),null,!1,!1)})),m.xlinkHref=new s("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach((function(g){m[g]=new s(g,1,!1,g.toLowerCase(),null,!0,!0)}));var y=C.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,h=Symbol.for("react.element"),B=Symbol.for("react.portal"),p=Symbol.for("react.fragment"),W=Symbol.for("react.strict_mode"),V=Symbol.for("react.profiler"),S=Symbol.for("react.provider"),v=Symbol.for("react.context"),f=Symbol.for("react.forward_ref"),R=Symbol.for("react.suspense"),X=Symbol.for("react.suspense_list"),J=Symbol.for("react.memo"),k=Symbol.for("react.lazy");Symbol.for("react.scope"),Symbol.for("react.debug_trace_mode");var Y=Symbol.for("react.offscreen");Symbol.for("react.legacy_hidden"),Symbol.for("react.cache"),Symbol.for("react.tracing_marker");var H=Symbol.iterator;function w(g){return null===g||"object"!==typeof g?null:"function"===typeof(g=H&&g[H]||g["@@iterator"])?g:null}var N,F=Object.assign;function K(g){if(void 0===N)try{throw Error()}catch(e){var I=e.stack.trim().match(/\n( *(at )?)/);N=I&&I[1]||""}return"\n"+N+g}var x=!1;function z(g,I){if(!g||x)return"";x=!0;var e=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(I)if(I=function(){throw Error()},Object.defineProperty(I.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(I,[])}catch(A){var C=A}Reflect.construct(g,[],I)}else{try{I.call()}catch(A){C=A}g.call(I.prototype)}else{try{throw Error()}catch(A){C=A}g()}}catch(A){if(A&&C&&"string"===typeof A.stack){for(var l=A.stack.split("\n"),n=C.stack.split("\n"),t=l.length-1,a=n.length-1;1<=t&&0<=a&&l[t]!==n[a];)a--;for(;1<=t&&0<=a;t--,a--)if(l[t]!==n[a]){if(1!==t||1!==a)do{if(t--,0>--a||l[t]!==n[a]){var o="\n"+l[t].replace(" at new "," at ");return g.displayName&&o.includes("<anonymous>")&&(o=o.replace("<anonymous>",g.displayName)),o}}while(1<=t&&0<=a);break}}}finally{x=!1,Error.prepareStackTrace=e}return(g=g?g.displayName||g.name:"")?K(g):""}function E(g){switch(g.tag){case 5:return K(g.type);case 16:return K("Lazy");case 13:return K("Suspense");case 19:return K("SuspenseList");case 0:case 2:case 15:return g=z(g.type,!1);case 11:return g=z(g.type.render,!1);case 1:return g=z(g.type,!0);default:return""}}function U(g){if(null==g)return null;if("function"===typeof g)return g.displayName||g.name||null;if("string"===typeof g)return g;switch(g){case p:return"Fragment";case B:return"Portal";case V:return"Profiler";case W:return"StrictMode";case R:return"Suspense";case X:return"SuspenseList"}if("object"===typeof g)switch(g.$$typeof){case v:return(g.displayName||"Context")+".Consumer";case S:return(g._context.displayName||"Context")+".Provider";case f:var I=g.render;return(g=g.displayName)||(g=""!==(g=I.displayName||I.name||"")?"ForwardRef("+g+")":"ForwardRef"),g;case J:return null!==(I=g.displayName||null)?I:U(g.type)||"Memo";case k:I=g._payload,g=g._init;try{return U(g(I))}catch(e){}}return null}function Q(g){var I=g.type;switch(g.tag){case 24:return"Cache";case 9:return(I.displayName||"Context")+".Consumer";case 10:return(I._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return g=(g=I.render).displayName||g.name||"",I.displayName||(""!==g?"ForwardRef("+g+")":"ForwardRef");case 7:return"Fragment";case 5:return I;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return U(I);case 8:return I===W?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if("function"===typeof I)return I.displayName||I.name||null;if("string"===typeof I)return I}return null}function M(g){switch(typeof g){case"boolean":case"number":case"string":case"undefined":case"object":return g;default:return""}}function L(g){var I=g.type;return(g=g.nodeName)&&"input"===g.toLowerCase()&&("checkbox"===I||"radio"===I)}function D(g){g._valueTracker||(g._valueTracker=function(g){var I=L(g)?"checked":"value",e=Object.getOwnPropertyDescriptor(g.constructor.prototype,I),C=""+g[I];if(!g.hasOwnProperty(I)&&"undefined"!==typeof e&&"function"===typeof e.get&&"function"===typeof e.set){var l=e.get,n=e.set;return Object.defineProperty(g,I,{configurable:!0,get:function(){return l.call(this)},set:function(g){C=""+g,n.call(this,g)}}),Object.defineProperty(g,I,{enumerable:e.enumerable}),{getValue:function(){return C},setValue:function(g){C=""+g},stopTracking:function(){g._valueTracker=null,delete g[I]}}}}(g))}function T(g){if(!g)return!1;var I=g._valueTracker;if(!I)return!0;var e=I.getValue(),C="";return g&&(C=L(g)?g.checked?"true":"false":g.value),(g=C)!==e&&(I.setValue(g),!0)}function j(g){if("undefined"===typeof(g=g||("undefined"!==typeof document?document:void 0)))return null;try{return g.activeElement||g.body}catch(I){return g.body}}function P(g,I){var e=I.checked;return F({},I,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=e?e:g._wrapperState.initialChecked})}function O(g,I){var e=null==I.defaultValue?"":I.defaultValue,C=null!=I.checked?I.checked:I.defaultChecked;e=M(null!=I.value?I.value:e),g._wrapperState={initialChecked:C,initialValue:e,controlled:"checkbox"===I.type||"radio"===I.type?null!=I.checked:null!=I.value}}function q(g,I){null!=(I=I.checked)&&G(g,"checked",I,!1)}function _(g,I){q(g,I);var e=M(I.value),C=I.type;if(null!=e)"number"===C?(0===e&&""===g.value||g.value!=e)&&(g.value=""+e):g.value!==""+e&&(g.value=""+e);else if("submit"===C||"reset"===C)return void g.removeAttribute("value");I.hasOwnProperty("value")?gg(g,I.type,e):I.hasOwnProperty("defaultValue")&&gg(g,I.type,M(I.defaultValue)),null==I.checked&&null!=I.defaultChecked&&(g.defaultChecked=!!I.defaultChecked)}function $(g,I,e){if(I.hasOwnProperty("value")||I.hasOwnProperty("defaultValue")){var C=I.type;if(!("submit"!==C&&"reset"!==C||void 0!==I.value&&null!==I.value))return;I=""+g._wrapperState.initialValue,e||I===g.value||(g.value=I),g.defaultValue=I}""!==(e=g.name)&&(g.name=""),g.defaultChecked=!!g._wrapperState.initialChecked,""!==e&&(g.name=e)}function gg(g,I,e){"number"===I&&j(g.ownerDocument)===g||(null==e?g.defaultValue=""+g._wrapperState.initialValue:g.defaultValue!==""+e&&(g.defaultValue=""+e))}var Ig=Array.isArray;function eg(g,I,e,C){if(g=g.options,I){I={};for(var l=0;l<e.length;l++)I["$"+e[l]]=!0;for(e=0;e<g.length;e++)l=I.hasOwnProperty("$"+g[e].value),g[e].selected!==l&&(g[e].selected=l),l&&C&&(g[e].defaultSelected=!0)}else{for(e=""+M(e),I=null,l=0;l<g.length;l++){if(g[l].value===e)return g[l].selected=!0,void(C&&(g[l].defaultSelected=!0));null!==I||g[l].disabled||(I=g[l])}null!==I&&(I.selected=!0)}}function Cg(g,I){if(null!=I.dangerouslySetInnerHTML)throw Error(n(91));return F({},I,{value:void 0,defaultValue:void 0,children:""+g._wrapperState.initialValue})}function lg(g,I){var e=I.value;if(null==e){if(e=I.children,I=I.defaultValue,null!=e){if(null!=I)throw Error(n(92));if(Ig(e)){if(1<e.length)throw Error(n(93));e=e[0]}I=e}null==I&&(I=""),e=I}g._wrapperState={initialValue:M(e)}}function ng(g,I){var e=M(I.value),C=M(I.defaultValue);null!=e&&((e=""+e)!==g.value&&(g.value=e),null==I.defaultValue&&g.defaultValue!==e&&(g.defaultValue=e)),null!=C&&(g.defaultValue=""+C)}function tg(g){var I=g.textContent;I===g._wrapperState.initialValue&&""!==I&&null!==I&&(g.value=I)}function ag(g){switch(g){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function og(g,I){return null==g||"http://www.w3.org/1999/xhtml"===g?ag(I):"http://www.w3.org/2000/svg"===g&&"foreignObject"===I?"http://www.w3.org/1999/xhtml":g}var Ag,rg,cg=(rg=function(g,I){if("http://www.w3.org/2000/svg"!==g.namespaceURI||"innerHTML"in g)g.innerHTML=I;else{for((Ag=Ag||document.createElement("div")).innerHTML="<svg>"+I.valueOf().toString()+"</svg>",I=Ag.firstChild;g.firstChild;)g.removeChild(g.firstChild);for(;I.firstChild;)g.appendChild(I.firstChild)}},"undefined"!==typeof MSApp&&MSApp.execUnsafeLocalFunction?function(g,I,e,C){MSApp.execUnsafeLocalFunction((function(){return rg(g,I)}))}:rg);function ig(g,I){if(I){var e=g.firstChild;if(e&&e===g.lastChild&&3===e.nodeType)return void(e.nodeValue=I)}g.textContent=I}var dg={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},ug=["Webkit","ms","Moz","O"];function sg(g,I,e){return null==I||"boolean"===typeof I||""===I?"":e||"number"!==typeof I||0===I||dg.hasOwnProperty(g)&&dg[g]?(""+I).trim():I+"px"}function mg(g,I){for(var e in g=g.style,I)if(I.hasOwnProperty(e)){var C=0===e.indexOf("--"),l=sg(e,I[e],C);"float"===e&&(e="cssFloat"),C?g.setProperty(e,l):g[e]=l}}Object.keys(dg).forEach((function(g){ug.forEach((function(I){I=I+g.charAt(0).toUpperCase()+g.substring(1),dg[I]=dg[g]}))}));var bg=F({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Zg(g,I){if(I){if(bg[g]&&(null!=I.children||null!=I.dangerouslySetInnerHTML))throw Error(n(137,g));if(null!=I.dangerouslySetInnerHTML){if(null!=I.children)throw Error(n(60));if("object"!==typeof I.dangerouslySetInnerHTML||!("__html"in I.dangerouslySetInnerHTML))throw Error(n(61))}if(null!=I.style&&"object"!==typeof I.style)throw Error(n(62))}}function Gg(g,I){if(-1===g.indexOf("-"))return"string"===typeof I.is;switch(g){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var yg=null;function hg(g){return(g=g.target||g.srcElement||window).correspondingUseElement&&(g=g.correspondingUseElement),3===g.nodeType?g.parentNode:g}var Bg=null,pg=null,Wg=null;function Vg(g){if(g=Zl(g)){if("function"!==typeof Bg)throw Error(n(280));var I=g.stateNode;I&&(I=yl(I),Bg(g.stateNode,g.type,I))}}function Sg(g){pg?Wg?Wg.push(g):Wg=[g]:pg=g}function vg(){if(pg){var g=pg,I=Wg;if(Wg=pg=null,Vg(g),I)for(g=0;g<I.length;g++)Vg(I[g])}}function fg(g,I){return g(I)}function Rg(){}var Xg=!1;function Jg(g,I,e){if(Xg)return g(I,e);Xg=!0;try{return fg(g,I,e)}finally{Xg=!1,(null!==pg||null!==Wg)&&(Rg(),vg())}}function kg(g,I){var e=g.stateNode;if(null===e)return null;var C=yl(e);if(null===C)return null;e=C[I];g:switch(I){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(C=!C.disabled)||(C=!("button"===(g=g.type)||"input"===g||"select"===g||"textarea"===g)),g=!C;break g;default:g=!1}if(g)return null;if(e&&"function"!==typeof e)throw Error(n(231,I,typeof e));return e}var Yg=!1;if(r)try{var Hg={};Object.defineProperty(Hg,"passive",{get:function(){Yg=!0}}),window.addEventListener("test",Hg,Hg),window.removeEventListener("test",Hg,Hg)}catch(rg){Yg=!1}function wg(g,I,e,C,l,n,t,a,o){var A=Array.prototype.slice.call(arguments,3);try{I.apply(e,A)}catch(r){this.onError(r)}}var Ng=!1,Fg=null,Kg=!1,xg=null,zg={onError:function(g){Ng=!0,Fg=g}};function Eg(g,I,e,C,l,n,t,a,o){Ng=!1,Fg=null,wg.apply(zg,arguments)}function Ug(g){var I=g,e=g;if(g.alternate)for(;I.return;)I=I.return;else{g=I;do{0!==(4098&(I=g).flags)&&(e=I.return),g=I.return}while(g)}return 3===I.tag?e:null}function Qg(g){if(13===g.tag){var I=g.memoizedState;if(null===I&&(null!==(g=g.alternate)&&(I=g.memoizedState)),null!==I)return I.dehydrated}return null}function Mg(g){if(Ug(g)!==g)throw Error(n(188))}function Lg(g){return null!==(g=function(g){var I=g.alternate;if(!I){if(null===(I=Ug(g)))throw Error(n(188));return I!==g?null:g}for(var e=g,C=I;;){var l=e.return;if(null===l)break;var t=l.alternate;if(null===t){if(null!==(C=l.return)){e=C;continue}break}if(l.child===t.child){for(t=l.child;t;){if(t===e)return Mg(l),g;if(t===C)return Mg(l),I;t=t.sibling}throw Error(n(188))}if(e.return!==C.return)e=l,C=t;else{for(var a=!1,o=l.child;o;){if(o===e){a=!0,e=l,C=t;break}if(o===C){a=!0,C=l,e=t;break}o=o.sibling}if(!a){for(o=t.child;o;){if(o===e){a=!0,e=t,C=l;break}if(o===C){a=!0,C=t,e=l;break}o=o.sibling}if(!a)throw Error(n(189))}}if(e.alternate!==C)throw Error(n(190))}if(3!==e.tag)throw Error(n(188));return e.stateNode.current===e?g:I}(g))?Dg(g):null}function Dg(g){if(5===g.tag||6===g.tag)return g;for(g=g.child;null!==g;){var I=Dg(g);if(null!==I)return I;g=g.sibling}return null}var Tg=l.unstable_scheduleCallback,jg=l.unstable_cancelCallback,Pg=l.unstable_shouldYield,Og=l.unstable_requestPaint,qg=l.unstable_now,_g=l.unstable_getCurrentPriorityLevel,$g=l.unstable_ImmediatePriority,gI=l.unstable_UserBlockingPriority,II=l.unstable_NormalPriority,eI=l.unstable_LowPriority,CI=l.unstable_IdlePriority,lI=null,nI=null;var tI=Math.clz32?Math.clz32:function(g){return g>>>=0,0===g?32:31-(aI(g)/oI|0)|0},aI=Math.log,oI=Math.LN2;var AI=64,rI=4194304;function cI(g){switch(g&-g){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194240&g;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return 130023424&g;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return g}}function iI(g,I){var e=g.pendingLanes;if(0===e)return 0;var C=0,l=g.suspendedLanes,n=g.pingedLanes,t=268435455&e;if(0!==t){var a=t&~l;0!==a?C=cI(a):0!==(n&=t)&&(C=cI(n))}else 0!==(t=e&~l)?C=cI(t):0!==n&&(C=cI(n));if(0===C)return 0;if(0!==I&&I!==C&&0===(I&l)&&((l=C&-C)>=(n=I&-I)||16===l&&0!==(4194240&n)))return I;if(0!==(4&C)&&(C|=16&e),0!==(I=g.entangledLanes))for(g=g.entanglements,I&=C;0<I;)l=1<<(e=31-tI(I)),C|=g[e],I&=~l;return C}function dI(g,I){switch(g){case 1:case 2:case 4:return I+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return I+5e3;default:return-1}}function uI(g){return 0!==(g=-1073741825&g.pendingLanes)?g:1073741824&g?1073741824:0}function sI(){var g=AI;return 0===(4194240&(AI<<=1))&&(AI=64),g}function mI(g){for(var I=[],e=0;31>e;e++)I.push(g);return I}function bI(g,I,e){g.pendingLanes|=I,536870912!==I&&(g.suspendedLanes=0,g.pingedLanes=0),(g=g.eventTimes)[I=31-tI(I)]=e}function ZI(g,I){var e=g.entangledLanes|=I;for(g=g.entanglements;e;){var C=31-tI(e),l=1<<C;l&I|g[C]&I&&(g[C]|=I),e&=~l}}var GI=0;function yI(g){return 1<(g&=-g)?4<g?0!==(268435455&g)?16:536870912:4:1}var hI,BI,pI,WI,VI,SI=!1,vI=[],fI=null,RI=null,XI=null,JI=new Map,kI=new Map,YI=[],HI="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function wI(g,I){switch(g){case"focusin":case"focusout":fI=null;break;case"dragenter":case"dragleave":RI=null;break;case"mouseover":case"mouseout":XI=null;break;case"pointerover":case"pointerout":JI.delete(I.pointerId);break;case"gotpointercapture":case"lostpointercapture":kI.delete(I.pointerId)}}function NI(g,I,e,C,l,n){return null===g||g.nativeEvent!==n?(g={blockedOn:I,domEventName:e,eventSystemFlags:C,nativeEvent:n,targetContainers:[l]},null!==I&&(null!==(I=Zl(I))&&BI(I)),g):(g.eventSystemFlags|=C,I=g.targetContainers,null!==l&&-1===I.indexOf(l)&&I.push(l),g)}function FI(g){var I=bl(g.target);if(null!==I){var e=Ug(I);if(null!==e)if(13===(I=e.tag)){if(null!==(I=Qg(e)))return g.blockedOn=I,void VI(g.priority,(function(){pI(e)}))}else if(3===I&&e.stateNode.current.memoizedState.isDehydrated)return void(g.blockedOn=3===e.tag?e.stateNode.containerInfo:null)}g.blockedOn=null}function KI(g){if(null!==g.blockedOn)return!1;for(var I=g.targetContainers;0<I.length;){var e=PI(g.domEventName,g.eventSystemFlags,I[0],g.nativeEvent);if(null!==e)return null!==(I=Zl(e))&&BI(I),g.blockedOn=e,!1;var C=new(e=g.nativeEvent).constructor(e.type,e);yg=C,e.target.dispatchEvent(C),yg=null,I.shift()}return!0}function xI(g,I,e){KI(g)&&e.delete(I)}function zI(){SI=!1,null!==fI&&KI(fI)&&(fI=null),null!==RI&&KI(RI)&&(RI=null),null!==XI&&KI(XI)&&(XI=null),JI.forEach(xI),kI.forEach(xI)}function EI(g,I){g.blockedOn===I&&(g.blockedOn=null,SI||(SI=!0,l.unstable_scheduleCallback(l.unstable_NormalPriority,zI)))}function UI(g){function I(I){return EI(I,g)}if(0<vI.length){EI(vI[0],g);for(var e=1;e<vI.length;e++){var C=vI[e];C.blockedOn===g&&(C.blockedOn=null)}}for(null!==fI&&EI(fI,g),null!==RI&&EI(RI,g),null!==XI&&EI(XI,g),JI.forEach(I),kI.forEach(I),e=0;e<YI.length;e++)(C=YI[e]).blockedOn===g&&(C.blockedOn=null);for(;0<YI.length&&null===(e=YI[0]).blockedOn;)FI(e),null===e.blockedOn&&YI.shift()}var QI=y.ReactCurrentBatchConfig,MI=!0;function LI(g,I,e,C){var l=GI,n=QI.transition;QI.transition=null;try{GI=1,TI(g,I,e,C)}finally{GI=l,QI.transition=n}}function DI(g,I,e,C){var l=GI,n=QI.transition;QI.transition=null;try{GI=4,TI(g,I,e,C)}finally{GI=l,QI.transition=n}}function TI(g,I,e,C){if(MI){var l=PI(g,I,e,C);if(null===l)QC(g,I,C,jI,e),wI(g,C);else if(function(g,I,e,C,l){switch(I){case"focusin":return fI=NI(fI,g,I,e,C,l),!0;case"dragenter":return RI=NI(RI,g,I,e,C,l),!0;case"mouseover":return XI=NI(XI,g,I,e,C,l),!0;case"pointerover":var n=l.pointerId;return JI.set(n,NI(JI.get(n)||null,g,I,e,C,l)),!0;case"gotpointercapture":return n=l.pointerId,kI.set(n,NI(kI.get(n)||null,g,I,e,C,l)),!0}return!1}(l,g,I,e,C))C.stopPropagation();else if(wI(g,C),4&I&&-1<HI.indexOf(g)){for(;null!==l;){var n=Zl(l);if(null!==n&&hI(n),null===(n=PI(g,I,e,C))&&QC(g,I,C,jI,e),n===l)break;l=n}null!==l&&C.stopPropagation()}else QC(g,I,C,null,e)}}var jI=null;function PI(g,I,e,C){if(jI=null,null!==(g=bl(g=hg(C))))if(null===(I=Ug(g)))g=null;else if(13===(e=I.tag)){if(null!==(g=Qg(I)))return g;g=null}else if(3===e){if(I.stateNode.current.memoizedState.isDehydrated)return 3===I.tag?I.stateNode.containerInfo:null;g=null}else I!==g&&(g=null);return jI=g,null}function OI(g){switch(g){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(_g()){case $g:return 1;case gI:return 4;case II:case eI:return 16;case CI:return 536870912;default:return 16}default:return 16}}var qI=null,_I=null,$I=null;function ge(){if($I)return $I;var g,I,e=_I,C=e.length,l="value"in qI?qI.value:qI.textContent,n=l.length;for(g=0;g<C&&e[g]===l[g];g++);var t=C-g;for(I=1;I<=t&&e[C-I]===l[n-I];I++);return $I=l.slice(g,1<I?1-I:void 0)}function Ie(g){var I=g.keyCode;return"charCode"in g?0===(g=g.charCode)&&13===I&&(g=13):g=I,10===g&&(g=13),32<=g||13===g?g:0}function ee(){return!0}function Ce(){return!1}function le(g){function I(I,e,C,l,n){for(var t in this._reactName=I,this._targetInst=C,this.type=e,this.nativeEvent=l,this.target=n,this.currentTarget=null,g)g.hasOwnProperty(t)&&(I=g[t],this[t]=I?I(l):l[t]);return this.isDefaultPrevented=(null!=l.defaultPrevented?l.defaultPrevented:!1===l.returnValue)?ee:Ce,this.isPropagationStopped=Ce,this}return F(I.prototype,{preventDefault:function(){this.defaultPrevented=!0;var g=this.nativeEvent;g&&(g.preventDefault?g.preventDefault():"unknown"!==typeof g.returnValue&&(g.returnValue=!1),this.isDefaultPrevented=ee)},stopPropagation:function(){var g=this.nativeEvent;g&&(g.stopPropagation?g.stopPropagation():"unknown"!==typeof g.cancelBubble&&(g.cancelBubble=!0),this.isPropagationStopped=ee)},persist:function(){},isPersistent:ee}),I}var ne,te,ae,oe={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(g){return g.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Ae=le(oe),re=F({},oe,{view:0,detail:0}),ce=le(re),ie=F({},re,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:We,button:0,buttons:0,relatedTarget:function(g){return void 0===g.relatedTarget?g.fromElement===g.srcElement?g.toElement:g.fromElement:g.relatedTarget},movementX:function(g){return"movementX"in g?g.movementX:(g!==ae&&(ae&&"mousemove"===g.type?(ne=g.screenX-ae.screenX,te=g.screenY-ae.screenY):te=ne=0,ae=g),ne)},movementY:function(g){return"movementY"in g?g.movementY:te}}),de=le(ie),ue=le(F({},ie,{dataTransfer:0})),se=le(F({},re,{relatedTarget:0})),me=le(F({},oe,{animationName:0,elapsedTime:0,pseudoElement:0})),be=F({},oe,{clipboardData:function(g){return"clipboardData"in g?g.clipboardData:window.clipboardData}}),Ze=le(be),Ge=le(F({},oe,{data:0})),ye={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},he={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Be={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function pe(g){var I=this.nativeEvent;return I.getModifierState?I.getModifierState(g):!!(g=Be[g])&&!!I[g]}function We(){return pe}var Ve=F({},re,{key:function(g){if(g.key){var I=ye[g.key]||g.key;if("Unidentified"!==I)return I}return"keypress"===g.type?13===(g=Ie(g))?"Enter":String.fromCharCode(g):"keydown"===g.type||"keyup"===g.type?he[g.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:We,charCode:function(g){return"keypress"===g.type?Ie(g):0},keyCode:function(g){return"keydown"===g.type||"keyup"===g.type?g.keyCode:0},which:function(g){return"keypress"===g.type?Ie(g):"keydown"===g.type||"keyup"===g.type?g.keyCode:0}}),Se=le(Ve),ve=le(F({},ie,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),fe=le(F({},re,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:We})),Re=le(F({},oe,{propertyName:0,elapsedTime:0,pseudoElement:0})),Xe=F({},ie,{deltaX:function(g){return"deltaX"in g?g.deltaX:"wheelDeltaX"in g?-g.wheelDeltaX:0},deltaY:function(g){return"deltaY"in g?g.deltaY:"wheelDeltaY"in g?-g.wheelDeltaY:"wheelDelta"in g?-g.wheelDelta:0},deltaZ:0,deltaMode:0}),Je=le(Xe),ke=[9,13,27,32],Ye=r&&"CompositionEvent"in window,He=null;r&&"documentMode"in document&&(He=document.documentMode);var we=r&&"TextEvent"in window&&!He,Ne=r&&(!Ye||He&&8<He&&11>=He),Fe=String.fromCharCode(32),Ke=!1;function xe(g,I){switch(g){case"keyup":return-1!==ke.indexOf(I.keyCode);case"keydown":return 229!==I.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function ze(g){return"object"===typeof(g=g.detail)&&"data"in g?g.data:null}var Ee=!1;var Ue={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Qe(g){var I=g&&g.nodeName&&g.nodeName.toLowerCase();return"input"===I?!!Ue[g.type]:"textarea"===I}function Me(g,I,e,C){Sg(C),0<(I=LC(I,"onChange")).length&&(e=new Ae("onChange","change",null,e,C),g.push({event:e,listeners:I}))}var Le=null,De=null;function Te(g){FC(g,0)}function je(g){if(T(Gl(g)))return g}function Pe(g,I){if("change"===g)return I}var Oe=!1;if(r){var qe;if(r){var _e="oninput"in document;if(!_e){var $e=document.createElement("div");$e.setAttribute("oninput","return;"),_e="function"===typeof $e.oninput}qe=_e}else qe=!1;Oe=qe&&(!document.documentMode||9<document.documentMode)}function gC(){Le&&(Le.detachEvent("onpropertychange",IC),De=Le=null)}function IC(g){if("value"===g.propertyName&&je(De)){var I=[];Me(I,De,g,hg(g)),Jg(Te,I)}}function eC(g,I,e){"focusin"===g?(gC(),De=e,(Le=I).attachEvent("onpropertychange",IC)):"focusout"===g&&gC()}function CC(g){if("selectionchange"===g||"keyup"===g||"keydown"===g)return je(De)}function lC(g,I){if("click"===g)return je(I)}function nC(g,I){if("input"===g||"change"===g)return je(I)}var tC="function"===typeof Object.is?Object.is:function(g,I){return g===I&&(0!==g||1/g===1/I)||g!==g&&I!==I};function aC(g,I){if(tC(g,I))return!0;if("object"!==typeof g||null===g||"object"!==typeof I||null===I)return!1;var e=Object.keys(g),C=Object.keys(I);if(e.length!==C.length)return!1;for(C=0;C<e.length;C++){var l=e[C];if(!c.call(I,l)||!tC(g[l],I[l]))return!1}return!0}function oC(g){for(;g&&g.firstChild;)g=g.firstChild;return g}function AC(g,I){var e,C=oC(g);for(g=0;C;){if(3===C.nodeType){if(e=g+C.textContent.length,g<=I&&e>=I)return{node:C,offset:I-g};g=e}g:{for(;C;){if(C.nextSibling){C=C.nextSibling;break g}C=C.parentNode}C=void 0}C=oC(C)}}function rC(g,I){return!(!g||!I)&&(g===I||(!g||3!==g.nodeType)&&(I&&3===I.nodeType?rC(g,I.parentNode):"contains"in g?g.contains(I):!!g.compareDocumentPosition&&!!(16&g.compareDocumentPosition(I))))}function cC(){for(var g=window,I=j();I instanceof g.HTMLIFrameElement;){try{var e="string"===typeof I.contentWindow.location.href}catch(C){e=!1}if(!e)break;I=j((g=I.contentWindow).document)}return I}function iC(g){var I=g&&g.nodeName&&g.nodeName.toLowerCase();return I&&("input"===I&&("text"===g.type||"search"===g.type||"tel"===g.type||"url"===g.type||"password"===g.type)||"textarea"===I||"true"===g.contentEditable)}function dC(g){var I=cC(),e=g.focusedElem,C=g.selectionRange;if(I!==e&&e&&e.ownerDocument&&rC(e.ownerDocument.documentElement,e)){if(null!==C&&iC(e))if(I=C.start,void 0===(g=C.end)&&(g=I),"selectionStart"in e)e.selectionStart=I,e.selectionEnd=Math.min(g,e.value.length);else if((g=(I=e.ownerDocument||document)&&I.defaultView||window).getSelection){g=g.getSelection();var l=e.textContent.length,n=Math.min(C.start,l);C=void 0===C.end?n:Math.min(C.end,l),!g.extend&&n>C&&(l=C,C=n,n=l),l=AC(e,n);var t=AC(e,C);l&&t&&(1!==g.rangeCount||g.anchorNode!==l.node||g.anchorOffset!==l.offset||g.focusNode!==t.node||g.focusOffset!==t.offset)&&((I=I.createRange()).setStart(l.node,l.offset),g.removeAllRanges(),n>C?(g.addRange(I),g.extend(t.node,t.offset)):(I.setEnd(t.node,t.offset),g.addRange(I)))}for(I=[],g=e;g=g.parentNode;)1===g.nodeType&&I.push({element:g,left:g.scrollLeft,top:g.scrollTop});for("function"===typeof e.focus&&e.focus(),e=0;e<I.length;e++)(g=I[e]).element.scrollLeft=g.left,g.element.scrollTop=g.top}}var uC=r&&"documentMode"in document&&11>=document.documentMode,sC=null,mC=null,bC=null,ZC=!1;function GC(g,I,e){var C=e.window===e?e.document:9===e.nodeType?e:e.ownerDocument;ZC||null==sC||sC!==j(C)||("selectionStart"in(C=sC)&&iC(C)?C={start:C.selectionStart,end:C.selectionEnd}:C={anchorNode:(C=(C.ownerDocument&&C.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:C.anchorOffset,focusNode:C.focusNode,focusOffset:C.focusOffset},bC&&aC(bC,C)||(bC=C,0<(C=LC(mC,"onSelect")).length&&(I=new Ae("onSelect","select",null,I,e),g.push({event:I,listeners:C}),I.target=sC)))}function yC(g,I){var e={};return e[g.toLowerCase()]=I.toLowerCase(),e["Webkit"+g]="webkit"+I,e["Moz"+g]="moz"+I,e}var hC={animationend:yC("Animation","AnimationEnd"),animationiteration:yC("Animation","AnimationIteration"),animationstart:yC("Animation","AnimationStart"),transitionend:yC("Transition","TransitionEnd")},BC={},pC={};function WC(g){if(BC[g])return BC[g];if(!hC[g])return g;var I,e=hC[g];for(I in e)if(e.hasOwnProperty(I)&&I in pC)return BC[g]=e[I];return g}r&&(pC=document.createElement("div").style,"AnimationEvent"in window||(delete hC.animationend.animation,delete hC.animationiteration.animation,delete hC.animationstart.animation),"TransitionEvent"in window||delete hC.transitionend.transition);var VC=WC("animationend"),SC=WC("animationiteration"),vC=WC("animationstart"),fC=WC("transitionend"),RC=new Map,XC="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function JC(g,I){RC.set(g,I),o(I,[g])}for(var kC=0;kC<XC.length;kC++){var YC=XC[kC];JC(YC.toLowerCase(),"on"+(YC[0].toUpperCase()+YC.slice(1)))}JC(VC,"onAnimationEnd"),JC(SC,"onAnimationIteration"),JC(vC,"onAnimationStart"),JC("dblclick","onDoubleClick"),JC("focusin","onFocus"),JC("focusout","onBlur"),JC(fC,"onTransitionEnd"),A("onMouseEnter",["mouseout","mouseover"]),A("onMouseLeave",["mouseout","mouseover"]),A("onPointerEnter",["pointerout","pointerover"]),A("onPointerLeave",["pointerout","pointerover"]),o("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),o("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),o("onBeforeInput",["compositionend","keypress","textInput","paste"]),o("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),o("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),o("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var HC="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),wC=new Set("cancel close invalid load scroll toggle".split(" ").concat(HC));function NC(g,I,e){var C=g.type||"unknown-event";g.currentTarget=e,function(g,I,e,C,l,t,a,o,A){if(Eg.apply(this,arguments),Ng){if(!Ng)throw Error(n(198));var r=Fg;Ng=!1,Fg=null,Kg||(Kg=!0,xg=r)}}(C,I,void 0,g),g.currentTarget=null}function FC(g,I){I=0!==(4&I);for(var e=0;e<g.length;e++){var C=g[e],l=C.event;C=C.listeners;g:{var n=void 0;if(I)for(var t=C.length-1;0<=t;t--){var a=C[t],o=a.instance,A=a.currentTarget;if(a=a.listener,o!==n&&l.isPropagationStopped())break g;NC(l,a,A),n=o}else for(t=0;t<C.length;t++){if(o=(a=C[t]).instance,A=a.currentTarget,a=a.listener,o!==n&&l.isPropagationStopped())break g;NC(l,a,A),n=o}}}if(Kg)throw g=xg,Kg=!1,xg=null,g}function KC(g,I){var e=I[ul];void 0===e&&(e=I[ul]=new Set);var C=g+"__bubble";e.has(C)||(UC(I,g,2,!1),e.add(C))}function xC(g,I,e){var C=0;I&&(C|=4),UC(e,g,C,I)}var zC="_reactListening"+Math.random().toString(36).slice(2);function EC(g){if(!g[zC]){g[zC]=!0,t.forEach((function(I){"selectionchange"!==I&&(wC.has(I)||xC(I,!1,g),xC(I,!0,g))}));var I=9===g.nodeType?g:g.ownerDocument;null===I||I[zC]||(I[zC]=!0,xC("selectionchange",!1,I))}}function UC(g,I,e,C){switch(OI(I)){case 1:var l=LI;break;case 4:l=DI;break;default:l=TI}e=l.bind(null,I,e,g),l=void 0,!Yg||"touchstart"!==I&&"touchmove"!==I&&"wheel"!==I||(l=!0),C?void 0!==l?g.addEventListener(I,e,{capture:!0,passive:l}):g.addEventListener(I,e,!0):void 0!==l?g.addEventListener(I,e,{passive:l}):g.addEventListener(I,e,!1)}function QC(g,I,e,C,l){var n=C;if(0===(1&I)&&0===(2&I)&&null!==C)g:for(;;){if(null===C)return;var t=C.tag;if(3===t||4===t){var a=C.stateNode.containerInfo;if(a===l||8===a.nodeType&&a.parentNode===l)break;if(4===t)for(t=C.return;null!==t;){var o=t.tag;if((3===o||4===o)&&((o=t.stateNode.containerInfo)===l||8===o.nodeType&&o.parentNode===l))return;t=t.return}for(;null!==a;){if(null===(t=bl(a)))return;if(5===(o=t.tag)||6===o){C=n=t;continue g}a=a.parentNode}}C=C.return}Jg((function(){var C=n,l=hg(e),t=[];g:{var a=RC.get(g);if(void 0!==a){var o=Ae,A=g;switch(g){case"keypress":if(0===Ie(e))break g;case"keydown":case"keyup":o=Se;break;case"focusin":A="focus",o=se;break;case"focusout":A="blur",o=se;break;case"beforeblur":case"afterblur":o=se;break;case"click":if(2===e.button)break g;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":o=de;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":o=ue;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":o=fe;break;case VC:case SC:case vC:o=me;break;case fC:o=Re;break;case"scroll":o=ce;break;case"wheel":o=Je;break;case"copy":case"cut":case"paste":o=Ze;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":o=ve}var r=0!==(4&I),c=!r&&"scroll"===g,i=r?null!==a?a+"Capture":null:a;r=[];for(var d,u=C;null!==u;){var s=(d=u).stateNode;if(5===d.tag&&null!==s&&(d=s,null!==i&&(null!=(s=kg(u,i))&&r.push(MC(u,s,d)))),c)break;u=u.return}0<r.length&&(a=new o(a,A,null,e,l),t.push({event:a,listeners:r}))}}if(0===(7&I)){if(o="mouseout"===g||"pointerout"===g,(!(a="mouseover"===g||"pointerover"===g)||e===yg||!(A=e.relatedTarget||e.fromElement)||!bl(A)&&!A[dl])&&(o||a)&&(a=l.window===l?l:(a=l.ownerDocument)?a.defaultView||a.parentWindow:window,o?(o=C,null!==(A=(A=e.relatedTarget||e.toElement)?bl(A):null)&&(A!==(c=Ug(A))||5!==A.tag&&6!==A.tag)&&(A=null)):(o=null,A=C),o!==A)){if(r=de,s="onMouseLeave",i="onMouseEnter",u="mouse","pointerout"!==g&&"pointerover"!==g||(r=ve,s="onPointerLeave",i="onPointerEnter",u="pointer"),c=null==o?a:Gl(o),d=null==A?a:Gl(A),(a=new r(s,u+"leave",o,e,l)).target=c,a.relatedTarget=d,s=null,bl(l)===C&&((r=new r(i,u+"enter",A,e,l)).target=d,r.relatedTarget=c,s=r),c=s,o&&A)g:{for(i=A,u=0,d=r=o;d;d=DC(d))u++;for(d=0,s=i;s;s=DC(s))d++;for(;0<u-d;)r=DC(r),u--;for(;0<d-u;)i=DC(i),d--;for(;u--;){if(r===i||null!==i&&r===i.alternate)break g;r=DC(r),i=DC(i)}r=null}else r=null;null!==o&&TC(t,a,o,r,!1),null!==A&&null!==c&&TC(t,c,A,r,!0)}if("select"===(o=(a=C?Gl(C):window).nodeName&&a.nodeName.toLowerCase())||"input"===o&&"file"===a.type)var m=Pe;else if(Qe(a))if(Oe)m=nC;else{m=CC;var b=eC}else(o=a.nodeName)&&"input"===o.toLowerCase()&&("checkbox"===a.type||"radio"===a.type)&&(m=lC);switch(m&&(m=m(g,C))?Me(t,m,e,l):(b&&b(g,a,C),"focusout"===g&&(b=a._wrapperState)&&b.controlled&&"number"===a.type&&gg(a,"number",a.value)),b=C?Gl(C):window,g){case"focusin":(Qe(b)||"true"===b.contentEditable)&&(sC=b,mC=C,bC=null);break;case"focusout":bC=mC=sC=null;break;case"mousedown":ZC=!0;break;case"contextmenu":case"mouseup":case"dragend":ZC=!1,GC(t,e,l);break;case"selectionchange":if(uC)break;case"keydown":case"keyup":GC(t,e,l)}var Z;if(Ye)g:{switch(g){case"compositionstart":var G="onCompositionStart";break g;case"compositionend":G="onCompositionEnd";break g;case"compositionupdate":G="onCompositionUpdate";break g}G=void 0}else Ee?xe(g,e)&&(G="onCompositionEnd"):"keydown"===g&&229===e.keyCode&&(G="onCompositionStart");G&&(Ne&&"ko"!==e.locale&&(Ee||"onCompositionStart"!==G?"onCompositionEnd"===G&&Ee&&(Z=ge()):(_I="value"in(qI=l)?qI.value:qI.textContent,Ee=!0)),0<(b=LC(C,G)).length&&(G=new Ge(G,g,null,e,l),t.push({event:G,listeners:b}),Z?G.data=Z:null!==(Z=ze(e))&&(G.data=Z))),(Z=we?function(g,I){switch(g){case"compositionend":return ze(I);case"keypress":return 32!==I.which?null:(Ke=!0,Fe);case"textInput":return(g=I.data)===Fe&&Ke?null:g;default:return null}}(g,e):function(g,I){if(Ee)return"compositionend"===g||!Ye&&xe(g,I)?(g=ge(),$I=_I=qI=null,Ee=!1,g):null;switch(g){case"paste":default:return null;case"keypress":if(!(I.ctrlKey||I.altKey||I.metaKey)||I.ctrlKey&&I.altKey){if(I.char&&1<I.char.length)return I.char;if(I.which)return String.fromCharCode(I.which)}return null;case"compositionend":return Ne&&"ko"!==I.locale?null:I.data}}(g,e))&&(0<(C=LC(C,"onBeforeInput")).length&&(l=new Ge("onBeforeInput","beforeinput",null,e,l),t.push({event:l,listeners:C}),l.data=Z))}FC(t,I)}))}function MC(g,I,e){return{instance:g,listener:I,currentTarget:e}}function LC(g,I){for(var e=I+"Capture",C=[];null!==g;){var l=g,n=l.stateNode;5===l.tag&&null!==n&&(l=n,null!=(n=kg(g,e))&&C.unshift(MC(g,n,l)),null!=(n=kg(g,I))&&C.push(MC(g,n,l))),g=g.return}return C}function DC(g){if(null===g)return null;do{g=g.return}while(g&&5!==g.tag);return g||null}function TC(g,I,e,C,l){for(var n=I._reactName,t=[];null!==e&&e!==C;){var a=e,o=a.alternate,A=a.stateNode;if(null!==o&&o===C)break;5===a.tag&&null!==A&&(a=A,l?null!=(o=kg(e,n))&&t.unshift(MC(e,o,a)):l||null!=(o=kg(e,n))&&t.push(MC(e,o,a))),e=e.return}0!==t.length&&g.push({event:I,listeners:t})}var jC=/\r\n?/g,PC=/\u0000|\uFFFD/g;function OC(g){return("string"===typeof g?g:""+g).replace(jC,"\n").replace(PC,"")}function qC(g,I,e){if(I=OC(I),OC(g)!==I&&e)throw Error(n(425))}function _C(){}var $C=null,gl=null;function Il(g,I){return"textarea"===g||"noscript"===g||"string"===typeof I.children||"number"===typeof I.children||"object"===typeof I.dangerouslySetInnerHTML&&null!==I.dangerouslySetInnerHTML&&null!=I.dangerouslySetInnerHTML.__html}var el="function"===typeof setTimeout?setTimeout:void 0,Cl="function"===typeof clearTimeout?clearTimeout:void 0,ll="function"===typeof Promise?Promise:void 0,nl="function"===typeof queueMicrotask?queueMicrotask:"undefined"!==typeof ll?function(g){return ll.resolve(null).then(g).catch(tl)}:el;function tl(g){setTimeout((function(){throw g}))}function al(g,I){var e=I,C=0;do{var l=e.nextSibling;if(g.removeChild(e),l&&8===l.nodeType)if("/$"===(e=l.data)){if(0===C)return g.removeChild(l),void UI(I);C--}else"$"!==e&&"$?"!==e&&"$!"!==e||C++;e=l}while(e);UI(I)}function ol(g){for(;null!=g;g=g.nextSibling){var I=g.nodeType;if(1===I||3===I)break;if(8===I){if("$"===(I=g.data)||"$!"===I||"$?"===I)break;if("/$"===I)return null}}return g}function Al(g){g=g.previousSibling;for(var I=0;g;){if(8===g.nodeType){var e=g.data;if("$"===e||"$!"===e||"$?"===e){if(0===I)return g;I--}else"/$"===e&&I++}g=g.previousSibling}return null}var rl=Math.random().toString(36).slice(2),cl="__reactFiber$"+rl,il="__reactProps$"+rl,dl="__reactContainer$"+rl,ul="__reactEvents$"+rl,sl="__reactListeners$"+rl,ml="__reactHandles$"+rl;function bl(g){var I=g[cl];if(I)return I;for(var e=g.parentNode;e;){if(I=e[dl]||e[cl]){if(e=I.alternate,null!==I.child||null!==e&&null!==e.child)for(g=Al(g);null!==g;){if(e=g[cl])return e;g=Al(g)}return I}e=(g=e).parentNode}return null}function Zl(g){return!(g=g[cl]||g[dl])||5!==g.tag&&6!==g.tag&&13!==g.tag&&3!==g.tag?null:g}function Gl(g){if(5===g.tag||6===g.tag)return g.stateNode;throw Error(n(33))}function yl(g){return g[il]||null}var hl=[],Bl=-1;function pl(g){return{current:g}}function Wl(g){0>Bl||(g.current=hl[Bl],hl[Bl]=null,Bl--)}function Vl(g,I){Bl++,hl[Bl]=g.current,g.current=I}var Sl={},vl=pl(Sl),fl=pl(!1),Rl=Sl;function Xl(g,I){var e=g.type.contextTypes;if(!e)return Sl;var C=g.stateNode;if(C&&C.__reactInternalMemoizedUnmaskedChildContext===I)return C.__reactInternalMemoizedMaskedChildContext;var l,n={};for(l in e)n[l]=I[l];return C&&((g=g.stateNode).__reactInternalMemoizedUnmaskedChildContext=I,g.__reactInternalMemoizedMaskedChildContext=n),n}function Jl(g){return null!==(g=g.childContextTypes)&&void 0!==g}function kl(){Wl(fl),Wl(vl)}function Yl(g,I,e){if(vl.current!==Sl)throw Error(n(168));Vl(vl,I),Vl(fl,e)}function Hl(g,I,e){var C=g.stateNode;if(I=I.childContextTypes,"function"!==typeof C.getChildContext)return e;for(var l in C=C.getChildContext())if(!(l in I))throw Error(n(108,Q(g)||"Unknown",l));return F({},e,C)}function wl(g){return g=(g=g.stateNode)&&g.__reactInternalMemoizedMergedChildContext||Sl,Rl=vl.current,Vl(vl,g),Vl(fl,fl.current),!0}function Nl(g,I,e){var C=g.stateNode;if(!C)throw Error(n(169));e?(g=Hl(g,I,Rl),C.__reactInternalMemoizedMergedChildContext=g,Wl(fl),Wl(vl),Vl(vl,g)):Wl(fl),Vl(fl,e)}var Fl=null,Kl=!1,xl=!1;function zl(g){null===Fl?Fl=[g]:Fl.push(g)}function El(){if(!xl&&null!==Fl){xl=!0;var g=0,I=GI;try{var e=Fl;for(GI=1;g<e.length;g++){var C=e[g];do{C=C(!0)}while(null!==C)}Fl=null,Kl=!1}catch(l){throw null!==Fl&&(Fl=Fl.slice(g+1)),Tg($g,El),l}finally{GI=I,xl=!1}}return null}var Ul=[],Ql=0,Ml=null,Ll=0,Dl=[],Tl=0,jl=null,Pl=1,Ol="";function ql(g,I){Ul[Ql++]=Ll,Ul[Ql++]=Ml,Ml=g,Ll=I}function _l(g,I,e){Dl[Tl++]=Pl,Dl[Tl++]=Ol,Dl[Tl++]=jl,jl=g;var C=Pl;g=Ol;var l=32-tI(C)-1;C&=~(1<<l),e+=1;var n=32-tI(I)+l;if(30<n){var t=l-l%5;n=(C&(1<<t)-1).toString(32),C>>=t,l-=t,Pl=1<<32-tI(I)+l|e<<l|C,Ol=n+g}else Pl=1<<n|e<<l|C,Ol=g}function $l(g){null!==g.return&&(ql(g,1),_l(g,1,0))}function gn(g){for(;g===Ml;)Ml=Ul[--Ql],Ul[Ql]=null,Ll=Ul[--Ql],Ul[Ql]=null;for(;g===jl;)jl=Dl[--Tl],Dl[Tl]=null,Ol=Dl[--Tl],Dl[Tl]=null,Pl=Dl[--Tl],Dl[Tl]=null}var In=null,en=null,Cn=!1,ln=null;function nn(g,I){var e=kA(5,null,null,0);e.elementType="DELETED",e.stateNode=I,e.return=g,null===(I=g.deletions)?(g.deletions=[e],g.flags|=16):I.push(e)}function tn(g,I){switch(g.tag){case 5:var e=g.type;return null!==(I=1!==I.nodeType||e.toLowerCase()!==I.nodeName.toLowerCase()?null:I)&&(g.stateNode=I,In=g,en=ol(I.firstChild),!0);case 6:return null!==(I=""===g.pendingProps||3!==I.nodeType?null:I)&&(g.stateNode=I,In=g,en=null,!0);case 13:return null!==(I=8!==I.nodeType?null:I)&&(e=null!==jl?{id:Pl,overflow:Ol}:null,g.memoizedState={dehydrated:I,treeContext:e,retryLane:1073741824},(e=kA(18,null,null,0)).stateNode=I,e.return=g,g.child=e,In=g,en=null,!0);default:return!1}}function an(g){return 0!==(1&g.mode)&&0===(128&g.flags)}function on(g){if(Cn){var I=en;if(I){var e=I;if(!tn(g,I)){if(an(g))throw Error(n(418));I=ol(e.nextSibling);var C=In;I&&tn(g,I)?nn(C,e):(g.flags=-4097&g.flags|2,Cn=!1,In=g)}}else{if(an(g))throw Error(n(418));g.flags=-4097&g.flags|2,Cn=!1,In=g}}}function An(g){for(g=g.return;null!==g&&5!==g.tag&&3!==g.tag&&13!==g.tag;)g=g.return;In=g}function rn(g){if(g!==In)return!1;if(!Cn)return An(g),Cn=!0,!1;var I;if((I=3!==g.tag)&&!(I=5!==g.tag)&&(I="head"!==(I=g.type)&&"body"!==I&&!Il(g.type,g.memoizedProps)),I&&(I=en)){if(an(g))throw cn(),Error(n(418));for(;I;)nn(g,I),I=ol(I.nextSibling)}if(An(g),13===g.tag){if(!(g=null!==(g=g.memoizedState)?g.dehydrated:null))throw Error(n(317));g:{for(g=g.nextSibling,I=0;g;){if(8===g.nodeType){var e=g.data;if("/$"===e){if(0===I){en=ol(g.nextSibling);break g}I--}else"$"!==e&&"$!"!==e&&"$?"!==e||I++}g=g.nextSibling}en=null}}else en=In?ol(g.stateNode.nextSibling):null;return!0}function cn(){for(var g=en;g;)g=ol(g.nextSibling)}function dn(){en=In=null,Cn=!1}function un(g){null===ln?ln=[g]:ln.push(g)}var sn=y.ReactCurrentBatchConfig;function mn(g,I){if(g&&g.defaultProps){for(var e in I=F({},I),g=g.defaultProps)void 0===I[e]&&(I[e]=g[e]);return I}return I}var bn=pl(null),Zn=null,Gn=null,yn=null;function hn(){yn=Gn=Zn=null}function Bn(g){var I=bn.current;Wl(bn),g._currentValue=I}function pn(g,I,e){for(;null!==g;){var C=g.alternate;if((g.childLanes&I)!==I?(g.childLanes|=I,null!==C&&(C.childLanes|=I)):null!==C&&(C.childLanes&I)!==I&&(C.childLanes|=I),g===e)break;g=g.return}}function Wn(g,I){Zn=g,yn=Gn=null,null!==(g=g.dependencies)&&null!==g.firstContext&&(0!==(g.lanes&I)&&(Ga=!0),g.firstContext=null)}function Vn(g){var I=g._currentValue;if(yn!==g)if(g={context:g,memoizedValue:I,next:null},null===Gn){if(null===Zn)throw Error(n(308));Gn=g,Zn.dependencies={lanes:0,firstContext:g}}else Gn=Gn.next=g;return I}var Sn=null;function vn(g){null===Sn?Sn=[g]:Sn.push(g)}function fn(g,I,e,C){var l=I.interleaved;return null===l?(e.next=e,vn(I)):(e.next=l.next,l.next=e),I.interleaved=e,Rn(g,C)}function Rn(g,I){g.lanes|=I;var e=g.alternate;for(null!==e&&(e.lanes|=I),e=g,g=g.return;null!==g;)g.childLanes|=I,null!==(e=g.alternate)&&(e.childLanes|=I),e=g,g=g.return;return 3===e.tag?e.stateNode:null}var Xn=!1;function Jn(g){g.updateQueue={baseState:g.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function kn(g,I){g=g.updateQueue,I.updateQueue===g&&(I.updateQueue={baseState:g.baseState,firstBaseUpdate:g.firstBaseUpdate,lastBaseUpdate:g.lastBaseUpdate,shared:g.shared,effects:g.effects})}function Yn(g,I){return{eventTime:g,lane:I,tag:0,payload:null,callback:null,next:null}}function Hn(g,I,e){var C=g.updateQueue;if(null===C)return null;if(C=C.shared,0!==(2&Ro)){var l=C.pending;return null===l?I.next=I:(I.next=l.next,l.next=I),C.pending=I,Rn(g,e)}return null===(l=C.interleaved)?(I.next=I,vn(C)):(I.next=l.next,l.next=I),C.interleaved=I,Rn(g,e)}function wn(g,I,e){if(null!==(I=I.updateQueue)&&(I=I.shared,0!==(4194240&e))){var C=I.lanes;e|=C&=g.pendingLanes,I.lanes=e,ZI(g,e)}}function Nn(g,I){var e=g.updateQueue,C=g.alternate;if(null!==C&&e===(C=C.updateQueue)){var l=null,n=null;if(null!==(e=e.firstBaseUpdate)){do{var t={eventTime:e.eventTime,lane:e.lane,tag:e.tag,payload:e.payload,callback:e.callback,next:null};null===n?l=n=t:n=n.next=t,e=e.next}while(null!==e);null===n?l=n=I:n=n.next=I}else l=n=I;return e={baseState:C.baseState,firstBaseUpdate:l,lastBaseUpdate:n,shared:C.shared,effects:C.effects},void(g.updateQueue=e)}null===(g=e.lastBaseUpdate)?e.firstBaseUpdate=I:g.next=I,e.lastBaseUpdate=I}function Fn(g,I,e,C){var l=g.updateQueue;Xn=!1;var n=l.firstBaseUpdate,t=l.lastBaseUpdate,a=l.shared.pending;if(null!==a){l.shared.pending=null;var o=a,A=o.next;o.next=null,null===t?n=A:t.next=A,t=o;var r=g.alternate;null!==r&&((a=(r=r.updateQueue).lastBaseUpdate)!==t&&(null===a?r.firstBaseUpdate=A:a.next=A,r.lastBaseUpdate=o))}if(null!==n){var c=l.baseState;for(t=0,r=A=o=null,a=n;;){var i=a.lane,d=a.eventTime;if((C&i)===i){null!==r&&(r=r.next={eventTime:d,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});g:{var u=g,s=a;switch(i=I,d=e,s.tag){case 1:if("function"===typeof(u=s.payload)){c=u.call(d,c,i);break g}c=u;break g;case 3:u.flags=-65537&u.flags|128;case 0:if(null===(i="function"===typeof(u=s.payload)?u.call(d,c,i):u)||void 0===i)break g;c=F({},c,i);break g;case 2:Xn=!0}}null!==a.callback&&0!==a.lane&&(g.flags|=64,null===(i=l.effects)?l.effects=[a]:i.push(a))}else d={eventTime:d,lane:i,tag:a.tag,payload:a.payload,callback:a.callback,next:null},null===r?(A=r=d,o=c):r=r.next=d,t|=i;if(null===(a=a.next)){if(null===(a=l.shared.pending))break;a=(i=a).next,i.next=null,l.lastBaseUpdate=i,l.shared.pending=null}}if(null===r&&(o=c),l.baseState=o,l.firstBaseUpdate=A,l.lastBaseUpdate=r,null!==(I=l.shared.interleaved)){l=I;do{t|=l.lane,l=l.next}while(l!==I)}else null===n&&(l.shared.lanes=0);Fo|=t,g.lanes=t,g.memoizedState=c}}function Kn(g,I,e){if(g=I.effects,I.effects=null,null!==g)for(I=0;I<g.length;I++){var C=g[I],l=C.callback;if(null!==l){if(C.callback=null,C=e,"function"!==typeof l)throw Error(n(191,l));l.call(C)}}}var xn=(new C.Component).refs;function zn(g,I,e,C){e=null===(e=e(C,I=g.memoizedState))||void 0===e?I:F({},I,e),g.memoizedState=e,0===g.lanes&&(g.updateQueue.baseState=e)}var En={isMounted:function(g){return!!(g=g._reactInternals)&&Ug(g)===g},enqueueSetState:function(g,I,e){g=g._reactInternals;var C=IA(),l=eA(g),n=Yn(C,l);n.payload=I,void 0!==e&&null!==e&&(n.callback=e),null!==(I=Hn(g,n,l))&&(CA(I,g,l,C),wn(I,g,l))},enqueueReplaceState:function(g,I,e){g=g._reactInternals;var C=IA(),l=eA(g),n=Yn(C,l);n.tag=1,n.payload=I,void 0!==e&&null!==e&&(n.callback=e),null!==(I=Hn(g,n,l))&&(CA(I,g,l,C),wn(I,g,l))},enqueueForceUpdate:function(g,I){g=g._reactInternals;var e=IA(),C=eA(g),l=Yn(e,C);l.tag=2,void 0!==I&&null!==I&&(l.callback=I),null!==(I=Hn(g,l,C))&&(CA(I,g,C,e),wn(I,g,C))}};function Un(g,I,e,C,l,n,t){return"function"===typeof(g=g.stateNode).shouldComponentUpdate?g.shouldComponentUpdate(C,n,t):!I.prototype||!I.prototype.isPureReactComponent||(!aC(e,C)||!aC(l,n))}function Qn(g,I,e){var C=!1,l=Sl,n=I.contextType;return"object"===typeof n&&null!==n?n=Vn(n):(l=Jl(I)?Rl:vl.current,n=(C=null!==(C=I.contextTypes)&&void 0!==C)?Xl(g,l):Sl),I=new I(e,n),g.memoizedState=null!==I.state&&void 0!==I.state?I.state:null,I.updater=En,g.stateNode=I,I._reactInternals=g,C&&((g=g.stateNode).__reactInternalMemoizedUnmaskedChildContext=l,g.__reactInternalMemoizedMaskedChildContext=n),I}function Mn(g,I,e,C){g=I.state,"function"===typeof I.componentWillReceiveProps&&I.componentWillReceiveProps(e,C),"function"===typeof I.UNSAFE_componentWillReceiveProps&&I.UNSAFE_componentWillReceiveProps(e,C),I.state!==g&&En.enqueueReplaceState(I,I.state,null)}function Ln(g,I,e,C){var l=g.stateNode;l.props=e,l.state=g.memoizedState,l.refs=xn,Jn(g);var n=I.contextType;"object"===typeof n&&null!==n?l.context=Vn(n):(n=Jl(I)?Rl:vl.current,l.context=Xl(g,n)),l.state=g.memoizedState,"function"===typeof(n=I.getDerivedStateFromProps)&&(zn(g,I,n,e),l.state=g.memoizedState),"function"===typeof I.getDerivedStateFromProps||"function"===typeof l.getSnapshotBeforeUpdate||"function"!==typeof l.UNSAFE_componentWillMount&&"function"!==typeof l.componentWillMount||(I=l.state,"function"===typeof l.componentWillMount&&l.componentWillMount(),"function"===typeof l.UNSAFE_componentWillMount&&l.UNSAFE_componentWillMount(),I!==l.state&&En.enqueueReplaceState(l,l.state,null),Fn(g,e,l,C),l.state=g.memoizedState),"function"===typeof l.componentDidMount&&(g.flags|=4194308)}function Dn(g,I,e){if(null!==(g=e.ref)&&"function"!==typeof g&&"object"!==typeof g){if(e._owner){if(e=e._owner){if(1!==e.tag)throw Error(n(309));var C=e.stateNode}if(!C)throw Error(n(147,g));var l=C,t=""+g;return null!==I&&null!==I.ref&&"function"===typeof I.ref&&I.ref._stringRef===t?I.ref:(I=function(g){var I=l.refs;I===xn&&(I=l.refs={}),null===g?delete I[t]:I[t]=g},I._stringRef=t,I)}if("string"!==typeof g)throw Error(n(284));if(!e._owner)throw Error(n(290,g))}return g}function Tn(g,I){throw g=Object.prototype.toString.call(I),Error(n(31,"[object Object]"===g?"object with keys {"+Object.keys(I).join(", ")+"}":g))}function jn(g){return(0,g._init)(g._payload)}function Pn(g){function I(I,e){if(g){var C=I.deletions;null===C?(I.deletions=[e],I.flags|=16):C.push(e)}}function e(e,C){if(!g)return null;for(;null!==C;)I(e,C),C=C.sibling;return null}function C(g,I){for(g=new Map;null!==I;)null!==I.key?g.set(I.key,I):g.set(I.index,I),I=I.sibling;return g}function l(g,I){return(g=HA(g,I)).index=0,g.sibling=null,g}function t(I,e,C){return I.index=C,g?null!==(C=I.alternate)?(C=C.index)<e?(I.flags|=2,e):C:(I.flags|=2,e):(I.flags|=1048576,e)}function a(I){return g&&null===I.alternate&&(I.flags|=2),I}function o(g,I,e,C){return null===I||6!==I.tag?((I=KA(e,g.mode,C)).return=g,I):((I=l(I,e)).return=g,I)}function A(g,I,e,C){var n=e.type;return n===p?c(g,I,e.props.children,C,e.key):null!==I&&(I.elementType===n||"object"===typeof n&&null!==n&&n.$$typeof===k&&jn(n)===I.type)?((C=l(I,e.props)).ref=Dn(g,I,e),C.return=g,C):((C=wA(e.type,e.key,e.props,null,g.mode,C)).ref=Dn(g,I,e),C.return=g,C)}function r(g,I,e,C){return null===I||4!==I.tag||I.stateNode.containerInfo!==e.containerInfo||I.stateNode.implementation!==e.implementation?((I=xA(e,g.mode,C)).return=g,I):((I=l(I,e.children||[])).return=g,I)}function c(g,I,e,C,n){return null===I||7!==I.tag?((I=NA(e,g.mode,C,n)).return=g,I):((I=l(I,e)).return=g,I)}function i(g,I,e){if("string"===typeof I&&""!==I||"number"===typeof I)return(I=KA(""+I,g.mode,e)).return=g,I;if("object"===typeof I&&null!==I){switch(I.$$typeof){case h:return(e=wA(I.type,I.key,I.props,null,g.mode,e)).ref=Dn(g,null,I),e.return=g,e;case B:return(I=xA(I,g.mode,e)).return=g,I;case k:return i(g,(0,I._init)(I._payload),e)}if(Ig(I)||w(I))return(I=NA(I,g.mode,e,null)).return=g,I;Tn(g,I)}return null}function d(g,I,e,C){var l=null!==I?I.key:null;if("string"===typeof e&&""!==e||"number"===typeof e)return null!==l?null:o(g,I,""+e,C);if("object"===typeof e&&null!==e){switch(e.$$typeof){case h:return e.key===l?A(g,I,e,C):null;case B:return e.key===l?r(g,I,e,C):null;case k:return d(g,I,(l=e._init)(e._payload),C)}if(Ig(e)||w(e))return null!==l?null:c(g,I,e,C,null);Tn(g,e)}return null}function u(g,I,e,C,l){if("string"===typeof C&&""!==C||"number"===typeof C)return o(I,g=g.get(e)||null,""+C,l);if("object"===typeof C&&null!==C){switch(C.$$typeof){case h:return A(I,g=g.get(null===C.key?e:C.key)||null,C,l);case B:return r(I,g=g.get(null===C.key?e:C.key)||null,C,l);case k:return u(g,I,e,(0,C._init)(C._payload),l)}if(Ig(C)||w(C))return c(I,g=g.get(e)||null,C,l,null);Tn(I,C)}return null}function s(l,n,a,o){for(var A=null,r=null,c=n,s=n=0,m=null;null!==c&&s<a.length;s++){c.index>s?(m=c,c=null):m=c.sibling;var b=d(l,c,a[s],o);if(null===b){null===c&&(c=m);break}g&&c&&null===b.alternate&&I(l,c),n=t(b,n,s),null===r?A=b:r.sibling=b,r=b,c=m}if(s===a.length)return e(l,c),Cn&&ql(l,s),A;if(null===c){for(;s<a.length;s++)null!==(c=i(l,a[s],o))&&(n=t(c,n,s),null===r?A=c:r.sibling=c,r=c);return Cn&&ql(l,s),A}for(c=C(l,c);s<a.length;s++)null!==(m=u(c,l,s,a[s],o))&&(g&&null!==m.alternate&&c.delete(null===m.key?s:m.key),n=t(m,n,s),null===r?A=m:r.sibling=m,r=m);return g&&c.forEach((function(g){return I(l,g)})),Cn&&ql(l,s),A}function m(l,a,o,A){var r=w(o);if("function"!==typeof r)throw Error(n(150));if(null==(o=r.call(o)))throw Error(n(151));for(var c=r=null,s=a,m=a=0,b=null,Z=o.next();null!==s&&!Z.done;m++,Z=o.next()){s.index>m?(b=s,s=null):b=s.sibling;var G=d(l,s,Z.value,A);if(null===G){null===s&&(s=b);break}g&&s&&null===G.alternate&&I(l,s),a=t(G,a,m),null===c?r=G:c.sibling=G,c=G,s=b}if(Z.done)return e(l,s),Cn&&ql(l,m),r;if(null===s){for(;!Z.done;m++,Z=o.next())null!==(Z=i(l,Z.value,A))&&(a=t(Z,a,m),null===c?r=Z:c.sibling=Z,c=Z);return Cn&&ql(l,m),r}for(s=C(l,s);!Z.done;m++,Z=o.next())null!==(Z=u(s,l,m,Z.value,A))&&(g&&null!==Z.alternate&&s.delete(null===Z.key?m:Z.key),a=t(Z,a,m),null===c?r=Z:c.sibling=Z,c=Z);return g&&s.forEach((function(g){return I(l,g)})),Cn&&ql(l,m),r}return function g(C,n,t,o){if("object"===typeof t&&null!==t&&t.type===p&&null===t.key&&(t=t.props.children),"object"===typeof t&&null!==t){switch(t.$$typeof){case h:g:{for(var A=t.key,r=n;null!==r;){if(r.key===A){if((A=t.type)===p){if(7===r.tag){e(C,r.sibling),(n=l(r,t.props.children)).return=C,C=n;break g}}else if(r.elementType===A||"object"===typeof A&&null!==A&&A.$$typeof===k&&jn(A)===r.type){e(C,r.sibling),(n=l(r,t.props)).ref=Dn(C,r,t),n.return=C,C=n;break g}e(C,r);break}I(C,r),r=r.sibling}t.type===p?((n=NA(t.props.children,C.mode,o,t.key)).return=C,C=n):((o=wA(t.type,t.key,t.props,null,C.mode,o)).ref=Dn(C,n,t),o.return=C,C=o)}return a(C);case B:g:{for(r=t.key;null!==n;){if(n.key===r){if(4===n.tag&&n.stateNode.containerInfo===t.containerInfo&&n.stateNode.implementation===t.implementation){e(C,n.sibling),(n=l(n,t.children||[])).return=C,C=n;break g}e(C,n);break}I(C,n),n=n.sibling}(n=xA(t,C.mode,o)).return=C,C=n}return a(C);case k:return g(C,n,(r=t._init)(t._payload),o)}if(Ig(t))return s(C,n,t,o);if(w(t))return m(C,n,t,o);Tn(C,t)}return"string"===typeof t&&""!==t||"number"===typeof t?(t=""+t,null!==n&&6===n.tag?(e(C,n.sibling),(n=l(n,t)).return=C,C=n):(e(C,n),(n=KA(t,C.mode,o)).return=C,C=n),a(C)):e(C,n)}}var On=Pn(!0),qn=Pn(!1),_n={},$n=pl(_n),gt=pl(_n),It=pl(_n);function et(g){if(g===_n)throw Error(n(174));return g}function Ct(g,I){switch(Vl(It,I),Vl(gt,g),Vl($n,_n),g=I.nodeType){case 9:case 11:I=(I=I.documentElement)?I.namespaceURI:og(null,"");break;default:I=og(I=(g=8===g?I.parentNode:I).namespaceURI||null,g=g.tagName)}Wl($n),Vl($n,I)}function lt(){Wl($n),Wl(gt),Wl(It)}function nt(g){et(It.current);var I=et($n.current),e=og(I,g.type);I!==e&&(Vl(gt,g),Vl($n,e))}function tt(g){gt.current===g&&(Wl($n),Wl(gt))}var at=pl(0);function ot(g){for(var I=g;null!==I;){if(13===I.tag){var e=I.memoizedState;if(null!==e&&(null===(e=e.dehydrated)||"$?"===e.data||"$!"===e.data))return I}else if(19===I.tag&&void 0!==I.memoizedProps.revealOrder){if(0!==(128&I.flags))return I}else if(null!==I.child){I.child.return=I,I=I.child;continue}if(I===g)break;for(;null===I.sibling;){if(null===I.return||I.return===g)return null;I=I.return}I.sibling.return=I.return,I=I.sibling}return null}var At=[];function rt(){for(var g=0;g<At.length;g++)At[g]._workInProgressVersionPrimary=null;At.length=0}var ct=y.ReactCurrentDispatcher,it=y.ReactCurrentBatchConfig,dt=0,ut=null,st=null,mt=null,bt=!1,Zt=!1,Gt=0,yt=0;function ht(){throw Error(n(321))}function Bt(g,I){if(null===I)return!1;for(var e=0;e<I.length&&e<g.length;e++)if(!tC(g[e],I[e]))return!1;return!0}function pt(g,I,e,C,l,t){if(dt=t,ut=I,I.memoizedState=null,I.updateQueue=null,I.lanes=0,ct.current=null===g||null===g.memoizedState?ta:aa,g=e(C,l),Zt){t=0;do{if(Zt=!1,Gt=0,25<=t)throw Error(n(301));t+=1,mt=st=null,I.updateQueue=null,ct.current=oa,g=e(C,l)}while(Zt)}if(ct.current=na,I=null!==st&&null!==st.next,dt=0,mt=st=ut=null,bt=!1,I)throw Error(n(300));return g}function Wt(){var g=0!==Gt;return Gt=0,g}function Vt(){var g={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===mt?ut.memoizedState=mt=g:mt=mt.next=g,mt}function St(){if(null===st){var g=ut.alternate;g=null!==g?g.memoizedState:null}else g=st.next;var I=null===mt?ut.memoizedState:mt.next;if(null!==I)mt=I,st=g;else{if(null===g)throw Error(n(310));g={memoizedState:(st=g).memoizedState,baseState:st.baseState,baseQueue:st.baseQueue,queue:st.queue,next:null},null===mt?ut.memoizedState=mt=g:mt=mt.next=g}return mt}function vt(g,I){return"function"===typeof I?I(g):I}function ft(g){var I=St(),e=I.queue;if(null===e)throw Error(n(311));e.lastRenderedReducer=g;var C=st,l=C.baseQueue,t=e.pending;if(null!==t){if(null!==l){var a=l.next;l.next=t.next,t.next=a}C.baseQueue=l=t,e.pending=null}if(null!==l){t=l.next,C=C.baseState;var o=a=null,A=null,r=t;do{var c=r.lane;if((dt&c)===c)null!==A&&(A=A.next={lane:0,action:r.action,hasEagerState:r.hasEagerState,eagerState:r.eagerState,next:null}),C=r.hasEagerState?r.eagerState:g(C,r.action);else{var i={lane:c,action:r.action,hasEagerState:r.hasEagerState,eagerState:r.eagerState,next:null};null===A?(o=A=i,a=C):A=A.next=i,ut.lanes|=c,Fo|=c}r=r.next}while(null!==r&&r!==t);null===A?a=C:A.next=o,tC(C,I.memoizedState)||(Ga=!0),I.memoizedState=C,I.baseState=a,I.baseQueue=A,e.lastRenderedState=C}if(null!==(g=e.interleaved)){l=g;do{t=l.lane,ut.lanes|=t,Fo|=t,l=l.next}while(l!==g)}else null===l&&(e.lanes=0);return[I.memoizedState,e.dispatch]}function Rt(g){var I=St(),e=I.queue;if(null===e)throw Error(n(311));e.lastRenderedReducer=g;var C=e.dispatch,l=e.pending,t=I.memoizedState;if(null!==l){e.pending=null;var a=l=l.next;do{t=g(t,a.action),a=a.next}while(a!==l);tC(t,I.memoizedState)||(Ga=!0),I.memoizedState=t,null===I.baseQueue&&(I.baseState=t),e.lastRenderedState=t}return[t,C]}function Xt(){}function Jt(g,I){var e=ut,C=St(),l=I(),t=!tC(C.memoizedState,l);if(t&&(C.memoizedState=l,Ga=!0),C=C.queue,Qt(Ht.bind(null,e,C,g),[g]),C.getSnapshot!==I||t||null!==mt&&1&mt.memoizedState.tag){if(e.flags|=2048,Kt(9,Yt.bind(null,e,C,l,I),void 0,null),null===Xo)throw Error(n(349));0!==(30&dt)||kt(e,I,l)}return l}function kt(g,I,e){g.flags|=16384,g={getSnapshot:I,value:e},null===(I=ut.updateQueue)?(I={lastEffect:null,stores:null},ut.updateQueue=I,I.stores=[g]):null===(e=I.stores)?I.stores=[g]:e.push(g)}function Yt(g,I,e,C){I.value=e,I.getSnapshot=C,wt(I)&&Nt(g)}function Ht(g,I,e){return e((function(){wt(I)&&Nt(g)}))}function wt(g){var I=g.getSnapshot;g=g.value;try{var e=I();return!tC(g,e)}catch(C){return!0}}function Nt(g){var I=Rn(g,1);null!==I&&CA(I,g,1,-1)}function Ft(g){var I=Vt();return"function"===typeof g&&(g=g()),I.memoizedState=I.baseState=g,g={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:vt,lastRenderedState:g},I.queue=g,g=g.dispatch=Ia.bind(null,ut,g),[I.memoizedState,g]}function Kt(g,I,e,C){return g={tag:g,create:I,destroy:e,deps:C,next:null},null===(I=ut.updateQueue)?(I={lastEffect:null,stores:null},ut.updateQueue=I,I.lastEffect=g.next=g):null===(e=I.lastEffect)?I.lastEffect=g.next=g:(C=e.next,e.next=g,g.next=C,I.lastEffect=g),g}function xt(){return St().memoizedState}function zt(g,I,e,C){var l=Vt();ut.flags|=g,l.memoizedState=Kt(1|I,e,void 0,void 0===C?null:C)}function Et(g,I,e,C){var l=St();C=void 0===C?null:C;var n=void 0;if(null!==st){var t=st.memoizedState;if(n=t.destroy,null!==C&&Bt(C,t.deps))return void(l.memoizedState=Kt(I,e,n,C))}ut.flags|=g,l.memoizedState=Kt(1|I,e,n,C)}function Ut(g,I){return zt(8390656,8,g,I)}function Qt(g,I){return Et(2048,8,g,I)}function Mt(g,I){return Et(4,2,g,I)}function Lt(g,I){return Et(4,4,g,I)}function Dt(g,I){return"function"===typeof I?(g=g(),I(g),function(){I(null)}):null!==I&&void 0!==I?(g=g(),I.current=g,function(){I.current=null}):void 0}function Tt(g,I,e){return e=null!==e&&void 0!==e?e.concat([g]):null,Et(4,4,Dt.bind(null,I,g),e)}function jt(){}function Pt(g,I){var e=St();I=void 0===I?null:I;var C=e.memoizedState;return null!==C&&null!==I&&Bt(I,C[1])?C[0]:(e.memoizedState=[g,I],g)}function Ot(g,I){var e=St();I=void 0===I?null:I;var C=e.memoizedState;return null!==C&&null!==I&&Bt(I,C[1])?C[0]:(g=g(),e.memoizedState=[g,I],g)}function qt(g,I,e){return 0===(21&dt)?(g.baseState&&(g.baseState=!1,Ga=!0),g.memoizedState=e):(tC(e,I)||(e=sI(),ut.lanes|=e,Fo|=e,g.baseState=!0),I)}function _t(g,I){var e=GI;GI=0!==e&&4>e?e:4,g(!0);var C=it.transition;it.transition={};try{g(!1),I()}finally{GI=e,it.transition=C}}function $t(){return St().memoizedState}function ga(g,I,e){var C=eA(g);if(e={lane:C,action:e,hasEagerState:!1,eagerState:null,next:null},ea(g))Ca(I,e);else if(null!==(e=fn(g,I,e,C))){CA(e,g,C,IA()),la(e,I,C)}}function Ia(g,I,e){var C=eA(g),l={lane:C,action:e,hasEagerState:!1,eagerState:null,next:null};if(ea(g))Ca(I,l);else{var n=g.alternate;if(0===g.lanes&&(null===n||0===n.lanes)&&null!==(n=I.lastRenderedReducer))try{var t=I.lastRenderedState,a=n(t,e);if(l.hasEagerState=!0,l.eagerState=a,tC(a,t)){var o=I.interleaved;return null===o?(l.next=l,vn(I)):(l.next=o.next,o.next=l),void(I.interleaved=l)}}catch(A){}null!==(e=fn(g,I,l,C))&&(CA(e,g,C,l=IA()),la(e,I,C))}}function ea(g){var I=g.alternate;return g===ut||null!==I&&I===ut}function Ca(g,I){Zt=bt=!0;var e=g.pending;null===e?I.next=I:(I.next=e.next,e.next=I),g.pending=I}function la(g,I,e){if(0!==(4194240&e)){var C=I.lanes;e|=C&=g.pendingLanes,I.lanes=e,ZI(g,e)}}var na={readContext:Vn,useCallback:ht,useContext:ht,useEffect:ht,useImperativeHandle:ht,useInsertionEffect:ht,useLayoutEffect:ht,useMemo:ht,useReducer:ht,useRef:ht,useState:ht,useDebugValue:ht,useDeferredValue:ht,useTransition:ht,useMutableSource:ht,useSyncExternalStore:ht,useId:ht,unstable_isNewReconciler:!1},ta={readContext:Vn,useCallback:function(g,I){return Vt().memoizedState=[g,void 0===I?null:I],g},useContext:Vn,useEffect:Ut,useImperativeHandle:function(g,I,e){return e=null!==e&&void 0!==e?e.concat([g]):null,zt(4194308,4,Dt.bind(null,I,g),e)},useLayoutEffect:function(g,I){return zt(4194308,4,g,I)},useInsertionEffect:function(g,I){return zt(4,2,g,I)},useMemo:function(g,I){var e=Vt();return I=void 0===I?null:I,g=g(),e.memoizedState=[g,I],g},useReducer:function(g,I,e){var C=Vt();return I=void 0!==e?e(I):I,C.memoizedState=C.baseState=I,g={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:g,lastRenderedState:I},C.queue=g,g=g.dispatch=ga.bind(null,ut,g),[C.memoizedState,g]},useRef:function(g){return g={current:g},Vt().memoizedState=g},useState:Ft,useDebugValue:jt,useDeferredValue:function(g){return Vt().memoizedState=g},useTransition:function(){var g=Ft(!1),I=g[0];return g=_t.bind(null,g[1]),Vt().memoizedState=g,[I,g]},useMutableSource:function(){},useSyncExternalStore:function(g,I,e){var C=ut,l=Vt();if(Cn){if(void 0===e)throw Error(n(407));e=e()}else{if(e=I(),null===Xo)throw Error(n(349));0!==(30&dt)||kt(C,I,e)}l.memoizedState=e;var t={value:e,getSnapshot:I};return l.queue=t,Ut(Ht.bind(null,C,t,g),[g]),C.flags|=2048,Kt(9,Yt.bind(null,C,t,e,I),void 0,null),e},useId:function(){var g=Vt(),I=Xo.identifierPrefix;if(Cn){var e=Ol;I=":"+I+"R"+(e=(Pl&~(1<<32-tI(Pl)-1)).toString(32)+e),0<(e=Gt++)&&(I+="H"+e.toString(32)),I+=":"}else I=":"+I+"r"+(e=yt++).toString(32)+":";return g.memoizedState=I},unstable_isNewReconciler:!1},aa={readContext:Vn,useCallback:Pt,useContext:Vn,useEffect:Qt,useImperativeHandle:Tt,useInsertionEffect:Mt,useLayoutEffect:Lt,useMemo:Ot,useReducer:ft,useRef:xt,useState:function(){return ft(vt)},useDebugValue:jt,useDeferredValue:function(g){return qt(St(),st.memoizedState,g)},useTransition:function(){return[ft(vt)[0],St().memoizedState]},useMutableSource:Xt,useSyncExternalStore:Jt,useId:$t,unstable_isNewReconciler:!1},oa={readContext:Vn,useCallback:Pt,useContext:Vn,useEffect:Qt,useImperativeHandle:Tt,useInsertionEffect:Mt,useLayoutEffect:Lt,useMemo:Ot,useReducer:Rt,useRef:xt,useState:function(){return Rt(vt)},useDebugValue:jt,useDeferredValue:function(g){var I=St();return null===st?I.memoizedState=g:qt(I,st.memoizedState,g)},useTransition:function(){return[Rt(vt)[0],St().memoizedState]},useMutableSource:Xt,useSyncExternalStore:Jt,useId:$t,unstable_isNewReconciler:!1};function Aa(g,I){try{var e="",C=I;do{e+=E(C),C=C.return}while(C);var l=e}catch(n){l="\nError generating stack: "+n.message+"\n"+n.stack}return{value:g,source:I,stack:l,digest:null}}function ra(g,I,e){return{value:g,source:null,stack:null!=e?e:null,digest:null!=I?I:null}}function ca(g,I){try{console.error(I.value)}catch(e){setTimeout((function(){throw e}))}}var ia="function"===typeof WeakMap?WeakMap:Map;function da(g,I,e){(e=Yn(-1,e)).tag=3,e.payload={element:null};var C=I.value;return e.callback=function(){Lo||(Lo=!0,Do=C),ca(0,I)},e}function ua(g,I,e){(e=Yn(-1,e)).tag=3;var C=g.type.getDerivedStateFromError;if("function"===typeof C){var l=I.value;e.payload=function(){return C(l)},e.callback=function(){ca(0,I)}}var n=g.stateNode;return null!==n&&"function"===typeof n.componentDidCatch&&(e.callback=function(){ca(0,I),"function"!==typeof C&&(null===To?To=new Set([this]):To.add(this));var g=I.stack;this.componentDidCatch(I.value,{componentStack:null!==g?g:""})}),e}function sa(g,I,e){var C=g.pingCache;if(null===C){C=g.pingCache=new ia;var l=new Set;C.set(I,l)}else void 0===(l=C.get(I))&&(l=new Set,C.set(I,l));l.has(e)||(l.add(e),g=SA.bind(null,g,I,e),I.then(g,g))}function ma(g){do{var I;if((I=13===g.tag)&&(I=null===(I=g.memoizedState)||null!==I.dehydrated),I)return g;g=g.return}while(null!==g);return null}function ba(g,I,e,C,l){return 0===(1&g.mode)?(g===I?g.flags|=65536:(g.flags|=128,e.flags|=131072,e.flags&=-52805,1===e.tag&&(null===e.alternate?e.tag=17:((I=Yn(-1,1)).tag=2,Hn(e,I,1))),e.lanes|=1),g):(g.flags|=65536,g.lanes=l,g)}var Za=y.ReactCurrentOwner,Ga=!1;function ya(g,I,e,C){I.child=null===g?qn(I,null,e,C):On(I,g.child,e,C)}function ha(g,I,e,C,l){e=e.render;var n=I.ref;return Wn(I,l),C=pt(g,I,e,C,n,l),e=Wt(),null===g||Ga?(Cn&&e&&$l(I),I.flags|=1,ya(g,I,C,l),I.child):(I.updateQueue=g.updateQueue,I.flags&=-2053,g.lanes&=~l,Ma(g,I,l))}function Ba(g,I,e,C,l){if(null===g){var n=e.type;return"function"!==typeof n||YA(n)||void 0!==n.defaultProps||null!==e.compare||void 0!==e.defaultProps?((g=wA(e.type,null,C,I,I.mode,l)).ref=I.ref,g.return=I,I.child=g):(I.tag=15,I.type=n,pa(g,I,n,C,l))}if(n=g.child,0===(g.lanes&l)){var t=n.memoizedProps;if((e=null!==(e=e.compare)?e:aC)(t,C)&&g.ref===I.ref)return Ma(g,I,l)}return I.flags|=1,(g=HA(n,C)).ref=I.ref,g.return=I,I.child=g}function pa(g,I,e,C,l){if(null!==g){var n=g.memoizedProps;if(aC(n,C)&&g.ref===I.ref){if(Ga=!1,I.pendingProps=C=n,0===(g.lanes&l))return I.lanes=g.lanes,Ma(g,I,l);0!==(131072&g.flags)&&(Ga=!0)}}return Sa(g,I,e,C,l)}function Wa(g,I,e){var C=I.pendingProps,l=C.children,n=null!==g?g.memoizedState:null;if("hidden"===C.mode)if(0===(1&I.mode))I.memoizedState={baseLanes:0,cachePool:null,transitions:null},Vl(Ho,Yo),Yo|=e;else{if(0===(1073741824&e))return g=null!==n?n.baseLanes|e:e,I.lanes=I.childLanes=1073741824,I.memoizedState={baseLanes:g,cachePool:null,transitions:null},I.updateQueue=null,Vl(Ho,Yo),Yo|=g,null;I.memoizedState={baseLanes:0,cachePool:null,transitions:null},C=null!==n?n.baseLanes:e,Vl(Ho,Yo),Yo|=C}else null!==n?(C=n.baseLanes|e,I.memoizedState=null):C=e,Vl(Ho,Yo),Yo|=C;return ya(g,I,l,e),I.child}function Va(g,I){var e=I.ref;(null===g&&null!==e||null!==g&&g.ref!==e)&&(I.flags|=512,I.flags|=2097152)}function Sa(g,I,e,C,l){var n=Jl(e)?Rl:vl.current;return n=Xl(I,n),Wn(I,l),e=pt(g,I,e,C,n,l),C=Wt(),null===g||Ga?(Cn&&C&&$l(I),I.flags|=1,ya(g,I,e,l),I.child):(I.updateQueue=g.updateQueue,I.flags&=-2053,g.lanes&=~l,Ma(g,I,l))}function va(g,I,e,C,l){if(Jl(e)){var n=!0;wl(I)}else n=!1;if(Wn(I,l),null===I.stateNode)Qa(g,I),Qn(I,e,C),Ln(I,e,C,l),C=!0;else if(null===g){var t=I.stateNode,a=I.memoizedProps;t.props=a;var o=t.context,A=e.contextType;"object"===typeof A&&null!==A?A=Vn(A):A=Xl(I,A=Jl(e)?Rl:vl.current);var r=e.getDerivedStateFromProps,c="function"===typeof r||"function"===typeof t.getSnapshotBeforeUpdate;c||"function"!==typeof t.UNSAFE_componentWillReceiveProps&&"function"!==typeof t.componentWillReceiveProps||(a!==C||o!==A)&&Mn(I,t,C,A),Xn=!1;var i=I.memoizedState;t.state=i,Fn(I,C,t,l),o=I.memoizedState,a!==C||i!==o||fl.current||Xn?("function"===typeof r&&(zn(I,e,r,C),o=I.memoizedState),(a=Xn||Un(I,e,a,C,i,o,A))?(c||"function"!==typeof t.UNSAFE_componentWillMount&&"function"!==typeof t.componentWillMount||("function"===typeof t.componentWillMount&&t.componentWillMount(),"function"===typeof t.UNSAFE_componentWillMount&&t.UNSAFE_componentWillMount()),"function"===typeof t.componentDidMount&&(I.flags|=4194308)):("function"===typeof t.componentDidMount&&(I.flags|=4194308),I.memoizedProps=C,I.memoizedState=o),t.props=C,t.state=o,t.context=A,C=a):("function"===typeof t.componentDidMount&&(I.flags|=4194308),C=!1)}else{t=I.stateNode,kn(g,I),a=I.memoizedProps,A=I.type===I.elementType?a:mn(I.type,a),t.props=A,c=I.pendingProps,i=t.context,"object"===typeof(o=e.contextType)&&null!==o?o=Vn(o):o=Xl(I,o=Jl(e)?Rl:vl.current);var d=e.getDerivedStateFromProps;(r="function"===typeof d||"function"===typeof t.getSnapshotBeforeUpdate)||"function"!==typeof t.UNSAFE_componentWillReceiveProps&&"function"!==typeof t.componentWillReceiveProps||(a!==c||i!==o)&&Mn(I,t,C,o),Xn=!1,i=I.memoizedState,t.state=i,Fn(I,C,t,l);var u=I.memoizedState;a!==c||i!==u||fl.current||Xn?("function"===typeof d&&(zn(I,e,d,C),u=I.memoizedState),(A=Xn||Un(I,e,A,C,i,u,o)||!1)?(r||"function"!==typeof t.UNSAFE_componentWillUpdate&&"function"!==typeof t.componentWillUpdate||("function"===typeof t.componentWillUpdate&&t.componentWillUpdate(C,u,o),"function"===typeof t.UNSAFE_componentWillUpdate&&t.UNSAFE_componentWillUpdate(C,u,o)),"function"===typeof t.componentDidUpdate&&(I.flags|=4),"function"===typeof t.getSnapshotBeforeUpdate&&(I.flags|=1024)):("function"!==typeof t.componentDidUpdate||a===g.memoizedProps&&i===g.memoizedState||(I.flags|=4),"function"!==typeof t.getSnapshotBeforeUpdate||a===g.memoizedProps&&i===g.memoizedState||(I.flags|=1024),I.memoizedProps=C,I.memoizedState=u),t.props=C,t.state=u,t.context=o,C=A):("function"!==typeof t.componentDidUpdate||a===g.memoizedProps&&i===g.memoizedState||(I.flags|=4),"function"!==typeof t.getSnapshotBeforeUpdate||a===g.memoizedProps&&i===g.memoizedState||(I.flags|=1024),C=!1)}return fa(g,I,e,C,n,l)}function fa(g,I,e,C,l,n){Va(g,I);var t=0!==(128&I.flags);if(!C&&!t)return l&&Nl(I,e,!1),Ma(g,I,n);C=I.stateNode,Za.current=I;var a=t&&"function"!==typeof e.getDerivedStateFromError?null:C.render();return I.flags|=1,null!==g&&t?(I.child=On(I,g.child,null,n),I.child=On(I,null,a,n)):ya(g,I,a,n),I.memoizedState=C.state,l&&Nl(I,e,!0),I.child}function Ra(g){var I=g.stateNode;I.pendingContext?Yl(0,I.pendingContext,I.pendingContext!==I.context):I.context&&Yl(0,I.context,!1),Ct(g,I.containerInfo)}function Xa(g,I,e,C,l){return dn(),un(l),I.flags|=256,ya(g,I,e,C),I.child}var Ja,ka,Ya,Ha,wa={dehydrated:null,treeContext:null,retryLane:0};function Na(g){return{baseLanes:g,cachePool:null,transitions:null}}function Fa(g,I,e){var C,l=I.pendingProps,t=at.current,a=!1,o=0!==(128&I.flags);if((C=o)||(C=(null===g||null!==g.memoizedState)&&0!==(2&t)),C?(a=!0,I.flags&=-129):null!==g&&null===g.memoizedState||(t|=1),Vl(at,1&t),null===g)return on(I),null!==(g=I.memoizedState)&&null!==(g=g.dehydrated)?(0===(1&I.mode)?I.lanes=1:"$!"===g.data?I.lanes=8:I.lanes=1073741824,null):(o=l.children,g=l.fallback,a?(l=I.mode,a=I.child,o={mode:"hidden",children:o},0===(1&l)&&null!==a?(a.childLanes=0,a.pendingProps=o):a=FA(o,l,0,null),g=NA(g,l,e,null),a.return=I,g.return=I,a.sibling=g,I.child=a,I.child.memoizedState=Na(e),I.memoizedState=wa,g):Ka(I,o));if(null!==(t=g.memoizedState)&&null!==(C=t.dehydrated))return function(g,I,e,C,l,t,a){if(e)return 256&I.flags?(I.flags&=-257,xa(g,I,a,C=ra(Error(n(422))))):null!==I.memoizedState?(I.child=g.child,I.flags|=128,null):(t=C.fallback,l=I.mode,C=FA({mode:"visible",children:C.children},l,0,null),(t=NA(t,l,a,null)).flags|=2,C.return=I,t.return=I,C.sibling=t,I.child=C,0!==(1&I.mode)&&On(I,g.child,null,a),I.child.memoizedState=Na(a),I.memoizedState=wa,t);if(0===(1&I.mode))return xa(g,I,a,null);if("$!"===l.data){if(C=l.nextSibling&&l.nextSibling.dataset)var o=C.dgst;return C=o,xa(g,I,a,C=ra(t=Error(n(419)),C,void 0))}if(o=0!==(a&g.childLanes),Ga||o){if(null!==(C=Xo)){switch(a&-a){case 4:l=2;break;case 16:l=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:l=32;break;case 536870912:l=268435456;break;default:l=0}0!==(l=0!==(l&(C.suspendedLanes|a))?0:l)&&l!==t.retryLane&&(t.retryLane=l,Rn(g,l),CA(C,g,l,-1))}return mA(),xa(g,I,a,C=ra(Error(n(421))))}return"$?"===l.data?(I.flags|=128,I.child=g.child,I=fA.bind(null,g),l._reactRetry=I,null):(g=t.treeContext,en=ol(l.nextSibling),In=I,Cn=!0,ln=null,null!==g&&(Dl[Tl++]=Pl,Dl[Tl++]=Ol,Dl[Tl++]=jl,Pl=g.id,Ol=g.overflow,jl=I),I=Ka(I,C.children),I.flags|=4096,I)}(g,I,o,l,C,t,e);if(a){a=l.fallback,o=I.mode,C=(t=g.child).sibling;var A={mode:"hidden",children:l.children};return 0===(1&o)&&I.child!==t?((l=I.child).childLanes=0,l.pendingProps=A,I.deletions=null):(l=HA(t,A)).subtreeFlags=14680064&t.subtreeFlags,null!==C?a=HA(C,a):(a=NA(a,o,e,null)).flags|=2,a.return=I,l.return=I,l.sibling=a,I.child=l,l=a,a=I.child,o=null===(o=g.child.memoizedState)?Na(e):{baseLanes:o.baseLanes|e,cachePool:null,transitions:o.transitions},a.memoizedState=o,a.childLanes=g.childLanes&~e,I.memoizedState=wa,l}return g=(a=g.child).sibling,l=HA(a,{mode:"visible",children:l.children}),0===(1&I.mode)&&(l.lanes=e),l.return=I,l.sibling=null,null!==g&&(null===(e=I.deletions)?(I.deletions=[g],I.flags|=16):e.push(g)),I.child=l,I.memoizedState=null,l}function Ka(g,I){return(I=FA({mode:"visible",children:I},g.mode,0,null)).return=g,g.child=I}function xa(g,I,e,C){return null!==C&&un(C),On(I,g.child,null,e),(g=Ka(I,I.pendingProps.children)).flags|=2,I.memoizedState=null,g}function za(g,I,e){g.lanes|=I;var C=g.alternate;null!==C&&(C.lanes|=I),pn(g.return,I,e)}function Ea(g,I,e,C,l){var n=g.memoizedState;null===n?g.memoizedState={isBackwards:I,rendering:null,renderingStartTime:0,last:C,tail:e,tailMode:l}:(n.isBackwards=I,n.rendering=null,n.renderingStartTime=0,n.last=C,n.tail=e,n.tailMode=l)}function Ua(g,I,e){var C=I.pendingProps,l=C.revealOrder,n=C.tail;if(ya(g,I,C.children,e),0!==(2&(C=at.current)))C=1&C|2,I.flags|=128;else{if(null!==g&&0!==(128&g.flags))g:for(g=I.child;null!==g;){if(13===g.tag)null!==g.memoizedState&&za(g,e,I);else if(19===g.tag)za(g,e,I);else if(null!==g.child){g.child.return=g,g=g.child;continue}if(g===I)break g;for(;null===g.sibling;){if(null===g.return||g.return===I)break g;g=g.return}g.sibling.return=g.return,g=g.sibling}C&=1}if(Vl(at,C),0===(1&I.mode))I.memoizedState=null;else switch(l){case"forwards":for(e=I.child,l=null;null!==e;)null!==(g=e.alternate)&&null===ot(g)&&(l=e),e=e.sibling;null===(e=l)?(l=I.child,I.child=null):(l=e.sibling,e.sibling=null),Ea(I,!1,l,e,n);break;case"backwards":for(e=null,l=I.child,I.child=null;null!==l;){if(null!==(g=l.alternate)&&null===ot(g)){I.child=l;break}g=l.sibling,l.sibling=e,e=l,l=g}Ea(I,!0,e,null,n);break;case"together":Ea(I,!1,null,null,void 0);break;default:I.memoizedState=null}return I.child}function Qa(g,I){0===(1&I.mode)&&null!==g&&(g.alternate=null,I.alternate=null,I.flags|=2)}function Ma(g,I,e){if(null!==g&&(I.dependencies=g.dependencies),Fo|=I.lanes,0===(e&I.childLanes))return null;if(null!==g&&I.child!==g.child)throw Error(n(153));if(null!==I.child){for(e=HA(g=I.child,g.pendingProps),I.child=e,e.return=I;null!==g.sibling;)g=g.sibling,(e=e.sibling=HA(g,g.pendingProps)).return=I;e.sibling=null}return I.child}function La(g,I){if(!Cn)switch(g.tailMode){case"hidden":I=g.tail;for(var e=null;null!==I;)null!==I.alternate&&(e=I),I=I.sibling;null===e?g.tail=null:e.sibling=null;break;case"collapsed":e=g.tail;for(var C=null;null!==e;)null!==e.alternate&&(C=e),e=e.sibling;null===C?I||null===g.tail?g.tail=null:g.tail.sibling=null:C.sibling=null}}function Da(g){var I=null!==g.alternate&&g.alternate.child===g.child,e=0,C=0;if(I)for(var l=g.child;null!==l;)e|=l.lanes|l.childLanes,C|=14680064&l.subtreeFlags,C|=14680064&l.flags,l.return=g,l=l.sibling;else for(l=g.child;null!==l;)e|=l.lanes|l.childLanes,C|=l.subtreeFlags,C|=l.flags,l.return=g,l=l.sibling;return g.subtreeFlags|=C,g.childLanes=e,I}function Ta(g,I,e){var C=I.pendingProps;switch(gn(I),I.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Da(I),null;case 1:case 17:return Jl(I.type)&&kl(),Da(I),null;case 3:return C=I.stateNode,lt(),Wl(fl),Wl(vl),rt(),C.pendingContext&&(C.context=C.pendingContext,C.pendingContext=null),null!==g&&null!==g.child||(rn(I)?I.flags|=4:null===g||g.memoizedState.isDehydrated&&0===(256&I.flags)||(I.flags|=1024,null!==ln&&(aA(ln),ln=null))),ka(g,I),Da(I),null;case 5:tt(I);var l=et(It.current);if(e=I.type,null!==g&&null!=I.stateNode)Ya(g,I,e,C,l),g.ref!==I.ref&&(I.flags|=512,I.flags|=2097152);else{if(!C){if(null===I.stateNode)throw Error(n(166));return Da(I),null}if(g=et($n.current),rn(I)){C=I.stateNode,e=I.type;var t=I.memoizedProps;switch(C[cl]=I,C[il]=t,g=0!==(1&I.mode),e){case"dialog":KC("cancel",C),KC("close",C);break;case"iframe":case"object":case"embed":KC("load",C);break;case"video":case"audio":for(l=0;l<HC.length;l++)KC(HC[l],C);break;case"source":KC("error",C);break;case"img":case"image":case"link":KC("error",C),KC("load",C);break;case"details":KC("toggle",C);break;case"input":O(C,t),KC("invalid",C);break;case"select":C._wrapperState={wasMultiple:!!t.multiple},KC("invalid",C);break;case"textarea":lg(C,t),KC("invalid",C)}for(var o in Zg(e,t),l=null,t)if(t.hasOwnProperty(o)){var A=t[o];"children"===o?"string"===typeof A?C.textContent!==A&&(!0!==t.suppressHydrationWarning&&qC(C.textContent,A,g),l=["children",A]):"number"===typeof A&&C.textContent!==""+A&&(!0!==t.suppressHydrationWarning&&qC(C.textContent,A,g),l=["children",""+A]):a.hasOwnProperty(o)&&null!=A&&"onScroll"===o&&KC("scroll",C)}switch(e){case"input":D(C),$(C,t,!0);break;case"textarea":D(C),tg(C);break;case"select":case"option":break;default:"function"===typeof t.onClick&&(C.onclick=_C)}C=l,I.updateQueue=C,null!==C&&(I.flags|=4)}else{o=9===l.nodeType?l:l.ownerDocument,"http://www.w3.org/1999/xhtml"===g&&(g=ag(e)),"http://www.w3.org/1999/xhtml"===g?"script"===e?((g=o.createElement("div")).innerHTML="<script><\/script>",g=g.removeChild(g.firstChild)):"string"===typeof C.is?g=o.createElement(e,{is:C.is}):(g=o.createElement(e),"select"===e&&(o=g,C.multiple?o.multiple=!0:C.size&&(o.size=C.size))):g=o.createElementNS(g,e),g[cl]=I,g[il]=C,Ja(g,I,!1,!1),I.stateNode=g;g:{switch(o=Gg(e,C),e){case"dialog":KC("cancel",g),KC("close",g),l=C;break;case"iframe":case"object":case"embed":KC("load",g),l=C;break;case"video":case"audio":for(l=0;l<HC.length;l++)KC(HC[l],g);l=C;break;case"source":KC("error",g),l=C;break;case"img":case"image":case"link":KC("error",g),KC("load",g),l=C;break;case"details":KC("toggle",g),l=C;break;case"input":O(g,C),l=P(g,C),KC("invalid",g);break;case"option":default:l=C;break;case"select":g._wrapperState={wasMultiple:!!C.multiple},l=F({},C,{value:void 0}),KC("invalid",g);break;case"textarea":lg(g,C),l=Cg(g,C),KC("invalid",g)}for(t in Zg(e,l),A=l)if(A.hasOwnProperty(t)){var r=A[t];"style"===t?mg(g,r):"dangerouslySetInnerHTML"===t?null!=(r=r?r.__html:void 0)&&cg(g,r):"children"===t?"string"===typeof r?("textarea"!==e||""!==r)&&ig(g,r):"number"===typeof r&&ig(g,""+r):"suppressContentEditableWarning"!==t&&"suppressHydrationWarning"!==t&&"autoFocus"!==t&&(a.hasOwnProperty(t)?null!=r&&"onScroll"===t&&KC("scroll",g):null!=r&&G(g,t,r,o))}switch(e){case"input":D(g),$(g,C,!1);break;case"textarea":D(g),tg(g);break;case"option":null!=C.value&&g.setAttribute("value",""+M(C.value));break;case"select":g.multiple=!!C.multiple,null!=(t=C.value)?eg(g,!!C.multiple,t,!1):null!=C.defaultValue&&eg(g,!!C.multiple,C.defaultValue,!0);break;default:"function"===typeof l.onClick&&(g.onclick=_C)}switch(e){case"button":case"input":case"select":case"textarea":C=!!C.autoFocus;break g;case"img":C=!0;break g;default:C=!1}}C&&(I.flags|=4)}null!==I.ref&&(I.flags|=512,I.flags|=2097152)}return Da(I),null;case 6:if(g&&null!=I.stateNode)Ha(g,I,g.memoizedProps,C);else{if("string"!==typeof C&&null===I.stateNode)throw Error(n(166));if(e=et(It.current),et($n.current),rn(I)){if(C=I.stateNode,e=I.memoizedProps,C[cl]=I,(t=C.nodeValue!==e)&&null!==(g=In))switch(g.tag){case 3:qC(C.nodeValue,e,0!==(1&g.mode));break;case 5:!0!==g.memoizedProps.suppressHydrationWarning&&qC(C.nodeValue,e,0!==(1&g.mode))}t&&(I.flags|=4)}else(C=(9===e.nodeType?e:e.ownerDocument).createTextNode(C))[cl]=I,I.stateNode=C}return Da(I),null;case 13:if(Wl(at),C=I.memoizedState,null===g||null!==g.memoizedState&&null!==g.memoizedState.dehydrated){if(Cn&&null!==en&&0!==(1&I.mode)&&0===(128&I.flags))cn(),dn(),I.flags|=98560,t=!1;else if(t=rn(I),null!==C&&null!==C.dehydrated){if(null===g){if(!t)throw Error(n(318));if(!(t=null!==(t=I.memoizedState)?t.dehydrated:null))throw Error(n(317));t[cl]=I}else dn(),0===(128&I.flags)&&(I.memoizedState=null),I.flags|=4;Da(I),t=!1}else null!==ln&&(aA(ln),ln=null),t=!0;if(!t)return 65536&I.flags?I:null}return 0!==(128&I.flags)?(I.lanes=e,I):((C=null!==C)!==(null!==g&&null!==g.memoizedState)&&C&&(I.child.flags|=8192,0!==(1&I.mode)&&(null===g||0!==(1&at.current)?0===wo&&(wo=3):mA())),null!==I.updateQueue&&(I.flags|=4),Da(I),null);case 4:return lt(),ka(g,I),null===g&&EC(I.stateNode.containerInfo),Da(I),null;case 10:return Bn(I.type._context),Da(I),null;case 19:if(Wl(at),null===(t=I.memoizedState))return Da(I),null;if(C=0!==(128&I.flags),null===(o=t.rendering))if(C)La(t,!1);else{if(0!==wo||null!==g&&0!==(128&g.flags))for(g=I.child;null!==g;){if(null!==(o=ot(g))){for(I.flags|=128,La(t,!1),null!==(C=o.updateQueue)&&(I.updateQueue=C,I.flags|=4),I.subtreeFlags=0,C=e,e=I.child;null!==e;)g=C,(t=e).flags&=14680066,null===(o=t.alternate)?(t.childLanes=0,t.lanes=g,t.child=null,t.subtreeFlags=0,t.memoizedProps=null,t.memoizedState=null,t.updateQueue=null,t.dependencies=null,t.stateNode=null):(t.childLanes=o.childLanes,t.lanes=o.lanes,t.child=o.child,t.subtreeFlags=0,t.deletions=null,t.memoizedProps=o.memoizedProps,t.memoizedState=o.memoizedState,t.updateQueue=o.updateQueue,t.type=o.type,g=o.dependencies,t.dependencies=null===g?null:{lanes:g.lanes,firstContext:g.firstContext}),e=e.sibling;return Vl(at,1&at.current|2),I.child}g=g.sibling}null!==t.tail&&qg()>Qo&&(I.flags|=128,C=!0,La(t,!1),I.lanes=4194304)}else{if(!C)if(null!==(g=ot(o))){if(I.flags|=128,C=!0,null!==(e=g.updateQueue)&&(I.updateQueue=e,I.flags|=4),La(t,!0),null===t.tail&&"hidden"===t.tailMode&&!o.alternate&&!Cn)return Da(I),null}else 2*qg()-t.renderingStartTime>Qo&&1073741824!==e&&(I.flags|=128,C=!0,La(t,!1),I.lanes=4194304);t.isBackwards?(o.sibling=I.child,I.child=o):(null!==(e=t.last)?e.sibling=o:I.child=o,t.last=o)}return null!==t.tail?(I=t.tail,t.rendering=I,t.tail=I.sibling,t.renderingStartTime=qg(),I.sibling=null,e=at.current,Vl(at,C?1&e|2:1&e),I):(Da(I),null);case 22:case 23:return iA(),C=null!==I.memoizedState,null!==g&&null!==g.memoizedState!==C&&(I.flags|=8192),C&&0!==(1&I.mode)?0!==(1073741824&Yo)&&(Da(I),6&I.subtreeFlags&&(I.flags|=8192)):Da(I),null;case 24:case 25:return null}throw Error(n(156,I.tag))}function ja(g,I){switch(gn(I),I.tag){case 1:return Jl(I.type)&&kl(),65536&(g=I.flags)?(I.flags=-65537&g|128,I):null;case 3:return lt(),Wl(fl),Wl(vl),rt(),0!==(65536&(g=I.flags))&&0===(128&g)?(I.flags=-65537&g|128,I):null;case 5:return tt(I),null;case 13:if(Wl(at),null!==(g=I.memoizedState)&&null!==g.dehydrated){if(null===I.alternate)throw Error(n(340));dn()}return 65536&(g=I.flags)?(I.flags=-65537&g|128,I):null;case 19:return Wl(at),null;case 4:return lt(),null;case 10:return Bn(I.type._context),null;case 22:case 23:return iA(),null;default:return null}}Ja=function(g,I){for(var e=I.child;null!==e;){if(5===e.tag||6===e.tag)g.appendChild(e.stateNode);else if(4!==e.tag&&null!==e.child){e.child.return=e,e=e.child;continue}if(e===I)break;for(;null===e.sibling;){if(null===e.return||e.return===I)return;e=e.return}e.sibling.return=e.return,e=e.sibling}},ka=function(){},Ya=function(g,I,e,C){var l=g.memoizedProps;if(l!==C){g=I.stateNode,et($n.current);var n,t=null;switch(e){case"input":l=P(g,l),C=P(g,C),t=[];break;case"select":l=F({},l,{value:void 0}),C=F({},C,{value:void 0}),t=[];break;case"textarea":l=Cg(g,l),C=Cg(g,C),t=[];break;default:"function"!==typeof l.onClick&&"function"===typeof C.onClick&&(g.onclick=_C)}for(r in Zg(e,C),e=null,l)if(!C.hasOwnProperty(r)&&l.hasOwnProperty(r)&&null!=l[r])if("style"===r){var o=l[r];for(n in o)o.hasOwnProperty(n)&&(e||(e={}),e[n]="")}else"dangerouslySetInnerHTML"!==r&&"children"!==r&&"suppressContentEditableWarning"!==r&&"suppressHydrationWarning"!==r&&"autoFocus"!==r&&(a.hasOwnProperty(r)?t||(t=[]):(t=t||[]).push(r,null));for(r in C){var A=C[r];if(o=null!=l?l[r]:void 0,C.hasOwnProperty(r)&&A!==o&&(null!=A||null!=o))if("style"===r)if(o){for(n in o)!o.hasOwnProperty(n)||A&&A.hasOwnProperty(n)||(e||(e={}),e[n]="");for(n in A)A.hasOwnProperty(n)&&o[n]!==A[n]&&(e||(e={}),e[n]=A[n])}else e||(t||(t=[]),t.push(r,e)),e=A;else"dangerouslySetInnerHTML"===r?(A=A?A.__html:void 0,o=o?o.__html:void 0,null!=A&&o!==A&&(t=t||[]).push(r,A)):"children"===r?"string"!==typeof A&&"number"!==typeof A||(t=t||[]).push(r,""+A):"suppressContentEditableWarning"!==r&&"suppressHydrationWarning"!==r&&(a.hasOwnProperty(r)?(null!=A&&"onScroll"===r&&KC("scroll",g),t||o===A||(t=[])):(t=t||[]).push(r,A))}e&&(t=t||[]).push("style",e);var r=t;(I.updateQueue=r)&&(I.flags|=4)}},Ha=function(g,I,e,C){e!==C&&(I.flags|=4)};var Pa=!1,Oa=!1,qa="function"===typeof WeakSet?WeakSet:Set,_a=null;function $a(g,I){var e=g.ref;if(null!==e)if("function"===typeof e)try{e(null)}catch(C){VA(g,I,C)}else e.current=null}function go(g,I,e){try{e()}catch(C){VA(g,I,C)}}var Io=!1;function eo(g,I,e){var C=I.updateQueue;if(null!==(C=null!==C?C.lastEffect:null)){var l=C=C.next;do{if((l.tag&g)===g){var n=l.destroy;l.destroy=void 0,void 0!==n&&go(I,e,n)}l=l.next}while(l!==C)}}function Co(g,I){if(null!==(I=null!==(I=I.updateQueue)?I.lastEffect:null)){var e=I=I.next;do{if((e.tag&g)===g){var C=e.create;e.destroy=C()}e=e.next}while(e!==I)}}function lo(g){var I=g.ref;if(null!==I){var e=g.stateNode;g.tag,g=e,"function"===typeof I?I(g):I.current=g}}function no(g){var I=g.alternate;null!==I&&(g.alternate=null,no(I)),g.child=null,g.deletions=null,g.sibling=null,5===g.tag&&(null!==(I=g.stateNode)&&(delete I[cl],delete I[il],delete I[ul],delete I[sl],delete I[ml])),g.stateNode=null,g.return=null,g.dependencies=null,g.memoizedProps=null,g.memoizedState=null,g.pendingProps=null,g.stateNode=null,g.updateQueue=null}function to(g){return 5===g.tag||3===g.tag||4===g.tag}function ao(g){g:for(;;){for(;null===g.sibling;){if(null===g.return||to(g.return))return null;g=g.return}for(g.sibling.return=g.return,g=g.sibling;5!==g.tag&&6!==g.tag&&18!==g.tag;){if(2&g.flags)continue g;if(null===g.child||4===g.tag)continue g;g.child.return=g,g=g.child}if(!(2&g.flags))return g.stateNode}}function oo(g,I,e){var C=g.tag;if(5===C||6===C)g=g.stateNode,I?8===e.nodeType?e.parentNode.insertBefore(g,I):e.insertBefore(g,I):(8===e.nodeType?(I=e.parentNode).insertBefore(g,e):(I=e).appendChild(g),null!==(e=e._reactRootContainer)&&void 0!==e||null!==I.onclick||(I.onclick=_C));else if(4!==C&&null!==(g=g.child))for(oo(g,I,e),g=g.sibling;null!==g;)oo(g,I,e),g=g.sibling}function Ao(g,I,e){var C=g.tag;if(5===C||6===C)g=g.stateNode,I?e.insertBefore(g,I):e.appendChild(g);else if(4!==C&&null!==(g=g.child))for(Ao(g,I,e),g=g.sibling;null!==g;)Ao(g,I,e),g=g.sibling}var ro=null,co=!1;function io(g,I,e){for(e=e.child;null!==e;)uo(g,I,e),e=e.sibling}function uo(g,I,e){if(nI&&"function"===typeof nI.onCommitFiberUnmount)try{nI.onCommitFiberUnmount(lI,e)}catch(a){}switch(e.tag){case 5:Oa||$a(e,I);case 6:var C=ro,l=co;ro=null,io(g,I,e),co=l,null!==(ro=C)&&(co?(g=ro,e=e.stateNode,8===g.nodeType?g.parentNode.removeChild(e):g.removeChild(e)):ro.removeChild(e.stateNode));break;case 18:null!==ro&&(co?(g=ro,e=e.stateNode,8===g.nodeType?al(g.parentNode,e):1===g.nodeType&&al(g,e),UI(g)):al(ro,e.stateNode));break;case 4:C=ro,l=co,ro=e.stateNode.containerInfo,co=!0,io(g,I,e),ro=C,co=l;break;case 0:case 11:case 14:case 15:if(!Oa&&(null!==(C=e.updateQueue)&&null!==(C=C.lastEffect))){l=C=C.next;do{var n=l,t=n.destroy;n=n.tag,void 0!==t&&(0!==(2&n)||0!==(4&n))&&go(e,I,t),l=l.next}while(l!==C)}io(g,I,e);break;case 1:if(!Oa&&($a(e,I),"function"===typeof(C=e.stateNode).componentWillUnmount))try{C.props=e.memoizedProps,C.state=e.memoizedState,C.componentWillUnmount()}catch(a){VA(e,I,a)}io(g,I,e);break;case 21:io(g,I,e);break;case 22:1&e.mode?(Oa=(C=Oa)||null!==e.memoizedState,io(g,I,e),Oa=C):io(g,I,e);break;default:io(g,I,e)}}function so(g){var I=g.updateQueue;if(null!==I){g.updateQueue=null;var e=g.stateNode;null===e&&(e=g.stateNode=new qa),I.forEach((function(I){var C=RA.bind(null,g,I);e.has(I)||(e.add(I),I.then(C,C))}))}}function mo(g,I){var e=I.deletions;if(null!==e)for(var C=0;C<e.length;C++){var l=e[C];try{var t=g,a=I,o=a;g:for(;null!==o;){switch(o.tag){case 5:ro=o.stateNode,co=!1;break g;case 3:case 4:ro=o.stateNode.containerInfo,co=!0;break g}o=o.return}if(null===ro)throw Error(n(160));uo(t,a,l),ro=null,co=!1;var A=l.alternate;null!==A&&(A.return=null),l.return=null}catch(r){VA(l,I,r)}}if(12854&I.subtreeFlags)for(I=I.child;null!==I;)bo(I,g),I=I.sibling}function bo(g,I){var e=g.alternate,C=g.flags;switch(g.tag){case 0:case 11:case 14:case 15:if(mo(I,g),Zo(g),4&C){try{eo(3,g,g.return),Co(3,g)}catch(m){VA(g,g.return,m)}try{eo(5,g,g.return)}catch(m){VA(g,g.return,m)}}break;case 1:mo(I,g),Zo(g),512&C&&null!==e&&$a(e,e.return);break;case 5:if(mo(I,g),Zo(g),512&C&&null!==e&&$a(e,e.return),32&g.flags){var l=g.stateNode;try{ig(l,"")}catch(m){VA(g,g.return,m)}}if(4&C&&null!=(l=g.stateNode)){var t=g.memoizedProps,a=null!==e?e.memoizedProps:t,o=g.type,A=g.updateQueue;if(g.updateQueue=null,null!==A)try{"input"===o&&"radio"===t.type&&null!=t.name&&q(l,t),Gg(o,a);var r=Gg(o,t);for(a=0;a<A.length;a+=2){var c=A[a],i=A[a+1];"style"===c?mg(l,i):"dangerouslySetInnerHTML"===c?cg(l,i):"children"===c?ig(l,i):G(l,c,i,r)}switch(o){case"input":_(l,t);break;case"textarea":ng(l,t);break;case"select":var d=l._wrapperState.wasMultiple;l._wrapperState.wasMultiple=!!t.multiple;var u=t.value;null!=u?eg(l,!!t.multiple,u,!1):d!==!!t.multiple&&(null!=t.defaultValue?eg(l,!!t.multiple,t.defaultValue,!0):eg(l,!!t.multiple,t.multiple?[]:"",!1))}l[il]=t}catch(m){VA(g,g.return,m)}}break;case 6:if(mo(I,g),Zo(g),4&C){if(null===g.stateNode)throw Error(n(162));l=g.stateNode,t=g.memoizedProps;try{l.nodeValue=t}catch(m){VA(g,g.return,m)}}break;case 3:if(mo(I,g),Zo(g),4&C&&null!==e&&e.memoizedState.isDehydrated)try{UI(I.containerInfo)}catch(m){VA(g,g.return,m)}break;case 4:default:mo(I,g),Zo(g);break;case 13:mo(I,g),Zo(g),8192&(l=g.child).flags&&(t=null!==l.memoizedState,l.stateNode.isHidden=t,!t||null!==l.alternate&&null!==l.alternate.memoizedState||(Uo=qg())),4&C&&so(g);break;case 22:if(c=null!==e&&null!==e.memoizedState,1&g.mode?(Oa=(r=Oa)||c,mo(I,g),Oa=r):mo(I,g),Zo(g),8192&C){if(r=null!==g.memoizedState,(g.stateNode.isHidden=r)&&!c&&0!==(1&g.mode))for(_a=g,c=g.child;null!==c;){for(i=_a=c;null!==_a;){switch(u=(d=_a).child,d.tag){case 0:case 11:case 14:case 15:eo(4,d,d.return);break;case 1:$a(d,d.return);var s=d.stateNode;if("function"===typeof s.componentWillUnmount){C=d,e=d.return;try{I=C,s.props=I.memoizedProps,s.state=I.memoizedState,s.componentWillUnmount()}catch(m){VA(C,e,m)}}break;case 5:$a(d,d.return);break;case 22:if(null!==d.memoizedState){Bo(i);continue}}null!==u?(u.return=d,_a=u):Bo(i)}c=c.sibling}g:for(c=null,i=g;;){if(5===i.tag){if(null===c){c=i;try{l=i.stateNode,r?"function"===typeof(t=l.style).setProperty?t.setProperty("display","none","important"):t.display="none":(o=i.stateNode,a=void 0!==(A=i.memoizedProps.style)&&null!==A&&A.hasOwnProperty("display")?A.display:null,o.style.display=sg("display",a))}catch(m){VA(g,g.return,m)}}}else if(6===i.tag){if(null===c)try{i.stateNode.nodeValue=r?"":i.memoizedProps}catch(m){VA(g,g.return,m)}}else if((22!==i.tag&&23!==i.tag||null===i.memoizedState||i===g)&&null!==i.child){i.child.return=i,i=i.child;continue}if(i===g)break g;for(;null===i.sibling;){if(null===i.return||i.return===g)break g;c===i&&(c=null),i=i.return}c===i&&(c=null),i.sibling.return=i.return,i=i.sibling}}break;case 19:mo(I,g),Zo(g),4&C&&so(g);case 21:}}function Zo(g){var I=g.flags;if(2&I){try{g:{for(var e=g.return;null!==e;){if(to(e)){var C=e;break g}e=e.return}throw Error(n(160))}switch(C.tag){case 5:var l=C.stateNode;32&C.flags&&(ig(l,""),C.flags&=-33),Ao(g,ao(g),l);break;case 3:case 4:var t=C.stateNode.containerInfo;oo(g,ao(g),t);break;default:throw Error(n(161))}}catch(a){VA(g,g.return,a)}g.flags&=-3}4096&I&&(g.flags&=-4097)}function Go(g,I,e){_a=g,yo(g,I,e)}function yo(g,I,e){for(var C=0!==(1&g.mode);null!==_a;){var l=_a,n=l.child;if(22===l.tag&&C){var t=null!==l.memoizedState||Pa;if(!t){var a=l.alternate,o=null!==a&&null!==a.memoizedState||Oa;a=Pa;var A=Oa;if(Pa=t,(Oa=o)&&!A)for(_a=l;null!==_a;)o=(t=_a).child,22===t.tag&&null!==t.memoizedState?po(l):null!==o?(o.return=t,_a=o):po(l);for(;null!==n;)_a=n,yo(n,I,e),n=n.sibling;_a=l,Pa=a,Oa=A}ho(g)}else 0!==(8772&l.subtreeFlags)&&null!==n?(n.return=l,_a=n):ho(g)}}function ho(g){for(;null!==_a;){var I=_a;if(0!==(8772&I.flags)){var e=I.alternate;try{if(0!==(8772&I.flags))switch(I.tag){case 0:case 11:case 15:Oa||Co(5,I);break;case 1:var C=I.stateNode;if(4&I.flags&&!Oa)if(null===e)C.componentDidMount();else{var l=I.elementType===I.type?e.memoizedProps:mn(I.type,e.memoizedProps);C.componentDidUpdate(l,e.memoizedState,C.__reactInternalSnapshotBeforeUpdate)}var t=I.updateQueue;null!==t&&Kn(I,t,C);break;case 3:var a=I.updateQueue;if(null!==a){if(e=null,null!==I.child)switch(I.child.tag){case 5:case 1:e=I.child.stateNode}Kn(I,a,e)}break;case 5:var o=I.stateNode;if(null===e&&4&I.flags){e=o;var A=I.memoizedProps;switch(I.type){case"button":case"input":case"select":case"textarea":A.autoFocus&&e.focus();break;case"img":A.src&&(e.src=A.src)}}break;case 6:case 4:case 12:case 19:case 17:case 21:case 22:case 23:case 25:break;case 13:if(null===I.memoizedState){var r=I.alternate;if(null!==r){var c=r.memoizedState;if(null!==c){var i=c.dehydrated;null!==i&&UI(i)}}}break;default:throw Error(n(163))}Oa||512&I.flags&&lo(I)}catch(d){VA(I,I.return,d)}}if(I===g){_a=null;break}if(null!==(e=I.sibling)){e.return=I.return,_a=e;break}_a=I.return}}function Bo(g){for(;null!==_a;){var I=_a;if(I===g){_a=null;break}var e=I.sibling;if(null!==e){e.return=I.return,_a=e;break}_a=I.return}}function po(g){for(;null!==_a;){var I=_a;try{switch(I.tag){case 0:case 11:case 15:var e=I.return;try{Co(4,I)}catch(o){VA(I,e,o)}break;case 1:var C=I.stateNode;if("function"===typeof C.componentDidMount){var l=I.return;try{C.componentDidMount()}catch(o){VA(I,l,o)}}var n=I.return;try{lo(I)}catch(o){VA(I,n,o)}break;case 5:var t=I.return;try{lo(I)}catch(o){VA(I,t,o)}}}catch(o){VA(I,I.return,o)}if(I===g){_a=null;break}var a=I.sibling;if(null!==a){a.return=I.return,_a=a;break}_a=I.return}}var Wo,Vo=Math.ceil,So=y.ReactCurrentDispatcher,vo=y.ReactCurrentOwner,fo=y.ReactCurrentBatchConfig,Ro=0,Xo=null,Jo=null,ko=0,Yo=0,Ho=pl(0),wo=0,No=null,Fo=0,Ko=0,xo=0,zo=null,Eo=null,Uo=0,Qo=1/0,Mo=null,Lo=!1,Do=null,To=null,jo=!1,Po=null,Oo=0,qo=0,_o=null,$o=-1,gA=0;function IA(){return 0!==(6&Ro)?qg():-1!==$o?$o:$o=qg()}function eA(g){return 0===(1&g.mode)?1:0!==(2&Ro)&&0!==ko?ko&-ko:null!==sn.transition?(0===gA&&(gA=sI()),gA):0!==(g=GI)?g:g=void 0===(g=window.event)?16:OI(g.type)}function CA(g,I,e,C){if(50<qo)throw qo=0,_o=null,Error(n(185));bI(g,e,C),0!==(2&Ro)&&g===Xo||(g===Xo&&(0===(2&Ro)&&(Ko|=e),4===wo&&oA(g,ko)),lA(g,C),1===e&&0===Ro&&0===(1&I.mode)&&(Qo=qg()+500,Kl&&El()))}function lA(g,I){var e=g.callbackNode;!function(g,I){for(var e=g.suspendedLanes,C=g.pingedLanes,l=g.expirationTimes,n=g.pendingLanes;0<n;){var t=31-tI(n),a=1<<t,o=l[t];-1===o?0!==(a&e)&&0===(a&C)||(l[t]=dI(a,I)):o<=I&&(g.expiredLanes|=a),n&=~a}}(g,I);var C=iI(g,g===Xo?ko:0);if(0===C)null!==e&&jg(e),g.callbackNode=null,g.callbackPriority=0;else if(I=C&-C,g.callbackPriority!==I){if(null!=e&&jg(e),1===I)0===g.tag?function(g){Kl=!0,zl(g)}(AA.bind(null,g)):zl(AA.bind(null,g)),nl((function(){0===(6&Ro)&&El()})),e=null;else{switch(yI(C)){case 1:e=$g;break;case 4:e=gI;break;case 16:default:e=II;break;case 536870912:e=CI}e=XA(e,nA.bind(null,g))}g.callbackPriority=I,g.callbackNode=e}}function nA(g,I){if($o=-1,gA=0,0!==(6&Ro))throw Error(n(327));var e=g.callbackNode;if(pA()&&g.callbackNode!==e)return null;var C=iI(g,g===Xo?ko:0);if(0===C)return null;if(0!==(30&C)||0!==(C&g.expiredLanes)||I)I=bA(g,C);else{I=C;var l=Ro;Ro|=2;var t=sA();for(Xo===g&&ko===I||(Mo=null,Qo=qg()+500,dA(g,I));;)try{GA();break}catch(o){uA(g,o)}hn(),So.current=t,Ro=l,null!==Jo?I=0:(Xo=null,ko=0,I=wo)}if(0!==I){if(2===I&&(0!==(l=uI(g))&&(C=l,I=tA(g,l))),1===I)throw e=No,dA(g,0),oA(g,C),lA(g,qg()),e;if(6===I)oA(g,C);else{if(l=g.current.alternate,0===(30&C)&&!function(g){for(var I=g;;){if(16384&I.flags){var e=I.updateQueue;if(null!==e&&null!==(e=e.stores))for(var C=0;C<e.length;C++){var l=e[C],n=l.getSnapshot;l=l.value;try{if(!tC(n(),l))return!1}catch(a){return!1}}}if(e=I.child,16384&I.subtreeFlags&&null!==e)e.return=I,I=e;else{if(I===g)break;for(;null===I.sibling;){if(null===I.return||I.return===g)return!0;I=I.return}I.sibling.return=I.return,I=I.sibling}}return!0}(l)&&(2===(I=bA(g,C))&&(0!==(t=uI(g))&&(C=t,I=tA(g,t))),1===I))throw e=No,dA(g,0),oA(g,C),lA(g,qg()),e;switch(g.finishedWork=l,g.finishedLanes=C,I){case 0:case 1:throw Error(n(345));case 2:case 5:BA(g,Eo,Mo);break;case 3:if(oA(g,C),(130023424&C)===C&&10<(I=Uo+500-qg())){if(0!==iI(g,0))break;if(((l=g.suspendedLanes)&C)!==C){IA(),g.pingedLanes|=g.suspendedLanes&l;break}g.timeoutHandle=el(BA.bind(null,g,Eo,Mo),I);break}BA(g,Eo,Mo);break;case 4:if(oA(g,C),(4194240&C)===C)break;for(I=g.eventTimes,l=-1;0<C;){var a=31-tI(C);t=1<<a,(a=I[a])>l&&(l=a),C&=~t}if(C=l,10<(C=(120>(C=qg()-C)?120:480>C?480:1080>C?1080:1920>C?1920:3e3>C?3e3:4320>C?4320:1960*Vo(C/1960))-C)){g.timeoutHandle=el(BA.bind(null,g,Eo,Mo),C);break}BA(g,Eo,Mo);break;default:throw Error(n(329))}}}return lA(g,qg()),g.callbackNode===e?nA.bind(null,g):null}function tA(g,I){var e=zo;return g.current.memoizedState.isDehydrated&&(dA(g,I).flags|=256),2!==(g=bA(g,I))&&(I=Eo,Eo=e,null!==I&&aA(I)),g}function aA(g){null===Eo?Eo=g:Eo.push.apply(Eo,g)}function oA(g,I){for(I&=~xo,I&=~Ko,g.suspendedLanes|=I,g.pingedLanes&=~I,g=g.expirationTimes;0<I;){var e=31-tI(I),C=1<<e;g[e]=-1,I&=~C}}function AA(g){if(0!==(6&Ro))throw Error(n(327));pA();var I=iI(g,0);if(0===(1&I))return lA(g,qg()),null;var e=bA(g,I);if(0!==g.tag&&2===e){var C=uI(g);0!==C&&(I=C,e=tA(g,C))}if(1===e)throw e=No,dA(g,0),oA(g,I),lA(g,qg()),e;if(6===e)throw Error(n(345));return g.finishedWork=g.current.alternate,g.finishedLanes=I,BA(g,Eo,Mo),lA(g,qg()),null}function rA(g,I){var e=Ro;Ro|=1;try{return g(I)}finally{0===(Ro=e)&&(Qo=qg()+500,Kl&&El())}}function cA(g){null!==Po&&0===Po.tag&&0===(6&Ro)&&pA();var I=Ro;Ro|=1;var e=fo.transition,C=GI;try{if(fo.transition=null,GI=1,g)return g()}finally{GI=C,fo.transition=e,0===(6&(Ro=I))&&El()}}function iA(){Yo=Ho.current,Wl(Ho)}function dA(g,I){g.finishedWork=null,g.finishedLanes=0;var e=g.timeoutHandle;if(-1!==e&&(g.timeoutHandle=-1,Cl(e)),null!==Jo)for(e=Jo.return;null!==e;){var C=e;switch(gn(C),C.tag){case 1:null!==(C=C.type.childContextTypes)&&void 0!==C&&kl();break;case 3:lt(),Wl(fl),Wl(vl),rt();break;case 5:tt(C);break;case 4:lt();break;case 13:case 19:Wl(at);break;case 10:Bn(C.type._context);break;case 22:case 23:iA()}e=e.return}if(Xo=g,Jo=g=HA(g.current,null),ko=Yo=I,wo=0,No=null,xo=Ko=Fo=0,Eo=zo=null,null!==Sn){for(I=0;I<Sn.length;I++)if(null!==(C=(e=Sn[I]).interleaved)){e.interleaved=null;var l=C.next,n=e.pending;if(null!==n){var t=n.next;n.next=l,C.next=t}e.pending=C}Sn=null}return g}function uA(g,I){for(;;){var e=Jo;try{if(hn(),ct.current=na,bt){for(var C=ut.memoizedState;null!==C;){var l=C.queue;null!==l&&(l.pending=null),C=C.next}bt=!1}if(dt=0,mt=st=ut=null,Zt=!1,Gt=0,vo.current=null,null===e||null===e.return){wo=1,No=I,Jo=null;break}g:{var t=g,a=e.return,o=e,A=I;if(I=ko,o.flags|=32768,null!==A&&"object"===typeof A&&"function"===typeof A.then){var r=A,c=o,i=c.tag;if(0===(1&c.mode)&&(0===i||11===i||15===i)){var d=c.alternate;d?(c.updateQueue=d.updateQueue,c.memoizedState=d.memoizedState,c.lanes=d.lanes):(c.updateQueue=null,c.memoizedState=null)}var u=ma(a);if(null!==u){u.flags&=-257,ba(u,a,o,0,I),1&u.mode&&sa(t,r,I),A=r;var s=(I=u).updateQueue;if(null===s){var m=new Set;m.add(A),I.updateQueue=m}else s.add(A);break g}if(0===(1&I)){sa(t,r,I),mA();break g}A=Error(n(426))}else if(Cn&&1&o.mode){var b=ma(a);if(null!==b){0===(65536&b.flags)&&(b.flags|=256),ba(b,a,o,0,I),un(Aa(A,o));break g}}t=A=Aa(A,o),4!==wo&&(wo=2),null===zo?zo=[t]:zo.push(t),t=a;do{switch(t.tag){case 3:t.flags|=65536,I&=-I,t.lanes|=I,Nn(t,da(0,A,I));break g;case 1:o=A;var Z=t.type,G=t.stateNode;if(0===(128&t.flags)&&("function"===typeof Z.getDerivedStateFromError||null!==G&&"function"===typeof G.componentDidCatch&&(null===To||!To.has(G)))){t.flags|=65536,I&=-I,t.lanes|=I,Nn(t,ua(t,o,I));break g}}t=t.return}while(null!==t)}hA(e)}catch(y){I=y,Jo===e&&null!==e&&(Jo=e=e.return);continue}break}}function sA(){var g=So.current;return So.current=na,null===g?na:g}function mA(){0!==wo&&3!==wo&&2!==wo||(wo=4),null===Xo||0===(268435455&Fo)&&0===(268435455&Ko)||oA(Xo,ko)}function bA(g,I){var e=Ro;Ro|=2;var C=sA();for(Xo===g&&ko===I||(Mo=null,dA(g,I));;)try{ZA();break}catch(l){uA(g,l)}if(hn(),Ro=e,So.current=C,null!==Jo)throw Error(n(261));return Xo=null,ko=0,wo}function ZA(){for(;null!==Jo;)yA(Jo)}function GA(){for(;null!==Jo&&!Pg();)yA(Jo)}function yA(g){var I=Wo(g.alternate,g,Yo);g.memoizedProps=g.pendingProps,null===I?hA(g):Jo=I,vo.current=null}function hA(g){var I=g;do{var e=I.alternate;if(g=I.return,0===(32768&I.flags)){if(null!==(e=Ta(e,I,Yo)))return void(Jo=e)}else{if(null!==(e=ja(e,I)))return e.flags&=32767,void(Jo=e);if(null===g)return wo=6,void(Jo=null);g.flags|=32768,g.subtreeFlags=0,g.deletions=null}if(null!==(I=I.sibling))return void(Jo=I);Jo=I=g}while(null!==I);0===wo&&(wo=5)}function BA(g,I,e){var C=GI,l=fo.transition;try{fo.transition=null,GI=1,function(g,I,e,C){do{pA()}while(null!==Po);if(0!==(6&Ro))throw Error(n(327));e=g.finishedWork;var l=g.finishedLanes;if(null===e)return null;if(g.finishedWork=null,g.finishedLanes=0,e===g.current)throw Error(n(177));g.callbackNode=null,g.callbackPriority=0;var t=e.lanes|e.childLanes;if(function(g,I){var e=g.pendingLanes&~I;g.pendingLanes=I,g.suspendedLanes=0,g.pingedLanes=0,g.expiredLanes&=I,g.mutableReadLanes&=I,g.entangledLanes&=I,I=g.entanglements;var C=g.eventTimes;for(g=g.expirationTimes;0<e;){var l=31-tI(e),n=1<<l;I[l]=0,C[l]=-1,g[l]=-1,e&=~n}}(g,t),g===Xo&&(Jo=Xo=null,ko=0),0===(2064&e.subtreeFlags)&&0===(2064&e.flags)||jo||(jo=!0,XA(II,(function(){return pA(),null}))),t=0!==(15990&e.flags),0!==(15990&e.subtreeFlags)||t){t=fo.transition,fo.transition=null;var a=GI;GI=1;var o=Ro;Ro|=4,vo.current=null,function(g,I){if($C=MI,iC(g=cC())){if("selectionStart"in g)var e={start:g.selectionStart,end:g.selectionEnd};else g:{var C=(e=(e=g.ownerDocument)&&e.defaultView||window).getSelection&&e.getSelection();if(C&&0!==C.rangeCount){e=C.anchorNode;var l=C.anchorOffset,t=C.focusNode;C=C.focusOffset;try{e.nodeType,t.nodeType}catch(h){e=null;break g}var a=0,o=-1,A=-1,r=0,c=0,i=g,d=null;I:for(;;){for(var u;i!==e||0!==l&&3!==i.nodeType||(o=a+l),i!==t||0!==C&&3!==i.nodeType||(A=a+C),3===i.nodeType&&(a+=i.nodeValue.length),null!==(u=i.firstChild);)d=i,i=u;for(;;){if(i===g)break I;if(d===e&&++r===l&&(o=a),d===t&&++c===C&&(A=a),null!==(u=i.nextSibling))break;d=(i=d).parentNode}i=u}e=-1===o||-1===A?null:{start:o,end:A}}else e=null}e=e||{start:0,end:0}}else e=null;for(gl={focusedElem:g,selectionRange:e},MI=!1,_a=I;null!==_a;)if(g=(I=_a).child,0!==(1028&I.subtreeFlags)&&null!==g)g.return=I,_a=g;else for(;null!==_a;){I=_a;try{var s=I.alternate;if(0!==(1024&I.flags))switch(I.tag){case 0:case 11:case 15:case 5:case 6:case 4:case 17:break;case 1:if(null!==s){var m=s.memoizedProps,b=s.memoizedState,Z=I.stateNode,G=Z.getSnapshotBeforeUpdate(I.elementType===I.type?m:mn(I.type,m),b);Z.__reactInternalSnapshotBeforeUpdate=G}break;case 3:var y=I.stateNode.containerInfo;1===y.nodeType?y.textContent="":9===y.nodeType&&y.documentElement&&y.removeChild(y.documentElement);break;default:throw Error(n(163))}}catch(h){VA(I,I.return,h)}if(null!==(g=I.sibling)){g.return=I.return,_a=g;break}_a=I.return}s=Io,Io=!1}(g,e),bo(e,g),dC(gl),MI=!!$C,gl=$C=null,g.current=e,Go(e,g,l),Og(),Ro=o,GI=a,fo.transition=t}else g.current=e;if(jo&&(jo=!1,Po=g,Oo=l),t=g.pendingLanes,0===t&&(To=null),function(g){if(nI&&"function"===typeof nI.onCommitFiberRoot)try{nI.onCommitFiberRoot(lI,g,void 0,128===(128&g.current.flags))}catch(I){}}(e.stateNode),lA(g,qg()),null!==I)for(C=g.onRecoverableError,e=0;e<I.length;e++)l=I[e],C(l.value,{componentStack:l.stack,digest:l.digest});if(Lo)throw Lo=!1,g=Do,Do=null,g;0!==(1&Oo)&&0!==g.tag&&pA(),t=g.pendingLanes,0!==(1&t)?g===_o?qo++:(qo=0,_o=g):qo=0,El()}(g,I,e,C)}finally{fo.transition=l,GI=C}return null}function pA(){if(null!==Po){var g=yI(Oo),I=fo.transition,e=GI;try{if(fo.transition=null,GI=16>g?16:g,null===Po)var C=!1;else{if(g=Po,Po=null,Oo=0,0!==(6&Ro))throw Error(n(331));var l=Ro;for(Ro|=4,_a=g.current;null!==_a;){var t=_a,a=t.child;if(0!==(16&_a.flags)){var o=t.deletions;if(null!==o){for(var A=0;A<o.length;A++){var r=o[A];for(_a=r;null!==_a;){var c=_a;switch(c.tag){case 0:case 11:case 15:eo(8,c,t)}var i=c.child;if(null!==i)i.return=c,_a=i;else for(;null!==_a;){var d=(c=_a).sibling,u=c.return;if(no(c),c===r){_a=null;break}if(null!==d){d.return=u,_a=d;break}_a=u}}}var s=t.alternate;if(null!==s){var m=s.child;if(null!==m){s.child=null;do{var b=m.sibling;m.sibling=null,m=b}while(null!==m)}}_a=t}}if(0!==(2064&t.subtreeFlags)&&null!==a)a.return=t,_a=a;else g:for(;null!==_a;){if(0!==(2048&(t=_a).flags))switch(t.tag){case 0:case 11:case 15:eo(9,t,t.return)}var Z=t.sibling;if(null!==Z){Z.return=t.return,_a=Z;break g}_a=t.return}}var G=g.current;for(_a=G;null!==_a;){var y=(a=_a).child;if(0!==(2064&a.subtreeFlags)&&null!==y)y.return=a,_a=y;else g:for(a=G;null!==_a;){if(0!==(2048&(o=_a).flags))try{switch(o.tag){case 0:case 11:case 15:Co(9,o)}}catch(B){VA(o,o.return,B)}if(o===a){_a=null;break g}var h=o.sibling;if(null!==h){h.return=o.return,_a=h;break g}_a=o.return}}if(Ro=l,El(),nI&&"function"===typeof nI.onPostCommitFiberRoot)try{nI.onPostCommitFiberRoot(lI,g)}catch(B){}C=!0}return C}finally{GI=e,fo.transition=I}}return!1}function WA(g,I,e){g=Hn(g,I=da(0,I=Aa(e,I),1),1),I=IA(),null!==g&&(bI(g,1,I),lA(g,I))}function VA(g,I,e){if(3===g.tag)WA(g,g,e);else for(;null!==I;){if(3===I.tag){WA(I,g,e);break}if(1===I.tag){var C=I.stateNode;if("function"===typeof I.type.getDerivedStateFromError||"function"===typeof C.componentDidCatch&&(null===To||!To.has(C))){I=Hn(I,g=ua(I,g=Aa(e,g),1),1),g=IA(),null!==I&&(bI(I,1,g),lA(I,g));break}}I=I.return}}function SA(g,I,e){var C=g.pingCache;null!==C&&C.delete(I),I=IA(),g.pingedLanes|=g.suspendedLanes&e,Xo===g&&(ko&e)===e&&(4===wo||3===wo&&(130023424&ko)===ko&&500>qg()-Uo?dA(g,0):xo|=e),lA(g,I)}function vA(g,I){0===I&&(0===(1&g.mode)?I=1:(I=rI,0===(130023424&(rI<<=1))&&(rI=4194304)));var e=IA();null!==(g=Rn(g,I))&&(bI(g,I,e),lA(g,e))}function fA(g){var I=g.memoizedState,e=0;null!==I&&(e=I.retryLane),vA(g,e)}function RA(g,I){var e=0;switch(g.tag){case 13:var C=g.stateNode,l=g.memoizedState;null!==l&&(e=l.retryLane);break;case 19:C=g.stateNode;break;default:throw Error(n(314))}null!==C&&C.delete(I),vA(g,e)}function XA(g,I){return Tg(g,I)}function JA(g,I,e,C){this.tag=g,this.key=e,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=I,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=C,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function kA(g,I,e,C){return new JA(g,I,e,C)}function YA(g){return!(!(g=g.prototype)||!g.isReactComponent)}function HA(g,I){var e=g.alternate;return null===e?((e=kA(g.tag,I,g.key,g.mode)).elementType=g.elementType,e.type=g.type,e.stateNode=g.stateNode,e.alternate=g,g.alternate=e):(e.pendingProps=I,e.type=g.type,e.flags=0,e.subtreeFlags=0,e.deletions=null),e.flags=14680064&g.flags,e.childLanes=g.childLanes,e.lanes=g.lanes,e.child=g.child,e.memoizedProps=g.memoizedProps,e.memoizedState=g.memoizedState,e.updateQueue=g.updateQueue,I=g.dependencies,e.dependencies=null===I?null:{lanes:I.lanes,firstContext:I.firstContext},e.sibling=g.sibling,e.index=g.index,e.ref=g.ref,e}function wA(g,I,e,C,l,t){var a=2;if(C=g,"function"===typeof g)YA(g)&&(a=1);else if("string"===typeof g)a=5;else g:switch(g){case p:return NA(e.children,l,t,I);case W:a=8,l|=8;break;case V:return(g=kA(12,e,I,2|l)).elementType=V,g.lanes=t,g;case R:return(g=kA(13,e,I,l)).elementType=R,g.lanes=t,g;case X:return(g=kA(19,e,I,l)).elementType=X,g.lanes=t,g;case Y:return FA(e,l,t,I);default:if("object"===typeof g&&null!==g)switch(g.$$typeof){case S:a=10;break g;case v:a=9;break g;case f:a=11;break g;case J:a=14;break g;case k:a=16,C=null;break g}throw Error(n(130,null==g?g:typeof g,""))}return(I=kA(a,e,I,l)).elementType=g,I.type=C,I.lanes=t,I}function NA(g,I,e,C){return(g=kA(7,g,C,I)).lanes=e,g}function FA(g,I,e,C){return(g=kA(22,g,C,I)).elementType=Y,g.lanes=e,g.stateNode={isHidden:!1},g}function KA(g,I,e){return(g=kA(6,g,null,I)).lanes=e,g}function xA(g,I,e){return(I=kA(4,null!==g.children?g.children:[],g.key,I)).lanes=e,I.stateNode={containerInfo:g.containerInfo,pendingChildren:null,implementation:g.implementation},I}function zA(g,I,e,C,l){this.tag=I,this.containerInfo=g,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=mI(0),this.expirationTimes=mI(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=mI(0),this.identifierPrefix=C,this.onRecoverableError=l,this.mutableSourceEagerHydrationData=null}function EA(g,I,e,C,l,n,t,a,o){return g=new zA(g,I,e,a,o),1===I?(I=1,!0===n&&(I|=8)):I=0,n=kA(3,null,null,I),g.current=n,n.stateNode=g,n.memoizedState={element:C,isDehydrated:e,cache:null,transitions:null,pendingSuspenseBoundaries:null},Jn(n),g}function UA(g){if(!g)return Sl;g:{if(Ug(g=g._reactInternals)!==g||1!==g.tag)throw Error(n(170));var I=g;do{switch(I.tag){case 3:I=I.stateNode.context;break g;case 1:if(Jl(I.type)){I=I.stateNode.__reactInternalMemoizedMergedChildContext;break g}}I=I.return}while(null!==I);throw Error(n(171))}if(1===g.tag){var e=g.type;if(Jl(e))return Hl(g,e,I)}return I}function QA(g,I,e,C,l,n,t,a,o){return(g=EA(e,C,!0,g,0,n,0,a,o)).context=UA(null),e=g.current,(n=Yn(C=IA(),l=eA(e))).callback=void 0!==I&&null!==I?I:null,Hn(e,n,l),g.current.lanes=l,bI(g,l,C),lA(g,C),g}function MA(g,I,e,C){var l=I.current,n=IA(),t=eA(l);return e=UA(e),null===I.context?I.context=e:I.pendingContext=e,(I=Yn(n,t)).payload={element:g},null!==(C=void 0===C?null:C)&&(I.callback=C),null!==(g=Hn(l,I,t))&&(CA(g,l,t,n),wn(g,l,t)),t}function LA(g){return(g=g.current).child?(g.child.tag,g.child.stateNode):null}function DA(g,I){if(null!==(g=g.memoizedState)&&null!==g.dehydrated){var e=g.retryLane;g.retryLane=0!==e&&e<I?e:I}}function TA(g,I){DA(g,I),(g=g.alternate)&&DA(g,I)}Wo=function(g,I,e){if(null!==g)if(g.memoizedProps!==I.pendingProps||fl.current)Ga=!0;else{if(0===(g.lanes&e)&&0===(128&I.flags))return Ga=!1,function(g,I,e){switch(I.tag){case 3:Ra(I),dn();break;case 5:nt(I);break;case 1:Jl(I.type)&&wl(I);break;case 4:Ct(I,I.stateNode.containerInfo);break;case 10:var C=I.type._context,l=I.memoizedProps.value;Vl(bn,C._currentValue),C._currentValue=l;break;case 13:if(null!==(C=I.memoizedState))return null!==C.dehydrated?(Vl(at,1&at.current),I.flags|=128,null):0!==(e&I.child.childLanes)?Fa(g,I,e):(Vl(at,1&at.current),null!==(g=Ma(g,I,e))?g.sibling:null);Vl(at,1&at.current);break;case 19:if(C=0!==(e&I.childLanes),0!==(128&g.flags)){if(C)return Ua(g,I,e);I.flags|=128}if(null!==(l=I.memoizedState)&&(l.rendering=null,l.tail=null,l.lastEffect=null),Vl(at,at.current),C)break;return null;case 22:case 23:return I.lanes=0,Wa(g,I,e)}return Ma(g,I,e)}(g,I,e);Ga=0!==(131072&g.flags)}else Ga=!1,Cn&&0!==(1048576&I.flags)&&_l(I,Ll,I.index);switch(I.lanes=0,I.tag){case 2:var C=I.type;Qa(g,I),g=I.pendingProps;var l=Xl(I,vl.current);Wn(I,e),l=pt(null,I,C,g,l,e);var t=Wt();return I.flags|=1,"object"===typeof l&&null!==l&&"function"===typeof l.render&&void 0===l.$$typeof?(I.tag=1,I.memoizedState=null,I.updateQueue=null,Jl(C)?(t=!0,wl(I)):t=!1,I.memoizedState=null!==l.state&&void 0!==l.state?l.state:null,Jn(I),l.updater=En,I.stateNode=l,l._reactInternals=I,Ln(I,C,g,e),I=fa(null,I,C,!0,t,e)):(I.tag=0,Cn&&t&&$l(I),ya(null,I,l,e),I=I.child),I;case 16:C=I.elementType;g:{switch(Qa(g,I),g=I.pendingProps,C=(l=C._init)(C._payload),I.type=C,l=I.tag=function(g){if("function"===typeof g)return YA(g)?1:0;if(void 0!==g&&null!==g){if((g=g.$$typeof)===f)return 11;if(g===J)return 14}return 2}(C),g=mn(C,g),l){case 0:I=Sa(null,I,C,g,e);break g;case 1:I=va(null,I,C,g,e);break g;case 11:I=ha(null,I,C,g,e);break g;case 14:I=Ba(null,I,C,mn(C.type,g),e);break g}throw Error(n(306,C,""))}return I;case 0:return C=I.type,l=I.pendingProps,Sa(g,I,C,l=I.elementType===C?l:mn(C,l),e);case 1:return C=I.type,l=I.pendingProps,va(g,I,C,l=I.elementType===C?l:mn(C,l),e);case 3:g:{if(Ra(I),null===g)throw Error(n(387));C=I.pendingProps,l=(t=I.memoizedState).element,kn(g,I),Fn(I,C,null,e);var a=I.memoizedState;if(C=a.element,t.isDehydrated){if(t={element:C,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},I.updateQueue.baseState=t,I.memoizedState=t,256&I.flags){I=Xa(g,I,C,e,l=Aa(Error(n(423)),I));break g}if(C!==l){I=Xa(g,I,C,e,l=Aa(Error(n(424)),I));break g}for(en=ol(I.stateNode.containerInfo.firstChild),In=I,Cn=!0,ln=null,e=qn(I,null,C,e),I.child=e;e;)e.flags=-3&e.flags|4096,e=e.sibling}else{if(dn(),C===l){I=Ma(g,I,e);break g}ya(g,I,C,e)}I=I.child}return I;case 5:return nt(I),null===g&&on(I),C=I.type,l=I.pendingProps,t=null!==g?g.memoizedProps:null,a=l.children,Il(C,l)?a=null:null!==t&&Il(C,t)&&(I.flags|=32),Va(g,I),ya(g,I,a,e),I.child;case 6:return null===g&&on(I),null;case 13:return Fa(g,I,e);case 4:return Ct(I,I.stateNode.containerInfo),C=I.pendingProps,null===g?I.child=On(I,null,C,e):ya(g,I,C,e),I.child;case 11:return C=I.type,l=I.pendingProps,ha(g,I,C,l=I.elementType===C?l:mn(C,l),e);case 7:return ya(g,I,I.pendingProps,e),I.child;case 8:case 12:return ya(g,I,I.pendingProps.children,e),I.child;case 10:g:{if(C=I.type._context,l=I.pendingProps,t=I.memoizedProps,a=l.value,Vl(bn,C._currentValue),C._currentValue=a,null!==t)if(tC(t.value,a)){if(t.children===l.children&&!fl.current){I=Ma(g,I,e);break g}}else for(null!==(t=I.child)&&(t.return=I);null!==t;){var o=t.dependencies;if(null!==o){a=t.child;for(var A=o.firstContext;null!==A;){if(A.context===C){if(1===t.tag){(A=Yn(-1,e&-e)).tag=2;var r=t.updateQueue;if(null!==r){var c=(r=r.shared).pending;null===c?A.next=A:(A.next=c.next,c.next=A),r.pending=A}}t.lanes|=e,null!==(A=t.alternate)&&(A.lanes|=e),pn(t.return,e,I),o.lanes|=e;break}A=A.next}}else if(10===t.tag)a=t.type===I.type?null:t.child;else if(18===t.tag){if(null===(a=t.return))throw Error(n(341));a.lanes|=e,null!==(o=a.alternate)&&(o.lanes|=e),pn(a,e,I),a=t.sibling}else a=t.child;if(null!==a)a.return=t;else for(a=t;null!==a;){if(a===I){a=null;break}if(null!==(t=a.sibling)){t.return=a.return,a=t;break}a=a.return}t=a}ya(g,I,l.children,e),I=I.child}return I;case 9:return l=I.type,C=I.pendingProps.children,Wn(I,e),C=C(l=Vn(l)),I.flags|=1,ya(g,I,C,e),I.child;case 14:return l=mn(C=I.type,I.pendingProps),Ba(g,I,C,l=mn(C.type,l),e);case 15:return pa(g,I,I.type,I.pendingProps,e);case 17:return C=I.type,l=I.pendingProps,l=I.elementType===C?l:mn(C,l),Qa(g,I),I.tag=1,Jl(C)?(g=!0,wl(I)):g=!1,Wn(I,e),Qn(I,C,l),Ln(I,C,l,e),fa(null,I,C,!0,g,e);case 19:return Ua(g,I,e);case 22:return Wa(g,I,e)}throw Error(n(156,I.tag))};var jA="function"===typeof reportError?reportError:function(g){console.error(g)};function PA(g){this._internalRoot=g}function OA(g){this._internalRoot=g}function qA(g){return!(!g||1!==g.nodeType&&9!==g.nodeType&&11!==g.nodeType)}function _A(g){return!(!g||1!==g.nodeType&&9!==g.nodeType&&11!==g.nodeType&&(8!==g.nodeType||" react-mount-point-unstable "!==g.nodeValue))}function $A(){}function gr(g,I,e,C,l){var n=e._reactRootContainer;if(n){var t=n;if("function"===typeof l){var a=l;l=function(){var g=LA(t);a.call(g)}}MA(I,t,g,l)}else t=function(g,I,e,C,l){if(l){if("function"===typeof C){var n=C;C=function(){var g=LA(t);n.call(g)}}var t=QA(I,C,g,0,null,!1,0,"",$A);return g._reactRootContainer=t,g[dl]=t.current,EC(8===g.nodeType?g.parentNode:g),cA(),t}for(;l=g.lastChild;)g.removeChild(l);if("function"===typeof C){var a=C;C=function(){var g=LA(o);a.call(g)}}var o=EA(g,0,!1,null,0,!1,0,"",$A);return g._reactRootContainer=o,g[dl]=o.current,EC(8===g.nodeType?g.parentNode:g),cA((function(){MA(I,o,e,C)})),o}(e,I,g,l,C);return LA(t)}OA.prototype.render=PA.prototype.render=function(g){var I=this._internalRoot;if(null===I)throw Error(n(409));MA(g,I,null,null)},OA.prototype.unmount=PA.prototype.unmount=function(){var g=this._internalRoot;if(null!==g){this._internalRoot=null;var I=g.containerInfo;cA((function(){MA(null,g,null,null)})),I[dl]=null}},OA.prototype.unstable_scheduleHydration=function(g){if(g){var I=WI();g={blockedOn:null,target:g,priority:I};for(var e=0;e<YI.length&&0!==I&&I<YI[e].priority;e++);YI.splice(e,0,g),0===e&&FI(g)}},hI=function(g){switch(g.tag){case 3:var I=g.stateNode;if(I.current.memoizedState.isDehydrated){var e=cI(I.pendingLanes);0!==e&&(ZI(I,1|e),lA(I,qg()),0===(6&Ro)&&(Qo=qg()+500,El()))}break;case 13:cA((function(){var I=Rn(g,1);if(null!==I){var e=IA();CA(I,g,1,e)}})),TA(g,1)}},BI=function(g){if(13===g.tag){var I=Rn(g,134217728);if(null!==I)CA(I,g,134217728,IA());TA(g,134217728)}},pI=function(g){if(13===g.tag){var I=eA(g),e=Rn(g,I);if(null!==e)CA(e,g,I,IA());TA(g,I)}},WI=function(){return GI},VI=function(g,I){var e=GI;try{return GI=g,I()}finally{GI=e}},Bg=function(g,I,e){switch(I){case"input":if(_(g,e),I=e.name,"radio"===e.type&&null!=I){for(e=g;e.parentNode;)e=e.parentNode;for(e=e.querySelectorAll("input[name="+JSON.stringify(""+I)+'][type="radio"]'),I=0;I<e.length;I++){var C=e[I];if(C!==g&&C.form===g.form){var l=yl(C);if(!l)throw Error(n(90));T(C),_(C,l)}}}break;case"textarea":ng(g,e);break;case"select":null!=(I=e.value)&&eg(g,!!e.multiple,I,!1)}},fg=rA,Rg=cA;var Ir={usingClientEntryPoint:!1,Events:[Zl,Gl,yl,Sg,vg,rA]},er={findFiberByHostInstance:bl,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},Cr={bundleType:er.bundleType,version:er.version,rendererPackageName:er.rendererPackageName,rendererConfig:er.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:y.ReactCurrentDispatcher,findHostInstanceByFiber:function(g){return null===(g=Lg(g))?null:g.stateNode},findFiberByHostInstance:er.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var lr=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!lr.isDisabled&&lr.supportsFiber)try{lI=lr.inject(Cr),nI=lr}catch(rg){}}I.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Ir,I.createPortal=function(g,I){var e=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!qA(I))throw Error(n(200));return function(g,I,e){var C=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:B,key:null==C?null:""+C,children:g,containerInfo:I,implementation:e}}(g,I,null,e)},I.createRoot=function(g,I){if(!qA(g))throw Error(n(299));var e=!1,C="",l=jA;return null!==I&&void 0!==I&&(!0===I.unstable_strictMode&&(e=!0),void 0!==I.identifierPrefix&&(C=I.identifierPrefix),void 0!==I.onRecoverableError&&(l=I.onRecoverableError)),I=EA(g,1,!1,null,0,e,0,C,l),g[dl]=I.current,EC(8===g.nodeType?g.parentNode:g),new PA(I)},I.findDOMNode=function(g){if(null==g)return null;if(1===g.nodeType)return g;var I=g._reactInternals;if(void 0===I){if("function"===typeof g.render)throw Error(n(188));throw g=Object.keys(g).join(","),Error(n(268,g))}return g=null===(g=Lg(I))?null:g.stateNode},I.flushSync=function(g){return cA(g)},I.hydrate=function(g,I,e){if(!_A(I))throw Error(n(200));return gr(null,g,I,!0,e)},I.hydrateRoot=function(g,I,e){if(!qA(g))throw Error(n(405));var C=null!=e&&e.hydratedSources||null,l=!1,t="",a=jA;if(null!==e&&void 0!==e&&(!0===e.unstable_strictMode&&(l=!0),void 0!==e.identifierPrefix&&(t=e.identifierPrefix),void 0!==e.onRecoverableError&&(a=e.onRecoverableError)),I=QA(I,null,g,1,null!=e?e:null,l,0,t,a),g[dl]=I.current,EC(g),C)for(g=0;g<C.length;g++)l=(l=(e=C[g])._getVersion)(e._source),null==I.mutableSourceEagerHydrationData?I.mutableSourceEagerHydrationData=[e,l]:I.mutableSourceEagerHydrationData.push(e,l);return new OA(I)},I.render=function(g,I,e){if(!_A(I))throw Error(n(200));return gr(null,g,I,!1,e)},I.unmountComponentAtNode=function(g){if(!_A(g))throw Error(n(40));return!!g._reactRootContainer&&(cA((function(){gr(null,null,g,!1,(function(){g._reactRootContainer=null,g[dl]=null}))})),!0)},I.unstable_batchedUpdates=rA,I.unstable_renderSubtreeIntoContainer=function(g,I,e,C){if(!_A(e))throw Error(n(200));if(null==g||void 0===g._reactInternals)throw Error(n(38));return gr(g,I,e,!1,C)},I.version="18.2.0-next-9e3b772b8-20220608"},898:function(g,I,e){"use strict";var C=e(274);I.createRoot=C.createRoot,I.hydrateRoot=C.hydrateRoot},274:function(g,I,e){"use strict";!function g(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(g)}catch(I){console.error(I)}}(),g.exports=e(597)},966:function(g,I,e){g.exports=function(g){"use strict";function I(g){if(g&&g.__esModule)return g;var I=Object.create(null);return g&&Object.keys(g).forEach((function(e){if("default"!==e){var C=Object.getOwnPropertyDescriptor(g,e);Object.defineProperty(I,e,C.get?C:{enumerable:!0,get:function(){return g[e]}})}})),I.default=g,Object.freeze(I)}var e=I(g);function C(){return C=Object.assign?Object.assign.bind():function(g){for(var I=1;I<arguments.length;I++){var e=arguments[I];for(var C in e)Object.prototype.hasOwnProperty.call(e,C)&&(g[C]=e[C])}return g},C.apply(this,arguments)}function l(g,I,e){return I in g?Object.defineProperty(g,I,{value:e,enumerable:!0,configurable:!0,writable:!0}):g[I]=e,g}function n(g){if(Array.isArray(g))return g}function t(g,I){var e=null==g?null:"undefined"!==typeof Symbol&&g[Symbol.iterator]||g["@@iterator"];if(null!=e){var C,l,n=[],t=!0,a=!1;try{for(e=e.call(g);!(t=(C=e.next()).done)&&(n.push(C.value),!I||n.length!==I);t=!0);}catch(o){a=!0,l=o}finally{try{t||null==e.return||e.return()}finally{if(a)throw l}}return n}}function a(g,I){(null==I||I>g.length)&&(I=g.length);for(var e=0,C=new Array(I);e<I;e++)C[e]=g[e];return C}function o(g,I){if(g){if("string"===typeof g)return a(g,I);var e=Object.prototype.toString.call(g).slice(8,-1);return"Object"===e&&g.constructor&&(e=g.constructor.name),"Map"===e||"Set"===e?Array.from(g):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?a(g,I):void 0}}function A(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function r(g,I){return n(g)||t(g,I)||o(g,I)||A()}function c(g,I){if(null==g)return{};var e,C,l={},n=Object.keys(g);for(C=0;C<n.length;C++)e=n[C],I.indexOf(e)>=0||(l[e]=g[e]);return l}function i(g,I){if(null==g)return{};var e,C,l=c(g,I);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(g);for(C=0;C<n.length;C++)e=n[C],I.indexOf(e)>=0||Object.prototype.propertyIsEnumerable.call(g,e)&&(l[e]=g[e])}return l}var d={exports:{}},u={exports:{}},s={},m="function"===typeof Symbol&&Symbol.for,b=m?Symbol.for("react.element"):60103,Z=m?Symbol.for("react.portal"):60106,G=m?Symbol.for("react.fragment"):60107,y=m?Symbol.for("react.strict_mode"):60108,h=m?Symbol.for("react.profiler"):60114,B=m?Symbol.for("react.provider"):60109,p=m?Symbol.for("react.context"):60110,W=m?Symbol.for("react.async_mode"):60111,V=m?Symbol.for("react.concurrent_mode"):60111,S=m?Symbol.for("react.forward_ref"):60112,v=m?Symbol.for("react.suspense"):60113,f=m?Symbol.for("react.suspense_list"):60120,R=m?Symbol.for("react.memo"):60115,X=m?Symbol.for("react.lazy"):60116,J=m?Symbol.for("react.block"):60121,k=m?Symbol.for("react.fundamental"):60117,Y=m?Symbol.for("react.responder"):60118,H=m?Symbol.for("react.scope"):60119;function w(g){if("object"===typeof g&&null!==g){var I=g.$$typeof;switch(I){case b:switch(g=g.type){case W:case V:case G:case h:case y:case v:return g;default:switch(g=g&&g.$$typeof){case p:case S:case X:case R:case B:return g;default:return I}}case Z:return I}}}function N(g){return w(g)===V}s.AsyncMode=W,s.ConcurrentMode=V,s.ContextConsumer=p,s.ContextProvider=B,s.Element=b,s.ForwardRef=S,s.Fragment=G,s.Lazy=X,s.Memo=R,s.Portal=Z,s.Profiler=h,s.StrictMode=y,s.Suspense=v,s.isAsyncMode=function(g){return N(g)||w(g)===W},s.isConcurrentMode=N,s.isContextConsumer=function(g){return w(g)===p},s.isContextProvider=function(g){return w(g)===B},s.isElement=function(g){return"object"===typeof g&&null!==g&&g.$$typeof===b},s.isForwardRef=function(g){return w(g)===S},s.isFragment=function(g){return w(g)===G},s.isLazy=function(g){return w(g)===X},s.isMemo=function(g){return w(g)===R},s.isPortal=function(g){return w(g)===Z},s.isProfiler=function(g){return w(g)===h},s.isStrictMode=function(g){return w(g)===y},s.isSuspense=function(g){return w(g)===v},s.isValidElementType=function(g){return"string"===typeof g||"function"===typeof g||g===G||g===V||g===h||g===y||g===v||g===f||"object"===typeof g&&null!==g&&(g.$$typeof===X||g.$$typeof===R||g.$$typeof===B||g.$$typeof===p||g.$$typeof===S||g.$$typeof===k||g.$$typeof===Y||g.$$typeof===H||g.$$typeof===J)},s.typeOf=w,u.exports=s;Object.getOwnPropertySymbols,Object.prototype.hasOwnProperty,Object.prototype.propertyIsEnumerable;function F(){try{if(!Object.assign)return!1;var g=new String("abc");if(g[5]="de","5"===Object.getOwnPropertyNames(g)[0])return!1;for(var I={},e=0;e<10;e++)I["_"+String.fromCharCode(e)]=e;var C=Object.getOwnPropertyNames(I).map((function(g){return I[g]}));if("0123456789"!==C.join(""))return!1;var l={};return"abcdefghijklmnopqrst".split("").forEach((function(g){l[g]=g})),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},l)).join("")}catch(n){return!1}}F()&&Object.assign;var K="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";function x(g,I,e,C,l){}Function.call.bind(Object.prototype.hasOwnProperty),x.resetWarningCache=function(){},u.exports;var z=K;function E(){}function U(){}U.resetWarningCache=E;var Q=function(){function g(g,I,e,C,l,n){if(n!==z){var t=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw t.name="Invariant Violation",t}}function I(){return g}g.isRequired=g;var e={array:g,bigint:g,bool:g,func:g,number:g,object:g,string:g,symbol:g,any:g,arrayOf:I,element:g,elementType:g,instanceOf:I,node:g,objectOf:I,oneOf:I,oneOfType:I,shape:I,exact:I,checkPropTypes:U,resetWarningCache:E};return e.PropTypes=e,e};d.exports=Q();var M=d.exports;function L(g,I){var e=atob(g);if(I){for(var C=new Uint8Array(e.length),l=0,n=e.length;l<n;++l)C[l]=e.charCodeAt(l);return String.fromCharCode.apply(null,new Uint16Array(C.buffer))}return e}function D(g,I,e){var C=void 0===I?null:I,l=L(g,void 0!==e&&e),n=l.indexOf("\n",10)+1,t=l.substring(n)+(C?"//# sourceMappingURL="+C:""),a=new Blob([t],{type:"application/javascript"});return URL.createObjectURL(a)}function T(g,I,e){var C;return function(l){return C=C||D(g,I,e),new Worker(C,l)}}var j=T("Lyogcm9sbHVwLXBsdWdpbi13ZWItd29ya2VyLWxvYWRlciAqLwooZnVuY3Rpb24gKCkgewoJJ3VzZSBzdHJpY3QnOwoKCXZhciBjb21tb25qc0dsb2JhbCA9IHR5cGVvZiBnbG9iYWxUaGlzICE9PSAndW5kZWZpbmVkJyA/IGdsb2JhbFRoaXMgOiB0eXBlb2Ygd2luZG93ICE9PSAndW5kZWZpbmVkJyA/IHdpbmRvdyA6IHR5cGVvZiBnbG9iYWwgIT09ICd1bmRlZmluZWQnID8gZ2xvYmFsIDogdHlwZW9mIHNlbGYgIT09ICd1bmRlZmluZWQnID8gc2VsZiA6IHt9OwoKCWZ1bmN0aW9uIGdldEF1Z21lbnRlZE5hbWVzcGFjZShuKSB7CgkJaWYgKG4uX19lc01vZHVsZSkgcmV0dXJuIG47CgkJdmFyIGEgPSBPYmplY3QuZGVmaW5lUHJvcGVydHkoe30sICdfX2VzTW9kdWxlJywge3ZhbHVlOiB0cnVlfSk7CgkJT2JqZWN0LmtleXMobikuZm9yRWFjaChmdW5jdGlvbiAoaykgewoJCQl2YXIgZCA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3Iobiwgayk7CgkJCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShhLCBrLCBkLmdldCA/IGQgOiB7CgkJCQllbnVtZXJhYmxlOiB0cnVlLAoJCQkJZ2V0OiBmdW5jdGlvbiAoKSB7CgkJCQkJcmV0dXJuIG5ba107CgkJCQl9CgkJCX0pOwoJCX0pOwoJCXJldHVybiBhOwoJfQoKCXZhciBCaW5hcnlCaXRtYXAkMSA9IHt9OwoKCXZhciBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb24kMSA9IHt9OwoKCXZhciBFeGNlcHRpb24kMSA9IHt9OwoKCWZ1bmN0aW9uIGZpeFByb3RvKHRhcmdldCwgcHJvdG90eXBlKSB7CgkgIHZhciBzZXRQcm90b3R5cGVPZiA9IE9iamVjdC5zZXRQcm90b3R5cGVPZjsKCSAgc2V0UHJvdG90eXBlT2YgPyBzZXRQcm90b3R5cGVPZih0YXJnZXQsIHByb3RvdHlwZSkgOiB0YXJnZXQuX19wcm90b19fID0gcHJvdG90eXBlOwoJfQoJZnVuY3Rpb24gZml4U3RhY2sodGFyZ2V0LCBmbikgewoJICBpZiAoZm4gPT09IHZvaWQgMCkgewoJICAgIGZuID0gdGFyZ2V0LmNvbnN0cnVjdG9yOwoJICB9CgoJICB2YXIgY2FwdHVyZVN0YWNrVHJhY2UgPSBFcnJvci5jYXB0dXJlU3RhY2tUcmFjZTsKCSAgY2FwdHVyZVN0YWNrVHJhY2UgJiYgY2FwdHVyZVN0YWNrVHJhY2UodGFyZ2V0LCBmbik7Cgl9CgoJdmFyIF9fZXh0ZW5kcyRrID0gZnVuY3Rpb24gKCkgewoJICB2YXIgZXh0ZW5kU3RhdGljcyA9IGZ1bmN0aW9uIChkLCBiKSB7CgkgICAgZXh0ZW5kU3RhdGljcyA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fCB7CgkgICAgICBfX3Byb3RvX186IFtdCgkgICAgfSBpbnN0YW5jZW9mIEFycmF5ICYmIGZ1bmN0aW9uIChkLCBiKSB7CgkgICAgICBkLl9fcHJvdG9fXyA9IGI7CgkgICAgfSB8fCBmdW5jdGlvbiAoZCwgYikgewoJICAgICAgZm9yICh2YXIgcCBpbiBiKSB7IGlmIChiLmhhc093blByb3BlcnR5KHApKSB7IGRbcF0gPSBiW3BdOyB9IH0KCSAgICB9OwoKCSAgICByZXR1cm4gZXh0ZW5kU3RhdGljcyhkLCBiKTsKCSAgfTsKCgkgIHJldHVybiBmdW5jdGlvbiAoZCwgYikgewoJICAgIGV4dGVuZFN0YXRpY3MoZCwgYik7CgoJICAgIGZ1bmN0aW9uIF9fKCkgewoJICAgICAgdGhpcy5jb25zdHJ1Y3RvciA9IGQ7CgkgICAgfQoKCSAgICBkLnByb3RvdHlwZSA9IGIgPT09IG51bGwgPyBPYmplY3QuY3JlYXRlKGIpIDogKF9fLnByb3RvdHlwZSA9IGIucHJvdG90eXBlLCBuZXcgX18oKSk7CgkgIH07Cgl9KCk7CgoJdmFyIEN1c3RvbUVycm9yID0gZnVuY3Rpb24gKF9zdXBlcikgewoJICBfX2V4dGVuZHMkayhDdXN0b21FcnJvciwgX3N1cGVyKTsKCgkgIGZ1bmN0aW9uIEN1c3RvbUVycm9yKG1lc3NhZ2UpIHsKCSAgICB2YXIgX25ld1RhcmdldCA9IHRoaXMuY29uc3RydWN0b3I7CgoJICAgIHZhciBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMsIG1lc3NhZ2UpIHx8IHRoaXM7CgoJICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShfdGhpcywgJ25hbWUnLCB7CgkgICAgICB2YWx1ZTogX25ld1RhcmdldC5uYW1lLAoJICAgICAgZW51bWVyYWJsZTogZmFsc2UsCgkgICAgICBjb25maWd1cmFibGU6IHRydWUKCSAgICB9KTsKCSAgICBmaXhQcm90byhfdGhpcywgX25ld1RhcmdldC5wcm90b3R5cGUpOwoJICAgIGZpeFN0YWNrKF90aGlzKTsKCSAgICByZXR1cm4gX3RoaXM7CgkgIH0KCgkgIHJldHVybiBDdXN0b21FcnJvcjsKCX0oRXJyb3IpOwoKCXZhciBfX3NwcmVhZEFycmF5cyA9IGZ1bmN0aW9uICgpIHsKCSAgdmFyIGFyZ3VtZW50cyQxID0gYXJndW1lbnRzOwoKCSAgZm9yICh2YXIgcyA9IDAsIGkgPSAwLCBpbCA9IGFyZ3VtZW50cy5sZW5ndGg7IGkgPCBpbDsgaSsrKSB7IHMgKz0gYXJndW1lbnRzJDFbaV0ubGVuZ3RoOyB9CgoJICBmb3IgKHZhciByID0gQXJyYXkocyksIGsgPSAwLCBpID0gMDsgaSA8IGlsOyBpKyspIHsgZm9yICh2YXIgYSA9IGFyZ3VtZW50c1tpXSwgaiA9IDAsIGpsID0gYS5sZW5ndGg7IGogPCBqbDsgaisrLCBrKyspIHsgcltrXSA9IGFbal07IH0gfQoKCSAgcmV0dXJuIHI7Cgl9OwoJZnVuY3Rpb24gY3VzdG9tRXJyb3JGYWN0b3J5KGZuLCBwYXJlbnQpIHsKCSAgaWYgKHBhcmVudCA9PT0gdm9pZCAwKSB7CgkgICAgcGFyZW50ID0gRXJyb3I7CgkgIH0KCgkgIGZ1bmN0aW9uIEN1c3RvbUVycm9yKCkgewoJICAgIHZhciBhcmd1bWVudHMkMSA9IGFyZ3VtZW50czsKCgkgICAgdmFyIGFyZ3MgPSBbXTsKCgkgICAgZm9yICh2YXIgX2kgPSAwOyBfaSA8IGFyZ3VtZW50cy5sZW5ndGg7IF9pKyspIHsKCSAgICAgIGFyZ3NbX2ldID0gYXJndW1lbnRzJDFbX2ldOwoJICAgIH0KCgkgICAgaWYgKCEodGhpcyBpbnN0YW5jZW9mIEN1c3RvbUVycm9yKSkgeyByZXR1cm4gbmV3IChDdXN0b21FcnJvci5iaW5kLmFwcGx5KEN1c3RvbUVycm9yLCBfX3NwcmVhZEFycmF5cyhbdm9pZCAwXSwgYXJncykpKSgpOyB9CgkgICAgcGFyZW50LmFwcGx5KHRoaXMsIGFyZ3MpOwoJICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCAnbmFtZScsIHsKCSAgICAgIHZhbHVlOiBmbi5uYW1lIHx8IHBhcmVudC5uYW1lLAoJICAgICAgZW51bWVyYWJsZTogZmFsc2UsCgkgICAgICBjb25maWd1cmFibGU6IHRydWUKCSAgICB9KTsKCSAgICBmbi5hcHBseSh0aGlzLCBhcmdzKTsKCSAgICBmaXhTdGFjayh0aGlzLCBDdXN0b21FcnJvcik7CgkgIH0KCgkgIHJldHVybiBPYmplY3QuZGVmaW5lUHJvcGVydGllcyhDdXN0b21FcnJvciwgewoJICAgIHByb3RvdHlwZTogewoJICAgICAgdmFsdWU6IE9iamVjdC5jcmVhdGUocGFyZW50LnByb3RvdHlwZSwgewoJICAgICAgICBjb25zdHJ1Y3RvcjogewoJICAgICAgICAgIHZhbHVlOiBDdXN0b21FcnJvciwKCSAgICAgICAgICB3cml0YWJsZTogdHJ1ZSwKCSAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUKCSAgICAgICAgfQoJICAgICAgfSkKCSAgICB9CgkgIH0pOwoJfQoKCXZhciBjdXN0b21FcnJvciA9IC8qI19fUFVSRV9fKi9PYmplY3QuZnJlZXplKHsKCQlfX3Byb3RvX186IG51bGwsCgkJQ3VzdG9tRXJyb3I6IEN1c3RvbUVycm9yLAoJCWN1c3RvbUVycm9yRmFjdG9yeTogY3VzdG9tRXJyb3JGYWN0b3J5Cgl9KTsKCgl2YXIgcmVxdWlyZSQkMCA9IC8qQF9fUFVSRV9fKi9nZXRBdWdtZW50ZWROYW1lc3BhY2UoY3VzdG9tRXJyb3IpOwoKCXZhciBfX2V4dGVuZHMkaiA9IChjb21tb25qc0dsb2JhbCAmJiBjb21tb25qc0dsb2JhbC5fX2V4dGVuZHMpIHx8IChmdW5jdGlvbiAoKSB7CgkgICAgdmFyIGV4dGVuZFN0YXRpY3MgPSBmdW5jdGlvbiAoZCwgYikgewoJICAgICAgICBleHRlbmRTdGF0aWNzID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8CgkgICAgICAgICAgICAoeyBfX3Byb3RvX186IFtdIH0gaW5zdGFuY2VvZiBBcnJheSAmJiBmdW5jdGlvbiAoZCwgYikgeyBkLl9fcHJvdG9fXyA9IGI7IH0pIHx8CgkgICAgICAgICAgICBmdW5jdGlvbiAoZCwgYikgeyBmb3IgKHZhciBwIGluIGIpIGlmIChiLmhhc093blByb3BlcnR5KHApKSBkW3BdID0gYltwXTsgfTsKCSAgICAgICAgcmV0dXJuIGV4dGVuZFN0YXRpY3MoZCwgYik7CgkgICAgfTsKCSAgICByZXR1cm4gZnVuY3Rpb24gKGQsIGIpIHsKCSAgICAgICAgZXh0ZW5kU3RhdGljcyhkLCBiKTsKCSAgICAgICAgZnVuY3Rpb24gX18oKSB7IHRoaXMuY29uc3RydWN0b3IgPSBkOyB9CgkgICAgICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTsKCSAgICB9OwoJfSkoKTsKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShFeGNlcHRpb24kMSwgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJdmFyIHRzX2N1c3RvbV9lcnJvcl8xID0gcmVxdWlyZSQkMDsKCS8qKgoJICogQ3VzdG9tIEVycm9yIGNsYXNzIG9mIHR5cGUgRXhjZXB0aW9uLgoJICovCgl2YXIgRXhjZXB0aW9uID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikgewoJICAgIF9fZXh0ZW5kcyRqKEV4Y2VwdGlvbiwgX3N1cGVyKTsKCSAgICAvKioKCSAgICAgKiBBbGxvd3MgRXhjZXB0aW9uIHRvIGJlIGNvbnN0cnVjdGVkIGRpcmVjdGx5CgkgICAgICogd2l0aCBzb21lIG1lc3NhZ2UgYW5kIHByb3RvdHlwZSBkZWZpbml0aW9uLgoJICAgICAqLwoJICAgIGZ1bmN0aW9uIEV4Y2VwdGlvbihtZXNzYWdlKSB7CgkgICAgICAgIGlmIChtZXNzYWdlID09PSB2b2lkIDApIHsgbWVzc2FnZSA9IHVuZGVmaW5lZDsgfQoJICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzLCBtZXNzYWdlKSB8fCB0aGlzOwoJICAgICAgICBfdGhpcy5tZXNzYWdlID0gbWVzc2FnZTsKCSAgICAgICAgcmV0dXJuIF90aGlzOwoJICAgIH0KCSAgICBFeGNlcHRpb24ucHJvdG90eXBlLmdldEtpbmQgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHZhciBleCA9IHRoaXMuY29uc3RydWN0b3I7CgkgICAgICAgIHJldHVybiBleC5raW5kOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogSXQncyB0eXBlZCBhcyBzdHJpbmcgc28gaXQgY2FuIGJlIGV4dGVuZGVkIGFuZCBvdmVycmlkZW4uCgkgICAgICovCgkgICAgRXhjZXB0aW9uLmtpbmQgPSAnRXhjZXB0aW9uJzsKCSAgICByZXR1cm4gRXhjZXB0aW9uOwoJfSh0c19jdXN0b21fZXJyb3JfMS5DdXN0b21FcnJvcikpOwoJRXhjZXB0aW9uJDEuZGVmYXVsdCA9IEV4Y2VwdGlvbjsKCgl2YXIgX19leHRlbmRzJGkgPSAoY29tbW9uanNHbG9iYWwgJiYgY29tbW9uanNHbG9iYWwuX19leHRlbmRzKSB8fCAoZnVuY3Rpb24gKCkgewoJICAgIHZhciBleHRlbmRTdGF0aWNzID0gZnVuY3Rpb24gKGQsIGIpIHsKCSAgICAgICAgZXh0ZW5kU3RhdGljcyA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fAoJICAgICAgICAgICAgKHsgX19wcm90b19fOiBbXSB9IGluc3RhbmNlb2YgQXJyYXkgJiYgZnVuY3Rpb24gKGQsIGIpIHsgZC5fX3Byb3RvX18gPSBiOyB9KSB8fAoJICAgICAgICAgICAgZnVuY3Rpb24gKGQsIGIpIHsgZm9yICh2YXIgcCBpbiBiKSBpZiAoYi5oYXNPd25Qcm9wZXJ0eShwKSkgZFtwXSA9IGJbcF07IH07CgkgICAgICAgIHJldHVybiBleHRlbmRTdGF0aWNzKGQsIGIpOwoJICAgIH07CgkgICAgcmV0dXJuIGZ1bmN0aW9uIChkLCBiKSB7CgkgICAgICAgIGV4dGVuZFN0YXRpY3MoZCwgYik7CgkgICAgICAgIGZ1bmN0aW9uIF9fKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gZDsgfQoJICAgICAgICBkLnByb3RvdHlwZSA9IGIgPT09IG51bGwgPyBPYmplY3QuY3JlYXRlKGIpIDogKF9fLnByb3RvdHlwZSA9IGIucHJvdG90eXBlLCBuZXcgX18oKSk7CgkgICAgfTsKCX0pKCk7CglPYmplY3QuZGVmaW5lUHJvcGVydHkoSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCXZhciBFeGNlcHRpb25fMSQ5ID0gRXhjZXB0aW9uJDE7CgkvKioKCSAqIEN1c3RvbSBFcnJvciBjbGFzcyBvZiB0eXBlIEV4Y2VwdGlvbi4KCSAqLwoJdmFyIElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbiA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHsKCSAgICBfX2V4dGVuZHMkaShJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb24sIF9zdXBlcik7CgkgICAgZnVuY3Rpb24gSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uKCkgewoJICAgICAgICByZXR1cm4gX3N1cGVyICE9PSBudWxsICYmIF9zdXBlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpIHx8IHRoaXM7CgkgICAgfQoJICAgIElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbi5raW5kID0gJ0lsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbic7CgkgICAgcmV0dXJuIElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbjsKCX0oRXhjZXB0aW9uXzEkOS5kZWZhdWx0KSk7CglJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb24kMS5kZWZhdWx0ID0gSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uOwoKCS8qCgkgKiBDb3B5cmlnaHQgMjAwOSBaWGluZyBhdXRob3JzCgkgKgoJICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIik7CgkgKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCgkgKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKCSAqCgkgKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAoJICoKCSAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKCSAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCgkgKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4KCSAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKCSAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgoJICovCglPYmplY3QuZGVmaW5lUHJvcGVydHkoQmluYXJ5Qml0bWFwJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCXZhciBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb25fMSRhID0gSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uJDE7Cgl2YXIgQmluYXJ5Qml0bWFwID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkgewoJICAgIGZ1bmN0aW9uIEJpbmFyeUJpdG1hcChiaW5hcml6ZXIpIHsKCSAgICAgICAgdGhpcy5iaW5hcml6ZXIgPSBiaW5hcml6ZXI7CgkgICAgICAgIGlmIChiaW5hcml6ZXIgPT09IG51bGwpIHsKCSAgICAgICAgICAgIHRocm93IG5ldyBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb25fMSRhLmRlZmF1bHQoJ0JpbmFyaXplciBtdXN0IGJlIG5vbi1udWxsLicpOwoJICAgICAgICB9CgkgICAgfQoJICAgIC8qKgoJICAgICAqIEByZXR1cm4gVGhlIHdpZHRoIG9mIHRoZSBiaXRtYXAuCgkgICAgICovCgkgICAgQmluYXJ5Qml0bWFwLnByb3RvdHlwZS5nZXRXaWR0aCA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMuYmluYXJpemVyLmdldFdpZHRoKCk7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcmV0dXJuIFRoZSBoZWlnaHQgb2YgdGhlIGJpdG1hcC4KCSAgICAgKi8KCSAgICBCaW5hcnlCaXRtYXAucHJvdG90eXBlLmdldEhlaWdodCA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMuYmluYXJpemVyLmdldEhlaWdodCgpOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQ29udmVydHMgb25lIHJvdyBvZiBsdW1pbmFuY2UgZGF0YSB0byAxIGJpdCBkYXRhLiBNYXkgYWN0dWFsbHkgZG8gdGhlIGNvbnZlcnNpb24sIG9yIHJldHVybgoJICAgICAqIGNhY2hlZCBkYXRhLiBDYWxsZXJzIHNob3VsZCBhc3N1bWUgdGhpcyBtZXRob2QgaXMgZXhwZW5zaXZlIGFuZCBjYWxsIGl0IGFzIHNlbGRvbSBhcyBwb3NzaWJsZS4KCSAgICAgKiBUaGlzIG1ldGhvZCBpcyBpbnRlbmRlZCBmb3IgZGVjb2RpbmcgMUQgYmFyY29kZXMgYW5kIG1heSBjaG9vc2UgdG8gYXBwbHkgc2hhcnBlbmluZy4KCSAgICAgKgoJICAgICAqIEBwYXJhbSB5IFRoZSByb3cgdG8gZmV0Y2gsIHdoaWNoIG11c3QgYmUgaW4gWzAsIGJpdG1hcCBoZWlnaHQpCgkgICAgICogQHBhcmFtIHJvdyBBbiBvcHRpb25hbCBwcmVhbGxvY2F0ZWQgYXJyYXkuIElmIG51bGwgb3IgdG9vIHNtYWxsLCBpdCB3aWxsIGJlIGlnbm9yZWQuCgkgICAgICogICAgICAgICAgICBJZiB1c2VkLCB0aGUgQmluYXJpemVyIHdpbGwgY2FsbCBCaXRBcnJheS5jbGVhcigpLiBBbHdheXMgdXNlIHRoZSByZXR1cm5lZCBvYmplY3QuCgkgICAgICogQHJldHVybiBUaGUgYXJyYXkgb2YgYml0cyBmb3IgdGhpcyByb3cgKHRydWUgbWVhbnMgYmxhY2spLgoJICAgICAqIEB0aHJvd3MgTm90Rm91bmRFeGNlcHRpb24gaWYgcm93IGNhbid0IGJlIGJpbmFyaXplZAoJICAgICAqLwoJICAgIEJpbmFyeUJpdG1hcC5wcm90b3R5cGUuZ2V0QmxhY2tSb3cgPSBmdW5jdGlvbiAoeSAvKmludCovLCByb3cpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMuYmluYXJpemVyLmdldEJsYWNrUm93KHksIHJvdyk7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBDb252ZXJ0cyBhIDJEIGFycmF5IG9mIGx1bWluYW5jZSBkYXRhIHRvIDEgYml0LiBBcyBhYm92ZSwgYXNzdW1lIHRoaXMgbWV0aG9kIGlzIGV4cGVuc2l2ZQoJICAgICAqIGFuZCBkbyBub3QgY2FsbCBpdCByZXBlYXRlZGx5LiBUaGlzIG1ldGhvZCBpcyBpbnRlbmRlZCBmb3IgZGVjb2RpbmcgMkQgYmFyY29kZXMgYW5kIG1heSBvcgoJICAgICAqIG1heSBub3QgYXBwbHkgc2hhcnBlbmluZy4gVGhlcmVmb3JlLCBhIHJvdyBmcm9tIHRoaXMgbWF0cml4IG1heSBub3QgYmUgaWRlbnRpY2FsIHRvIG9uZQoJICAgICAqIGZldGNoZWQgdXNpbmcgZ2V0QmxhY2tSb3coKSwgc28gZG9uJ3QgbWl4IGFuZCBtYXRjaCBiZXR3ZWVuIHRoZW0uCgkgICAgICoKCSAgICAgKiBAcmV0dXJuIFRoZSAyRCBhcnJheSBvZiBiaXRzIGZvciB0aGUgaW1hZ2UgKHRydWUgbWVhbnMgYmxhY2spLgoJICAgICAqIEB0aHJvd3MgTm90Rm91bmRFeGNlcHRpb24gaWYgaW1hZ2UgY2FuJ3QgYmUgYmluYXJpemVkIHRvIG1ha2UgYSBtYXRyaXgKCSAgICAgKi8KCSAgICBCaW5hcnlCaXRtYXAucHJvdG90eXBlLmdldEJsYWNrTWF0cml4ID0gZnVuY3Rpb24gKCkgewoJICAgICAgICAvLyBUaGUgbWF0cml4IGlzIGNyZWF0ZWQgb24gZGVtYW5kIHRoZSBmaXJzdCB0aW1lIGl0IGlzIHJlcXVlc3RlZCwgdGhlbiBjYWNoZWQuIFRoZXJlIGFyZSB0d28KCSAgICAgICAgLy8gcmVhc29ucyBmb3IgdGhpczoKCSAgICAgICAgLy8gMS4gVGhpcyB3b3JrIHdpbGwgbmV2ZXIgYmUgZG9uZSBpZiB0aGUgY2FsbGVyIG9ubHkgaW5zdGFsbHMgMUQgUmVhZGVyIG9iamVjdHMsIG9yIGlmIGEKCSAgICAgICAgLy8gICAgMUQgUmVhZGVyIGZpbmRzIGEgYmFyY29kZSBiZWZvcmUgdGhlIDJEIFJlYWRlcnMgcnVuLgoJICAgICAgICAvLyAyLiBUaGlzIHdvcmsgd2lsbCBvbmx5IGJlIGRvbmUgb25jZSBldmVuIGlmIHRoZSBjYWxsZXIgaW5zdGFsbHMgbXVsdGlwbGUgMkQgUmVhZGVycy4KCSAgICAgICAgaWYgKHRoaXMubWF0cml4ID09PSBudWxsIHx8IHRoaXMubWF0cml4ID09PSB1bmRlZmluZWQpIHsKCSAgICAgICAgICAgIHRoaXMubWF0cml4ID0gdGhpcy5iaW5hcml6ZXIuZ2V0QmxhY2tNYXRyaXgoKTsKCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gdGhpcy5tYXRyaXg7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcmV0dXJuIFdoZXRoZXIgdGhpcyBiaXRtYXAgY2FuIGJlIGNyb3BwZWQuCgkgICAgICovCgkgICAgQmluYXJ5Qml0bWFwLnByb3RvdHlwZS5pc0Nyb3BTdXBwb3J0ZWQgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLmJpbmFyaXplci5nZXRMdW1pbmFuY2VTb3VyY2UoKS5pc0Nyb3BTdXBwb3J0ZWQoKTsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIFJldHVybnMgYSBuZXcgb2JqZWN0IHdpdGggY3JvcHBlZCBpbWFnZSBkYXRhLiBJbXBsZW1lbnRhdGlvbnMgbWF5IGtlZXAgYSByZWZlcmVuY2UgdG8gdGhlCgkgICAgICogb3JpZ2luYWwgZGF0YSByYXRoZXIgdGhhbiBhIGNvcHkuIE9ubHkgY2FsbGFibGUgaWYgaXNDcm9wU3VwcG9ydGVkKCkgaXMgdHJ1ZS4KCSAgICAgKgoJICAgICAqIEBwYXJhbSBsZWZ0IFRoZSBsZWZ0IGNvb3JkaW5hdGUsIHdoaWNoIG11c3QgYmUgaW4gWzAsZ2V0V2lkdGgoKSkKCSAgICAgKiBAcGFyYW0gdG9wIFRoZSB0b3AgY29vcmRpbmF0ZSwgd2hpY2ggbXVzdCBiZSBpbiBbMCxnZXRIZWlnaHQoKSkKCSAgICAgKiBAcGFyYW0gd2lkdGggVGhlIHdpZHRoIG9mIHRoZSByZWN0YW5nbGUgdG8gY3JvcC4KCSAgICAgKiBAcGFyYW0gaGVpZ2h0IFRoZSBoZWlnaHQgb2YgdGhlIHJlY3RhbmdsZSB0byBjcm9wLgoJICAgICAqIEByZXR1cm4gQSBjcm9wcGVkIHZlcnNpb24gb2YgdGhpcyBvYmplY3QuCgkgICAgICovCgkgICAgQmluYXJ5Qml0bWFwLnByb3RvdHlwZS5jcm9wID0gZnVuY3Rpb24gKGxlZnQgLyppbnQqLywgdG9wIC8qaW50Ki8sIHdpZHRoIC8qaW50Ki8sIGhlaWdodCAvKmludCovKSB7CgkgICAgICAgIHZhciBuZXdTb3VyY2UgPSB0aGlzLmJpbmFyaXplci5nZXRMdW1pbmFuY2VTb3VyY2UoKS5jcm9wKGxlZnQsIHRvcCwgd2lkdGgsIGhlaWdodCk7CgkgICAgICAgIHJldHVybiBuZXcgQmluYXJ5Qml0bWFwKHRoaXMuYmluYXJpemVyLmNyZWF0ZUJpbmFyaXplcihuZXdTb3VyY2UpKTsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEByZXR1cm4gV2hldGhlciB0aGlzIGJpdG1hcCBzdXBwb3J0cyBjb3VudGVyLWNsb2Nrd2lzZSByb3RhdGlvbi4KCSAgICAgKi8KCSAgICBCaW5hcnlCaXRtYXAucHJvdG90eXBlLmlzUm90YXRlU3VwcG9ydGVkID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5iaW5hcml6ZXIuZ2V0THVtaW5hbmNlU291cmNlKCkuaXNSb3RhdGVTdXBwb3J0ZWQoKTsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIFJldHVybnMgYSBuZXcgb2JqZWN0IHdpdGggcm90YXRlZCBpbWFnZSBkYXRhIGJ5IDkwIGRlZ3JlZXMgY291bnRlcmNsb2Nrd2lzZS4KCSAgICAgKiBPbmx5IGNhbGxhYmxlIGlmIHtAbGluayAjaXNSb3RhdGVTdXBwb3J0ZWQoKX0gaXMgdHJ1ZS4KCSAgICAgKgoJICAgICAqIEByZXR1cm4gQSByb3RhdGVkIHZlcnNpb24gb2YgdGhpcyBvYmplY3QuCgkgICAgICovCgkgICAgQmluYXJ5Qml0bWFwLnByb3RvdHlwZS5yb3RhdGVDb3VudGVyQ2xvY2t3aXNlID0gZnVuY3Rpb24gKCkgewoJICAgICAgICB2YXIgbmV3U291cmNlID0gdGhpcy5iaW5hcml6ZXIuZ2V0THVtaW5hbmNlU291cmNlKCkucm90YXRlQ291bnRlckNsb2Nrd2lzZSgpOwoJICAgICAgICByZXR1cm4gbmV3IEJpbmFyeUJpdG1hcCh0aGlzLmJpbmFyaXplci5jcmVhdGVCaW5hcml6ZXIobmV3U291cmNlKSk7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBSZXR1cm5zIGEgbmV3IG9iamVjdCB3aXRoIHJvdGF0ZWQgaW1hZ2UgZGF0YSBieSA0NSBkZWdyZWVzIGNvdW50ZXJjbG9ja3dpc2UuCgkgICAgICogT25seSBjYWxsYWJsZSBpZiB7QGxpbmsgI2lzUm90YXRlU3VwcG9ydGVkKCl9IGlzIHRydWUuCgkgICAgICoKCSAgICAgKiBAcmV0dXJuIEEgcm90YXRlZCB2ZXJzaW9uIG9mIHRoaXMgb2JqZWN0LgoJICAgICAqLwoJICAgIEJpbmFyeUJpdG1hcC5wcm90b3R5cGUucm90YXRlQ291bnRlckNsb2Nrd2lzZTQ1ID0gZnVuY3Rpb24gKCkgewoJICAgICAgICB2YXIgbmV3U291cmNlID0gdGhpcy5iaW5hcml6ZXIuZ2V0THVtaW5hbmNlU291cmNlKCkucm90YXRlQ291bnRlckNsb2Nrd2lzZTQ1KCk7CgkgICAgICAgIHJldHVybiBuZXcgQmluYXJ5Qml0bWFwKHRoaXMuYmluYXJpemVyLmNyZWF0ZUJpbmFyaXplcihuZXdTb3VyY2UpKTsKCSAgICB9OwoJICAgIC8qQE92ZXJyaWRlKi8KCSAgICBCaW5hcnlCaXRtYXAucHJvdG90eXBlLnRvU3RyaW5nID0gZnVuY3Rpb24gKCkgewoJICAgICAgICB0cnkgewoJICAgICAgICAgICAgcmV0dXJuIHRoaXMuZ2V0QmxhY2tNYXRyaXgoKS50b1N0cmluZygpOwoJICAgICAgICB9CgkgICAgICAgIGNhdGNoIChlIC8qOiBOb3RGb3VuZEV4Y2VwdGlvbiovKSB7CgkgICAgICAgICAgICByZXR1cm4gJyc7CgkgICAgICAgIH0KCSAgICB9OwoJICAgIHJldHVybiBCaW5hcnlCaXRtYXA7Cgl9KCkpOwoJdmFyIF9kZWZhdWx0JDMgPSBCaW5hcnlCaXRtYXAkMS5kZWZhdWx0ID0gQmluYXJ5Qml0bWFwOwoKCXZhciBIeWJyaWRCaW5hcml6ZXIkMSA9IHt9OwoKCXZhciBHbG9iYWxIaXN0b2dyYW1CaW5hcml6ZXIkMSA9IHt9OwoKCXZhciBCaW5hcml6ZXIkMSA9IHt9OwoKCS8qCgkgKiBDb3B5cmlnaHQgMjAwOSBaWGluZyBhdXRob3JzCgkgKgoJICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIik7CgkgKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCgkgKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKCSAqCgkgKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAoJICoKCSAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKCSAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCgkgKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4KCSAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKCSAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgoJICovCglPYmplY3QuZGVmaW5lUHJvcGVydHkoQmluYXJpemVyJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCS8qKgoJICogVGhpcyBjbGFzcyBoaWVyYXJjaHkgcHJvdmlkZXMgYSBzZXQgb2YgbWV0aG9kcyB0byBjb252ZXJ0IGx1bWluYW5jZSBkYXRhIHRvIDEgYml0IGRhdGEuCgkgKiBJdCBhbGxvd3MgdGhlIGFsZ29yaXRobSB0byB2YXJ5IHBvbHltb3JwaGljYWxseSwgZm9yIGV4YW1wbGUgYWxsb3dpbmcgYSB2ZXJ5IGV4cGVuc2l2ZQoJICogdGhyZXNob2xkaW5nIHRlY2huaXF1ZSBmb3Igc2VydmVycyBhbmQgYSBmYXN0IG9uZSBmb3IgbW9iaWxlLiBJdCBhbHNvIHBlcm1pdHMgdGhlIGltcGxlbWVudGF0aW9uCgkgKiB0byB2YXJ5LCBlLmcuIGEgSk5JIHZlcnNpb24gZm9yIEFuZHJvaWQgYW5kIGEgSmF2YSBmYWxsYmFjayB2ZXJzaW9uIGZvciBvdGhlciBwbGF0Zm9ybXMuCgkgKgoJICogQGF1dGhvciBkc3dpdGtpbkBnb29nbGUuY29tIChEYW5pZWwgU3dpdGtpbikKCSAqLwoJdmFyIEJpbmFyaXplciA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHsKCSAgICBmdW5jdGlvbiBCaW5hcml6ZXIoc291cmNlKSB7CgkgICAgICAgIHRoaXMuc291cmNlID0gc291cmNlOwoJICAgIH0KCSAgICBCaW5hcml6ZXIucHJvdG90eXBlLmdldEx1bWluYW5jZVNvdXJjZSA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMuc291cmNlOwoJICAgIH07CgkgICAgQmluYXJpemVyLnByb3RvdHlwZS5nZXRXaWR0aCA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMuc291cmNlLmdldFdpZHRoKCk7CgkgICAgfTsKCSAgICBCaW5hcml6ZXIucHJvdG90eXBlLmdldEhlaWdodCA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMuc291cmNlLmdldEhlaWdodCgpOwoJICAgIH07CgkgICAgcmV0dXJuIEJpbmFyaXplcjsKCX0oKSk7CglCaW5hcml6ZXIkMS5kZWZhdWx0ID0gQmluYXJpemVyOwoKCXZhciBCaXRBcnJheSQxID0ge307CgoJdmFyIEFycmF5cyQxID0ge307CgoJdmFyIFN5c3RlbSQxID0ge307CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KFN5c3RlbSQxLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7Cgl2YXIgU3lzdGVtID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkgewoJICAgIGZ1bmN0aW9uIFN5c3RlbSgpIHsKCSAgICB9CgkgICAgLy8gcHVibGljIHN0YXRpYyB2b2lkIGFycmF5Y29weShPYmplY3Qgc3JjLCBpbnQgc3JjUG9zLCBPYmplY3QgZGVzdCwgaW50IGRlc3RQb3MsIGludCBsZW5ndGgpCgkgICAgLyoqCgkgICAgICogTWFrZXMgYSBjb3B5IG9mIGEgYXJyYXkuCgkgICAgICovCgkgICAgU3lzdGVtLmFycmF5Y29weSA9IGZ1bmN0aW9uIChzcmMsIHNyY1BvcywgZGVzdCwgZGVzdFBvcywgbGVuZ3RoKSB7CgkgICAgICAgIC8vIFRPRE86IGJldHRlciB1c2Ugc3BsaXQgb3Igc2V0PwoJICAgICAgICB3aGlsZSAobGVuZ3RoLS0pIHsKCSAgICAgICAgICAgIGRlc3RbZGVzdFBvcysrXSA9IHNyY1tzcmNQb3MrK107CgkgICAgICAgIH0KCSAgICB9OwoJICAgIC8qKgoJICAgICAqIFJldHVybnMgdGhlIGN1cnJlbnQgdGltZSBpbiBtaWxsaXNlY29uZHMuCgkgICAgICovCgkgICAgU3lzdGVtLmN1cnJlbnRUaW1lTWlsbGlzID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gRGF0ZS5ub3coKTsKCSAgICB9OwoJICAgIHJldHVybiBTeXN0ZW07Cgl9KCkpOwoJU3lzdGVtJDEuZGVmYXVsdCA9IFN5c3RlbTsKCgl2YXIgQXJyYXlJbmRleE91dE9mQm91bmRzRXhjZXB0aW9uJDEgPSB7fTsKCgl2YXIgSW5kZXhPdXRPZkJvdW5kc0V4Y2VwdGlvbiQxID0ge307CgoJdmFyIF9fZXh0ZW5kcyRoID0gKGNvbW1vbmpzR2xvYmFsICYmIGNvbW1vbmpzR2xvYmFsLl9fZXh0ZW5kcykgfHwgKGZ1bmN0aW9uICgpIHsKCSAgICB2YXIgZXh0ZW5kU3RhdGljcyA9IGZ1bmN0aW9uIChkLCBiKSB7CgkgICAgICAgIGV4dGVuZFN0YXRpY3MgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgfHwKCSAgICAgICAgICAgICh7IF9fcHJvdG9fXzogW10gfSBpbnN0YW5jZW9mIEFycmF5ICYmIGZ1bmN0aW9uIChkLCBiKSB7IGQuX19wcm90b19fID0gYjsgfSkgfHwKCSAgICAgICAgICAgIGZ1bmN0aW9uIChkLCBiKSB7IGZvciAodmFyIHAgaW4gYikgaWYgKGIuaGFzT3duUHJvcGVydHkocCkpIGRbcF0gPSBiW3BdOyB9OwoJICAgICAgICByZXR1cm4gZXh0ZW5kU3RhdGljcyhkLCBiKTsKCSAgICB9OwoJICAgIHJldHVybiBmdW5jdGlvbiAoZCwgYikgewoJICAgICAgICBleHRlbmRTdGF0aWNzKGQsIGIpOwoJICAgICAgICBmdW5jdGlvbiBfXygpIHsgdGhpcy5jb25zdHJ1Y3RvciA9IGQ7IH0KCSAgICAgICAgZC5wcm90b3R5cGUgPSBiID09PSBudWxsID8gT2JqZWN0LmNyZWF0ZShiKSA6IChfXy5wcm90b3R5cGUgPSBiLnByb3RvdHlwZSwgbmV3IF9fKCkpOwoJICAgIH07Cgl9KSgpOwoJT2JqZWN0LmRlZmluZVByb3BlcnR5KEluZGV4T3V0T2ZCb3VuZHNFeGNlcHRpb24kMSwgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJdmFyIEV4Y2VwdGlvbl8xJDggPSBFeGNlcHRpb24kMTsKCS8qKgoJICogQ3VzdG9tIEVycm9yIGNsYXNzIG9mIHR5cGUgRXhjZXB0aW9uLgoJICovCgl2YXIgSW5kZXhPdXRPZkJvdW5kc0V4Y2VwdGlvbiA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHsKCSAgICBfX2V4dGVuZHMkaChJbmRleE91dE9mQm91bmRzRXhjZXB0aW9uLCBfc3VwZXIpOwoJICAgIGZ1bmN0aW9uIEluZGV4T3V0T2ZCb3VuZHNFeGNlcHRpb24oKSB7CgkgICAgICAgIHJldHVybiBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpczsKCSAgICB9CgkgICAgSW5kZXhPdXRPZkJvdW5kc0V4Y2VwdGlvbi5raW5kID0gJ0luZGV4T3V0T2ZCb3VuZHNFeGNlcHRpb24nOwoJICAgIHJldHVybiBJbmRleE91dE9mQm91bmRzRXhjZXB0aW9uOwoJfShFeGNlcHRpb25fMSQ4LmRlZmF1bHQpKTsKCUluZGV4T3V0T2ZCb3VuZHNFeGNlcHRpb24kMS5kZWZhdWx0ID0gSW5kZXhPdXRPZkJvdW5kc0V4Y2VwdGlvbjsKCgl2YXIgX19leHRlbmRzJGcgPSAoY29tbW9uanNHbG9iYWwgJiYgY29tbW9uanNHbG9iYWwuX19leHRlbmRzKSB8fCAoZnVuY3Rpb24gKCkgewoJICAgIHZhciBleHRlbmRTdGF0aWNzID0gZnVuY3Rpb24gKGQsIGIpIHsKCSAgICAgICAgZXh0ZW5kU3RhdGljcyA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fAoJICAgICAgICAgICAgKHsgX19wcm90b19fOiBbXSB9IGluc3RhbmNlb2YgQXJyYXkgJiYgZnVuY3Rpb24gKGQsIGIpIHsgZC5fX3Byb3RvX18gPSBiOyB9KSB8fAoJICAgICAgICAgICAgZnVuY3Rpb24gKGQsIGIpIHsgZm9yICh2YXIgcCBpbiBiKSBpZiAoYi5oYXNPd25Qcm9wZXJ0eShwKSkgZFtwXSA9IGJbcF07IH07CgkgICAgICAgIHJldHVybiBleHRlbmRTdGF0aWNzKGQsIGIpOwoJICAgIH07CgkgICAgcmV0dXJuIGZ1bmN0aW9uIChkLCBiKSB7CgkgICAgICAgIGV4dGVuZFN0YXRpY3MoZCwgYik7CgkgICAgICAgIGZ1bmN0aW9uIF9fKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gZDsgfQoJICAgICAgICBkLnByb3RvdHlwZSA9IGIgPT09IG51bGwgPyBPYmplY3QuY3JlYXRlKGIpIDogKF9fLnByb3RvdHlwZSA9IGIucHJvdG90eXBlLCBuZXcgX18oKSk7CgkgICAgfTsKCX0pKCk7CglPYmplY3QuZGVmaW5lUHJvcGVydHkoQXJyYXlJbmRleE91dE9mQm91bmRzRXhjZXB0aW9uJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCXZhciBJbmRleE91dE9mQm91bmRzRXhjZXB0aW9uXzEgPSBJbmRleE91dE9mQm91bmRzRXhjZXB0aW9uJDE7CgkvKioKCSAqIEN1c3RvbSBFcnJvciBjbGFzcyBvZiB0eXBlIEV4Y2VwdGlvbi4KCSAqLwoJdmFyIEFycmF5SW5kZXhPdXRPZkJvdW5kc0V4Y2VwdGlvbiA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHsKCSAgICBfX2V4dGVuZHMkZyhBcnJheUluZGV4T3V0T2ZCb3VuZHNFeGNlcHRpb24sIF9zdXBlcik7CgkgICAgZnVuY3Rpb24gQXJyYXlJbmRleE91dE9mQm91bmRzRXhjZXB0aW9uKGluZGV4LCBtZXNzYWdlKSB7CgkgICAgICAgIGlmIChpbmRleCA9PT0gdm9pZCAwKSB7IGluZGV4ID0gdW5kZWZpbmVkOyB9CgkgICAgICAgIGlmIChtZXNzYWdlID09PSB2b2lkIDApIHsgbWVzc2FnZSA9IHVuZGVmaW5lZDsgfQoJICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzLCBtZXNzYWdlKSB8fCB0aGlzOwoJICAgICAgICBfdGhpcy5pbmRleCA9IGluZGV4OwoJICAgICAgICBfdGhpcy5tZXNzYWdlID0gbWVzc2FnZTsKCSAgICAgICAgcmV0dXJuIF90aGlzOwoJICAgIH0KCSAgICBBcnJheUluZGV4T3V0T2ZCb3VuZHNFeGNlcHRpb24ua2luZCA9ICdBcnJheUluZGV4T3V0T2ZCb3VuZHNFeGNlcHRpb24nOwoJICAgIHJldHVybiBBcnJheUluZGV4T3V0T2ZCb3VuZHNFeGNlcHRpb247Cgl9KEluZGV4T3V0T2ZCb3VuZHNFeGNlcHRpb25fMS5kZWZhdWx0KSk7CglBcnJheUluZGV4T3V0T2ZCb3VuZHNFeGNlcHRpb24kMS5kZWZhdWx0ID0gQXJyYXlJbmRleE91dE9mQm91bmRzRXhjZXB0aW9uOwoKCXZhciBfX3ZhbHVlcyQ3ID0gKGNvbW1vbmpzR2xvYmFsICYmIGNvbW1vbmpzR2xvYmFsLl9fdmFsdWVzKSB8fCBmdW5jdGlvbihvKSB7CgkgICAgdmFyIHMgPSB0eXBlb2YgU3ltYm9sID09PSAiZnVuY3Rpb24iICYmIFN5bWJvbC5pdGVyYXRvciwgbSA9IHMgJiYgb1tzXSwgaSA9IDA7CgkgICAgaWYgKG0pIHJldHVybiBtLmNhbGwobyk7CgkgICAgaWYgKG8gJiYgdHlwZW9mIG8ubGVuZ3RoID09PSAibnVtYmVyIikgcmV0dXJuIHsKCSAgICAgICAgbmV4dDogZnVuY3Rpb24gKCkgewoJICAgICAgICAgICAgaWYgKG8gJiYgaSA+PSBvLmxlbmd0aCkgbyA9IHZvaWQgMDsKCSAgICAgICAgICAgIHJldHVybiB7IHZhbHVlOiBvICYmIG9baSsrXSwgZG9uZTogIW8gfTsKCSAgICAgICAgfQoJICAgIH07CgkgICAgdGhyb3cgbmV3IFR5cGVFcnJvcihzID8gIk9iamVjdCBpcyBub3QgaXRlcmFibGUuIiA6ICJTeW1ib2wuaXRlcmF0b3IgaXMgbm90IGRlZmluZWQuIik7Cgl9OwoJT2JqZWN0LmRlZmluZVByb3BlcnR5KEFycmF5cyQxLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7Cgl2YXIgU3lzdGVtXzEkNSA9IFN5c3RlbSQxOwoJdmFyIElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbl8xJDkgPSBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb24kMTsKCXZhciBBcnJheUluZGV4T3V0T2ZCb3VuZHNFeGNlcHRpb25fMSA9IEFycmF5SW5kZXhPdXRPZkJvdW5kc0V4Y2VwdGlvbiQxOwoJdmFyIEFycmF5cyA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHsKCSAgICBmdW5jdGlvbiBBcnJheXMoKSB7CgkgICAgfQoJICAgIC8qKgoJICAgICAqIEFzc2lnbnMgdGhlIHNwZWNpZmllZCBpbnQgdmFsdWUgdG8gZWFjaCBlbGVtZW50IG9mIHRoZSBzcGVjaWZpZWQgYXJyYXkKCSAgICAgKiBvZiBpbnRzLgoJICAgICAqCgkgICAgICogQHBhcmFtIGEgdGhlIGFycmF5IHRvIGJlIGZpbGxlZAoJICAgICAqIEBwYXJhbSB2YWwgdGhlIHZhbHVlIHRvIGJlIHN0b3JlZCBpbiBhbGwgZWxlbWVudHMgb2YgdGhlIGFycmF5CgkgICAgICovCgkgICAgQXJyYXlzLmZpbGwgPSBmdW5jdGlvbiAoYSwgdmFsKSB7CgkgICAgICAgIGZvciAodmFyIGkgPSAwLCBsZW4gPSBhLmxlbmd0aDsgaSA8IGxlbjsgaSsrKQoJICAgICAgICAgICAgYVtpXSA9IHZhbDsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEFzc2lnbnMgdGhlIHNwZWNpZmllZCBpbnQgdmFsdWUgdG8gZWFjaCBlbGVtZW50IG9mIHRoZSBzcGVjaWZpZWQKCSAgICAgKiByYW5nZSBvZiB0aGUgc3BlY2lmaWVkIGFycmF5IG9mIGludHMuICBUaGUgcmFuZ2UgdG8gYmUgZmlsbGVkCgkgICAgICogZXh0ZW5kcyBmcm9tIGluZGV4IHtAY29kZSBmcm9tSW5kZXh9LCBpbmNsdXNpdmUsIHRvIGluZGV4CgkgICAgICoge0Bjb2RlIHRvSW5kZXh9LCBleGNsdXNpdmUuICAoSWYge0Bjb2RlIGZyb21JbmRleD09dG9JbmRleH0sIHRoZQoJICAgICAqIHJhbmdlIHRvIGJlIGZpbGxlZCBpcyBlbXB0eS4pCgkgICAgICoKCSAgICAgKiBAcGFyYW0gYSB0aGUgYXJyYXkgdG8gYmUgZmlsbGVkCgkgICAgICogQHBhcmFtIGZyb21JbmRleCB0aGUgaW5kZXggb2YgdGhlIGZpcnN0IGVsZW1lbnQgKGluY2x1c2l2ZSkgdG8gYmUKCSAgICAgKiAgICAgICAgZmlsbGVkIHdpdGggdGhlIHNwZWNpZmllZCB2YWx1ZQoJICAgICAqIEBwYXJhbSB0b0luZGV4IHRoZSBpbmRleCBvZiB0aGUgbGFzdCBlbGVtZW50IChleGNsdXNpdmUpIHRvIGJlCgkgICAgICogICAgICAgIGZpbGxlZCB3aXRoIHRoZSBzcGVjaWZpZWQgdmFsdWUKCSAgICAgKiBAcGFyYW0gdmFsIHRoZSB2YWx1ZSB0byBiZSBzdG9yZWQgaW4gYWxsIGVsZW1lbnRzIG9mIHRoZSBhcnJheQoJICAgICAqIEB0aHJvd3MgSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uIGlmIHtAY29kZSBmcm9tSW5kZXggPiB0b0luZGV4fQoJICAgICAqIEB0aHJvd3MgQXJyYXlJbmRleE91dE9mQm91bmRzRXhjZXB0aW9uIGlmIHtAY29kZSBmcm9tSW5kZXggPCAwfSBvcgoJICAgICAqICAgICAgICAge0Bjb2RlIHRvSW5kZXggPiBhLmxlbmd0aH0KCSAgICAgKi8KCSAgICBBcnJheXMuZmlsbFdpdGhpbiA9IGZ1bmN0aW9uIChhLCBmcm9tSW5kZXgsIHRvSW5kZXgsIHZhbCkgewoJICAgICAgICBBcnJheXMucmFuZ2VDaGVjayhhLmxlbmd0aCwgZnJvbUluZGV4LCB0b0luZGV4KTsKCSAgICAgICAgZm9yICh2YXIgaSA9IGZyb21JbmRleDsgaSA8IHRvSW5kZXg7IGkrKykKCSAgICAgICAgICAgIGFbaV0gPSB2YWw7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBDaGVja3MgdGhhdCB7QGNvZGUgZnJvbUluZGV4fSBhbmQge0Bjb2RlIHRvSW5kZXh9IGFyZSBpbgoJICAgICAqIHRoZSByYW5nZSBhbmQgdGhyb3dzIGFuIGV4Y2VwdGlvbiBpZiB0aGV5IGFyZW4ndC4KCSAgICAgKi8KCSAgICBBcnJheXMucmFuZ2VDaGVjayA9IGZ1bmN0aW9uIChhcnJheUxlbmd0aCwgZnJvbUluZGV4LCB0b0luZGV4KSB7CgkgICAgICAgIGlmIChmcm9tSW5kZXggPiB0b0luZGV4KSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uXzEkOS5kZWZhdWx0KCdmcm9tSW5kZXgoJyArIGZyb21JbmRleCArICcpID4gdG9JbmRleCgnICsgdG9JbmRleCArICcpJyk7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKGZyb21JbmRleCA8IDApIHsKCSAgICAgICAgICAgIHRocm93IG5ldyBBcnJheUluZGV4T3V0T2ZCb3VuZHNFeGNlcHRpb25fMS5kZWZhdWx0KGZyb21JbmRleCk7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKHRvSW5kZXggPiBhcnJheUxlbmd0aCkgewoJICAgICAgICAgICAgdGhyb3cgbmV3IEFycmF5SW5kZXhPdXRPZkJvdW5kc0V4Y2VwdGlvbl8xLmRlZmF1bHQodG9JbmRleCk7CgkgICAgICAgIH0KCSAgICB9OwoJICAgIEFycmF5cy5hc0xpc3QgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHZhciBhcmdzID0gW107CgkgICAgICAgIGZvciAodmFyIF9pID0gMDsgX2kgPCBhcmd1bWVudHMubGVuZ3RoOyBfaSsrKSB7CgkgICAgICAgICAgICBhcmdzW19pXSA9IGFyZ3VtZW50c1tfaV07CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIGFyZ3M7CgkgICAgfTsKCSAgICBBcnJheXMuY3JlYXRlID0gZnVuY3Rpb24gKHJvd3MsIGNvbHMsIHZhbHVlKSB7CgkgICAgICAgIHZhciBhcnIgPSBBcnJheS5mcm9tKHsgbGVuZ3RoOiByb3dzIH0pOwoJICAgICAgICByZXR1cm4gYXJyLm1hcChmdW5jdGlvbiAoeCkgeyByZXR1cm4gQXJyYXkuZnJvbSh7IGxlbmd0aDogY29scyB9KS5maWxsKHZhbHVlKTsgfSk7CgkgICAgfTsKCSAgICBBcnJheXMuY3JlYXRlSW50MzJBcnJheSA9IGZ1bmN0aW9uIChyb3dzLCBjb2xzLCB2YWx1ZSkgewoJICAgICAgICB2YXIgYXJyID0gQXJyYXkuZnJvbSh7IGxlbmd0aDogcm93cyB9KTsKCSAgICAgICAgcmV0dXJuIGFyci5tYXAoZnVuY3Rpb24gKHgpIHsgcmV0dXJuIEludDMyQXJyYXkuZnJvbSh7IGxlbmd0aDogY29scyB9KS5maWxsKHZhbHVlKTsgfSk7CgkgICAgfTsKCSAgICBBcnJheXMuZXF1YWxzID0gZnVuY3Rpb24gKGZpcnN0LCBzZWNvbmQpIHsKCSAgICAgICAgaWYgKCFmaXJzdCkgewoJICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwoJICAgICAgICB9CgkgICAgICAgIGlmICghc2Vjb25kKSB7CgkgICAgICAgICAgICByZXR1cm4gZmFsc2U7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKCFmaXJzdC5sZW5ndGgpIHsKCSAgICAgICAgICAgIHJldHVybiBmYWxzZTsKCSAgICAgICAgfQoJICAgICAgICBpZiAoIXNlY29uZC5sZW5ndGgpIHsKCSAgICAgICAgICAgIHJldHVybiBmYWxzZTsKCSAgICAgICAgfQoJICAgICAgICBpZiAoZmlyc3QubGVuZ3RoICE9PSBzZWNvbmQubGVuZ3RoKSB7CgkgICAgICAgICAgICByZXR1cm4gZmFsc2U7CgkgICAgICAgIH0KCSAgICAgICAgZm9yICh2YXIgaSA9IDAsIGxlbmd0aF8xID0gZmlyc3QubGVuZ3RoOyBpIDwgbGVuZ3RoXzE7IGkrKykgewoJICAgICAgICAgICAgaWYgKGZpcnN0W2ldICE9PSBzZWNvbmRbaV0pIHsKCSAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIHRydWU7CgkgICAgfTsKCSAgICBBcnJheXMuaGFzaENvZGUgPSBmdW5jdGlvbiAoYSkgewoJICAgICAgICB2YXIgZV8xLCBfYTsKCSAgICAgICAgaWYgKGEgPT09IG51bGwpIHsKCSAgICAgICAgICAgIHJldHVybiAwOwoJICAgICAgICB9CgkgICAgICAgIHZhciByZXN1bHQgPSAxOwoJICAgICAgICB0cnkgewoJICAgICAgICAgICAgZm9yICh2YXIgYV8xID0gX192YWx1ZXMkNyhhKSwgYV8xXzEgPSBhXzEubmV4dCgpOyAhYV8xXzEuZG9uZTsgYV8xXzEgPSBhXzEubmV4dCgpKSB7CgkgICAgICAgICAgICAgICAgdmFyIGVsZW1lbnQgPSBhXzFfMS52YWx1ZTsKCSAgICAgICAgICAgICAgICByZXN1bHQgPSAzMSAqIHJlc3VsdCArIGVsZW1lbnQ7CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICAgICAgY2F0Y2ggKGVfMV8xKSB7IGVfMSA9IHsgZXJyb3I6IGVfMV8xIH07IH0KCSAgICAgICAgZmluYWxseSB7CgkgICAgICAgICAgICB0cnkgewoJICAgICAgICAgICAgICAgIGlmIChhXzFfMSAmJiAhYV8xXzEuZG9uZSAmJiAoX2EgPSBhXzEucmV0dXJuKSkgX2EuY2FsbChhXzEpOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgZmluYWxseSB7IGlmIChlXzEpIHRocm93IGVfMS5lcnJvcjsgfQoJICAgICAgICB9CgkgICAgICAgIHJldHVybiByZXN1bHQ7CgkgICAgfTsKCSAgICBBcnJheXMuZmlsbFVpbnQ4QXJyYXkgPSBmdW5jdGlvbiAoYSwgdmFsdWUpIHsKCSAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgIT09IGEubGVuZ3RoOyBpKyspIHsKCSAgICAgICAgICAgIGFbaV0gPSB2YWx1ZTsKCSAgICAgICAgfQoJICAgIH07CgkgICAgQXJyYXlzLmNvcHlPZiA9IGZ1bmN0aW9uIChvcmlnaW5hbCwgbmV3TGVuZ3RoKSB7CgkgICAgICAgIHJldHVybiBvcmlnaW5hbC5zbGljZSgwLCBuZXdMZW5ndGgpOwoJICAgIH07CgkgICAgQXJyYXlzLmNvcHlPZlVpbnQ4QXJyYXkgPSBmdW5jdGlvbiAob3JpZ2luYWwsIG5ld0xlbmd0aCkgewoJICAgICAgICBpZiAob3JpZ2luYWwubGVuZ3RoIDw9IG5ld0xlbmd0aCkgewoJICAgICAgICAgICAgdmFyIG5ld0FycmF5ID0gbmV3IFVpbnQ4QXJyYXkobmV3TGVuZ3RoKTsKCSAgICAgICAgICAgIG5ld0FycmF5LnNldChvcmlnaW5hbCk7CgkgICAgICAgICAgICByZXR1cm4gbmV3QXJyYXk7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIG9yaWdpbmFsLnNsaWNlKDAsIG5ld0xlbmd0aCk7CgkgICAgfTsKCSAgICBBcnJheXMuY29weU9mUmFuZ2UgPSBmdW5jdGlvbiAob3JpZ2luYWwsIGZyb20sIHRvKSB7CgkgICAgICAgIHZhciBuZXdMZW5ndGggPSB0byAtIGZyb207CgkgICAgICAgIHZhciBjb3B5ID0gbmV3IEludDMyQXJyYXkobmV3TGVuZ3RoKTsKCSAgICAgICAgU3lzdGVtXzEkNS5kZWZhdWx0LmFycmF5Y29weShvcmlnaW5hbCwgZnJvbSwgY29weSwgMCwgbmV3TGVuZ3RoKTsKCSAgICAgICAgcmV0dXJuIGNvcHk7CgkgICAgfTsKCSAgICAvKgoJICAgICogUmV0dXJucyB0aGUgaW5kZXggb2Ygb2YgdGhlIGVsZW1lbnQgaW4gYSBzb3J0ZWQgYXJyYXkgb3IgKC1uLTEpIHdoZXJlIG4gaXMgdGhlIGluc2VydGlvbiBwb2ludAoJICAgICogZm9yIHRoZSBuZXcgZWxlbWVudC4KCSAgICAqIFBhcmFtZXRlcnM6CgkgICAgKiAgICAgYXIgLSBBIHNvcnRlZCBhcnJheQoJICAgICogICAgIGVsIC0gQW4gZWxlbWVudCB0byBzZWFyY2ggZm9yCgkgICAgKiAgICAgY29tcGFyYXRvciAtIEEgY29tcGFyYXRvciBmdW5jdGlvbi4gVGhlIGZ1bmN0aW9uIHRha2VzIHR3byBhcmd1bWVudHM6IChhLCBiKSBhbmQgcmV0dXJuczoKCSAgICAqICAgICAgICBhIG5lZ2F0aXZlIG51bWJlciAgaWYgYSBpcyBsZXNzIHRoYW4gYjsKCSAgICAqICAgICAgICAwIGlmIGEgaXMgZXF1YWwgdG8gYjsKCSAgICAqICAgICAgICBhIHBvc2l0aXZlIG51bWJlciBvZiBhIGlzIGdyZWF0ZXIgdGhhbiBiLgoJICAgICogVGhlIGFycmF5IG1heSBjb250YWluIGR1cGxpY2F0ZSBlbGVtZW50cy4gSWYgdGhlcmUgYXJlIG1vcmUgdGhhbiBvbmUgZXF1YWwgZWxlbWVudHMgaW4gdGhlIGFycmF5LAoJICAgICogdGhlIHJldHVybmVkIHZhbHVlIGNhbiBiZSB0aGUgaW5kZXggb2YgYW55IG9uZSBvZiB0aGUgZXF1YWwgZWxlbWVudHMuCgkgICAgKgoJICAgICogaHR0cDovL2pzZmlkZGxlLm5ldC9hcnl6aG92L3BrZnN0NTUwLwoJICAgICovCgkgICAgQXJyYXlzLmJpbmFyeVNlYXJjaCA9IGZ1bmN0aW9uIChhciwgZWwsIGNvbXBhcmF0b3IpIHsKCSAgICAgICAgaWYgKHVuZGVmaW5lZCA9PT0gY29tcGFyYXRvcikgewoJICAgICAgICAgICAgY29tcGFyYXRvciA9IEFycmF5cy5udW1iZXJDb21wYXJhdG9yOwoJICAgICAgICB9CgkgICAgICAgIHZhciBtID0gMDsKCSAgICAgICAgdmFyIG4gPSBhci5sZW5ndGggLSAxOwoJICAgICAgICB3aGlsZSAobSA8PSBuKSB7CgkgICAgICAgICAgICB2YXIgayA9IChuICsgbSkgPj4gMTsKCSAgICAgICAgICAgIHZhciBjbXAgPSBjb21wYXJhdG9yKGVsLCBhcltrXSk7CgkgICAgICAgICAgICBpZiAoY21wID4gMCkgewoJICAgICAgICAgICAgICAgIG0gPSBrICsgMTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIGVsc2UgaWYgKGNtcCA8IDApIHsKCSAgICAgICAgICAgICAgICBuID0gayAtIDE7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBlbHNlIHsKCSAgICAgICAgICAgICAgICByZXR1cm4gazsKCSAgICAgICAgICAgIH0KCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gLW0gLSAxOwoJICAgIH07CgkgICAgQXJyYXlzLm51bWJlckNvbXBhcmF0b3IgPSBmdW5jdGlvbiAoYSwgYikgewoJICAgICAgICByZXR1cm4gYSAtIGI7CgkgICAgfTsKCSAgICByZXR1cm4gQXJyYXlzOwoJfSgpKTsKCUFycmF5cyQxLmRlZmF1bHQgPSBBcnJheXM7CgoJdmFyIEludGVnZXIkMSA9IHt9OwoKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShJbnRlZ2VyJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCS8qKgoJICogUG9ueWZpbGwgZm9yIEphdmEncyBJbnRlZ2VyIGNsYXNzLgoJICovCgl2YXIgSW50ZWdlciA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHsKCSAgICBmdW5jdGlvbiBJbnRlZ2VyKCkgewoJICAgIH0KCSAgICBJbnRlZ2VyLm51bWJlck9mVHJhaWxpbmdaZXJvcyA9IGZ1bmN0aW9uIChpKSB7CgkgICAgICAgIHZhciB5OwoJICAgICAgICBpZiAoaSA9PT0gMCkKCSAgICAgICAgICAgIHJldHVybiAzMjsKCSAgICAgICAgdmFyIG4gPSAzMTsKCSAgICAgICAgeSA9IGkgPDwgMTY7CgkgICAgICAgIGlmICh5ICE9PSAwKSB7CgkgICAgICAgICAgICBuIC09IDE2OwoJICAgICAgICAgICAgaSA9IHk7CgkgICAgICAgIH0KCSAgICAgICAgeSA9IGkgPDwgODsKCSAgICAgICAgaWYgKHkgIT09IDApIHsKCSAgICAgICAgICAgIG4gLT0gODsKCSAgICAgICAgICAgIGkgPSB5OwoJICAgICAgICB9CgkgICAgICAgIHkgPSBpIDw8IDQ7CgkgICAgICAgIGlmICh5ICE9PSAwKSB7CgkgICAgICAgICAgICBuIC09IDQ7CgkgICAgICAgICAgICBpID0geTsKCSAgICAgICAgfQoJICAgICAgICB5ID0gaSA8PCAyOwoJICAgICAgICBpZiAoeSAhPT0gMCkgewoJICAgICAgICAgICAgbiAtPSAyOwoJICAgICAgICAgICAgaSA9IHk7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIG4gLSAoKGkgPDwgMSkgPj4+IDMxKTsKCSAgICB9OwoJICAgIEludGVnZXIubnVtYmVyT2ZMZWFkaW5nWmVyb3MgPSBmdW5jdGlvbiAoaSkgewoJICAgICAgICAvLyBIRCwgRmlndXJlIDUtNgoJICAgICAgICBpZiAoaSA9PT0gMCkgewoJICAgICAgICAgICAgcmV0dXJuIDMyOwoJICAgICAgICB9CgkgICAgICAgIHZhciBuID0gMTsKCSAgICAgICAgaWYgKGkgPj4+IDE2ID09PSAwKSB7CgkgICAgICAgICAgICBuICs9IDE2OwoJICAgICAgICAgICAgaSA8PD0gMTY7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKGkgPj4+IDI0ID09PSAwKSB7CgkgICAgICAgICAgICBuICs9IDg7CgkgICAgICAgICAgICBpIDw8PSA4OwoJICAgICAgICB9CgkgICAgICAgIGlmIChpID4+PiAyOCA9PT0gMCkgewoJICAgICAgICAgICAgbiArPSA0OwoJICAgICAgICAgICAgaSA8PD0gNDsKCSAgICAgICAgfQoJICAgICAgICBpZiAoaSA+Pj4gMzAgPT09IDApIHsKCSAgICAgICAgICAgIG4gKz0gMjsKCSAgICAgICAgICAgIGkgPDw9IDI7CgkgICAgICAgIH0KCSAgICAgICAgbiAtPSBpID4+PiAzMTsKCSAgICAgICAgcmV0dXJuIG47CgkgICAgfTsKCSAgICBJbnRlZ2VyLnRvSGV4U3RyaW5nID0gZnVuY3Rpb24gKGkpIHsKCSAgICAgICAgcmV0dXJuIGkudG9TdHJpbmcoMTYpOwoJICAgIH07CgkgICAgSW50ZWdlci50b0JpbmFyeVN0cmluZyA9IGZ1bmN0aW9uIChpbnROdW1iZXIpIHsKCSAgICAgICAgcmV0dXJuIFN0cmluZyhwYXJzZUludChTdHJpbmcoaW50TnVtYmVyKSwgMikpOwoJICAgIH07CgkgICAgLy8gUmV0dXJucyB0aGUgbnVtYmVyIG9mIG9uZS1iaXRzIGluIHRoZSB0d28ncyBjb21wbGVtZW50IGJpbmFyeSByZXByZXNlbnRhdGlvbiBvZiB0aGUgc3BlY2lmaWVkIGludCB2YWx1ZS4gVGhpcyBmdW5jdGlvbiBpcyBzb21ldGltZXMgcmVmZXJyZWQgdG8gYXMgdGhlIHBvcHVsYXRpb24gY291bnQuCgkgICAgLy8gUmV0dXJuczoKCSAgICAvLyB0aGUgbnVtYmVyIG9mIG9uZS1iaXRzIGluIHRoZSB0d28ncyBjb21wbGVtZW50IGJpbmFyeSByZXByZXNlbnRhdGlvbiBvZiB0aGUgc3BlY2lmaWVkIGludCB2YWx1ZS4KCSAgICBJbnRlZ2VyLmJpdENvdW50ID0gZnVuY3Rpb24gKGkpIHsKCSAgICAgICAgLy8gSEQsIEZpZ3VyZSA1LTIKCSAgICAgICAgaSA9IGkgLSAoKGkgPj4+IDEpICYgMHg1NTU1NTU1NSk7CgkgICAgICAgIGkgPSAoaSAmIDB4MzMzMzMzMzMpICsgKChpID4+PiAyKSAmIDB4MzMzMzMzMzMpOwoJICAgICAgICBpID0gKGkgKyAoaSA+Pj4gNCkpICYgMHgwZjBmMGYwZjsKCSAgICAgICAgaSA9IGkgKyAoaSA+Pj4gOCk7CgkgICAgICAgIGkgPSBpICsgKGkgPj4+IDE2KTsKCSAgICAgICAgcmV0dXJuIGkgJiAweDNmOwoJICAgIH07CgkgICAgSW50ZWdlci50cnVuY0RpdmlzaW9uID0gZnVuY3Rpb24gKGRpdmlkZW5kLCBkaXZpc29yKSB7CgkgICAgICAgIHJldHVybiBNYXRoLnRydW5jKGRpdmlkZW5kIC8gZGl2aXNvcik7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBDb252ZXJ0cyBBIHN0cmluZyB0byBhbiBpbnRlZ2VyLgoJICAgICAqIEBwYXJhbSBzIEEgc3RyaW5nIHRvIGNvbnZlcnQgaW50byBhIG51bWJlci4KCSAgICAgKiBAcGFyYW0gcmFkaXggQSB2YWx1ZSBiZXR3ZWVuIDIgYW5kIDM2IHRoYXQgc3BlY2lmaWVzIHRoZSBiYXNlIG9mIHRoZSBudW1iZXIgaW4gbnVtU3RyaW5nLiBJZiB0aGlzIGFyZ3VtZW50IGlzIG5vdCBzdXBwbGllZCwgc3RyaW5ncyB3aXRoIGEgcHJlZml4IG9mICcweCcgYXJlIGNvbnNpZGVyZWQgaGV4YWRlY2ltYWwuIEFsbCBvdGhlciBzdHJpbmdzIGFyZSBjb25zaWRlcmVkIGRlY2ltYWwuCgkgICAgICovCgkgICAgSW50ZWdlci5wYXJzZUludCA9IGZ1bmN0aW9uIChudW0sIHJhZGl4KSB7CgkgICAgICAgIGlmIChyYWRpeCA9PT0gdm9pZCAwKSB7IHJhZGl4ID0gdW5kZWZpbmVkOyB9CgkgICAgICAgIHJldHVybiBwYXJzZUludChudW0sIHJhZGl4KTsKCSAgICB9OwoJICAgIEludGVnZXIuTUlOX1ZBTFVFXzMyX0JJVFMgPSAtMjE0NzQ4MzY0ODsKCSAgICBJbnRlZ2VyLk1BWF9WQUxVRSA9IE51bWJlci5NQVhfU0FGRV9JTlRFR0VSOwoJICAgIHJldHVybiBJbnRlZ2VyOwoJfSgpKTsKCUludGVnZXIkMS5kZWZhdWx0ID0gSW50ZWdlcjsKCgkvKgoJICogQ29weXJpZ2h0IDIwMDcgWlhpbmcgYXV0aG9ycwoJICoKCSAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoJICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoJICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkgKgoJICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKCSAqCgkgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCgkgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoJICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCgkgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCSAqLwoJT2JqZWN0LmRlZmluZVByb3BlcnR5KEJpdEFycmF5JDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCS8qbmFtZXNwYWNlIGNvbS5nb29nbGUuenhpbmcuY29tbW9uIHsqLwoJLyppbXBvcnQgamF2YS51dGlsLkFycmF5czsqLwoJdmFyIElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbl8xJDggPSBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb24kMTsKCXZhciBBcnJheXNfMSQxID0gQXJyYXlzJDE7Cgl2YXIgSW50ZWdlcl8xJDIgPSBJbnRlZ2VyJDE7Cgl2YXIgU3lzdGVtXzEkNCA9IFN5c3RlbSQxOwoJLyoqCgkgKiA8cD5BIHNpbXBsZSwgZmFzdCBhcnJheSBvZiBiaXRzLCByZXByZXNlbnRlZCBjb21wYWN0bHkgYnkgYW4gYXJyYXkgb2YgaW50cyBpbnRlcm5hbGx5LjwvcD4KCSAqCgkgKiBAYXV0aG9yIFNlYW4gT3dlbgoJICovCgl2YXIgQml0QXJyYXkgLyppbXBsZW1lbnRzIENsb25lYWJsZSovID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkgewoJICAgIC8vIHB1YmxpYyBjb25zdHJ1Y3RvcigpIHsKCSAgICAvLyAgIHRoaXMuc2l6ZSA9IDAKCSAgICAvLyAgIHRoaXMuYml0cyA9IG5ldyBJbnQzMkFycmF5KDEpCgkgICAgLy8gfQoJICAgIC8vIHB1YmxpYyBjb25zdHJ1Y3RvcihzaXplPzogbnVtYmVyIC8qaW50Ki8pIHsKCSAgICAvLyAgIGlmICh1bmRlZmluZWQgPT09IHNpemUpIHsKCSAgICAvLyAgICAgdGhpcy5zaXplID0gMAoJICAgIC8vICAgfSBlbHNlIHsKCSAgICAvLyAgICAgdGhpcy5zaXplID0gc2l6ZQoJICAgIC8vICAgfQoJICAgIC8vICAgdGhpcy5iaXRzID0gdGhpcy5tYWtlQXJyYXkoc2l6ZSkKCSAgICAvLyB9CgkgICAgLy8gRm9yIHRlc3Rpbmcgb25seQoJICAgIGZ1bmN0aW9uIEJpdEFycmF5KHNpemUgLyppbnQqLywgYml0cykgewoJICAgICAgICBpZiAodW5kZWZpbmVkID09PSBzaXplKSB7CgkgICAgICAgICAgICB0aGlzLnNpemUgPSAwOwoJICAgICAgICAgICAgdGhpcy5iaXRzID0gbmV3IEludDMyQXJyYXkoMSk7CgkgICAgICAgIH0KCSAgICAgICAgZWxzZSB7CgkgICAgICAgICAgICB0aGlzLnNpemUgPSBzaXplOwoJICAgICAgICAgICAgaWYgKHVuZGVmaW5lZCA9PT0gYml0cyB8fCBudWxsID09PSBiaXRzKSB7CgkgICAgICAgICAgICAgICAgdGhpcy5iaXRzID0gQml0QXJyYXkubWFrZUFycmF5KHNpemUpOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgZWxzZSB7CgkgICAgICAgICAgICAgICAgdGhpcy5iaXRzID0gYml0czsKCSAgICAgICAgICAgIH0KCSAgICAgICAgfQoJICAgIH0KCSAgICBCaXRBcnJheS5wcm90b3R5cGUuZ2V0U2l6ZSA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMuc2l6ZTsKCSAgICB9OwoJICAgIEJpdEFycmF5LnByb3RvdHlwZS5nZXRTaXplSW5CeXRlcyA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIE1hdGguZmxvb3IoKHRoaXMuc2l6ZSArIDcpIC8gOCk7CgkgICAgfTsKCSAgICBCaXRBcnJheS5wcm90b3R5cGUuZW5zdXJlQ2FwYWNpdHkgPSBmdW5jdGlvbiAoc2l6ZSAvKmludCovKSB7CgkgICAgICAgIGlmIChzaXplID4gdGhpcy5iaXRzLmxlbmd0aCAqIDMyKSB7CgkgICAgICAgICAgICB2YXIgbmV3Qml0cyA9IEJpdEFycmF5Lm1ha2VBcnJheShzaXplKTsKCSAgICAgICAgICAgIFN5c3RlbV8xJDQuZGVmYXVsdC5hcnJheWNvcHkodGhpcy5iaXRzLCAwLCBuZXdCaXRzLCAwLCB0aGlzLmJpdHMubGVuZ3RoKTsKCSAgICAgICAgICAgIHRoaXMuYml0cyA9IG5ld0JpdHM7CgkgICAgICAgIH0KCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEBwYXJhbSBpIGJpdCB0byBnZXQKCSAgICAgKiBAcmV0dXJuIHRydWUgaWZmIGJpdCBpIGlzIHNldAoJICAgICAqLwoJICAgIEJpdEFycmF5LnByb3RvdHlwZS5nZXQgPSBmdW5jdGlvbiAoaSAvKmludCovKSB7CgkgICAgICAgIHJldHVybiAodGhpcy5iaXRzW01hdGguZmxvb3IoaSAvIDMyKV0gJiAoMSA8PCAoaSAmIDB4MUYpKSkgIT09IDA7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBTZXRzIGJpdCBpLgoJICAgICAqCgkgICAgICogQHBhcmFtIGkgYml0IHRvIHNldAoJICAgICAqLwoJICAgIEJpdEFycmF5LnByb3RvdHlwZS5zZXQgPSBmdW5jdGlvbiAoaSAvKmludCovKSB7CgkgICAgICAgIHRoaXMuYml0c1tNYXRoLmZsb29yKGkgLyAzMildIHw9IDEgPDwgKGkgJiAweDFGKTsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEZsaXBzIGJpdCBpLgoJICAgICAqCgkgICAgICogQHBhcmFtIGkgYml0IHRvIHNldAoJICAgICAqLwoJICAgIEJpdEFycmF5LnByb3RvdHlwZS5mbGlwID0gZnVuY3Rpb24gKGkgLyppbnQqLykgewoJICAgICAgICB0aGlzLmJpdHNbTWF0aC5mbG9vcihpIC8gMzIpXSBePSAxIDw8IChpICYgMHgxRik7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcGFyYW0gZnJvbSBmaXJzdCBiaXQgdG8gY2hlY2sKCSAgICAgKiBAcmV0dXJuIGluZGV4IG9mIGZpcnN0IGJpdCB0aGF0IGlzIHNldCwgc3RhcnRpbmcgZnJvbSB0aGUgZ2l2ZW4gaW5kZXgsIG9yIHNpemUgaWYgbm9uZSBhcmUgc2V0CgkgICAgICogIGF0IG9yIGJleW9uZCB0aGlzIGdpdmVuIGluZGV4CgkgICAgICogQHNlZSAjZ2V0TmV4dFVuc2V0KGludCkKCSAgICAgKi8KCSAgICBCaXRBcnJheS5wcm90b3R5cGUuZ2V0TmV4dFNldCA9IGZ1bmN0aW9uIChmcm9tIC8qaW50Ki8pIHsKCSAgICAgICAgdmFyIHNpemUgPSB0aGlzLnNpemU7CgkgICAgICAgIGlmIChmcm9tID49IHNpemUpIHsKCSAgICAgICAgICAgIHJldHVybiBzaXplOwoJICAgICAgICB9CgkgICAgICAgIHZhciBiaXRzID0gdGhpcy5iaXRzOwoJICAgICAgICB2YXIgYml0c09mZnNldCA9IE1hdGguZmxvb3IoZnJvbSAvIDMyKTsKCSAgICAgICAgdmFyIGN1cnJlbnRCaXRzID0gYml0c1tiaXRzT2Zmc2V0XTsKCSAgICAgICAgLy8gbWFzayBvZmYgbGVzc2VyIGJpdHMgZmlyc3QKCSAgICAgICAgY3VycmVudEJpdHMgJj0gfigoMSA8PCAoZnJvbSAmIDB4MUYpKSAtIDEpOwoJICAgICAgICB2YXIgbGVuZ3RoID0gYml0cy5sZW5ndGg7CgkgICAgICAgIHdoaWxlIChjdXJyZW50Qml0cyA9PT0gMCkgewoJICAgICAgICAgICAgaWYgKCsrYml0c09mZnNldCA9PT0gbGVuZ3RoKSB7CgkgICAgICAgICAgICAgICAgcmV0dXJuIHNpemU7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBjdXJyZW50Qml0cyA9IGJpdHNbYml0c09mZnNldF07CgkgICAgICAgIH0KCSAgICAgICAgdmFyIHJlc3VsdCA9IChiaXRzT2Zmc2V0ICogMzIpICsgSW50ZWdlcl8xJDIuZGVmYXVsdC5udW1iZXJPZlRyYWlsaW5nWmVyb3MoY3VycmVudEJpdHMpOwoJICAgICAgICByZXR1cm4gcmVzdWx0ID4gc2l6ZSA/IHNpemUgOiByZXN1bHQ7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcGFyYW0gZnJvbSBpbmRleCB0byBzdGFydCBsb29raW5nIGZvciB1bnNldCBiaXQKCSAgICAgKiBAcmV0dXJuIGluZGV4IG9mIG5leHQgdW5zZXQgYml0LCBvciB7QGNvZGUgc2l6ZX0gaWYgbm9uZSBhcmUgdW5zZXQgdW50aWwgdGhlIGVuZAoJICAgICAqIEBzZWUgI2dldE5leHRTZXQoaW50KQoJICAgICAqLwoJICAgIEJpdEFycmF5LnByb3RvdHlwZS5nZXROZXh0VW5zZXQgPSBmdW5jdGlvbiAoZnJvbSAvKmludCovKSB7CgkgICAgICAgIHZhciBzaXplID0gdGhpcy5zaXplOwoJICAgICAgICBpZiAoZnJvbSA+PSBzaXplKSB7CgkgICAgICAgICAgICByZXR1cm4gc2l6ZTsKCSAgICAgICAgfQoJICAgICAgICB2YXIgYml0cyA9IHRoaXMuYml0czsKCSAgICAgICAgdmFyIGJpdHNPZmZzZXQgPSBNYXRoLmZsb29yKGZyb20gLyAzMik7CgkgICAgICAgIHZhciBjdXJyZW50Qml0cyA9IH5iaXRzW2JpdHNPZmZzZXRdOwoJICAgICAgICAvLyBtYXNrIG9mZiBsZXNzZXIgYml0cyBmaXJzdAoJICAgICAgICBjdXJyZW50Qml0cyAmPSB+KCgxIDw8IChmcm9tICYgMHgxRikpIC0gMSk7CgkgICAgICAgIHZhciBsZW5ndGggPSBiaXRzLmxlbmd0aDsKCSAgICAgICAgd2hpbGUgKGN1cnJlbnRCaXRzID09PSAwKSB7CgkgICAgICAgICAgICBpZiAoKytiaXRzT2Zmc2V0ID09PSBsZW5ndGgpIHsKCSAgICAgICAgICAgICAgICByZXR1cm4gc2l6ZTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIGN1cnJlbnRCaXRzID0gfmJpdHNbYml0c09mZnNldF07CgkgICAgICAgIH0KCSAgICAgICAgdmFyIHJlc3VsdCA9IChiaXRzT2Zmc2V0ICogMzIpICsgSW50ZWdlcl8xJDIuZGVmYXVsdC5udW1iZXJPZlRyYWlsaW5nWmVyb3MoY3VycmVudEJpdHMpOwoJICAgICAgICByZXR1cm4gcmVzdWx0ID4gc2l6ZSA/IHNpemUgOiByZXN1bHQ7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBTZXRzIGEgYmxvY2sgb2YgMzIgYml0cywgc3RhcnRpbmcgYXQgYml0IGkuCgkgICAgICoKCSAgICAgKiBAcGFyYW0gaSBmaXJzdCBiaXQgdG8gc2V0CgkgICAgICogQHBhcmFtIG5ld0JpdHMgdGhlIG5ldyB2YWx1ZSBvZiB0aGUgbmV4dCAzMiBiaXRzLiBOb3RlIGFnYWluIHRoYXQgdGhlIGxlYXN0LXNpZ25pZmljYW50IGJpdAoJICAgICAqIGNvcnJlc3BvbmRzIHRvIGJpdCBpLCB0aGUgbmV4dC1sZWFzdC1zaWduaWZpY2FudCB0byBpKzEsIGFuZCBzbyBvbi4KCSAgICAgKi8KCSAgICBCaXRBcnJheS5wcm90b3R5cGUuc2V0QnVsayA9IGZ1bmN0aW9uIChpIC8qaW50Ki8sIG5ld0JpdHMgLyppbnQqLykgewoJICAgICAgICB0aGlzLmJpdHNbTWF0aC5mbG9vcihpIC8gMzIpXSA9IG5ld0JpdHM7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBTZXRzIGEgcmFuZ2Ugb2YgYml0cy4KCSAgICAgKgoJICAgICAqIEBwYXJhbSBzdGFydCBzdGFydCBvZiByYW5nZSwgaW5jbHVzaXZlLgoJICAgICAqIEBwYXJhbSBlbmQgZW5kIG9mIHJhbmdlLCBleGNsdXNpdmUKCSAgICAgKi8KCSAgICBCaXRBcnJheS5wcm90b3R5cGUuc2V0UmFuZ2UgPSBmdW5jdGlvbiAoc3RhcnQgLyppbnQqLywgZW5kIC8qaW50Ki8pIHsKCSAgICAgICAgaWYgKGVuZCA8IHN0YXJ0IHx8IHN0YXJ0IDwgMCB8fCBlbmQgPiB0aGlzLnNpemUpIHsKCSAgICAgICAgICAgIHRocm93IG5ldyBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb25fMSQ4LmRlZmF1bHQoKTsKCSAgICAgICAgfQoJICAgICAgICBpZiAoZW5kID09PSBzdGFydCkgewoJICAgICAgICAgICAgcmV0dXJuOwoJICAgICAgICB9CgkgICAgICAgIGVuZC0tOyAvLyB3aWxsIGJlIGVhc2llciB0byB0cmVhdCB0aGlzIGFzIHRoZSBsYXN0IGFjdHVhbGx5IHNldCBiaXQgLS0gaW5jbHVzaXZlCgkgICAgICAgIHZhciBmaXJzdEludCA9IE1hdGguZmxvb3Ioc3RhcnQgLyAzMik7CgkgICAgICAgIHZhciBsYXN0SW50ID0gTWF0aC5mbG9vcihlbmQgLyAzMik7CgkgICAgICAgIHZhciBiaXRzID0gdGhpcy5iaXRzOwoJICAgICAgICBmb3IgKHZhciBpID0gZmlyc3RJbnQ7IGkgPD0gbGFzdEludDsgaSsrKSB7CgkgICAgICAgICAgICB2YXIgZmlyc3RCaXQgPSBpID4gZmlyc3RJbnQgPyAwIDogc3RhcnQgJiAweDFGOwoJICAgICAgICAgICAgdmFyIGxhc3RCaXQgPSBpIDwgbGFzdEludCA/IDMxIDogZW5kICYgMHgxRjsKCSAgICAgICAgICAgIC8vIE9uZXMgZnJvbSBmaXJzdEJpdCB0byBsYXN0Qml0LCBpbmNsdXNpdmUKCSAgICAgICAgICAgIHZhciBtYXNrID0gKDIgPDwgbGFzdEJpdCkgLSAoMSA8PCBmaXJzdEJpdCk7CgkgICAgICAgICAgICBiaXRzW2ldIHw9IG1hc2s7CgkgICAgICAgIH0KCSAgICB9OwoJICAgIC8qKgoJICAgICAqIENsZWFycyBhbGwgYml0cyAoc2V0cyB0byBmYWxzZSkuCgkgICAgICovCgkgICAgQml0QXJyYXkucHJvdG90eXBlLmNsZWFyID0gZnVuY3Rpb24gKCkgewoJICAgICAgICB2YXIgbWF4ID0gdGhpcy5iaXRzLmxlbmd0aDsKCSAgICAgICAgdmFyIGJpdHMgPSB0aGlzLmJpdHM7CgkgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbWF4OyBpKyspIHsKCSAgICAgICAgICAgIGJpdHNbaV0gPSAwOwoJICAgICAgICB9CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBFZmZpY2llbnQgbWV0aG9kIHRvIGNoZWNrIGlmIGEgcmFuZ2Ugb2YgYml0cyBpcyBzZXQsIG9yIG5vdCBzZXQuCgkgICAgICoKCSAgICAgKiBAcGFyYW0gc3RhcnQgc3RhcnQgb2YgcmFuZ2UsIGluY2x1c2l2ZS4KCSAgICAgKiBAcGFyYW0gZW5kIGVuZCBvZiByYW5nZSwgZXhjbHVzaXZlCgkgICAgICogQHBhcmFtIHZhbHVlIGlmIHRydWUsIGNoZWNrcyB0aGF0IGJpdHMgaW4gcmFuZ2UgYXJlIHNldCwgb3RoZXJ3aXNlIGNoZWNrcyB0aGF0IHRoZXkgYXJlIG5vdCBzZXQKCSAgICAgKiBAcmV0dXJuIHRydWUgaWZmIGFsbCBiaXRzIGFyZSBzZXQgb3Igbm90IHNldCBpbiByYW5nZSwgYWNjb3JkaW5nIHRvIHZhbHVlIGFyZ3VtZW50CgkgICAgICogQHRocm93cyBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb24gaWYgZW5kIGlzIGxlc3MgdGhhbiBzdGFydCBvciB0aGUgcmFuZ2UgaXMgbm90IGNvbnRhaW5lZCBpbiB0aGUgYXJyYXkKCSAgICAgKi8KCSAgICBCaXRBcnJheS5wcm90b3R5cGUuaXNSYW5nZSA9IGZ1bmN0aW9uIChzdGFydCAvKmludCovLCBlbmQgLyppbnQqLywgdmFsdWUpIHsKCSAgICAgICAgaWYgKGVuZCA8IHN0YXJ0IHx8IHN0YXJ0IDwgMCB8fCBlbmQgPiB0aGlzLnNpemUpIHsKCSAgICAgICAgICAgIHRocm93IG5ldyBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb25fMSQ4LmRlZmF1bHQoKTsKCSAgICAgICAgfQoJICAgICAgICBpZiAoZW5kID09PSBzdGFydCkgewoJICAgICAgICAgICAgcmV0dXJuIHRydWU7IC8vIGVtcHR5IHJhbmdlIG1hdGNoZXMKCSAgICAgICAgfQoJICAgICAgICBlbmQtLTsgLy8gd2lsbCBiZSBlYXNpZXIgdG8gdHJlYXQgdGhpcyBhcyB0aGUgbGFzdCBhY3R1YWxseSBzZXQgYml0IC0tIGluY2x1c2l2ZQoJICAgICAgICB2YXIgZmlyc3RJbnQgPSBNYXRoLmZsb29yKHN0YXJ0IC8gMzIpOwoJICAgICAgICB2YXIgbGFzdEludCA9IE1hdGguZmxvb3IoZW5kIC8gMzIpOwoJICAgICAgICB2YXIgYml0cyA9IHRoaXMuYml0czsKCSAgICAgICAgZm9yICh2YXIgaSA9IGZpcnN0SW50OyBpIDw9IGxhc3RJbnQ7IGkrKykgewoJICAgICAgICAgICAgdmFyIGZpcnN0Qml0ID0gaSA+IGZpcnN0SW50ID8gMCA6IHN0YXJ0ICYgMHgxRjsKCSAgICAgICAgICAgIHZhciBsYXN0Qml0ID0gaSA8IGxhc3RJbnQgPyAzMSA6IGVuZCAmIDB4MUY7CgkgICAgICAgICAgICAvLyBPbmVzIGZyb20gZmlyc3RCaXQgdG8gbGFzdEJpdCwgaW5jbHVzaXZlCgkgICAgICAgICAgICB2YXIgbWFzayA9ICgyIDw8IGxhc3RCaXQpIC0gKDEgPDwgZmlyc3RCaXQpICYgMHhGRkZGRkZGRjsKCSAgICAgICAgICAgIC8vIFRZUEVTQ1JJUFRQT1JUOiAmIDB4RkZGRkZGRkYgYWRkZWQgdG8gZGlzY2FyZCBhbnl0aGluZyBhZnRlciAzMiBiaXRzLCBhcyBFUyBoYXMgNTMgYml0cwoJICAgICAgICAgICAgLy8gUmV0dXJuIGZhbHNlIGlmIHdlJ3JlIGxvb2tpbmcgZm9yIDFzIGFuZCB0aGUgbWFza2VkIGJpdHNbaV0gaXNuJ3QgYWxsIDFzIChpczogdGhhdCwKCSAgICAgICAgICAgIC8vIGVxdWFscyB0aGUgbWFzaywgb3Igd2UncmUgbG9va2luZyBmb3IgMHMgYW5kIHRoZSBtYXNrZWQgcG9ydGlvbiBpcyBub3QgYWxsIDBzCgkgICAgICAgICAgICBpZiAoKGJpdHNbaV0gJiBtYXNrKSAhPT0gKHZhbHVlID8gbWFzayA6IDApKSB7CgkgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIHJldHVybiB0cnVlOwoJICAgIH07CgkgICAgQml0QXJyYXkucHJvdG90eXBlLmFwcGVuZEJpdCA9IGZ1bmN0aW9uIChiaXQpIHsKCSAgICAgICAgdGhpcy5lbnN1cmVDYXBhY2l0eSh0aGlzLnNpemUgKyAxKTsKCSAgICAgICAgaWYgKGJpdCkgewoJICAgICAgICAgICAgdGhpcy5iaXRzW01hdGguZmxvb3IodGhpcy5zaXplIC8gMzIpXSB8PSAxIDw8ICh0aGlzLnNpemUgJiAweDFGKTsKCSAgICAgICAgfQoJICAgICAgICB0aGlzLnNpemUrKzsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEFwcGVuZHMgdGhlIGxlYXN0LXNpZ25pZmljYW50IGJpdHMsIGZyb20gdmFsdWUsIGluIG9yZGVyIGZyb20gbW9zdC1zaWduaWZpY2FudCB0bwoJICAgICAqIGxlYXN0LXNpZ25pZmljYW50LiBGb3IgZXhhbXBsZSwgYXBwZW5kaW5nIDYgYml0cyBmcm9tIDB4MDAwMDAxRSB3aWxsIGFwcGVuZCB0aGUgYml0cwoJICAgICAqIDAsIDEsIDEsIDEsIDEsIDAgaW4gdGhhdCBvcmRlci4KCSAgICAgKgoJICAgICAqIEBwYXJhbSB2YWx1ZSB7QGNvZGUgaW50fSBjb250YWluaW5nIGJpdHMgdG8gYXBwZW5kCgkgICAgICogQHBhcmFtIG51bUJpdHMgYml0cyBmcm9tIHZhbHVlIHRvIGFwcGVuZAoJICAgICAqLwoJICAgIEJpdEFycmF5LnByb3RvdHlwZS5hcHBlbmRCaXRzID0gZnVuY3Rpb24gKHZhbHVlIC8qaW50Ki8sIG51bUJpdHMgLyppbnQqLykgewoJICAgICAgICBpZiAobnVtQml0cyA8IDAgfHwgbnVtQml0cyA+IDMyKSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uXzEkOC5kZWZhdWx0KCdOdW0gYml0cyBtdXN0IGJlIGJldHdlZW4gMCBhbmQgMzInKTsKCSAgICAgICAgfQoJICAgICAgICB0aGlzLmVuc3VyZUNhcGFjaXR5KHRoaXMuc2l6ZSArIG51bUJpdHMpOwoJICAgICAgICAvLyBjb25zdCBhcHBlbmRCaXQgPSB0aGlzLmFwcGVuZEJpdDsKCSAgICAgICAgZm9yICh2YXIgbnVtQml0c0xlZnQgPSBudW1CaXRzOyBudW1CaXRzTGVmdCA+IDA7IG51bUJpdHNMZWZ0LS0pIHsKCSAgICAgICAgICAgIHRoaXMuYXBwZW5kQml0KCgodmFsdWUgPj4gKG51bUJpdHNMZWZ0IC0gMSkpICYgMHgwMSkgPT09IDEpOwoJICAgICAgICB9CgkgICAgfTsKCSAgICBCaXRBcnJheS5wcm90b3R5cGUuYXBwZW5kQml0QXJyYXkgPSBmdW5jdGlvbiAob3RoZXIpIHsKCSAgICAgICAgdmFyIG90aGVyU2l6ZSA9IG90aGVyLnNpemU7CgkgICAgICAgIHRoaXMuZW5zdXJlQ2FwYWNpdHkodGhpcy5zaXplICsgb3RoZXJTaXplKTsKCSAgICAgICAgLy8gY29uc3QgYXBwZW5kQml0ID0gdGhpcy5hcHBlbmRCaXQ7CgkgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgb3RoZXJTaXplOyBpKyspIHsKCSAgICAgICAgICAgIHRoaXMuYXBwZW5kQml0KG90aGVyLmdldChpKSk7CgkgICAgICAgIH0KCSAgICB9OwoJICAgIEJpdEFycmF5LnByb3RvdHlwZS54b3IgPSBmdW5jdGlvbiAob3RoZXIpIHsKCSAgICAgICAgaWYgKHRoaXMuc2l6ZSAhPT0gb3RoZXIuc2l6ZSkgewoJICAgICAgICAgICAgdGhyb3cgbmV3IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbl8xJDguZGVmYXVsdCgnU2l6ZXMgZG9uXCd0IG1hdGNoJyk7CgkgICAgICAgIH0KCSAgICAgICAgdmFyIGJpdHMgPSB0aGlzLmJpdHM7CgkgICAgICAgIGZvciAodmFyIGkgPSAwLCBsZW5ndGhfMSA9IGJpdHMubGVuZ3RoOyBpIDwgbGVuZ3RoXzE7IGkrKykgewoJICAgICAgICAgICAgLy8gVGhlIGxhc3QgaW50IGNvdWxkIGJlIGluY29tcGxldGUgKGkuZS4gbm90IGhhdmUgMzIgYml0cyBpbgoJICAgICAgICAgICAgLy8gaXQpIGJ1dCB0aGVyZSBpcyBubyBwcm9ibGVtIHNpbmNlIDAgWE9SIDAgPT0gMC4KCSAgICAgICAgICAgIGJpdHNbaV0gXj0gb3RoZXIuYml0c1tpXTsKCSAgICAgICAgfQoJICAgIH07CgkgICAgLyoqCgkgICAgICoKCSAgICAgKiBAcGFyYW0gYml0T2Zmc2V0IGZpcnN0IGJpdCB0byBzdGFydCB3cml0aW5nCgkgICAgICogQHBhcmFtIGFycmF5IGFycmF5IHRvIHdyaXRlIGludG8uIEJ5dGVzIGFyZSB3cml0dGVuIG1vc3Qtc2lnbmlmaWNhbnQgYnl0ZSBmaXJzdC4gVGhpcyBpcyB0aGUgb3Bwb3NpdGUKCSAgICAgKiAgb2YgdGhlIGludGVybmFsIHJlcHJlc2VudGF0aW9uLCB3aGljaCBpcyBleHBvc2VkIGJ5IHtAbGluayAjZ2V0Qml0QXJyYXkoKX0KCSAgICAgKiBAcGFyYW0gb2Zmc2V0IHBvc2l0aW9uIGluIGFycmF5IHRvIHN0YXJ0IHdyaXRpbmcKCSAgICAgKiBAcGFyYW0gbnVtQnl0ZXMgaG93IG1hbnkgYnl0ZXMgdG8gd3JpdGUKCSAgICAgKi8KCSAgICBCaXRBcnJheS5wcm90b3R5cGUudG9CeXRlcyA9IGZ1bmN0aW9uIChiaXRPZmZzZXQgLyppbnQqLywgYXJyYXksIG9mZnNldCAvKmludCovLCBudW1CeXRlcyAvKmludCovKSB7CgkgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbnVtQnl0ZXM7IGkrKykgewoJICAgICAgICAgICAgdmFyIHRoZUJ5dGUgPSAwOwoJICAgICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCA4OyBqKyspIHsKCSAgICAgICAgICAgICAgICBpZiAodGhpcy5nZXQoYml0T2Zmc2V0KSkgewoJICAgICAgICAgICAgICAgICAgICB0aGVCeXRlIHw9IDEgPDwgKDcgLSBqKTsKCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgYml0T2Zmc2V0Kys7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBhcnJheVtvZmZzZXQgKyBpXSA9IC8qKGJ5dGUpKi8gdGhlQnl0ZTsKCSAgICAgICAgfQoJICAgIH07CgkgICAgLyoqCgkgICAgICogQHJldHVybiB1bmRlcmx5aW5nIGFycmF5IG9mIGludHMuIFRoZSBmaXJzdCBlbGVtZW50IGhvbGRzIHRoZSBmaXJzdCAzMiBiaXRzLCBhbmQgdGhlIGxlYXN0CgkgICAgICogICAgICAgICBzaWduaWZpY2FudCBiaXQgaXMgYml0IDAuCgkgICAgICovCgkgICAgQml0QXJyYXkucHJvdG90eXBlLmdldEJpdEFycmF5ID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5iaXRzOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogUmV2ZXJzZXMgYWxsIGJpdHMgaW4gdGhlIGFycmF5LgoJICAgICAqLwoJICAgIEJpdEFycmF5LnByb3RvdHlwZS5yZXZlcnNlID0gZnVuY3Rpb24gKCkgewoJICAgICAgICB2YXIgbmV3Qml0cyA9IG5ldyBJbnQzMkFycmF5KHRoaXMuYml0cy5sZW5ndGgpOwoJICAgICAgICAvLyByZXZlcnNlIGFsbCBpbnQncyBmaXJzdAoJICAgICAgICB2YXIgbGVuID0gTWF0aC5mbG9vcigodGhpcy5zaXplIC0gMSkgLyAzMik7CgkgICAgICAgIHZhciBvbGRCaXRzTGVuID0gbGVuICsgMTsKCSAgICAgICAgdmFyIGJpdHMgPSB0aGlzLmJpdHM7CgkgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgb2xkQml0c0xlbjsgaSsrKSB7CgkgICAgICAgICAgICB2YXIgeCA9IGJpdHNbaV07CgkgICAgICAgICAgICB4ID0gKCh4ID4+IDEpICYgMHg1NTU1NTU1NSkgfCAoKHggJiAweDU1NTU1NTU1KSA8PCAxKTsKCSAgICAgICAgICAgIHggPSAoKHggPj4gMikgJiAweDMzMzMzMzMzKSB8ICgoeCAmIDB4MzMzMzMzMzMpIDw8IDIpOwoJICAgICAgICAgICAgeCA9ICgoeCA+PiA0KSAmIDB4MGYwZjBmMGYpIHwgKCh4ICYgMHgwZjBmMGYwZikgPDwgNCk7CgkgICAgICAgICAgICB4ID0gKCh4ID4+IDgpICYgMHgwMGZmMDBmZikgfCAoKHggJiAweDAwZmYwMGZmKSA8PCA4KTsKCSAgICAgICAgICAgIHggPSAoKHggPj4gMTYpICYgMHgwMDAwZmZmZikgfCAoKHggJiAweDAwMDBmZmZmKSA8PCAxNik7CgkgICAgICAgICAgICBuZXdCaXRzW2xlbiAtIGldID0gLyooaW50KSovIHg7CgkgICAgICAgIH0KCSAgICAgICAgLy8gbm93IGNvcnJlY3QgdGhlIGludCdzIGlmIHRoZSBiaXQgc2l6ZSBpc24ndCBhIG11bHRpcGxlIG9mIDMyCgkgICAgICAgIGlmICh0aGlzLnNpemUgIT09IG9sZEJpdHNMZW4gKiAzMikgewoJICAgICAgICAgICAgdmFyIGxlZnRPZmZzZXQgPSBvbGRCaXRzTGVuICogMzIgLSB0aGlzLnNpemU7CgkgICAgICAgICAgICB2YXIgY3VycmVudEludCA9IG5ld0JpdHNbMF0gPj4+IGxlZnRPZmZzZXQ7CgkgICAgICAgICAgICBmb3IgKHZhciBpID0gMTsgaSA8IG9sZEJpdHNMZW47IGkrKykgewoJICAgICAgICAgICAgICAgIHZhciBuZXh0SW50ID0gbmV3Qml0c1tpXTsKCSAgICAgICAgICAgICAgICBjdXJyZW50SW50IHw9IG5leHRJbnQgPDwgKDMyIC0gbGVmdE9mZnNldCk7CgkgICAgICAgICAgICAgICAgbmV3Qml0c1tpIC0gMV0gPSBjdXJyZW50SW50OwoJICAgICAgICAgICAgICAgIGN1cnJlbnRJbnQgPSBuZXh0SW50ID4+PiBsZWZ0T2Zmc2V0OwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgbmV3Qml0c1tvbGRCaXRzTGVuIC0gMV0gPSBjdXJyZW50SW50OwoJICAgICAgICB9CgkgICAgICAgIHRoaXMuYml0cyA9IG5ld0JpdHM7CgkgICAgfTsKCSAgICBCaXRBcnJheS5tYWtlQXJyYXkgPSBmdW5jdGlvbiAoc2l6ZSAvKmludCovKSB7CgkgICAgICAgIHJldHVybiBuZXcgSW50MzJBcnJheShNYXRoLmZsb29yKChzaXplICsgMzEpIC8gMzIpKTsKCSAgICB9OwoJICAgIC8qQE92ZXJyaWRlKi8KCSAgICBCaXRBcnJheS5wcm90b3R5cGUuZXF1YWxzID0gZnVuY3Rpb24gKG8pIHsKCSAgICAgICAgaWYgKCEobyBpbnN0YW5jZW9mIEJpdEFycmF5KSkgewoJICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwoJICAgICAgICB9CgkgICAgICAgIHZhciBvdGhlciA9IG87CgkgICAgICAgIHJldHVybiB0aGlzLnNpemUgPT09IG90aGVyLnNpemUgJiYgQXJyYXlzXzEkMS5kZWZhdWx0LmVxdWFscyh0aGlzLmJpdHMsIG90aGVyLmJpdHMpOwoJICAgIH07CgkgICAgLypAT3ZlcnJpZGUqLwoJICAgIEJpdEFycmF5LnByb3RvdHlwZS5oYXNoQ29kZSA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIDMxICogdGhpcy5zaXplICsgQXJyYXlzXzEkMS5kZWZhdWx0Lmhhc2hDb2RlKHRoaXMuYml0cyk7CgkgICAgfTsKCSAgICAvKkBPdmVycmlkZSovCgkgICAgQml0QXJyYXkucHJvdG90eXBlLnRvU3RyaW5nID0gZnVuY3Rpb24gKCkgewoJICAgICAgICB2YXIgcmVzdWx0ID0gJyc7CgkgICAgICAgIGZvciAodmFyIGkgPSAwLCBzaXplID0gdGhpcy5zaXplOyBpIDwgc2l6ZTsgaSsrKSB7CgkgICAgICAgICAgICBpZiAoKGkgJiAweDA3KSA9PT0gMCkgewoJICAgICAgICAgICAgICAgIHJlc3VsdCArPSAnICc7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICByZXN1bHQgKz0gdGhpcy5nZXQoaSkgPyAnWCcgOiAnLic7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIHJlc3VsdDsKCSAgICB9OwoJICAgIC8qQE92ZXJyaWRlKi8KCSAgICBCaXRBcnJheS5wcm90b3R5cGUuY2xvbmUgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiBuZXcgQml0QXJyYXkodGhpcy5zaXplLCB0aGlzLmJpdHMuc2xpY2UoKSk7CgkgICAgfTsKCSAgICByZXR1cm4gQml0QXJyYXk7Cgl9KCkpOwoJQml0QXJyYXkkMS5kZWZhdWx0ID0gQml0QXJyYXk7CgoJdmFyIEJpdE1hdHJpeCQxID0ge307CgoJdmFyIFN0cmluZ0J1aWxkZXIkMSA9IHt9OwoKCXZhciBTdHJpbmdVdGlscyQxID0ge307CgoJdmFyIERlY29kZUhpbnRUeXBlJDEgPSB7fTsKCgkvKgoJICogQ29weXJpZ2h0IDIwMDkgWlhpbmcgYXV0aG9ycwoJICoKCSAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoJICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoJICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkgKgoJICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKCSAqCgkgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCgkgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoJICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCgkgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCSAqLwoJT2JqZWN0LmRlZmluZVByb3BlcnR5KERlY29kZUhpbnRUeXBlJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCS8qbmFtZXNwYWNlIGNvbS5nb29nbGUuenhpbmcgeyovCgkvKioKCSAqIEVuY2Fwc3VsYXRlcyBhIHR5cGUgb2YgaGludCB0aGF0IGEgY2FsbGVyIG1heSBwYXNzIHRvIGEgYmFyY29kZSByZWFkZXIgdG8gaGVscCBpdAoJICogbW9yZSBxdWlja2x5IG9yIGFjY3VyYXRlbHkgZGVjb2RlIGl0LiBJdCBpcyB1cCB0byBpbXBsZW1lbnRhdGlvbnMgdG8gZGVjaWRlIHdoYXQsCgkgKiBpZiBhbnl0aGluZywgdG8gZG8gd2l0aCB0aGUgaW5mb3JtYXRpb24gdGhhdCBpcyBzdXBwbGllZC4KCSAqCgkgKiBAYXV0aG9yIFNlYW4gT3dlbgoJICogQGF1dGhvciBkc3dpdGtpbkBnb29nbGUuY29tIChEYW5pZWwgU3dpdGtpbikKCSAqIEBzZWUgUmVhZGVyI2RlY29kZShCaW5hcnlCaXRtYXAsamF2YS51dGlsLk1hcCkKCSAqLwoJdmFyIERlY29kZUhpbnRUeXBlOwoJKGZ1bmN0aW9uIChEZWNvZGVIaW50VHlwZSkgewoJICAgIC8qKgoJICAgICAqIFVuc3BlY2lmaWVkLCBhcHBsaWNhdGlvbi1zcGVjaWZpYyBoaW50LiBNYXBzIHRvIGFuIHVuc3BlY2lmaWVkIHtAbGluayBPYmplY3R9LgoJICAgICAqLwoJICAgIERlY29kZUhpbnRUeXBlW0RlY29kZUhpbnRUeXBlWyJPVEhFUiJdID0gMF0gPSAiT1RIRVIiOyAvKihPYmplY3QuY2xhc3MpKi8KCSAgICAvKioKCSAgICAgKiBJbWFnZSBpcyBhIHB1cmUgbW9ub2Nocm9tZSBpbWFnZSBvZiBhIGJhcmNvZGUuIERvZXNuJ3QgbWF0dGVyIHdoYXQgaXQgbWFwcyB0bzsKCSAgICAgKiB1c2Uge0BsaW5rIEJvb2xlYW4jVFJVRX0uCgkgICAgICovCgkgICAgRGVjb2RlSGludFR5cGVbRGVjb2RlSGludFR5cGVbIlBVUkVfQkFSQ09ERSJdID0gMV0gPSAiUFVSRV9CQVJDT0RFIjsgLyooVm9pZC5jbGFzcykqLwoJICAgIC8qKgoJICAgICAqIEltYWdlIGlzIGtub3duIHRvIGJlIG9mIG9uZSBvZiBhIGZldyBwb3NzaWJsZSBmb3JtYXRzLgoJICAgICAqIE1hcHMgdG8gYSB7QGxpbmsgTGlzdH0gb2Yge0BsaW5rIEJhcmNvZGVGb3JtYXR9cy4KCSAgICAgKi8KCSAgICBEZWNvZGVIaW50VHlwZVtEZWNvZGVIaW50VHlwZVsiUE9TU0lCTEVfRk9STUFUUyJdID0gMl0gPSAiUE9TU0lCTEVfRk9STUFUUyI7IC8qKExpc3QuY2xhc3MpKi8KCSAgICAvKioKCSAgICAgKiBTcGVuZCBtb3JlIHRpbWUgdG8gdHJ5IHRvIGZpbmQgYSBiYXJjb2RlOyBvcHRpbWl6ZSBmb3IgYWNjdXJhY3ksIG5vdCBzcGVlZC4KCSAgICAgKiBEb2Vzbid0IG1hdHRlciB3aGF0IGl0IG1hcHMgdG87IHVzZSB7QGxpbmsgQm9vbGVhbiNUUlVFfS4KCSAgICAgKi8KCSAgICBEZWNvZGVIaW50VHlwZVtEZWNvZGVIaW50VHlwZVsiVFJZX0hBUkRFUiJdID0gM10gPSAiVFJZX0hBUkRFUiI7IC8qKFZvaWQuY2xhc3MpKi8KCSAgICAvKioKCSAgICAgKiBTcGVjaWZpZXMgd2hhdCBjaGFyYWN0ZXIgZW5jb2RpbmcgdG8gdXNlIHdoZW4gZGVjb2RpbmcsIHdoZXJlIGFwcGxpY2FibGUgKHR5cGUgU3RyaW5nKQoJICAgICAqLwoJICAgIERlY29kZUhpbnRUeXBlW0RlY29kZUhpbnRUeXBlWyJDSEFSQUNURVJfU0VUIl0gPSA0XSA9ICJDSEFSQUNURVJfU0VUIjsgLyooU3RyaW5nLmNsYXNzKSovCgkgICAgLyoqCgkgICAgICogQWxsb3dlZCBsZW5ndGhzIG9mIGVuY29kZWQgZGF0YSAtLSByZWplY3QgYW55dGhpbmcgZWxzZS4gTWFwcyB0byBhbiB7QGNvZGUgSW50MzJBcnJheX0uCgkgICAgICovCgkgICAgRGVjb2RlSGludFR5cGVbRGVjb2RlSGludFR5cGVbIkFMTE9XRURfTEVOR1RIUyJdID0gNV0gPSAiQUxMT1dFRF9MRU5HVEhTIjsgLyooSW50MzJBcnJheS5jbGFzcykqLwoJICAgIC8qKgoJICAgICAqIEFzc3VtZSBDb2RlIDM5IGNvZGVzIGVtcGxveSBhIGNoZWNrIGRpZ2l0LiBEb2Vzbid0IG1hdHRlciB3aGF0IGl0IG1hcHMgdG87CgkgICAgICogdXNlIHtAbGluayBCb29sZWFuI1RSVUV9LgoJICAgICAqLwoJICAgIERlY29kZUhpbnRUeXBlW0RlY29kZUhpbnRUeXBlWyJBU1NVTUVfQ09ERV8zOV9DSEVDS19ESUdJVCJdID0gNl0gPSAiQVNTVU1FX0NPREVfMzlfQ0hFQ0tfRElHSVQiOyAvKihWb2lkLmNsYXNzKSovCgkgICAgLyoqCgkgICAgICogQXNzdW1lIHRoZSBiYXJjb2RlIGlzIGJlaW5nIHByb2Nlc3NlZCBhcyBhIEdTMSBiYXJjb2RlLCBhbmQgbW9kaWZ5IGJlaGF2aW9yIGFzIG5lZWRlZC4KCSAgICAgKiBGb3IgZXhhbXBsZSB0aGlzIGFmZmVjdHMgRk5DMSBoYW5kbGluZyBmb3IgQ29kZSAxMjggKGFrYSBHUzEtMTI4KS4gRG9lc24ndCBtYXR0ZXIgd2hhdCBpdCBtYXBzIHRvOwoJICAgICAqIHVzZSB7QGxpbmsgQm9vbGVhbiNUUlVFfS4KCSAgICAgKi8KCSAgICBEZWNvZGVIaW50VHlwZVtEZWNvZGVIaW50VHlwZVsiQVNTVU1FX0dTMSJdID0gN10gPSAiQVNTVU1FX0dTMSI7IC8qKFZvaWQuY2xhc3MpKi8KCSAgICAvKioKCSAgICAgKiBJZiB0cnVlLCByZXR1cm4gdGhlIHN0YXJ0IGFuZCBlbmQgZGlnaXRzIGluIGEgQ29kYWJhciBiYXJjb2RlIGluc3RlYWQgb2Ygc3RyaXBwaW5nIHRoZW0uIFRoZXkKCSAgICAgKiBhcmUgYWxwaGEsIHdoZXJlYXMgdGhlIHJlc3QgYXJlIG51bWVyaWMuIEJ5IGRlZmF1bHQsIHRoZXkgYXJlIHN0cmlwcGVkLCBidXQgdGhpcyBjYXVzZXMgdGhlbQoJICAgICAqIHRvIG5vdCBiZS4gRG9lc24ndCBtYXR0ZXIgd2hhdCBpdCBtYXBzIHRvOyB1c2Uge0BsaW5rIEJvb2xlYW4jVFJVRX0uCgkgICAgICovCgkgICAgRGVjb2RlSGludFR5cGVbRGVjb2RlSGludFR5cGVbIlJFVFVSTl9DT0RBQkFSX1NUQVJUX0VORCJdID0gOF0gPSAiUkVUVVJOX0NPREFCQVJfU1RBUlRfRU5EIjsgLyooVm9pZC5jbGFzcykqLwoJICAgIC8qKgoJICAgICAqIFRoZSBjYWxsZXIgbmVlZHMgdG8gYmUgbm90aWZpZWQgdmlhIGNhbGxiYWNrIHdoZW4gYSBwb3NzaWJsZSB7QGxpbmsgUmVzdWx0UG9pbnR9CgkgICAgICogaXMgZm91bmQuIE1hcHMgdG8gYSB7QGxpbmsgUmVzdWx0UG9pbnRDYWxsYmFja30uCgkgICAgICovCgkgICAgRGVjb2RlSGludFR5cGVbRGVjb2RlSGludFR5cGVbIk5FRURfUkVTVUxUX1BPSU5UX0NBTExCQUNLIl0gPSA5XSA9ICJORUVEX1JFU1VMVF9QT0lOVF9DQUxMQkFDSyI7IC8qKFJlc3VsdFBvaW50Q2FsbGJhY2suY2xhc3MpKi8KCSAgICAvKioKCSAgICAgKiBBbGxvd2VkIGV4dGVuc2lvbiBsZW5ndGhzIGZvciBFQU4gb3IgVVBDIGJhcmNvZGVzLiBPdGhlciBmb3JtYXRzIHdpbGwgaWdub3JlIHRoaXMuCgkgICAgICogTWFwcyB0byBhbiB7QGNvZGUgSW50MzJBcnJheX0gb2YgdGhlIGFsbG93ZWQgZXh0ZW5zaW9uIGxlbmd0aHMsIGZvciBleGFtcGxlIFsyXSwgWzVdLCBvciBbMiwgNV0uCgkgICAgICogSWYgaXQgaXMgb3B0aW9uYWwgdG8gaGF2ZSBhbiBleHRlbnNpb24sIGRvIG5vdCBzZXQgdGhpcyBoaW50LiBJZiB0aGlzIGlzIHNldCwKCSAgICAgKiBhbmQgYSBVUEMgb3IgRUFOIGJhcmNvZGUgaXMgZm91bmQgYnV0IGFuIGV4dGVuc2lvbiBpcyBub3QsIHRoZW4gbm8gcmVzdWx0IHdpbGwgYmUgcmV0dXJuZWQKCSAgICAgKiBhdCBhbGwuCgkgICAgICovCgkgICAgRGVjb2RlSGludFR5cGVbRGVjb2RlSGludFR5cGVbIkFMTE9XRURfRUFOX0VYVEVOU0lPTlMiXSA9IDEwXSA9ICJBTExPV0VEX0VBTl9FWFRFTlNJT05TIjsgLyooSW50MzJBcnJheS5jbGFzcykqLwoJICAgIC8vIEVuZCBvZiBlbnVtZXJhdGlvbiB2YWx1ZXMuCgkgICAgLyoqCgkgICAgICogRGF0YSB0eXBlIHRoZSBoaW50IGlzIGV4cGVjdGluZy4KCSAgICAgKiBBbW9uZyB0aGUgcG9zc2libGUgdmFsdWVzIHRoZSB7QGxpbmsgVm9pZH0gc3RhbmRzIG91dCBhcyBiZWluZyB1c2VkIGZvcgoJICAgICAqIGhpbnRzIHRoYXQgZG8gbm90IGV4cGVjdCBhIHZhbHVlIHRvIGJlIHN1cHBsaWVkIChmbGFnIGhpbnRzKS4gU3VjaCBoaW50cwoJICAgICAqIHdpbGwgcG9zc2libHkgaGF2ZSB0aGVpciB2YWx1ZSBpZ25vcmVkLCBvciByZXBsYWNlZCBieSBhCgkgICAgICoge0BsaW5rIEJvb2xlYW4jVFJVRX0uIEhpbnQgc3VwcGxpZXJzIHNob3VsZCBwcm9iYWJseSB1c2UKCSAgICAgKiB7QGxpbmsgQm9vbGVhbiNUUlVFfSBhcyBkaXJlY3RlZCBieSB0aGUgYWN0dWFsIGhpbnQgZG9jdW1lbnRhdGlvbi4KCSAgICAgKi8KCSAgICAvLyBwcml2YXRlIHZhbHVlVHlwZTogQ2xhc3M8Pz4KCSAgICAvLyBEZWNvZGVIaW50VHlwZSh2YWx1ZVR5cGU6IENsYXNzPD8+KSB7CgkgICAgLy8gICB0aGlzLnZhbHVlVHlwZSA9IHZhbHVlVHlwZQoJICAgIC8vIH0KCSAgICAvLyBwdWJsaWMgZ2V0VmFsdWVUeXBlKCk6IENsYXNzPD8+IHsKCSAgICAvLyAgIHJldHVybiB2YWx1ZVR5cGUKCSAgICAvLyB9Cgl9KShEZWNvZGVIaW50VHlwZSB8fCAoRGVjb2RlSGludFR5cGUgPSB7fSkpOwoJRGVjb2RlSGludFR5cGUkMS5kZWZhdWx0ID0gRGVjb2RlSGludFR5cGU7CgoJdmFyIENoYXJhY3RlclNldEVDSSA9IHt9OwoKCXZhciBGb3JtYXRFeGNlcHRpb24kMSA9IHt9OwoKCXZhciBfX2V4dGVuZHMkZiA9IChjb21tb25qc0dsb2JhbCAmJiBjb21tb25qc0dsb2JhbC5fX2V4dGVuZHMpIHx8IChmdW5jdGlvbiAoKSB7CgkgICAgdmFyIGV4dGVuZFN0YXRpY3MgPSBmdW5jdGlvbiAoZCwgYikgewoJICAgICAgICBleHRlbmRTdGF0aWNzID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8CgkgICAgICAgICAgICAoeyBfX3Byb3RvX186IFtdIH0gaW5zdGFuY2VvZiBBcnJheSAmJiBmdW5jdGlvbiAoZCwgYikgeyBkLl9fcHJvdG9fXyA9IGI7IH0pIHx8CgkgICAgICAgICAgICBmdW5jdGlvbiAoZCwgYikgeyBmb3IgKHZhciBwIGluIGIpIGlmIChiLmhhc093blByb3BlcnR5KHApKSBkW3BdID0gYltwXTsgfTsKCSAgICAgICAgcmV0dXJuIGV4dGVuZFN0YXRpY3MoZCwgYik7CgkgICAgfTsKCSAgICByZXR1cm4gZnVuY3Rpb24gKGQsIGIpIHsKCSAgICAgICAgZXh0ZW5kU3RhdGljcyhkLCBiKTsKCSAgICAgICAgZnVuY3Rpb24gX18oKSB7IHRoaXMuY29uc3RydWN0b3IgPSBkOyB9CgkgICAgICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTsKCSAgICB9OwoJfSkoKTsKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShGb3JtYXRFeGNlcHRpb24kMSwgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJdmFyIEV4Y2VwdGlvbl8xJDcgPSBFeGNlcHRpb24kMTsKCS8qKgoJICogQ3VzdG9tIEVycm9yIGNsYXNzIG9mIHR5cGUgRXhjZXB0aW9uLgoJICovCgl2YXIgRm9ybWF0RXhjZXB0aW9uID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikgewoJICAgIF9fZXh0ZW5kcyRmKEZvcm1hdEV4Y2VwdGlvbiwgX3N1cGVyKTsKCSAgICBmdW5jdGlvbiBGb3JtYXRFeGNlcHRpb24oKSB7CgkgICAgICAgIHJldHVybiBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpczsKCSAgICB9CgkgICAgRm9ybWF0RXhjZXB0aW9uLmdldEZvcm1hdEluc3RhbmNlID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gbmV3IEZvcm1hdEV4Y2VwdGlvbigpOwoJICAgIH07CgkgICAgRm9ybWF0RXhjZXB0aW9uLmtpbmQgPSAnRm9ybWF0RXhjZXB0aW9uJzsKCSAgICByZXR1cm4gRm9ybWF0RXhjZXB0aW9uOwoJfShFeGNlcHRpb25fMSQ3LmRlZmF1bHQpKTsKCUZvcm1hdEV4Y2VwdGlvbiQxLmRlZmF1bHQgPSBGb3JtYXRFeGNlcHRpb247CgoJKGZ1bmN0aW9uIChleHBvcnRzKSB7CgkvKgoJICogQ29weXJpZ2h0IDIwMDggWlhpbmcgYXV0aG9ycwoJICoKCSAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoJICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoJICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkgKgoJICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKCSAqCgkgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCgkgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoJICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCgkgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCSAqLwoJdmFyIF9fdmFsdWVzID0gKGNvbW1vbmpzR2xvYmFsICYmIGNvbW1vbmpzR2xvYmFsLl9fdmFsdWVzKSB8fCBmdW5jdGlvbihvKSB7CgkgICAgdmFyIHMgPSB0eXBlb2YgU3ltYm9sID09PSAiZnVuY3Rpb24iICYmIFN5bWJvbC5pdGVyYXRvciwgbSA9IHMgJiYgb1tzXSwgaSA9IDA7CgkgICAgaWYgKG0pIHJldHVybiBtLmNhbGwobyk7CgkgICAgaWYgKG8gJiYgdHlwZW9mIG8ubGVuZ3RoID09PSAibnVtYmVyIikgcmV0dXJuIHsKCSAgICAgICAgbmV4dDogZnVuY3Rpb24gKCkgewoJICAgICAgICAgICAgaWYgKG8gJiYgaSA+PSBvLmxlbmd0aCkgbyA9IHZvaWQgMDsKCSAgICAgICAgICAgIHJldHVybiB7IHZhbHVlOiBvICYmIG9baSsrXSwgZG9uZTogIW8gfTsKCSAgICAgICAgfQoJICAgIH07CgkgICAgdGhyb3cgbmV3IFR5cGVFcnJvcihzID8gIk9iamVjdCBpcyBub3QgaXRlcmFibGUuIiA6ICJTeW1ib2wuaXRlcmF0b3IgaXMgbm90IGRlZmluZWQuIik7Cgl9OwoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCWV4cG9ydHMuQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVycyA9IHZvaWQgMDsKCS8qbmFtZXNwYWNlIGNvbS5nb29nbGUuenhpbmcuY29tbW9uIHsqLwoJdmFyIEZvcm1hdEV4Y2VwdGlvbl8xID0gRm9ybWF0RXhjZXB0aW9uJDE7CgkvKmltcG9ydCBqYXZhLnV0aWwuSGFzaE1hcDsqLwoJLyppbXBvcnQgamF2YS51dGlsLk1hcDsqLwoJdmFyIENoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnM7CgkoZnVuY3Rpb24gKENoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnMpIHsKCSAgICBDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzW0NoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnNbIkNwNDM3Il0gPSAwXSA9ICJDcDQzNyI7CgkgICAgQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1tDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzWyJJU084ODU5XzEiXSA9IDFdID0gIklTTzg4NTlfMSI7CgkgICAgQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1tDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzWyJJU084ODU5XzIiXSA9IDJdID0gIklTTzg4NTlfMiI7CgkgICAgQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1tDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzWyJJU084ODU5XzMiXSA9IDNdID0gIklTTzg4NTlfMyI7CgkgICAgQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1tDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzWyJJU084ODU5XzQiXSA9IDRdID0gIklTTzg4NTlfNCI7CgkgICAgQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1tDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzWyJJU084ODU5XzUiXSA9IDVdID0gIklTTzg4NTlfNSI7CgkgICAgQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1tDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzWyJJU084ODU5XzYiXSA9IDZdID0gIklTTzg4NTlfNiI7CgkgICAgQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1tDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzWyJJU084ODU5XzciXSA9IDddID0gIklTTzg4NTlfNyI7CgkgICAgQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1tDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzWyJJU084ODU5XzgiXSA9IDhdID0gIklTTzg4NTlfOCI7CgkgICAgQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1tDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzWyJJU084ODU5XzkiXSA9IDldID0gIklTTzg4NTlfOSI7CgkgICAgQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1tDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzWyJJU084ODU5XzEwIl0gPSAxMF0gPSAiSVNPODg1OV8xMCI7CgkgICAgQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1tDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzWyJJU084ODU5XzExIl0gPSAxMV0gPSAiSVNPODg1OV8xMSI7CgkgICAgQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1tDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzWyJJU084ODU5XzEzIl0gPSAxMl0gPSAiSVNPODg1OV8xMyI7CgkgICAgQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1tDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzWyJJU084ODU5XzE0Il0gPSAxM10gPSAiSVNPODg1OV8xNCI7CgkgICAgQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1tDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzWyJJU084ODU5XzE1Il0gPSAxNF0gPSAiSVNPODg1OV8xNSI7CgkgICAgQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1tDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzWyJJU084ODU5XzE2Il0gPSAxNV0gPSAiSVNPODg1OV8xNiI7CgkgICAgQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1tDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzWyJTSklTIl0gPSAxNl0gPSAiU0pJUyI7CgkgICAgQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1tDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzWyJDcDEyNTAiXSA9IDE3XSA9ICJDcDEyNTAiOwoJICAgIENoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnNbQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1siQ3AxMjUxIl0gPSAxOF0gPSAiQ3AxMjUxIjsKCSAgICBDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzW0NoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnNbIkNwMTI1MiJdID0gMTldID0gIkNwMTI1MiI7CgkgICAgQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1tDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzWyJDcDEyNTYiXSA9IDIwXSA9ICJDcDEyNTYiOwoJICAgIENoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnNbQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1siVW5pY29kZUJpZ1VubWFya2VkIl0gPSAyMV0gPSAiVW5pY29kZUJpZ1VubWFya2VkIjsKCSAgICBDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzW0NoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnNbIlVURjgiXSA9IDIyXSA9ICJVVEY4IjsKCSAgICBDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzW0NoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnNbIkFTQ0lJIl0gPSAyM10gPSAiQVNDSUkiOwoJICAgIENoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnNbQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1siQmlnNSJdID0gMjRdID0gIkJpZzUiOwoJICAgIENoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnNbQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1siR0IxODAzMCJdID0gMjVdID0gIkdCMTgwMzAiOwoJICAgIENoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnNbQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1siRVVDX0tSIl0gPSAyNl0gPSAiRVVDX0tSIjsKCX0pKENoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnMgPSBleHBvcnRzLkNoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnMgfHwgKGV4cG9ydHMuQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVycyA9IHt9KSk7CgkvKioKCSAqIEVuY2Fwc3VsYXRlcyBhIENoYXJhY3RlciBTZXQgRUNJLCBhY2NvcmRpbmcgdG8gIkV4dGVuZGVkIENoYW5uZWwgSW50ZXJwcmV0YXRpb25zIiA1LjMuMS4xCgkgKiBvZiBJU08gMTgwMDQuCgkgKgoJICogQGF1dGhvciBTZWFuIE93ZW4KCSAqLwoJdmFyIENoYXJhY3RlclNldEVDSSA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHsKCSAgICBmdW5jdGlvbiBDaGFyYWN0ZXJTZXRFQ0kodmFsdWVJZGVudGlmaWVyLCB2YWx1ZXNQYXJhbSwgbmFtZSkgewoJICAgICAgICB2YXIgZV8xLCBfYTsKCSAgICAgICAgdmFyIG90aGVyRW5jb2RpbmdOYW1lcyA9IFtdOwoJICAgICAgICBmb3IgKHZhciBfaSA9IDM7IF9pIDwgYXJndW1lbnRzLmxlbmd0aDsgX2krKykgewoJICAgICAgICAgICAgb3RoZXJFbmNvZGluZ05hbWVzW19pIC0gM10gPSBhcmd1bWVudHNbX2ldOwoJICAgICAgICB9CgkgICAgICAgIHRoaXMudmFsdWVJZGVudGlmaWVyID0gdmFsdWVJZGVudGlmaWVyOwoJICAgICAgICB0aGlzLm5hbWUgPSBuYW1lOwoJICAgICAgICBpZiAodHlwZW9mIHZhbHVlc1BhcmFtID09PSAnbnVtYmVyJykgewoJICAgICAgICAgICAgdGhpcy52YWx1ZXMgPSBJbnQzMkFycmF5LmZyb20oW3ZhbHVlc1BhcmFtXSk7CgkgICAgICAgIH0KCSAgICAgICAgZWxzZSB7CgkgICAgICAgICAgICB0aGlzLnZhbHVlcyA9IHZhbHVlc1BhcmFtOwoJICAgICAgICB9CgkgICAgICAgIHRoaXMub3RoZXJFbmNvZGluZ05hbWVzID0gb3RoZXJFbmNvZGluZ05hbWVzOwoJICAgICAgICBDaGFyYWN0ZXJTZXRFQ0kuVkFMVUVfSURFTlRJRklFUl9UT19FQ0kuc2V0KHZhbHVlSWRlbnRpZmllciwgdGhpcyk7CgkgICAgICAgIENoYXJhY3RlclNldEVDSS5OQU1FX1RPX0VDSS5zZXQobmFtZSwgdGhpcyk7CgkgICAgICAgIHZhciB2YWx1ZXMgPSB0aGlzLnZhbHVlczsKCSAgICAgICAgZm9yICh2YXIgaSA9IDAsIGxlbmd0aF8xID0gdmFsdWVzLmxlbmd0aDsgaSAhPT0gbGVuZ3RoXzE7IGkrKykgewoJICAgICAgICAgICAgdmFyIHYgPSB2YWx1ZXNbaV07CgkgICAgICAgICAgICBDaGFyYWN0ZXJTZXRFQ0kuVkFMVUVTX1RPX0VDSS5zZXQodiwgdGhpcyk7CgkgICAgICAgIH0KCSAgICAgICAgdHJ5IHsKCSAgICAgICAgICAgIGZvciAodmFyIG90aGVyRW5jb2RpbmdOYW1lc18xID0gX192YWx1ZXMob3RoZXJFbmNvZGluZ05hbWVzKSwgb3RoZXJFbmNvZGluZ05hbWVzXzFfMSA9IG90aGVyRW5jb2RpbmdOYW1lc18xLm5leHQoKTsgIW90aGVyRW5jb2RpbmdOYW1lc18xXzEuZG9uZTsgb3RoZXJFbmNvZGluZ05hbWVzXzFfMSA9IG90aGVyRW5jb2RpbmdOYW1lc18xLm5leHQoKSkgewoJICAgICAgICAgICAgICAgIHZhciBvdGhlck5hbWUgPSBvdGhlckVuY29kaW5nTmFtZXNfMV8xLnZhbHVlOwoJICAgICAgICAgICAgICAgIENoYXJhY3RlclNldEVDSS5OQU1FX1RPX0VDSS5zZXQob3RoZXJOYW1lLCB0aGlzKTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgfQoJICAgICAgICBjYXRjaCAoZV8xXzEpIHsgZV8xID0geyBlcnJvcjogZV8xXzEgfTsgfQoJICAgICAgICBmaW5hbGx5IHsKCSAgICAgICAgICAgIHRyeSB7CgkgICAgICAgICAgICAgICAgaWYgKG90aGVyRW5jb2RpbmdOYW1lc18xXzEgJiYgIW90aGVyRW5jb2RpbmdOYW1lc18xXzEuZG9uZSAmJiAoX2EgPSBvdGhlckVuY29kaW5nTmFtZXNfMS5yZXR1cm4pKSBfYS5jYWxsKG90aGVyRW5jb2RpbmdOYW1lc18xKTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIGZpbmFsbHkgeyBpZiAoZV8xKSB0aHJvdyBlXzEuZXJyb3I7IH0KCSAgICAgICAgfQoJICAgIH0KCSAgICAvLyBDaGFyYWN0ZXJTZXRFQ0kodmFsdWU6IG51bWJlciAvKmludCovKSB7CgkgICAgLy8gICB0aGlzKG5ldyBJbnQzMkFycmF5IHt2YWx1ZX0pCgkgICAgLy8gfQoJICAgIC8vIENoYXJhY3RlclNldEVDSSh2YWx1ZTogbnVtYmVyIC8qaW50Ki8sIFN0cmluZy4uLiBvdGhlckVuY29kaW5nTmFtZXMpIHsKCSAgICAvLyAgIHRoaXMudmFsdWVzID0gbmV3IEludDMyQXJyYXkge3ZhbHVlfQoJICAgIC8vICAgdGhpcy5vdGhlckVuY29kaW5nTmFtZXMgPSBvdGhlckVuY29kaW5nTmFtZXMKCSAgICAvLyB9CgkgICAgLy8gQ2hhcmFjdGVyU2V0RUNJKHZhbHVlczogSW50MzJBcnJheSwgU3RyaW5nLi4uIG90aGVyRW5jb2RpbmdOYW1lcykgewoJICAgIC8vICAgdGhpcy52YWx1ZXMgPSB2YWx1ZXMKCSAgICAvLyAgIHRoaXMub3RoZXJFbmNvZGluZ05hbWVzID0gb3RoZXJFbmNvZGluZ05hbWVzCgkgICAgLy8gfQoJICAgIENoYXJhY3RlclNldEVDSS5wcm90b3R5cGUuZ2V0VmFsdWVJZGVudGlmaWVyID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy52YWx1ZUlkZW50aWZpZXI7CgkgICAgfTsKCSAgICBDaGFyYWN0ZXJTZXRFQ0kucHJvdG90eXBlLmdldE5hbWUgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLm5hbWU7CgkgICAgfTsKCSAgICBDaGFyYWN0ZXJTZXRFQ0kucHJvdG90eXBlLmdldFZhbHVlID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy52YWx1ZXNbMF07CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcGFyYW0gdmFsdWUgY2hhcmFjdGVyIHNldCBFQ0kgdmFsdWUKCSAgICAgKiBAcmV0dXJuIHtAY29kZSBDaGFyYWN0ZXJTZXRFQ0l9IHJlcHJlc2VudGluZyBFQ0kgb2YgZ2l2ZW4gdmFsdWUsIG9yIG51bGwgaWYgaXQgaXMgbGVnYWwgYnV0CgkgICAgICogICB1bnN1cHBvcnRlZAoJICAgICAqIEB0aHJvd3MgRm9ybWF0RXhjZXB0aW9uIGlmIEVDSSB2YWx1ZSBpcyBpbnZhbGlkCgkgICAgICovCgkgICAgQ2hhcmFjdGVyU2V0RUNJLmdldENoYXJhY3RlclNldEVDSUJ5VmFsdWUgPSBmdW5jdGlvbiAodmFsdWUgLyppbnQqLykgewoJICAgICAgICBpZiAodmFsdWUgPCAwIHx8IHZhbHVlID49IDkwMCkgewoJICAgICAgICAgICAgdGhyb3cgbmV3IEZvcm1hdEV4Y2VwdGlvbl8xLmRlZmF1bHQoJ2luY29yZWN0IHZhbHVlJyk7CgkgICAgICAgIH0KCSAgICAgICAgdmFyIGNoYXJhY3RlclNldCA9IENoYXJhY3RlclNldEVDSS5WQUxVRVNfVE9fRUNJLmdldCh2YWx1ZSk7CgkgICAgICAgIGlmICh1bmRlZmluZWQgPT09IGNoYXJhY3RlclNldCkgewoJICAgICAgICAgICAgdGhyb3cgbmV3IEZvcm1hdEV4Y2VwdGlvbl8xLmRlZmF1bHQoJ2luY29yZWN0IHZhbHVlJyk7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIGNoYXJhY3RlclNldDsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEBwYXJhbSBuYW1lIGNoYXJhY3RlciBzZXQgRUNJIGVuY29kaW5nIG5hbWUKCSAgICAgKiBAcmV0dXJuIENoYXJhY3RlclNldEVDSSByZXByZXNlbnRpbmcgRUNJIGZvciBjaGFyYWN0ZXIgZW5jb2RpbmcsIG9yIG51bGwgaWYgaXQgaXMgbGVnYWwKCSAgICAgKiAgIGJ1dCB1bnN1cHBvcnRlZAoJICAgICAqLwoJICAgIENoYXJhY3RlclNldEVDSS5nZXRDaGFyYWN0ZXJTZXRFQ0lCeU5hbWUgPSBmdW5jdGlvbiAobmFtZSkgewoJICAgICAgICB2YXIgY2hhcmFjdGVyU2V0ID0gQ2hhcmFjdGVyU2V0RUNJLk5BTUVfVE9fRUNJLmdldChuYW1lKTsKCSAgICAgICAgaWYgKHVuZGVmaW5lZCA9PT0gY2hhcmFjdGVyU2V0KSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgRm9ybWF0RXhjZXB0aW9uXzEuZGVmYXVsdCgnaW5jb3JlY3QgdmFsdWUnKTsKCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gY2hhcmFjdGVyU2V0OwoJICAgIH07CgkgICAgQ2hhcmFjdGVyU2V0RUNJLnByb3RvdHlwZS5lcXVhbHMgPSBmdW5jdGlvbiAobykgewoJICAgICAgICBpZiAoIShvIGluc3RhbmNlb2YgQ2hhcmFjdGVyU2V0RUNJKSkgewoJICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwoJICAgICAgICB9CgkgICAgICAgIHZhciBvdGhlciA9IG87CgkgICAgICAgIHJldHVybiB0aGlzLmdldE5hbWUoKSA9PT0gb3RoZXIuZ2V0TmFtZSgpOwoJICAgIH07CgkgICAgQ2hhcmFjdGVyU2V0RUNJLlZBTFVFX0lERU5USUZJRVJfVE9fRUNJID0gbmV3IE1hcCgpOwoJICAgIENoYXJhY3RlclNldEVDSS5WQUxVRVNfVE9fRUNJID0gbmV3IE1hcCgpOwoJICAgIENoYXJhY3RlclNldEVDSS5OQU1FX1RPX0VDSSA9IG5ldyBNYXAoKTsKCSAgICAvLyBFbnVtIG5hbWUgaXMgYSBKYXZhIGVuY29kaW5nIHZhbGlkIGZvciBqYXZhLmxhbmcgYW5kIGphdmEuaW8KCSAgICAvLyBUWVBFU0NSSVBUUE9SVDogY2hhbmdlZCB0aGUgbWFpbiBsYWJlbCBmb3IgSVNPIGFzIHRoZSBUZXh0RW5jb2RlciBkaWQgbm90IHJlY29nbml6ZWQgdGhlbSBpbiB0aGUgZm9ybSBmcm9tIGphdmEKCSAgICAvLyAoZWcgSVNPODg1OV8xIG11c3QgYmUgSVNPODg1OTEgb3IgSVNPODg1OS0xIG9yIElTTy04ODU5LTEpCgkgICAgLy8gbGF0ZXIgb246IHdlbGwsIGV4Y2VwdCAxNiB3aWNoIGRvZXMgbm90IHdvcmsgd2l0aCBJU084ODU5MTYgc28gdXNlZCBJU08tODg1OS0xIGZvcm0gZm9yIGRlZmF1bHQKCSAgICBDaGFyYWN0ZXJTZXRFQ0kuQ3A0MzcgPSBuZXcgQ2hhcmFjdGVyU2V0RUNJKENoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnMuQ3A0MzcsIEludDMyQXJyYXkuZnJvbShbMCwgMl0pLCAnQ3A0MzcnKTsKCSAgICBDaGFyYWN0ZXJTZXRFQ0kuSVNPODg1OV8xID0gbmV3IENoYXJhY3RlclNldEVDSShDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzLklTTzg4NTlfMSwgSW50MzJBcnJheS5mcm9tKFsxLCAzXSksICdJU08tODg1OS0xJywgJ0lTTzg4NTkxJywgJ0lTTzg4NTlfMScpOwoJICAgIENoYXJhY3RlclNldEVDSS5JU084ODU5XzIgPSBuZXcgQ2hhcmFjdGVyU2V0RUNJKENoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnMuSVNPODg1OV8yLCA0LCAnSVNPLTg4NTktMicsICdJU084ODU5MicsICdJU084ODU5XzInKTsKCSAgICBDaGFyYWN0ZXJTZXRFQ0kuSVNPODg1OV8zID0gbmV3IENoYXJhY3RlclNldEVDSShDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzLklTTzg4NTlfMywgNSwgJ0lTTy04ODU5LTMnLCAnSVNPODg1OTMnLCAnSVNPODg1OV8zJyk7CgkgICAgQ2hhcmFjdGVyU2V0RUNJLklTTzg4NTlfNCA9IG5ldyBDaGFyYWN0ZXJTZXRFQ0koQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVycy5JU084ODU5XzQsIDYsICdJU08tODg1OS00JywgJ0lTTzg4NTk0JywgJ0lTTzg4NTlfNCcpOwoJICAgIENoYXJhY3RlclNldEVDSS5JU084ODU5XzUgPSBuZXcgQ2hhcmFjdGVyU2V0RUNJKENoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnMuSVNPODg1OV81LCA3LCAnSVNPLTg4NTktNScsICdJU084ODU5NScsICdJU084ODU5XzUnKTsKCSAgICBDaGFyYWN0ZXJTZXRFQ0kuSVNPODg1OV82ID0gbmV3IENoYXJhY3RlclNldEVDSShDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzLklTTzg4NTlfNiwgOCwgJ0lTTy04ODU5LTYnLCAnSVNPODg1OTYnLCAnSVNPODg1OV82Jyk7CgkgICAgQ2hhcmFjdGVyU2V0RUNJLklTTzg4NTlfNyA9IG5ldyBDaGFyYWN0ZXJTZXRFQ0koQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVycy5JU084ODU5XzcsIDksICdJU08tODg1OS03JywgJ0lTTzg4NTk3JywgJ0lTTzg4NTlfNycpOwoJICAgIENoYXJhY3RlclNldEVDSS5JU084ODU5XzggPSBuZXcgQ2hhcmFjdGVyU2V0RUNJKENoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnMuSVNPODg1OV84LCAxMCwgJ0lTTy04ODU5LTgnLCAnSVNPODg1OTgnLCAnSVNPODg1OV84Jyk7CgkgICAgQ2hhcmFjdGVyU2V0RUNJLklTTzg4NTlfOSA9IG5ldyBDaGFyYWN0ZXJTZXRFQ0koQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVycy5JU084ODU5XzksIDExLCAnSVNPLTg4NTktOScsICdJU084ODU5OScsICdJU084ODU5XzknKTsKCSAgICBDaGFyYWN0ZXJTZXRFQ0kuSVNPODg1OV8xMCA9IG5ldyBDaGFyYWN0ZXJTZXRFQ0koQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVycy5JU084ODU5XzEwLCAxMiwgJ0lTTy04ODU5LTEwJywgJ0lTTzg4NTkxMCcsICdJU084ODU5XzEwJyk7CgkgICAgQ2hhcmFjdGVyU2V0RUNJLklTTzg4NTlfMTEgPSBuZXcgQ2hhcmFjdGVyU2V0RUNJKENoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnMuSVNPODg1OV8xMSwgMTMsICdJU08tODg1OS0xMScsICdJU084ODU5MTEnLCAnSVNPODg1OV8xMScpOwoJICAgIENoYXJhY3RlclNldEVDSS5JU084ODU5XzEzID0gbmV3IENoYXJhY3RlclNldEVDSShDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzLklTTzg4NTlfMTMsIDE1LCAnSVNPLTg4NTktMTMnLCAnSVNPODg1OTEzJywgJ0lTTzg4NTlfMTMnKTsKCSAgICBDaGFyYWN0ZXJTZXRFQ0kuSVNPODg1OV8xNCA9IG5ldyBDaGFyYWN0ZXJTZXRFQ0koQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVycy5JU084ODU5XzE0LCAxNiwgJ0lTTy04ODU5LTE0JywgJ0lTTzg4NTkxNCcsICdJU084ODU5XzE0Jyk7CgkgICAgQ2hhcmFjdGVyU2V0RUNJLklTTzg4NTlfMTUgPSBuZXcgQ2hhcmFjdGVyU2V0RUNJKENoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnMuSVNPODg1OV8xNSwgMTcsICdJU08tODg1OS0xNScsICdJU084ODU5MTUnLCAnSVNPODg1OV8xNScpOwoJICAgIENoYXJhY3RlclNldEVDSS5JU084ODU5XzE2ID0gbmV3IENoYXJhY3RlclNldEVDSShDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzLklTTzg4NTlfMTYsIDE4LCAnSVNPLTg4NTktMTYnLCAnSVNPODg1OTE2JywgJ0lTTzg4NTlfMTYnKTsKCSAgICBDaGFyYWN0ZXJTZXRFQ0kuU0pJUyA9IG5ldyBDaGFyYWN0ZXJTZXRFQ0koQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVycy5TSklTLCAyMCwgJ1NKSVMnLCAnU2hpZnRfSklTJyk7CgkgICAgQ2hhcmFjdGVyU2V0RUNJLkNwMTI1MCA9IG5ldyBDaGFyYWN0ZXJTZXRFQ0koQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVycy5DcDEyNTAsIDIxLCAnQ3AxMjUwJywgJ3dpbmRvd3MtMTI1MCcpOwoJICAgIENoYXJhY3RlclNldEVDSS5DcDEyNTEgPSBuZXcgQ2hhcmFjdGVyU2V0RUNJKENoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnMuQ3AxMjUxLCAyMiwgJ0NwMTI1MScsICd3aW5kb3dzLTEyNTEnKTsKCSAgICBDaGFyYWN0ZXJTZXRFQ0kuQ3AxMjUyID0gbmV3IENoYXJhY3RlclNldEVDSShDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzLkNwMTI1MiwgMjMsICdDcDEyNTInLCAnd2luZG93cy0xMjUyJyk7CgkgICAgQ2hhcmFjdGVyU2V0RUNJLkNwMTI1NiA9IG5ldyBDaGFyYWN0ZXJTZXRFQ0koQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVycy5DcDEyNTYsIDI0LCAnQ3AxMjU2JywgJ3dpbmRvd3MtMTI1NicpOwoJICAgIENoYXJhY3RlclNldEVDSS5Vbmljb2RlQmlnVW5tYXJrZWQgPSBuZXcgQ2hhcmFjdGVyU2V0RUNJKENoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnMuVW5pY29kZUJpZ1VubWFya2VkLCAyNSwgJ1VuaWNvZGVCaWdVbm1hcmtlZCcsICdVVEYtMTZCRScsICdVbmljb2RlQmlnJyk7CgkgICAgQ2hhcmFjdGVyU2V0RUNJLlVURjggPSBuZXcgQ2hhcmFjdGVyU2V0RUNJKENoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnMuVVRGOCwgMjYsICdVVEY4JywgJ1VURi04Jyk7CgkgICAgQ2hhcmFjdGVyU2V0RUNJLkFTQ0lJID0gbmV3IENoYXJhY3RlclNldEVDSShDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzLkFTQ0lJLCBJbnQzMkFycmF5LmZyb20oWzI3LCAxNzBdKSwgJ0FTQ0lJJywgJ1VTLUFTQ0lJJyk7CgkgICAgQ2hhcmFjdGVyU2V0RUNJLkJpZzUgPSBuZXcgQ2hhcmFjdGVyU2V0RUNJKENoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnMuQmlnNSwgMjgsICdCaWc1Jyk7CgkgICAgQ2hhcmFjdGVyU2V0RUNJLkdCMTgwMzAgPSBuZXcgQ2hhcmFjdGVyU2V0RUNJKENoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnMuR0IxODAzMCwgMjksICdHQjE4MDMwJywgJ0dCMjMxMicsICdFVUNfQ04nLCAnR0JLJyk7CgkgICAgQ2hhcmFjdGVyU2V0RUNJLkVVQ19LUiA9IG5ldyBDaGFyYWN0ZXJTZXRFQ0koQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVycy5FVUNfS1IsIDMwLCAnRVVDX0tSJywgJ0VVQy1LUicpOwoJICAgIHJldHVybiBDaGFyYWN0ZXJTZXRFQ0k7Cgl9KCkpOwoJZXhwb3J0cy5kZWZhdWx0ID0gQ2hhcmFjdGVyU2V0RUNJOwoKCX0oQ2hhcmFjdGVyU2V0RUNJKSk7CgoJdmFyIFN0cmluZ0VuY29kaW5nJDEgPSB7fTsKCgl2YXIgVW5zdXBwb3J0ZWRPcGVyYXRpb25FeGNlcHRpb24kMSA9IHt9OwoKCXZhciBfX2V4dGVuZHMkZSA9IChjb21tb25qc0dsb2JhbCAmJiBjb21tb25qc0dsb2JhbC5fX2V4dGVuZHMpIHx8IChmdW5jdGlvbiAoKSB7CgkgICAgdmFyIGV4dGVuZFN0YXRpY3MgPSBmdW5jdGlvbiAoZCwgYikgewoJICAgICAgICBleHRlbmRTdGF0aWNzID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8CgkgICAgICAgICAgICAoeyBfX3Byb3RvX186IFtdIH0gaW5zdGFuY2VvZiBBcnJheSAmJiBmdW5jdGlvbiAoZCwgYikgeyBkLl9fcHJvdG9fXyA9IGI7IH0pIHx8CgkgICAgICAgICAgICBmdW5jdGlvbiAoZCwgYikgeyBmb3IgKHZhciBwIGluIGIpIGlmIChiLmhhc093blByb3BlcnR5KHApKSBkW3BdID0gYltwXTsgfTsKCSAgICAgICAgcmV0dXJuIGV4dGVuZFN0YXRpY3MoZCwgYik7CgkgICAgfTsKCSAgICByZXR1cm4gZnVuY3Rpb24gKGQsIGIpIHsKCSAgICAgICAgZXh0ZW5kU3RhdGljcyhkLCBiKTsKCSAgICAgICAgZnVuY3Rpb24gX18oKSB7IHRoaXMuY29uc3RydWN0b3IgPSBkOyB9CgkgICAgICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTsKCSAgICB9OwoJfSkoKTsKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShVbnN1cHBvcnRlZE9wZXJhdGlvbkV4Y2VwdGlvbiQxLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7Cgl2YXIgRXhjZXB0aW9uXzEkNiA9IEV4Y2VwdGlvbiQxOwoJLyoqCgkgKiBDdXN0b20gRXJyb3IgY2xhc3Mgb2YgdHlwZSBFeGNlcHRpb24uCgkgKi8KCXZhciBVbnN1cHBvcnRlZE9wZXJhdGlvbkV4Y2VwdGlvbiA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHsKCSAgICBfX2V4dGVuZHMkZShVbnN1cHBvcnRlZE9wZXJhdGlvbkV4Y2VwdGlvbiwgX3N1cGVyKTsKCSAgICBmdW5jdGlvbiBVbnN1cHBvcnRlZE9wZXJhdGlvbkV4Y2VwdGlvbigpIHsKCSAgICAgICAgcmV0dXJuIF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzOwoJICAgIH0KCSAgICBVbnN1cHBvcnRlZE9wZXJhdGlvbkV4Y2VwdGlvbi5raW5kID0gJ1Vuc3VwcG9ydGVkT3BlcmF0aW9uRXhjZXB0aW9uJzsKCSAgICByZXR1cm4gVW5zdXBwb3J0ZWRPcGVyYXRpb25FeGNlcHRpb247Cgl9KEV4Y2VwdGlvbl8xJDYuZGVmYXVsdCkpOwoJVW5zdXBwb3J0ZWRPcGVyYXRpb25FeGNlcHRpb24kMS5kZWZhdWx0ID0gVW5zdXBwb3J0ZWRPcGVyYXRpb25FeGNlcHRpb247CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KFN0cmluZ0VuY29kaW5nJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCXZhciBVbnN1cHBvcnRlZE9wZXJhdGlvbkV4Y2VwdGlvbl8xJDEgPSBVbnN1cHBvcnRlZE9wZXJhdGlvbkV4Y2VwdGlvbiQxOwoJdmFyIENoYXJhY3RlclNldEVDSV8xJDIgPSBDaGFyYWN0ZXJTZXRFQ0k7CgkvKioKCSAqIFJlc3BvbnNpYmxlIGZvciBlbi9kZWNvZGluZyBzdHJpbmdzLgoJICovCgl2YXIgU3RyaW5nRW5jb2RpbmcgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7CgkgICAgZnVuY3Rpb24gU3RyaW5nRW5jb2RpbmcoKSB7CgkgICAgfQoJICAgIC8qKgoJICAgICAqIERlY29kZXMgc29tZSBVaW50OEFycmF5IHRvIGEgc3RyaW5nIGZvcm1hdC4KCSAgICAgKi8KCSAgICBTdHJpbmdFbmNvZGluZy5kZWNvZGUgPSBmdW5jdGlvbiAoYnl0ZXMsIGVuY29kaW5nKSB7CgkgICAgICAgIHZhciBlbmNvZGluZ05hbWUgPSB0aGlzLmVuY29kaW5nTmFtZShlbmNvZGluZyk7CgkgICAgICAgIGlmICh0aGlzLmN1c3RvbURlY29kZXIpIHsKCSAgICAgICAgICAgIHJldHVybiB0aGlzLmN1c3RvbURlY29kZXIoYnl0ZXMsIGVuY29kaW5nTmFtZSk7CgkgICAgICAgIH0KCSAgICAgICAgLy8gSW5jcmVhc2VzIGJyb3dzZXIgc3VwcG9ydC4KCSAgICAgICAgaWYgKHR5cGVvZiBUZXh0RGVjb2RlciA9PT0gJ3VuZGVmaW5lZCcgfHwgdGhpcy5zaG91bGREZWNvZGVPbkZhbGxiYWNrKGVuY29kaW5nTmFtZSkpIHsKCSAgICAgICAgICAgIHJldHVybiB0aGlzLmRlY29kZUZhbGxiYWNrKGJ5dGVzLCBlbmNvZGluZ05hbWUpOwoJICAgICAgICB9CgkgICAgICAgIHJldHVybiBuZXcgVGV4dERlY29kZXIoZW5jb2RpbmdOYW1lKS5kZWNvZGUoYnl0ZXMpOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQ2hlY2tzIGlmIHRoZSBkZWNvZGluZyBtZXRob2Qgc2hvdWxkIHVzZSB0aGUgZmFsbGJhY2sgZm9yIGRlY29kaW5nCgkgICAgICogb25jZSBOb2RlIFRleHREZWNvZGVyIGRvZXNuJ3Qgc3VwcG9ydCBhbGwgZW5jb2RpbmcgZm9ybWF0cy4KCSAgICAgKgoJICAgICAqIEBwYXJhbSBlbmNvZGluZ05hbWUKCSAgICAgKi8KCSAgICBTdHJpbmdFbmNvZGluZy5zaG91bGREZWNvZGVPbkZhbGxiYWNrID0gZnVuY3Rpb24gKGVuY29kaW5nTmFtZSkgewoJICAgICAgICByZXR1cm4gIVN0cmluZ0VuY29kaW5nLmlzQnJvd3NlcigpICYmIGVuY29kaW5nTmFtZSA9PT0gJ0lTTy04ODU5LTEnOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogRW5jb2RlcyBzb21lIHN0cmluZyBpbnRvIGEgVWludDhBcnJheS4KCSAgICAgKi8KCSAgICBTdHJpbmdFbmNvZGluZy5lbmNvZGUgPSBmdW5jdGlvbiAocywgZW5jb2RpbmcpIHsKCSAgICAgICAgdmFyIGVuY29kaW5nTmFtZSA9IHRoaXMuZW5jb2RpbmdOYW1lKGVuY29kaW5nKTsKCSAgICAgICAgaWYgKHRoaXMuY3VzdG9tRW5jb2RlcikgewoJICAgICAgICAgICAgcmV0dXJuIHRoaXMuY3VzdG9tRW5jb2RlcihzLCBlbmNvZGluZ05hbWUpOwoJICAgICAgICB9CgkgICAgICAgIC8vIEluY3JlYXNlcyBicm93c2VyIHN1cHBvcnQuCgkgICAgICAgIGlmICh0eXBlb2YgVGV4dEVuY29kZXIgPT09ICd1bmRlZmluZWQnKSB7CgkgICAgICAgICAgICByZXR1cm4gdGhpcy5lbmNvZGVGYWxsYmFjayhzKTsKCSAgICAgICAgfQoJICAgICAgICAvLyBUZXh0RW5jb2RlciBvbmx5IGVuY29kZXMgdG8gVVRGOCBieSBkZWZhdWx0IGFzIHNwZWNpZmllZCBieSBlbmNvZGluZy5zcGVjLndoYXR3Zy5vcmcKCSAgICAgICAgcmV0dXJuIG5ldyBUZXh0RW5jb2RlcigpLmVuY29kZShzKTsKCSAgICB9OwoJICAgIFN0cmluZ0VuY29kaW5nLmlzQnJvd3NlciA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuICh0eXBlb2Ygd2luZG93ICE9PSAndW5kZWZpbmVkJyAmJiB7fS50b1N0cmluZy5jYWxsKHdpbmRvdykgPT09ICdbb2JqZWN0IFdpbmRvd10nKTsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIFJldHVybnMgdGhlIHN0cmluZyB2YWx1ZSBmcm9tIHNvbWUgZW5jb2RpbmcgY2hhcmFjdGVyIHNldC4KCSAgICAgKi8KCSAgICBTdHJpbmdFbmNvZGluZy5lbmNvZGluZ05hbWUgPSBmdW5jdGlvbiAoZW5jb2RpbmcpIHsKCSAgICAgICAgcmV0dXJuIHR5cGVvZiBlbmNvZGluZyA9PT0gJ3N0cmluZycKCSAgICAgICAgICAgID8gZW5jb2RpbmcKCSAgICAgICAgICAgIDogZW5jb2RpbmcuZ2V0TmFtZSgpOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogUmV0dXJucyBjaGFyYWN0ZXIgc2V0IGZyb20gc29tZSBlbmNvZGluZyBjaGFyYWN0ZXIgc2V0LgoJICAgICAqLwoJICAgIFN0cmluZ0VuY29kaW5nLmVuY29kaW5nQ2hhcmFjdGVyU2V0ID0gZnVuY3Rpb24gKGVuY29kaW5nKSB7CgkgICAgICAgIGlmIChlbmNvZGluZyBpbnN0YW5jZW9mIENoYXJhY3RlclNldEVDSV8xJDIuZGVmYXVsdCkgewoJICAgICAgICAgICAgcmV0dXJuIGVuY29kaW5nOwoJICAgICAgICB9CgkgICAgICAgIHJldHVybiBDaGFyYWN0ZXJTZXRFQ0lfMSQyLmRlZmF1bHQuZ2V0Q2hhcmFjdGVyU2V0RUNJQnlOYW1lKGVuY29kaW5nKTsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIFJ1bnMgYSBmYWxsYmFjayBmb3IgdGhlIG5hdGl2ZSBkZWNvZGluZyBmdW5jaW9uLgoJICAgICAqLwoJICAgIFN0cmluZ0VuY29kaW5nLmRlY29kZUZhbGxiYWNrID0gZnVuY3Rpb24gKGJ5dGVzLCBlbmNvZGluZykgewoJICAgICAgICB2YXIgY2hhcmFjdGVyU2V0ID0gdGhpcy5lbmNvZGluZ0NoYXJhY3RlclNldChlbmNvZGluZyk7CgkgICAgICAgIGlmIChTdHJpbmdFbmNvZGluZy5pc0RlY29kZUZhbGxiYWNrU3VwcG9ydGVkKGNoYXJhY3RlclNldCkpIHsKCSAgICAgICAgICAgIHZhciBzID0gJyc7CgkgICAgICAgICAgICBmb3IgKHZhciBpID0gMCwgbGVuZ3RoXzEgPSBieXRlcy5sZW5ndGg7IGkgPCBsZW5ndGhfMTsgaSsrKSB7CgkgICAgICAgICAgICAgICAgdmFyIGggPSBieXRlc1tpXS50b1N0cmluZygxNik7CgkgICAgICAgICAgICAgICAgaWYgKGgubGVuZ3RoIDwgMikgewoJICAgICAgICAgICAgICAgICAgICBoID0gJzAnICsgaDsKCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgcyArPSAnJScgKyBoOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgcmV0dXJuIGRlY29kZVVSSUNvbXBvbmVudChzKTsKCSAgICAgICAgfQoJICAgICAgICBpZiAoY2hhcmFjdGVyU2V0LmVxdWFscyhDaGFyYWN0ZXJTZXRFQ0lfMSQyLmRlZmF1bHQuVW5pY29kZUJpZ1VubWFya2VkKSkgewoJICAgICAgICAgICAgcmV0dXJuIFN0cmluZy5mcm9tQ2hhckNvZGUuYXBwbHkobnVsbCwgbmV3IFVpbnQxNkFycmF5KGJ5dGVzLmJ1ZmZlcikpOwoJICAgICAgICB9CgkgICAgICAgIHRocm93IG5ldyBVbnN1cHBvcnRlZE9wZXJhdGlvbkV4Y2VwdGlvbl8xJDEuZGVmYXVsdCgiRW5jb2RpbmcgIiArIHRoaXMuZW5jb2RpbmdOYW1lKGVuY29kaW5nKSArICIgbm90IHN1cHBvcnRlZCBieSBmYWxsYmFjay4iKTsKCSAgICB9OwoJICAgIFN0cmluZ0VuY29kaW5nLmlzRGVjb2RlRmFsbGJhY2tTdXBwb3J0ZWQgPSBmdW5jdGlvbiAoY2hhcmFjdGVyU2V0KSB7CgkgICAgICAgIHJldHVybiBjaGFyYWN0ZXJTZXQuZXF1YWxzKENoYXJhY3RlclNldEVDSV8xJDIuZGVmYXVsdC5VVEY4KSB8fAoJICAgICAgICAgICAgY2hhcmFjdGVyU2V0LmVxdWFscyhDaGFyYWN0ZXJTZXRFQ0lfMSQyLmRlZmF1bHQuSVNPODg1OV8xKSB8fAoJICAgICAgICAgICAgY2hhcmFjdGVyU2V0LmVxdWFscyhDaGFyYWN0ZXJTZXRFQ0lfMSQyLmRlZmF1bHQuQVNDSUkpOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogUnVucyBhIGZhbGxiYWNrIGZvciB0aGUgbmF0aXZlIGVuY29kaW5nIGZ1bmNpb24uCgkgICAgICoKCSAgICAgKiBAc2VlIGh0dHBzOi8vc3RhY2tvdmVyZmxvdy5jb20vYS8xNzE5Mjg0NS80MzY3NjgzCgkgICAgICovCgkgICAgU3RyaW5nRW5jb2RpbmcuZW5jb2RlRmFsbGJhY2sgPSBmdW5jdGlvbiAocykgewoJICAgICAgICB2YXIgZW5jb2RlZFVSSXN0cmluZyA9IGJ0b2EodW5lc2NhcGUoZW5jb2RlVVJJQ29tcG9uZW50KHMpKSk7CgkgICAgICAgIHZhciBjaGFyTGlzdCA9IGVuY29kZWRVUklzdHJpbmcuc3BsaXQoJycpOwoJICAgICAgICB2YXIgdWludEFycmF5ID0gW107CgkgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgY2hhckxpc3QubGVuZ3RoOyBpKyspIHsKCSAgICAgICAgICAgIHVpbnRBcnJheS5wdXNoKGNoYXJMaXN0W2ldLmNoYXJDb2RlQXQoMCkpOwoJICAgICAgICB9CgkgICAgICAgIHJldHVybiBuZXcgVWludDhBcnJheSh1aW50QXJyYXkpOwoJICAgIH07CgkgICAgcmV0dXJuIFN0cmluZ0VuY29kaW5nOwoJfSgpKTsKCVN0cmluZ0VuY29kaW5nJDEuZGVmYXVsdCA9IFN0cmluZ0VuY29kaW5nOwoKCS8qCgkgKiBDb3B5cmlnaHQgKEMpIDIwMTAgWlhpbmcgYXV0aG9ycwoJICoKCSAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoJICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoJICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkgKgoJICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKCSAqCgkgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCgkgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoJICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCgkgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCSAqLwoJT2JqZWN0LmRlZmluZVByb3BlcnR5KFN0cmluZ1V0aWxzJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCS8qbmFtZXNwYWNlIGNvbS5nb29nbGUuenhpbmcuY29tbW9uIHsqLwoJLyppbXBvcnQgamF2YS5uaW8uY2hhcnNldC5DaGFyc2V0OyovCgkvKmltcG9ydCBqYXZhLnV0aWwuTWFwOyovCgl2YXIgRGVjb2RlSGludFR5cGVfMSQzID0gRGVjb2RlSGludFR5cGUkMTsKCXZhciBDaGFyYWN0ZXJTZXRFQ0lfMSQxID0gQ2hhcmFjdGVyU2V0RUNJOwoJdmFyIFN0cmluZ0VuY29kaW5nXzEkMSA9IFN0cmluZ0VuY29kaW5nJDE7CgkvKioKCSAqIENvbW1vbiBzdHJpbmctcmVsYXRlZCBmdW5jdGlvbnMuCgkgKgoJICogQGF1dGhvciBTZWFuIE93ZW4KCSAqIEBhdXRob3IgQWxleCBEdXByZQoJICovCgl2YXIgU3RyaW5nVXRpbHMgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7CgkgICAgZnVuY3Rpb24gU3RyaW5nVXRpbHMoKSB7CgkgICAgfQoJICAgIC8vIFNISUZUX0pJUy5lcXVhbHNJZ25vcmVDYXNlKFBMQVRGT1JNX0RFRkFVTFRfRU5DT0RJTkcpIHx8CgkgICAgLy8gRVVDX0pQLmVxdWFsc0lnbm9yZUNhc2UoUExBVEZPUk1fREVGQVVMVF9FTkNPRElORyk7CgkgICAgU3RyaW5nVXRpbHMuY2FzdEFzTm9uVXRmOENoYXIgPSBmdW5jdGlvbiAoY29kZSwgZW5jb2RpbmcpIHsKCSAgICAgICAgaWYgKGVuY29kaW5nID09PSB2b2lkIDApIHsgZW5jb2RpbmcgPSBudWxsOyB9CgkgICAgICAgIC8vIElTTyA4ODU5LTEgaXMgdGhlIEphdmEgZGVmYXVsdCBhcyBVVEYtOCBpcyBKYXZhU2NyaXB0cwoJICAgICAgICAvLyB5b3UgY2FuIHNlZSB0aGlzIG1ldGhvZCBhcyBhIEphdmEgdmVyc2lvbiBvZiBTdHJpbmcuZnJvbUNoYXJDb2RlCgkgICAgICAgIHZhciBlID0gZW5jb2RpbmcgPyBlbmNvZGluZy5nZXROYW1lKCkgOiB0aGlzLklTTzg4NTkxOwoJICAgICAgICAvLyB1c2UgcGFzc2VkIGZvcm1hdCAoZnJvbUNoYXJDb2RlIHdpbGwgcmV0dXJuIFVURjggZW5jb2RpbmcpCgkgICAgICAgIHJldHVybiBTdHJpbmdFbmNvZGluZ18xJDEuZGVmYXVsdC5kZWNvZGUobmV3IFVpbnQ4QXJyYXkoW2NvZGVdKSwgZSk7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcGFyYW0gYnl0ZXMgYnl0ZXMgZW5jb2RpbmcgYSBzdHJpbmcsIHdob3NlIGVuY29kaW5nIHNob3VsZCBiZSBndWVzc2VkCgkgICAgICogQHBhcmFtIGhpbnRzIGRlY29kZSBoaW50cyBpZiBhcHBsaWNhYmxlCgkgICAgICogQHJldHVybiBuYW1lIG9mIGd1ZXNzZWQgZW5jb2Rpbmc7IGF0IHRoZSBtb21lbnQgd2lsbCBvbmx5IGd1ZXNzIG9uZSBvZjoKCSAgICAgKiAge0BsaW5rICNTSElGVF9KSVN9LCB7QGxpbmsgI1VURjh9LCB7QGxpbmsgI0lTTzg4NTkxfSwgb3IgdGhlIHBsYXRmb3JtCgkgICAgICogIGRlZmF1bHQgZW5jb2RpbmcgaWYgbm9uZSBvZiB0aGVzZSBjYW4gcG9zc2libHkgYmUgY29ycmVjdAoJICAgICAqLwoJICAgIFN0cmluZ1V0aWxzLmd1ZXNzRW5jb2RpbmcgPSBmdW5jdGlvbiAoYnl0ZXMsIGhpbnRzKSB7CgkgICAgICAgIGlmIChoaW50cyAhPT0gbnVsbCAmJiBoaW50cyAhPT0gdW5kZWZpbmVkICYmIHVuZGVmaW5lZCAhPT0gaGludHMuZ2V0KERlY29kZUhpbnRUeXBlXzEkMy5kZWZhdWx0LkNIQVJBQ1RFUl9TRVQpKSB7CgkgICAgICAgICAgICByZXR1cm4gaGludHMuZ2V0KERlY29kZUhpbnRUeXBlXzEkMy5kZWZhdWx0LkNIQVJBQ1RFUl9TRVQpLnRvU3RyaW5nKCk7CgkgICAgICAgIH0KCSAgICAgICAgLy8gRm9yIG5vdywgbWVyZWx5IHRyaWVzIHRvIGRpc3Rpbmd1aXNoIElTTy04ODU5LTEsIFVURi04IGFuZCBTaGlmdF9KSVMsCgkgICAgICAgIC8vIHdoaWNoIHNob3VsZCBiZSBieSBmYXIgdGhlIG1vc3QgY29tbW9uIGVuY29kaW5ncy4KCSAgICAgICAgdmFyIGxlbmd0aCA9IGJ5dGVzLmxlbmd0aDsKCSAgICAgICAgdmFyIGNhbkJlSVNPODg1OTEgPSB0cnVlOwoJICAgICAgICB2YXIgY2FuQmVTaGlmdEpJUyA9IHRydWU7CgkgICAgICAgIHZhciBjYW5CZVVURjggPSB0cnVlOwoJICAgICAgICB2YXIgdXRmOEJ5dGVzTGVmdCA9IDA7CgkgICAgICAgIC8vIGludCB1dGY4TG93Q2hhcnMgPSAwCgkgICAgICAgIHZhciB1dGYyQnl0ZXNDaGFycyA9IDA7CgkgICAgICAgIHZhciB1dGYzQnl0ZXNDaGFycyA9IDA7CgkgICAgICAgIHZhciB1dGY0Qnl0ZXNDaGFycyA9IDA7CgkgICAgICAgIHZhciBzamlzQnl0ZXNMZWZ0ID0gMDsKCSAgICAgICAgLy8gaW50IHNqaXNMb3dDaGFycyA9IDAKCSAgICAgICAgdmFyIHNqaXNLYXRha2FuYUNoYXJzID0gMDsKCSAgICAgICAgLy8gaW50IHNqaXNEb3VibGVCeXRlc0NoYXJzID0gMAoJICAgICAgICB2YXIgc2ppc0N1ckthdGFrYW5hV29yZExlbmd0aCA9IDA7CgkgICAgICAgIHZhciBzamlzQ3VyRG91YmxlQnl0ZXNXb3JkTGVuZ3RoID0gMDsKCSAgICAgICAgdmFyIHNqaXNNYXhLYXRha2FuYVdvcmRMZW5ndGggPSAwOwoJICAgICAgICB2YXIgc2ppc01heERvdWJsZUJ5dGVzV29yZExlbmd0aCA9IDA7CgkgICAgICAgIC8vIGludCBpc29Mb3dDaGFycyA9IDAKCSAgICAgICAgLy8gaW50IGlzb0hpZ2hDaGFycyA9IDAKCSAgICAgICAgdmFyIGlzb0hpZ2hPdGhlciA9IDA7CgkgICAgICAgIHZhciB1dGY4Ym9tID0gYnl0ZXMubGVuZ3RoID4gMyAmJgoJICAgICAgICAgICAgYnl0ZXNbMF0gPT09IC8qKGJ5dGUpICovIDB4RUYgJiYKCSAgICAgICAgICAgIGJ5dGVzWzFdID09PSAvKihieXRlKSAqLyAweEJCICYmCgkgICAgICAgICAgICBieXRlc1syXSA9PT0gLyooYnl0ZSkgKi8gMHhCRjsKCSAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW5ndGggJiYgKGNhbkJlSVNPODg1OTEgfHwgY2FuQmVTaGlmdEpJUyB8fCBjYW5CZVVURjgpOyBpKyspIHsKCSAgICAgICAgICAgIHZhciB2YWx1ZSA9IGJ5dGVzW2ldICYgMHhGRjsKCSAgICAgICAgICAgIC8vIFVURi04IHN0dWZmCgkgICAgICAgICAgICBpZiAoY2FuQmVVVEY4KSB7CgkgICAgICAgICAgICAgICAgaWYgKHV0ZjhCeXRlc0xlZnQgPiAwKSB7CgkgICAgICAgICAgICAgICAgICAgIGlmICgodmFsdWUgJiAweDgwKSA9PT0gMCkgewoJICAgICAgICAgICAgICAgICAgICAgICAgY2FuQmVVVEY4ID0gZmFsc2U7CgkgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICAgICAgZWxzZSB7CgkgICAgICAgICAgICAgICAgICAgICAgICB1dGY4Qnl0ZXNMZWZ0LS07CgkgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgZWxzZSBpZiAoKHZhbHVlICYgMHg4MCkgIT09IDApIHsKCSAgICAgICAgICAgICAgICAgICAgaWYgKCh2YWx1ZSAmIDB4NDApID09PSAwKSB7CgkgICAgICAgICAgICAgICAgICAgICAgICBjYW5CZVVURjggPSBmYWxzZTsKCSAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICBlbHNlIHsKCSAgICAgICAgICAgICAgICAgICAgICAgIHV0ZjhCeXRlc0xlZnQrKzsKCSAgICAgICAgICAgICAgICAgICAgICAgIGlmICgodmFsdWUgJiAweDIwKSA9PT0gMCkgewoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIHV0ZjJCeXRlc0NoYXJzKys7CgkgICAgICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICB1dGY4Qnl0ZXNMZWZ0Kys7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCh2YWx1ZSAmIDB4MTApID09PSAwKSB7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHV0ZjNCeXRlc0NoYXJzKys7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UgewoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1dGY4Qnl0ZXNMZWZ0Kys7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICgodmFsdWUgJiAweDA4KSA9PT0gMCkgewoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdXRmNEJ5dGVzQ2hhcnMrKzsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhbkJlVVRGOCA9IGZhbHNlOwoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgfSAvLyBlbHNlIHsKCSAgICAgICAgICAgICAgICAvLyB1dGY4TG93Q2hhcnMrKwoJICAgICAgICAgICAgICAgIC8vIH0KCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIC8vIElTTy04ODU5LTEgc3R1ZmYKCSAgICAgICAgICAgIGlmIChjYW5CZUlTTzg4NTkxKSB7CgkgICAgICAgICAgICAgICAgaWYgKHZhbHVlID4gMHg3RiAmJiB2YWx1ZSA8IDB4QTApIHsKCSAgICAgICAgICAgICAgICAgICAgY2FuQmVJU084ODU5MSA9IGZhbHNlOwoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICBlbHNlIGlmICh2YWx1ZSA+IDB4OUYpIHsKCSAgICAgICAgICAgICAgICAgICAgaWYgKHZhbHVlIDwgMHhDMCB8fCB2YWx1ZSA9PT0gMHhENyB8fCB2YWx1ZSA9PT0gMHhGNykgewoJICAgICAgICAgICAgICAgICAgICAgICAgaXNvSGlnaE90aGVyKys7CgkgICAgICAgICAgICAgICAgICAgIH0gLy8gZWxzZSB7CgkgICAgICAgICAgICAgICAgICAgIC8vIGlzb0hpZ2hDaGFycysrCgkgICAgICAgICAgICAgICAgICAgIC8vIH0KCSAgICAgICAgICAgICAgICB9IC8vIGVsc2UgewoJICAgICAgICAgICAgICAgIC8vIGlzb0xvd0NoYXJzKysKCSAgICAgICAgICAgICAgICAvLyB9CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICAvLyBTaGlmdF9KSVMgc3R1ZmYKCSAgICAgICAgICAgIGlmIChjYW5CZVNoaWZ0SklTKSB7CgkgICAgICAgICAgICAgICAgaWYgKHNqaXNCeXRlc0xlZnQgPiAwKSB7CgkgICAgICAgICAgICAgICAgICAgIGlmICh2YWx1ZSA8IDB4NDAgfHwgdmFsdWUgPT09IDB4N0YgfHwgdmFsdWUgPiAweEZDKSB7CgkgICAgICAgICAgICAgICAgICAgICAgICBjYW5CZVNoaWZ0SklTID0gZmFsc2U7CgkgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICAgICAgZWxzZSB7CgkgICAgICAgICAgICAgICAgICAgICAgICBzamlzQnl0ZXNMZWZ0LS07CgkgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgZWxzZSBpZiAodmFsdWUgPT09IDB4ODAgfHwgdmFsdWUgPT09IDB4QTAgfHwgdmFsdWUgPiAweEVGKSB7CgkgICAgICAgICAgICAgICAgICAgIGNhbkJlU2hpZnRKSVMgPSBmYWxzZTsKCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgZWxzZSBpZiAodmFsdWUgPiAweEEwICYmIHZhbHVlIDwgMHhFMCkgewoJICAgICAgICAgICAgICAgICAgICBzamlzS2F0YWthbmFDaGFycysrOwoJICAgICAgICAgICAgICAgICAgICBzamlzQ3VyRG91YmxlQnl0ZXNXb3JkTGVuZ3RoID0gMDsKCSAgICAgICAgICAgICAgICAgICAgc2ppc0N1ckthdGFrYW5hV29yZExlbmd0aCsrOwoJICAgICAgICAgICAgICAgICAgICBpZiAoc2ppc0N1ckthdGFrYW5hV29yZExlbmd0aCA+IHNqaXNNYXhLYXRha2FuYVdvcmRMZW5ndGgpIHsKCSAgICAgICAgICAgICAgICAgICAgICAgIHNqaXNNYXhLYXRha2FuYVdvcmRMZW5ndGggPSBzamlzQ3VyS2F0YWthbmFXb3JkTGVuZ3RoOwoJICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgIGVsc2UgaWYgKHZhbHVlID4gMHg3RikgewoJICAgICAgICAgICAgICAgICAgICBzamlzQnl0ZXNMZWZ0Kys7CgkgICAgICAgICAgICAgICAgICAgIC8vIHNqaXNEb3VibGVCeXRlc0NoYXJzKysKCSAgICAgICAgICAgICAgICAgICAgc2ppc0N1ckthdGFrYW5hV29yZExlbmd0aCA9IDA7CgkgICAgICAgICAgICAgICAgICAgIHNqaXNDdXJEb3VibGVCeXRlc1dvcmRMZW5ndGgrKzsKCSAgICAgICAgICAgICAgICAgICAgaWYgKHNqaXNDdXJEb3VibGVCeXRlc1dvcmRMZW5ndGggPiBzamlzTWF4RG91YmxlQnl0ZXNXb3JkTGVuZ3RoKSB7CgkgICAgICAgICAgICAgICAgICAgICAgICBzamlzTWF4RG91YmxlQnl0ZXNXb3JkTGVuZ3RoID0gc2ppc0N1ckRvdWJsZUJ5dGVzV29yZExlbmd0aDsKCSAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICBlbHNlIHsKCSAgICAgICAgICAgICAgICAgICAgLy8gc2ppc0xvd0NoYXJzKysKCSAgICAgICAgICAgICAgICAgICAgc2ppc0N1ckthdGFrYW5hV29yZExlbmd0aCA9IDA7CgkgICAgICAgICAgICAgICAgICAgIHNqaXNDdXJEb3VibGVCeXRlc1dvcmRMZW5ndGggPSAwOwoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgIH0KCSAgICAgICAgfQoJICAgICAgICBpZiAoY2FuQmVVVEY4ICYmIHV0ZjhCeXRlc0xlZnQgPiAwKSB7CgkgICAgICAgICAgICBjYW5CZVVURjggPSBmYWxzZTsKCSAgICAgICAgfQoJICAgICAgICBpZiAoY2FuQmVTaGlmdEpJUyAmJiBzamlzQnl0ZXNMZWZ0ID4gMCkgewoJICAgICAgICAgICAgY2FuQmVTaGlmdEpJUyA9IGZhbHNlOwoJICAgICAgICB9CgkgICAgICAgIC8vIEVhc3kgLS0gaWYgdGhlcmUgaXMgQk9NIG9yIGF0IGxlYXN0IDEgdmFsaWQgbm90LXNpbmdsZSBieXRlIGNoYXJhY3RlciAoYW5kIG5vIGV2aWRlbmNlIGl0IGNhbid0IGJlIFVURi04KSwgZG9uZQoJICAgICAgICBpZiAoY2FuQmVVVEY4ICYmICh1dGY4Ym9tIHx8IHV0ZjJCeXRlc0NoYXJzICsgdXRmM0J5dGVzQ2hhcnMgKyB1dGY0Qnl0ZXNDaGFycyA+IDApKSB7CgkgICAgICAgICAgICByZXR1cm4gU3RyaW5nVXRpbHMuVVRGODsKCSAgICAgICAgfQoJICAgICAgICAvLyBFYXN5IC0tIGlmIGFzc3VtaW5nIFNoaWZ0X0pJUyBvciBhdCBsZWFzdCAzIHZhbGlkIGNvbnNlY3V0aXZlIG5vdC1hc2NpaSBjaGFyYWN0ZXJzIChhbmQgbm8gZXZpZGVuY2UgaXQgY2FuJ3QgYmUpLCBkb25lCgkgICAgICAgIGlmIChjYW5CZVNoaWZ0SklTICYmIChTdHJpbmdVdGlscy5BU1NVTUVfU0hJRlRfSklTIHx8IHNqaXNNYXhLYXRha2FuYVdvcmRMZW5ndGggPj0gMyB8fCBzamlzTWF4RG91YmxlQnl0ZXNXb3JkTGVuZ3RoID49IDMpKSB7CgkgICAgICAgICAgICByZXR1cm4gU3RyaW5nVXRpbHMuU0hJRlRfSklTOwoJICAgICAgICB9CgkgICAgICAgIC8vIERpc3Rpbmd1aXNoaW5nIFNoaWZ0X0pJUyBhbmQgSVNPLTg4NTktMSBjYW4gYmUgYSBsaXR0bGUgdG91Z2ggZm9yIHNob3J0IHdvcmRzLiBUaGUgY3J1ZGUgaGV1cmlzdGljIGlzOgoJICAgICAgICAvLyAtIElmIHdlIHNhdwoJICAgICAgICAvLyAgIC0gb25seSB0d28gY29uc2VjdXRpdmUga2F0YWthbmEgY2hhcnMgaW4gdGhlIHdob2xlIHRleHQsIG9yCgkgICAgICAgIC8vICAgLSBhdCBsZWFzdCAxMCUgb2YgYnl0ZXMgdGhhdCBjb3VsZCBiZSAidXBwZXIiIG5vdC1hbHBoYW51bWVyaWMgTGF0aW4xLAoJICAgICAgICAvLyAtIHRoZW4gd2UgY29uY2x1ZGUgU2hpZnRfSklTLCBlbHNlIElTTy04ODU5LTEKCSAgICAgICAgaWYgKGNhbkJlSVNPODg1OTEgJiYgY2FuQmVTaGlmdEpJUykgewoJICAgICAgICAgICAgcmV0dXJuIChzamlzTWF4S2F0YWthbmFXb3JkTGVuZ3RoID09PSAyICYmIHNqaXNLYXRha2FuYUNoYXJzID09PSAyKSB8fCBpc29IaWdoT3RoZXIgKiAxMCA+PSBsZW5ndGgKCSAgICAgICAgICAgICAgICA/IFN0cmluZ1V0aWxzLlNISUZUX0pJUyA6IFN0cmluZ1V0aWxzLklTTzg4NTkxOwoJICAgICAgICB9CgkgICAgICAgIC8vIE90aGVyd2lzZSwgdHJ5IGluIG9yZGVyIElTTy04ODU5LTEsIFNoaWZ0IEpJUywgVVRGLTggYW5kIGZhbGwgYmFjayB0byBkZWZhdWx0IHBsYXRmb3JtIGVuY29kaW5nCgkgICAgICAgIGlmIChjYW5CZUlTTzg4NTkxKSB7CgkgICAgICAgICAgICByZXR1cm4gU3RyaW5nVXRpbHMuSVNPODg1OTE7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKGNhbkJlU2hpZnRKSVMpIHsKCSAgICAgICAgICAgIHJldHVybiBTdHJpbmdVdGlscy5TSElGVF9KSVM7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKGNhbkJlVVRGOCkgewoJICAgICAgICAgICAgcmV0dXJuIFN0cmluZ1V0aWxzLlVURjg7CgkgICAgICAgIH0KCSAgICAgICAgLy8gT3RoZXJ3aXNlLCB3ZSB0YWtlIGEgd2lsZCBndWVzcyB3aXRoIHBsYXRmb3JtIGVuY29kaW5nCgkgICAgICAgIHJldHVybiBTdHJpbmdVdGlscy5QTEFURk9STV9ERUZBVUxUX0VOQ09ESU5HOwoJICAgIH07CgkgICAgLyoqCgkgICAgICoKCSAgICAgKiBAc2VlIGh0dHBzOi8vc3RhY2tvdmVyZmxvdy5jb20vYS8xMzQzOTcxMS80MzY3NjgzCgkgICAgICoKCSAgICAgKiBAcGFyYW0gYXBwZW5kIFRoZSBuZXcgc3RyaW5nIHRvIGFwcGVuZC4KCSAgICAgKiBAcGFyYW0gYXJncyBBcmd1bWV0cyB2YWx1ZXMgdG8gYmUgZm9ybWF0ZWQuCgkgICAgICovCgkgICAgU3RyaW5nVXRpbHMuZm9ybWF0ID0gZnVuY3Rpb24gKGFwcGVuZCkgewoJICAgICAgICB2YXIgYXJncyA9IFtdOwoJICAgICAgICBmb3IgKHZhciBfaSA9IDE7IF9pIDwgYXJndW1lbnRzLmxlbmd0aDsgX2krKykgewoJICAgICAgICAgICAgYXJnc1tfaSAtIDFdID0gYXJndW1lbnRzW19pXTsKCSAgICAgICAgfQoJICAgICAgICB2YXIgaSA9IC0xOwoJICAgICAgICBmdW5jdGlvbiBjYWxsYmFjayhleHAsIHAwLCBwMSwgcDIsIHAzLCBwNCkgewoJICAgICAgICAgICAgaWYgKGV4cCA9PT0gJyUlJykKCSAgICAgICAgICAgICAgICByZXR1cm4gJyUnOwoJICAgICAgICAgICAgaWYgKGFyZ3NbKytpXSA9PT0gdW5kZWZpbmVkKQoJICAgICAgICAgICAgICAgIHJldHVybiB1bmRlZmluZWQ7CgkgICAgICAgICAgICBleHAgPSBwMiA/IHBhcnNlSW50KHAyLnN1YnN0cigxKSkgOiB1bmRlZmluZWQ7CgkgICAgICAgICAgICB2YXIgYmFzZSA9IHAzID8gcGFyc2VJbnQocDMuc3Vic3RyKDEpKSA6IHVuZGVmaW5lZDsKCSAgICAgICAgICAgIHZhciB2YWw7CgkgICAgICAgICAgICBzd2l0Y2ggKHA0KSB7CgkgICAgICAgICAgICAgICAgY2FzZSAncyc6CgkgICAgICAgICAgICAgICAgICAgIHZhbCA9IGFyZ3NbaV07CgkgICAgICAgICAgICAgICAgICAgIGJyZWFrOwoJICAgICAgICAgICAgICAgIGNhc2UgJ2MnOgoJICAgICAgICAgICAgICAgICAgICB2YWwgPSBhcmdzW2ldWzBdOwoJICAgICAgICAgICAgICAgICAgICBicmVhazsKCSAgICAgICAgICAgICAgICBjYXNlICdmJzoKCSAgICAgICAgICAgICAgICAgICAgdmFsID0gcGFyc2VGbG9hdChhcmdzW2ldKS50b0ZpeGVkKGV4cCk7CgkgICAgICAgICAgICAgICAgICAgIGJyZWFrOwoJICAgICAgICAgICAgICAgIGNhc2UgJ3AnOgoJICAgICAgICAgICAgICAgICAgICB2YWwgPSBwYXJzZUZsb2F0KGFyZ3NbaV0pLnRvUHJlY2lzaW9uKGV4cCk7CgkgICAgICAgICAgICAgICAgICAgIGJyZWFrOwoJICAgICAgICAgICAgICAgIGNhc2UgJ2UnOgoJICAgICAgICAgICAgICAgICAgICB2YWwgPSBwYXJzZUZsb2F0KGFyZ3NbaV0pLnRvRXhwb25lbnRpYWwoZXhwKTsKCSAgICAgICAgICAgICAgICAgICAgYnJlYWs7CgkgICAgICAgICAgICAgICAgY2FzZSAneCc6CgkgICAgICAgICAgICAgICAgICAgIHZhbCA9IHBhcnNlSW50KGFyZ3NbaV0pLnRvU3RyaW5nKGJhc2UgPyBiYXNlIDogMTYpOwoJICAgICAgICAgICAgICAgICAgICBicmVhazsKCSAgICAgICAgICAgICAgICBjYXNlICdkJzoKCSAgICAgICAgICAgICAgICAgICAgdmFsID0gcGFyc2VGbG9hdChwYXJzZUludChhcmdzW2ldLCBiYXNlID8gYmFzZSA6IDEwKS50b1ByZWNpc2lvbihleHApKS50b0ZpeGVkKDApOwoJICAgICAgICAgICAgICAgICAgICBicmVhazsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIHZhbCA9IHR5cGVvZiB2YWwgPT09ICdvYmplY3QnID8gSlNPTi5zdHJpbmdpZnkodmFsKSA6ICgrdmFsKS50b1N0cmluZyhiYXNlKTsKCSAgICAgICAgICAgIHZhciBzaXplID0gcGFyc2VJbnQocDEpOyAvKiBwYWRkaW5nIHNpemUgKi8KCSAgICAgICAgICAgIHZhciBjaCA9IHAxICYmIChwMVswXSArICcnKSA9PT0gJzAnID8gJzAnIDogJyAnOyAvKiBpc251bGw/ICovCgkgICAgICAgICAgICB3aGlsZSAodmFsLmxlbmd0aCA8IHNpemUpCgkgICAgICAgICAgICAgICAgdmFsID0gcDAgIT09IHVuZGVmaW5lZCA/IHZhbCArIGNoIDogY2ggKyB2YWw7IC8qIGlzbWludXM/ICovCgkgICAgICAgICAgICByZXR1cm4gdmFsOwoJICAgICAgICB9CgkgICAgICAgIHZhciByZWdleCA9IC8lKC0pPygwP1swLTldKyk/KFsuXVswLTldKyk/KFsjXVswLTldKyk/KFtzY2ZwZXhkJV0pL2c7CgkgICAgICAgIHJldHVybiBhcHBlbmQucmVwbGFjZShyZWdleCwgY2FsbGJhY2spOwoJICAgIH07CgkgICAgLyoqCgkgICAgICoKCSAgICAgKi8KCSAgICBTdHJpbmdVdGlscy5nZXRCeXRlcyA9IGZ1bmN0aW9uIChzdHIsIGVuY29kaW5nKSB7CgkgICAgICAgIHJldHVybiBTdHJpbmdFbmNvZGluZ18xJDEuZGVmYXVsdC5lbmNvZGUoc3RyLCBlbmNvZGluZyk7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBSZXR1cm5zIHRoZSBjaGFyY29kZSBhdCB0aGUgc3BlY2lmaWVkIGluZGV4IG9yIGF0IGluZGV4IHplcm8uCgkgICAgICovCgkgICAgU3RyaW5nVXRpbHMuZ2V0Q2hhckNvZGUgPSBmdW5jdGlvbiAoc3RyLCBpbmRleCkgewoJICAgICAgICBpZiAoaW5kZXggPT09IHZvaWQgMCkgeyBpbmRleCA9IDA7IH0KCSAgICAgICAgcmV0dXJuIHN0ci5jaGFyQ29kZUF0KGluZGV4KTsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIFJldHVybnMgY2hhciBmb3IgZ2l2ZW4gY2hhcmNvZGUKCSAgICAgKi8KCSAgICBTdHJpbmdVdGlscy5nZXRDaGFyQXQgPSBmdW5jdGlvbiAoY2hhckNvZGUpIHsKCSAgICAgICAgcmV0dXJuIFN0cmluZy5mcm9tQ2hhckNvZGUoY2hhckNvZGUpOwoJICAgIH07CgkgICAgU3RyaW5nVXRpbHMuU0hJRlRfSklTID0gQ2hhcmFjdGVyU2V0RUNJXzEkMS5kZWZhdWx0LlNKSVMuZ2V0TmFtZSgpOyAvLyAiU0pJUyIKCSAgICBTdHJpbmdVdGlscy5HQjIzMTIgPSAnR0IyMzEyJzsKCSAgICBTdHJpbmdVdGlscy5JU084ODU5MSA9IENoYXJhY3RlclNldEVDSV8xJDEuZGVmYXVsdC5JU084ODU5XzEuZ2V0TmFtZSgpOyAvLyAiSVNPODg1OV8xIgoJICAgIFN0cmluZ1V0aWxzLkVVQ19KUCA9ICdFVUNfSlAnOwoJICAgIFN0cmluZ1V0aWxzLlVURjggPSBDaGFyYWN0ZXJTZXRFQ0lfMSQxLmRlZmF1bHQuVVRGOC5nZXROYW1lKCk7IC8vICJVVEY4IgoJICAgIFN0cmluZ1V0aWxzLlBMQVRGT1JNX0RFRkFVTFRfRU5DT0RJTkcgPSBTdHJpbmdVdGlscy5VVEY4OyAvLyAiVVRGOCIvL0NoYXJzZXQuZGVmYXVsdENoYXJzZXQoKS5uYW1lKCkKCSAgICBTdHJpbmdVdGlscy5BU1NVTUVfU0hJRlRfSklTID0gZmFsc2U7CgkgICAgcmV0dXJuIFN0cmluZ1V0aWxzOwoJfSgpKTsKCVN0cmluZ1V0aWxzJDEuZGVmYXVsdCA9IFN0cmluZ1V0aWxzOwoKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShTdHJpbmdCdWlsZGVyJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCXZhciBTdHJpbmdVdGlsc18xJDEgPSBTdHJpbmdVdGlscyQxOwoJdmFyIFN0cmluZ0J1aWxkZXIgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7CgkgICAgZnVuY3Rpb24gU3RyaW5nQnVpbGRlcih2YWx1ZSkgewoJICAgICAgICBpZiAodmFsdWUgPT09IHZvaWQgMCkgeyB2YWx1ZSA9ICcnOyB9CgkgICAgICAgIHRoaXMudmFsdWUgPSB2YWx1ZTsKCSAgICB9CgkgICAgU3RyaW5nQnVpbGRlci5wcm90b3R5cGUuZW5hYmxlRGVjb2RpbmcgPSBmdW5jdGlvbiAoZW5jb2RpbmcpIHsKCSAgICAgICAgdGhpcy5lbmNvZGluZyA9IGVuY29kaW5nOwoJICAgICAgICByZXR1cm4gdGhpczsKCSAgICB9OwoJICAgIFN0cmluZ0J1aWxkZXIucHJvdG90eXBlLmFwcGVuZCA9IGZ1bmN0aW9uIChzKSB7CgkgICAgICAgIGlmICh0eXBlb2YgcyA9PT0gJ3N0cmluZycpIHsKCSAgICAgICAgICAgIHRoaXMudmFsdWUgKz0gcy50b1N0cmluZygpOwoJICAgICAgICB9CgkgICAgICAgIGVsc2UgaWYgKHRoaXMuZW5jb2RpbmcpIHsKCSAgICAgICAgICAgIC8vIHVzZSBwYXNzZWQgZm9ybWF0IChmcm9tQ2hhckNvZGUgd2lsbCByZXR1cm4gVVRGOCBlbmNvZGluZykKCSAgICAgICAgICAgIHRoaXMudmFsdWUgKz0gU3RyaW5nVXRpbHNfMSQxLmRlZmF1bHQuY2FzdEFzTm9uVXRmOENoYXIocywgdGhpcy5lbmNvZGluZyk7CgkgICAgICAgIH0KCSAgICAgICAgZWxzZSB7CgkgICAgICAgICAgICAvLyBjb3JyZWN0bHkgY29udmVydHMgZnJvbSBVVEYtOCwgYnV0IG5vdCBvdGhlciBlbmNvZGluZ3MKCSAgICAgICAgICAgIHRoaXMudmFsdWUgKz0gU3RyaW5nLmZyb21DaGFyQ29kZShzKTsKCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gdGhpczsKCSAgICB9OwoJICAgIFN0cmluZ0J1aWxkZXIucHJvdG90eXBlLmFwcGVuZENoYXJzID0gZnVuY3Rpb24gKHN0ciwgb2Zmc2V0LCBsZW4pIHsKCSAgICAgICAgZm9yICh2YXIgaSA9IG9mZnNldDsgb2Zmc2V0IDwgb2Zmc2V0ICsgbGVuOyBpKyspIHsKCSAgICAgICAgICAgIHRoaXMuYXBwZW5kKHN0cltpXSk7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIHRoaXM7CgkgICAgfTsKCSAgICBTdHJpbmdCdWlsZGVyLnByb3RvdHlwZS5sZW5ndGggPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLnZhbHVlLmxlbmd0aDsKCSAgICB9OwoJICAgIFN0cmluZ0J1aWxkZXIucHJvdG90eXBlLmNoYXJBdCA9IGZ1bmN0aW9uIChuKSB7CgkgICAgICAgIHJldHVybiB0aGlzLnZhbHVlLmNoYXJBdChuKTsKCSAgICB9OwoJICAgIFN0cmluZ0J1aWxkZXIucHJvdG90eXBlLmRlbGV0ZUNoYXJBdCA9IGZ1bmN0aW9uIChuKSB7CgkgICAgICAgIHRoaXMudmFsdWUgPSB0aGlzLnZhbHVlLnN1YnN0cigwLCBuKSArIHRoaXMudmFsdWUuc3Vic3RyaW5nKG4gKyAxKTsKCSAgICB9OwoJICAgIFN0cmluZ0J1aWxkZXIucHJvdG90eXBlLnNldENoYXJBdCA9IGZ1bmN0aW9uIChuLCBjKSB7CgkgICAgICAgIHRoaXMudmFsdWUgPSB0aGlzLnZhbHVlLnN1YnN0cigwLCBuKSArIGMgKyB0aGlzLnZhbHVlLnN1YnN0cihuICsgMSk7CgkgICAgfTsKCSAgICBTdHJpbmdCdWlsZGVyLnByb3RvdHlwZS5zdWJzdHJpbmcgPSBmdW5jdGlvbiAoc3RhcnQsIGVuZCkgewoJICAgICAgICByZXR1cm4gdGhpcy52YWx1ZS5zdWJzdHJpbmcoc3RhcnQsIGVuZCk7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAbm90ZSBoZWxwZXIgbWV0aG9kIGZvciBSU1MgRXhwYW5kZWQKCSAgICAgKi8KCSAgICBTdHJpbmdCdWlsZGVyLnByb3RvdHlwZS5zZXRMZW5ndGhUb1plcm8gPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHRoaXMudmFsdWUgPSAnJzsKCSAgICB9OwoJICAgIFN0cmluZ0J1aWxkZXIucHJvdG90eXBlLnRvU3RyaW5nID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy52YWx1ZTsKCSAgICB9OwoJICAgIFN0cmluZ0J1aWxkZXIucHJvdG90eXBlLmluc2VydCA9IGZ1bmN0aW9uIChuLCBjKSB7CgkgICAgICAgIHRoaXMudmFsdWUgPSB0aGlzLnZhbHVlLnN1YnN0cigwLCBuKSArIGMgKyB0aGlzLnZhbHVlLnN1YnN0cihuICsgYy5sZW5ndGgpOwoJICAgIH07CgkgICAgcmV0dXJuIFN0cmluZ0J1aWxkZXI7Cgl9KCkpOwoJU3RyaW5nQnVpbGRlciQxLmRlZmF1bHQgPSBTdHJpbmdCdWlsZGVyOwoKCS8qCgkgKiBDb3B5cmlnaHQgMjAwNyBaWGluZyBhdXRob3JzCgkgKgoJICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIik7CgkgKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCgkgKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKCSAqCgkgKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAoJICoKCSAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKCSAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCgkgKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4KCSAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKCSAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgoJICovCglPYmplY3QuZGVmaW5lUHJvcGVydHkoQml0TWF0cml4JDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCS8qbmFtZXNwYWNlIGNvbS5nb29nbGUuenhpbmcuY29tbW9uIHsqLwoJLyppbXBvcnQgamF2YS51dGlsLkFycmF5czsqLwoJdmFyIEJpdEFycmF5XzEkMSA9IEJpdEFycmF5JDE7Cgl2YXIgU3lzdGVtXzEkMyA9IFN5c3RlbSQxOwoJdmFyIEFycmF5c18xID0gQXJyYXlzJDE7Cgl2YXIgU3RyaW5nQnVpbGRlcl8xJDIgPSBTdHJpbmdCdWlsZGVyJDE7Cgl2YXIgSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uXzEkNyA9IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbiQxOwoJLyoqCgkgKiA8cD5SZXByZXNlbnRzIGEgMkQgbWF0cml4IG9mIGJpdHMuIEluIGZ1bmN0aW9uIGFyZ3VtZW50cyBiZWxvdywgYW5kIHRocm91Z2hvdXQgdGhlIGNvbW1vbgoJICogbW9kdWxlLCB4IGlzIHRoZSBjb2x1bW4gcG9zaXRpb24sIGFuZCB5IGlzIHRoZSByb3cgcG9zaXRpb24uIFRoZSBvcmRlcmluZyBpcyBhbHdheXMgeCwgeS4KCSAqIFRoZSBvcmlnaW4gaXMgYXQgdGhlIHRvcC1sZWZ0LjwvcD4KCSAqCgkgKiA8cD5JbnRlcm5hbGx5IHRoZSBiaXRzIGFyZSByZXByZXNlbnRlZCBpbiBhIDEtRCBhcnJheSBvZiAzMi1iaXQgaW50cy4gSG93ZXZlciwgZWFjaCByb3cgYmVnaW5zCgkgKiB3aXRoIGEgbmV3IGludC4gVGhpcyBpcyBkb25lIGludGVudGlvbmFsbHkgc28gdGhhdCB3ZSBjYW4gY29weSBvdXQgYSByb3cgaW50byBhIEJpdEFycmF5IHZlcnkKCSAqIGVmZmljaWVudGx5LjwvcD4KCSAqCgkgKiA8cD5UaGUgb3JkZXJpbmcgb2YgYml0cyBpcyByb3ctbWFqb3IuIFdpdGhpbiBlYWNoIGludCwgdGhlIGxlYXN0IHNpZ25pZmljYW50IGJpdHMgYXJlIHVzZWQgZmlyc3QsCgkgKiBtZWFuaW5nIHRoZXkgcmVwcmVzZW50IGxvd2VyIHggdmFsdWVzLiBUaGlzIGlzIGNvbXBhdGlibGUgd2l0aCBCaXRBcnJheSdzIGltcGxlbWVudGF0aW9uLjwvcD4KCSAqCgkgKiBAYXV0aG9yIFNlYW4gT3dlbgoJICogQGF1dGhvciBkc3dpdGtpbkBnb29nbGUuY29tIChEYW5pZWwgU3dpdGtpbikKCSAqLwoJdmFyIEJpdE1hdHJpeCAvKmltcGxlbWVudHMgQ2xvbmVhYmxlKi8gPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7CgkgICAgLyoqCgkgICAgICogQ3JlYXRlcyBhbiBlbXB0eSBzcXVhcmUge0BsaW5rIEJpdE1hdHJpeH0uCgkgICAgICoKCSAgICAgKiBAcGFyYW0gZGltZW5zaW9uIGhlaWdodCBhbmQgd2lkdGgKCSAgICAgKi8KCSAgICAvLyBwdWJsaWMgY29uc3RydWN0b3IoZGltZW5zaW9uOiBudW1iZXIgLyppbnQqLykgewoJICAgIC8vICAgdGhpcyhkaW1lbnNpb24sIGRpbWVuc2lvbikKCSAgICAvLyB9CgkgICAgLyoqCgkgICAgICogQ3JlYXRlcyBhbiBlbXB0eSB7QGxpbmsgQml0TWF0cml4fS4KCSAgICAgKgoJICAgICAqIEBwYXJhbSB3aWR0aCBiaXQgbWF0cml4IHdpZHRoCgkgICAgICogQHBhcmFtIGhlaWdodCBiaXQgbWF0cml4IGhlaWdodAoJICAgICAqLwoJICAgIC8vIHB1YmxpYyBjb25zdHJ1Y3Rvcih3aWR0aDogbnVtYmVyIC8qaW50Ki8sIGhlaWdodDogbnVtYmVyIC8qaW50Ki8pIHsKCSAgICAvLyAgIGlmICh3aWR0aCA8IDEgfHwgaGVpZ2h0IDwgMSkgewoJICAgIC8vICAgICB0aHJvdyBuZXcgSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uKCJCb3RoIGRpbWVuc2lvbnMgbXVzdCBiZSBncmVhdGVyIHRoYW4gMCIpCgkgICAgLy8gICB9CgkgICAgLy8gICB0aGlzLndpZHRoID0gd2lkdGgKCSAgICAvLyAgIHRoaXMuaGVpZ2h0ID0gaGVpZ2h0CgkgICAgLy8gICB0aGlzLnJvd1NpemUgPSAod2lkdGggKyAzMSkgLyAzMgoJICAgIC8vICAgYml0cyA9IG5ldyBpbnRbcm93U2l6ZSAqIGhlaWdodF07CgkgICAgLy8gfQoJICAgIGZ1bmN0aW9uIEJpdE1hdHJpeCh3aWR0aCAvKmludCovLCBoZWlnaHQgLyppbnQqLywgcm93U2l6ZSAvKmludCovLCBiaXRzKSB7CgkgICAgICAgIHRoaXMud2lkdGggPSB3aWR0aDsKCSAgICAgICAgdGhpcy5oZWlnaHQgPSBoZWlnaHQ7CgkgICAgICAgIHRoaXMucm93U2l6ZSA9IHJvd1NpemU7CgkgICAgICAgIHRoaXMuYml0cyA9IGJpdHM7CgkgICAgICAgIGlmICh1bmRlZmluZWQgPT09IGhlaWdodCB8fCBudWxsID09PSBoZWlnaHQpIHsKCSAgICAgICAgICAgIGhlaWdodCA9IHdpZHRoOwoJICAgICAgICB9CgkgICAgICAgIHRoaXMuaGVpZ2h0ID0gaGVpZ2h0OwoJICAgICAgICBpZiAod2lkdGggPCAxIHx8IGhlaWdodCA8IDEpIHsKCSAgICAgICAgICAgIHRocm93IG5ldyBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb25fMSQ3LmRlZmF1bHQoJ0JvdGggZGltZW5zaW9ucyBtdXN0IGJlIGdyZWF0ZXIgdGhhbiAwJyk7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKHVuZGVmaW5lZCA9PT0gcm93U2l6ZSB8fCBudWxsID09PSByb3dTaXplKSB7CgkgICAgICAgICAgICByb3dTaXplID0gTWF0aC5mbG9vcigod2lkdGggKyAzMSkgLyAzMik7CgkgICAgICAgIH0KCSAgICAgICAgdGhpcy5yb3dTaXplID0gcm93U2l6ZTsKCSAgICAgICAgaWYgKHVuZGVmaW5lZCA9PT0gYml0cyB8fCBudWxsID09PSBiaXRzKSB7CgkgICAgICAgICAgICB0aGlzLmJpdHMgPSBuZXcgSW50MzJBcnJheSh0aGlzLnJvd1NpemUgKiB0aGlzLmhlaWdodCk7CgkgICAgICAgIH0KCSAgICB9CgkgICAgLyoqCgkgICAgICogSW50ZXJwcmV0cyBhIDJEIGFycmF5IG9mIGJvb2xlYW5zIGFzIGEge0BsaW5rIEJpdE1hdHJpeH0sIHdoZXJlICJ0cnVlIiBtZWFucyBhbiAib24iIGJpdC4KCSAgICAgKgoJICAgICAqIEBmdW5jdGlvbiBwYXJzZQoJICAgICAqIEBwYXJhbSBpbWFnZSBiaXRzIG9mIHRoZSBpbWFnZSwgYXMgYSByb3ctbWFqb3IgMkQgYXJyYXkuIEVsZW1lbnRzIGFyZSBhcnJheXMgcmVwcmVzZW50aW5nIHJvd3MKCSAgICAgKiBAcmV0dXJuIHtAbGluayBCaXRNYXRyaXh9IHJlcHJlc2VudGF0aW9uIG9mIGltYWdlCgkgICAgICovCgkgICAgQml0TWF0cml4LnBhcnNlRnJvbUJvb2xlYW5BcnJheSA9IGZ1bmN0aW9uIChpbWFnZSkgewoJICAgICAgICB2YXIgaGVpZ2h0ID0gaW1hZ2UubGVuZ3RoOwoJICAgICAgICB2YXIgd2lkdGggPSBpbWFnZVswXS5sZW5ndGg7CgkgICAgICAgIHZhciBiaXRzID0gbmV3IEJpdE1hdHJpeCh3aWR0aCwgaGVpZ2h0KTsKCSAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBoZWlnaHQ7IGkrKykgewoJICAgICAgICAgICAgdmFyIGltYWdlSSA9IGltYWdlW2ldOwoJICAgICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCB3aWR0aDsgaisrKSB7CgkgICAgICAgICAgICAgICAgaWYgKGltYWdlSVtqXSkgewoJICAgICAgICAgICAgICAgICAgICBiaXRzLnNldChqLCBpKTsKCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIGJpdHM7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKgoJICAgICAqIEBmdW5jdGlvbiBwYXJzZQoJICAgICAqIEBwYXJhbSBzdHJpbmdSZXByZXNlbnRhdGlvbgoJICAgICAqIEBwYXJhbSBzZXRTdHJpbmcKCSAgICAgKiBAcGFyYW0gdW5zZXRTdHJpbmcKCSAgICAgKi8KCSAgICBCaXRNYXRyaXgucGFyc2VGcm9tU3RyaW5nID0gZnVuY3Rpb24gKHN0cmluZ1JlcHJlc2VudGF0aW9uLCBzZXRTdHJpbmcsIHVuc2V0U3RyaW5nKSB7CgkgICAgICAgIGlmIChzdHJpbmdSZXByZXNlbnRhdGlvbiA9PT0gbnVsbCkgewoJICAgICAgICAgICAgdGhyb3cgbmV3IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbl8xJDcuZGVmYXVsdCgnc3RyaW5nUmVwcmVzZW50YXRpb24gY2Fubm90IGJlIG51bGwnKTsKCSAgICAgICAgfQoJICAgICAgICB2YXIgYml0cyA9IG5ldyBBcnJheShzdHJpbmdSZXByZXNlbnRhdGlvbi5sZW5ndGgpOwoJICAgICAgICB2YXIgYml0c1BvcyA9IDA7CgkgICAgICAgIHZhciByb3dTdGFydFBvcyA9IDA7CgkgICAgICAgIHZhciByb3dMZW5ndGggPSAtMTsKCSAgICAgICAgdmFyIG5Sb3dzID0gMDsKCSAgICAgICAgdmFyIHBvcyA9IDA7CgkgICAgICAgIHdoaWxlIChwb3MgPCBzdHJpbmdSZXByZXNlbnRhdGlvbi5sZW5ndGgpIHsKCSAgICAgICAgICAgIGlmIChzdHJpbmdSZXByZXNlbnRhdGlvbi5jaGFyQXQocG9zKSA9PT0gJ1xuJyB8fAoJICAgICAgICAgICAgICAgIHN0cmluZ1JlcHJlc2VudGF0aW9uLmNoYXJBdChwb3MpID09PSAnXHInKSB7CgkgICAgICAgICAgICAgICAgaWYgKGJpdHNQb3MgPiByb3dTdGFydFBvcykgewoJICAgICAgICAgICAgICAgICAgICBpZiAocm93TGVuZ3RoID09PSAtMSkgewoJICAgICAgICAgICAgICAgICAgICAgICAgcm93TGVuZ3RoID0gYml0c1BvcyAtIHJvd1N0YXJ0UG9zOwoJICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgIGVsc2UgaWYgKGJpdHNQb3MgLSByb3dTdGFydFBvcyAhPT0gcm93TGVuZ3RoKSB7CgkgICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uXzEkNy5kZWZhdWx0KCdyb3cgbGVuZ3RocyBkbyBub3QgbWF0Y2gnKTsKCSAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICByb3dTdGFydFBvcyA9IGJpdHNQb3M7CgkgICAgICAgICAgICAgICAgICAgIG5Sb3dzKys7CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgIHBvcysrOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgZWxzZSBpZiAoc3RyaW5nUmVwcmVzZW50YXRpb24uc3Vic3RyaW5nKHBvcywgcG9zICsgc2V0U3RyaW5nLmxlbmd0aCkgPT09IHNldFN0cmluZykgewoJICAgICAgICAgICAgICAgIHBvcyArPSBzZXRTdHJpbmcubGVuZ3RoOwoJICAgICAgICAgICAgICAgIGJpdHNbYml0c1Bvc10gPSB0cnVlOwoJICAgICAgICAgICAgICAgIGJpdHNQb3MrKzsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIGVsc2UgaWYgKHN0cmluZ1JlcHJlc2VudGF0aW9uLnN1YnN0cmluZyhwb3MsIHBvcyArIHVuc2V0U3RyaW5nLmxlbmd0aCkgPT09IHVuc2V0U3RyaW5nKSB7CgkgICAgICAgICAgICAgICAgcG9zICs9IHVuc2V0U3RyaW5nLmxlbmd0aDsKCSAgICAgICAgICAgICAgICBiaXRzW2JpdHNQb3NdID0gZmFsc2U7CgkgICAgICAgICAgICAgICAgYml0c1BvcysrOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgZWxzZSB7CgkgICAgICAgICAgICAgICAgdGhyb3cgbmV3IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbl8xJDcuZGVmYXVsdCgnaWxsZWdhbCBjaGFyYWN0ZXIgZW5jb3VudGVyZWQ6ICcgKyBzdHJpbmdSZXByZXNlbnRhdGlvbi5zdWJzdHJpbmcocG9zKSk7CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICAgICAgLy8gbm8gRU9MIGF0IGVuZD8KCSAgICAgICAgaWYgKGJpdHNQb3MgPiByb3dTdGFydFBvcykgewoJICAgICAgICAgICAgaWYgKHJvd0xlbmd0aCA9PT0gLTEpIHsKCSAgICAgICAgICAgICAgICByb3dMZW5ndGggPSBiaXRzUG9zIC0gcm93U3RhcnRQb3M7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBlbHNlIGlmIChiaXRzUG9zIC0gcm93U3RhcnRQb3MgIT09IHJvd0xlbmd0aCkgewoJICAgICAgICAgICAgICAgIHRocm93IG5ldyBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb25fMSQ3LmRlZmF1bHQoJ3JvdyBsZW5ndGhzIGRvIG5vdCBtYXRjaCcpOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgblJvd3MrKzsKCSAgICAgICAgfQoJICAgICAgICB2YXIgbWF0cml4ID0gbmV3IEJpdE1hdHJpeChyb3dMZW5ndGgsIG5Sb3dzKTsKCSAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBiaXRzUG9zOyBpKyspIHsKCSAgICAgICAgICAgIGlmIChiaXRzW2ldKSB7CgkgICAgICAgICAgICAgICAgbWF0cml4LnNldChNYXRoLmZsb29yKGkgJSByb3dMZW5ndGgpLCBNYXRoLmZsb29yKGkgLyByb3dMZW5ndGgpKTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gbWF0cml4OwoJICAgIH07CgkgICAgLyoqCgkgICAgICogPHA+R2V0cyB0aGUgcmVxdWVzdGVkIGJpdCwgd2hlcmUgdHJ1ZSBtZWFucyBibGFjay48L3A+CgkgICAgICoKCSAgICAgKiBAcGFyYW0geCBUaGUgaG9yaXpvbnRhbCBjb21wb25lbnQgKGkuZS4gd2hpY2ggY29sdW1uKQoJICAgICAqIEBwYXJhbSB5IFRoZSB2ZXJ0aWNhbCBjb21wb25lbnQgKGkuZS4gd2hpY2ggcm93KQoJICAgICAqIEByZXR1cm4gdmFsdWUgb2YgZ2l2ZW4gYml0IGluIG1hdHJpeAoJICAgICAqLwoJICAgIEJpdE1hdHJpeC5wcm90b3R5cGUuZ2V0ID0gZnVuY3Rpb24gKHggLyppbnQqLywgeSAvKmludCovKSB7CgkgICAgICAgIHZhciBvZmZzZXQgPSB5ICogdGhpcy5yb3dTaXplICsgTWF0aC5mbG9vcih4IC8gMzIpOwoJICAgICAgICByZXR1cm4gKCh0aGlzLmJpdHNbb2Zmc2V0XSA+Pj4gKHggJiAweDFmKSkgJiAxKSAhPT0gMDsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIDxwPlNldHMgdGhlIGdpdmVuIGJpdCB0byB0cnVlLjwvcD4KCSAgICAgKgoJICAgICAqIEBwYXJhbSB4IFRoZSBob3Jpem9udGFsIGNvbXBvbmVudCAoaS5lLiB3aGljaCBjb2x1bW4pCgkgICAgICogQHBhcmFtIHkgVGhlIHZlcnRpY2FsIGNvbXBvbmVudCAoaS5lLiB3aGljaCByb3cpCgkgICAgICovCgkgICAgQml0TWF0cml4LnByb3RvdHlwZS5zZXQgPSBmdW5jdGlvbiAoeCAvKmludCovLCB5IC8qaW50Ki8pIHsKCSAgICAgICAgdmFyIG9mZnNldCA9IHkgKiB0aGlzLnJvd1NpemUgKyBNYXRoLmZsb29yKHggLyAzMik7CgkgICAgICAgIHRoaXMuYml0c1tvZmZzZXRdIHw9ICgxIDw8ICh4ICYgMHgxZikpICYgMHhGRkZGRkZGRjsKCSAgICB9OwoJICAgIEJpdE1hdHJpeC5wcm90b3R5cGUudW5zZXQgPSBmdW5jdGlvbiAoeCAvKmludCovLCB5IC8qaW50Ki8pIHsKCSAgICAgICAgdmFyIG9mZnNldCA9IHkgKiB0aGlzLnJvd1NpemUgKyBNYXRoLmZsb29yKHggLyAzMik7CgkgICAgICAgIHRoaXMuYml0c1tvZmZzZXRdICY9IH4oKDEgPDwgKHggJiAweDFmKSkgJiAweEZGRkZGRkZGKTsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIDxwPkZsaXBzIHRoZSBnaXZlbiBiaXQuPC9wPgoJICAgICAqCgkgICAgICogQHBhcmFtIHggVGhlIGhvcml6b250YWwgY29tcG9uZW50IChpLmUuIHdoaWNoIGNvbHVtbikKCSAgICAgKiBAcGFyYW0geSBUaGUgdmVydGljYWwgY29tcG9uZW50IChpLmUuIHdoaWNoIHJvdykKCSAgICAgKi8KCSAgICBCaXRNYXRyaXgucHJvdG90eXBlLmZsaXAgPSBmdW5jdGlvbiAoeCAvKmludCovLCB5IC8qaW50Ki8pIHsKCSAgICAgICAgdmFyIG9mZnNldCA9IHkgKiB0aGlzLnJvd1NpemUgKyBNYXRoLmZsb29yKHggLyAzMik7CgkgICAgICAgIHRoaXMuYml0c1tvZmZzZXRdIF49ICgoMSA8PCAoeCAmIDB4MWYpKSAmIDB4RkZGRkZGRkYpOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogRXhjbHVzaXZlLW9yIChYT1IpOiBGbGlwIHRoZSBiaXQgaW4gdGhpcyB7QGNvZGUgQml0TWF0cml4fSBpZiB0aGUgY29ycmVzcG9uZGluZwoJICAgICAqIG1hc2sgYml0IGlzIHNldC4KCSAgICAgKgoJICAgICAqIEBwYXJhbSBtYXNrIFhPUiBtYXNrCgkgICAgICovCgkgICAgQml0TWF0cml4LnByb3RvdHlwZS54b3IgPSBmdW5jdGlvbiAobWFzaykgewoJICAgICAgICBpZiAodGhpcy53aWR0aCAhPT0gbWFzay5nZXRXaWR0aCgpIHx8IHRoaXMuaGVpZ2h0ICE9PSBtYXNrLmdldEhlaWdodCgpCgkgICAgICAgICAgICB8fCB0aGlzLnJvd1NpemUgIT09IG1hc2suZ2V0Um93U2l6ZSgpKSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uXzEkNy5kZWZhdWx0KCdpbnB1dCBtYXRyaXggZGltZW5zaW9ucyBkbyBub3QgbWF0Y2gnKTsKCSAgICAgICAgfQoJICAgICAgICB2YXIgcm93QXJyYXkgPSBuZXcgQml0QXJyYXlfMSQxLmRlZmF1bHQoTWF0aC5mbG9vcih0aGlzLndpZHRoIC8gMzIpICsgMSk7CgkgICAgICAgIHZhciByb3dTaXplID0gdGhpcy5yb3dTaXplOwoJICAgICAgICB2YXIgYml0cyA9IHRoaXMuYml0czsKCSAgICAgICAgZm9yICh2YXIgeSA9IDAsIGhlaWdodCA9IHRoaXMuaGVpZ2h0OyB5IDwgaGVpZ2h0OyB5KyspIHsKCSAgICAgICAgICAgIHZhciBvZmZzZXQgPSB5ICogcm93U2l6ZTsKCSAgICAgICAgICAgIHZhciByb3cgPSBtYXNrLmdldFJvdyh5LCByb3dBcnJheSkuZ2V0Qml0QXJyYXkoKTsKCSAgICAgICAgICAgIGZvciAodmFyIHggPSAwOyB4IDwgcm93U2l6ZTsgeCsrKSB7CgkgICAgICAgICAgICAgICAgYml0c1tvZmZzZXQgKyB4XSBePSByb3dbeF07CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICB9OwoJICAgIC8qKgoJICAgICAqIENsZWFycyBhbGwgYml0cyAoc2V0cyB0byBmYWxzZSkuCgkgICAgICovCgkgICAgQml0TWF0cml4LnByb3RvdHlwZS5jbGVhciA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgdmFyIGJpdHMgPSB0aGlzLmJpdHM7CgkgICAgICAgIHZhciBtYXggPSBiaXRzLmxlbmd0aDsKCSAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBtYXg7IGkrKykgewoJICAgICAgICAgICAgYml0c1tpXSA9IDA7CgkgICAgICAgIH0KCSAgICB9OwoJICAgIC8qKgoJICAgICAqIDxwPlNldHMgYSBzcXVhcmUgcmVnaW9uIG9mIHRoZSBiaXQgbWF0cml4IHRvIHRydWUuPC9wPgoJICAgICAqCgkgICAgICogQHBhcmFtIGxlZnQgVGhlIGhvcml6b250YWwgcG9zaXRpb24gdG8gYmVnaW4gYXQgKGluY2x1c2l2ZSkKCSAgICAgKiBAcGFyYW0gdG9wIFRoZSB2ZXJ0aWNhbCBwb3NpdGlvbiB0byBiZWdpbiBhdCAoaW5jbHVzaXZlKQoJICAgICAqIEBwYXJhbSB3aWR0aCBUaGUgd2lkdGggb2YgdGhlIHJlZ2lvbgoJICAgICAqIEBwYXJhbSBoZWlnaHQgVGhlIGhlaWdodCBvZiB0aGUgcmVnaW9uCgkgICAgICovCgkgICAgQml0TWF0cml4LnByb3RvdHlwZS5zZXRSZWdpb24gPSBmdW5jdGlvbiAobGVmdCAvKmludCovLCB0b3AgLyppbnQqLywgd2lkdGggLyppbnQqLywgaGVpZ2h0IC8qaW50Ki8pIHsKCSAgICAgICAgaWYgKHRvcCA8IDAgfHwgbGVmdCA8IDApIHsKCSAgICAgICAgICAgIHRocm93IG5ldyBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb25fMSQ3LmRlZmF1bHQoJ0xlZnQgYW5kIHRvcCBtdXN0IGJlIG5vbm5lZ2F0aXZlJyk7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKGhlaWdodCA8IDEgfHwgd2lkdGggPCAxKSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uXzEkNy5kZWZhdWx0KCdIZWlnaHQgYW5kIHdpZHRoIG11c3QgYmUgYXQgbGVhc3QgMScpOwoJICAgICAgICB9CgkgICAgICAgIHZhciByaWdodCA9IGxlZnQgKyB3aWR0aDsKCSAgICAgICAgdmFyIGJvdHRvbSA9IHRvcCArIGhlaWdodDsKCSAgICAgICAgaWYgKGJvdHRvbSA+IHRoaXMuaGVpZ2h0IHx8IHJpZ2h0ID4gdGhpcy53aWR0aCkgewoJICAgICAgICAgICAgdGhyb3cgbmV3IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbl8xJDcuZGVmYXVsdCgnVGhlIHJlZ2lvbiBtdXN0IGZpdCBpbnNpZGUgdGhlIG1hdHJpeCcpOwoJICAgICAgICB9CgkgICAgICAgIHZhciByb3dTaXplID0gdGhpcy5yb3dTaXplOwoJICAgICAgICB2YXIgYml0cyA9IHRoaXMuYml0czsKCSAgICAgICAgZm9yICh2YXIgeSA9IHRvcDsgeSA8IGJvdHRvbTsgeSsrKSB7CgkgICAgICAgICAgICB2YXIgb2Zmc2V0ID0geSAqIHJvd1NpemU7CgkgICAgICAgICAgICBmb3IgKHZhciB4ID0gbGVmdDsgeCA8IHJpZ2h0OyB4KyspIHsKCSAgICAgICAgICAgICAgICBiaXRzW29mZnNldCArIE1hdGguZmxvb3IoeCAvIDMyKV0gfD0gKCgxIDw8ICh4ICYgMHgxZikpICYgMHhGRkZGRkZGRik7CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEEgZmFzdCBtZXRob2QgdG8gcmV0cmlldmUgb25lIHJvdyBvZiBkYXRhIGZyb20gdGhlIG1hdHJpeCBhcyBhIEJpdEFycmF5LgoJICAgICAqCgkgICAgICogQHBhcmFtIHkgVGhlIHJvdyB0byByZXRyaWV2ZQoJICAgICAqIEBwYXJhbSByb3cgQW4gb3B0aW9uYWwgY2FsbGVyLWFsbG9jYXRlZCBCaXRBcnJheSwgd2lsbCBiZSBhbGxvY2F0ZWQgaWYgbnVsbCBvciB0b28gc21hbGwKCSAgICAgKiBAcmV0dXJuIFRoZSByZXN1bHRpbmcgQml0QXJyYXkgLSB0aGlzIHJlZmVyZW5jZSBzaG91bGQgYWx3YXlzIGJlIHVzZWQgZXZlbiB3aGVuIHBhc3NpbmcKCSAgICAgKiAgICAgICAgIHlvdXIgb3duIHJvdwoJICAgICAqLwoJICAgIEJpdE1hdHJpeC5wcm90b3R5cGUuZ2V0Um93ID0gZnVuY3Rpb24gKHkgLyppbnQqLywgcm93KSB7CgkgICAgICAgIGlmIChyb3cgPT09IG51bGwgfHwgcm93ID09PSB1bmRlZmluZWQgfHwgcm93LmdldFNpemUoKSA8IHRoaXMud2lkdGgpIHsKCSAgICAgICAgICAgIHJvdyA9IG5ldyBCaXRBcnJheV8xJDEuZGVmYXVsdCh0aGlzLndpZHRoKTsKCSAgICAgICAgfQoJICAgICAgICBlbHNlIHsKCSAgICAgICAgICAgIHJvdy5jbGVhcigpOwoJICAgICAgICB9CgkgICAgICAgIHZhciByb3dTaXplID0gdGhpcy5yb3dTaXplOwoJICAgICAgICB2YXIgYml0cyA9IHRoaXMuYml0czsKCSAgICAgICAgdmFyIG9mZnNldCA9IHkgKiByb3dTaXplOwoJICAgICAgICBmb3IgKHZhciB4ID0gMDsgeCA8IHJvd1NpemU7IHgrKykgewoJICAgICAgICAgICAgcm93LnNldEJ1bGsoeCAqIDMyLCBiaXRzW29mZnNldCArIHhdKTsKCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gcm93OwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQHBhcmFtIHkgcm93IHRvIHNldAoJICAgICAqIEBwYXJhbSByb3cge0BsaW5rIEJpdEFycmF5fSB0byBjb3B5IGZyb20KCSAgICAgKi8KCSAgICBCaXRNYXRyaXgucHJvdG90eXBlLnNldFJvdyA9IGZ1bmN0aW9uICh5IC8qaW50Ki8sIHJvdykgewoJICAgICAgICBTeXN0ZW1fMSQzLmRlZmF1bHQuYXJyYXljb3B5KHJvdy5nZXRCaXRBcnJheSgpLCAwLCB0aGlzLmJpdHMsIHkgKiB0aGlzLnJvd1NpemUsIHRoaXMucm93U2l6ZSk7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBNb2RpZmllcyB0aGlzIHtAY29kZSBCaXRNYXRyaXh9IHRvIHJlcHJlc2VudCB0aGUgc2FtZSBidXQgcm90YXRlZCAxODAgZGVncmVlcwoJICAgICAqLwoJICAgIEJpdE1hdHJpeC5wcm90b3R5cGUucm90YXRlMTgwID0gZnVuY3Rpb24gKCkgewoJICAgICAgICB2YXIgd2lkdGggPSB0aGlzLmdldFdpZHRoKCk7CgkgICAgICAgIHZhciBoZWlnaHQgPSB0aGlzLmdldEhlaWdodCgpOwoJICAgICAgICB2YXIgdG9wUm93ID0gbmV3IEJpdEFycmF5XzEkMS5kZWZhdWx0KHdpZHRoKTsKCSAgICAgICAgdmFyIGJvdHRvbVJvdyA9IG5ldyBCaXRBcnJheV8xJDEuZGVmYXVsdCh3aWR0aCk7CgkgICAgICAgIGZvciAodmFyIGkgPSAwLCBsZW5ndGhfMSA9IE1hdGguZmxvb3IoKGhlaWdodCArIDEpIC8gMik7IGkgPCBsZW5ndGhfMTsgaSsrKSB7CgkgICAgICAgICAgICB0b3BSb3cgPSB0aGlzLmdldFJvdyhpLCB0b3BSb3cpOwoJICAgICAgICAgICAgYm90dG9tUm93ID0gdGhpcy5nZXRSb3coaGVpZ2h0IC0gMSAtIGksIGJvdHRvbVJvdyk7CgkgICAgICAgICAgICB0b3BSb3cucmV2ZXJzZSgpOwoJICAgICAgICAgICAgYm90dG9tUm93LnJldmVyc2UoKTsKCSAgICAgICAgICAgIHRoaXMuc2V0Um93KGksIGJvdHRvbVJvdyk7CgkgICAgICAgICAgICB0aGlzLnNldFJvdyhoZWlnaHQgLSAxIC0gaSwgdG9wUm93KTsKCSAgICAgICAgfQoJICAgIH07CgkgICAgLyoqCgkgICAgICogVGhpcyBpcyB1c2VmdWwgaW4gZGV0ZWN0aW5nIHRoZSBlbmNsb3NpbmcgcmVjdGFuZ2xlIG9mIGEgJ3B1cmUnIGJhcmNvZGUuCgkgICAgICoKCSAgICAgKiBAcmV0dXJuIHtAY29kZSBsZWZ0LHRvcCx3aWR0aCxoZWlnaHR9IGVuY2xvc2luZyByZWN0YW5nbGUgb2YgYWxsIDEgYml0cywgb3IgbnVsbCBpZiBpdCBpcyBhbGwgd2hpdGUKCSAgICAgKi8KCSAgICBCaXRNYXRyaXgucHJvdG90eXBlLmdldEVuY2xvc2luZ1JlY3RhbmdsZSA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgdmFyIHdpZHRoID0gdGhpcy53aWR0aDsKCSAgICAgICAgdmFyIGhlaWdodCA9IHRoaXMuaGVpZ2h0OwoJICAgICAgICB2YXIgcm93U2l6ZSA9IHRoaXMucm93U2l6ZTsKCSAgICAgICAgdmFyIGJpdHMgPSB0aGlzLmJpdHM7CgkgICAgICAgIHZhciBsZWZ0ID0gd2lkdGg7CgkgICAgICAgIHZhciB0b3AgPSBoZWlnaHQ7CgkgICAgICAgIHZhciByaWdodCA9IC0xOwoJICAgICAgICB2YXIgYm90dG9tID0gLTE7CgkgICAgICAgIGZvciAodmFyIHkgPSAwOyB5IDwgaGVpZ2h0OyB5KyspIHsKCSAgICAgICAgICAgIGZvciAodmFyIHgzMiA9IDA7IHgzMiA8IHJvd1NpemU7IHgzMisrKSB7CgkgICAgICAgICAgICAgICAgdmFyIHRoZUJpdHMgPSBiaXRzW3kgKiByb3dTaXplICsgeDMyXTsKCSAgICAgICAgICAgICAgICBpZiAodGhlQml0cyAhPT0gMCkgewoJICAgICAgICAgICAgICAgICAgICBpZiAoeSA8IHRvcCkgewoJICAgICAgICAgICAgICAgICAgICAgICAgdG9wID0geTsKCSAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICBpZiAoeSA+IGJvdHRvbSkgewoJICAgICAgICAgICAgICAgICAgICAgICAgYm90dG9tID0geTsKCSAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICBpZiAoeDMyICogMzIgPCBsZWZ0KSB7CgkgICAgICAgICAgICAgICAgICAgICAgICB2YXIgYml0ID0gMDsKCSAgICAgICAgICAgICAgICAgICAgICAgIHdoaWxlICgoKHRoZUJpdHMgPDwgKDMxIC0gYml0KSkgJiAweEZGRkZGRkZGKSA9PT0gMCkgewoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJpdCsrOwoJICAgICAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCh4MzIgKiAzMiArIGJpdCkgPCBsZWZ0KSB7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGVmdCA9IHgzMiAqIDMyICsgYml0OwoJICAgICAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgIGlmICh4MzIgKiAzMiArIDMxID4gcmlnaHQpIHsKCSAgICAgICAgICAgICAgICAgICAgICAgIHZhciBiaXQgPSAzMTsKCSAgICAgICAgICAgICAgICAgICAgICAgIHdoaWxlICgodGhlQml0cyA+Pj4gYml0KSA9PT0gMCkgewoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJpdC0tOwoJICAgICAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCh4MzIgKiAzMiArIGJpdCkgPiByaWdodCkgewoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJpZ2h0ID0geDMyICogMzIgKyBiaXQ7CgkgICAgICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICAgICAgaWYgKHJpZ2h0IDwgbGVmdCB8fCBib3R0b20gPCB0b3ApIHsKCSAgICAgICAgICAgIHJldHVybiBudWxsOwoJICAgICAgICB9CgkgICAgICAgIHJldHVybiBJbnQzMkFycmF5LmZyb20oW2xlZnQsIHRvcCwgcmlnaHQgLSBsZWZ0ICsgMSwgYm90dG9tIC0gdG9wICsgMV0pOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogVGhpcyBpcyB1c2VmdWwgaW4gZGV0ZWN0aW5nIGEgY29ybmVyIG9mIGEgJ3B1cmUnIGJhcmNvZGUuCgkgICAgICoKCSAgICAgKiBAcmV0dXJuIHtAY29kZSB4LHl9IGNvb3JkaW5hdGUgb2YgdG9wLWxlZnQtbW9zdCAxIGJpdCwgb3IgbnVsbCBpZiBpdCBpcyBhbGwgd2hpdGUKCSAgICAgKi8KCSAgICBCaXRNYXRyaXgucHJvdG90eXBlLmdldFRvcExlZnRPbkJpdCA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgdmFyIHJvd1NpemUgPSB0aGlzLnJvd1NpemU7CgkgICAgICAgIHZhciBiaXRzID0gdGhpcy5iaXRzOwoJICAgICAgICB2YXIgYml0c09mZnNldCA9IDA7CgkgICAgICAgIHdoaWxlIChiaXRzT2Zmc2V0IDwgYml0cy5sZW5ndGggJiYgYml0c1tiaXRzT2Zmc2V0XSA9PT0gMCkgewoJICAgICAgICAgICAgYml0c09mZnNldCsrOwoJICAgICAgICB9CgkgICAgICAgIGlmIChiaXRzT2Zmc2V0ID09PSBiaXRzLmxlbmd0aCkgewoJICAgICAgICAgICAgcmV0dXJuIG51bGw7CgkgICAgICAgIH0KCSAgICAgICAgdmFyIHkgPSBiaXRzT2Zmc2V0IC8gcm93U2l6ZTsKCSAgICAgICAgdmFyIHggPSAoYml0c09mZnNldCAlIHJvd1NpemUpICogMzI7CgkgICAgICAgIHZhciB0aGVCaXRzID0gYml0c1tiaXRzT2Zmc2V0XTsKCSAgICAgICAgdmFyIGJpdCA9IDA7CgkgICAgICAgIHdoaWxlICgoKHRoZUJpdHMgPDwgKDMxIC0gYml0KSkgJiAweEZGRkZGRkZGKSA9PT0gMCkgewoJICAgICAgICAgICAgYml0Kys7CgkgICAgICAgIH0KCSAgICAgICAgeCArPSBiaXQ7CgkgICAgICAgIHJldHVybiBJbnQzMkFycmF5LmZyb20oW3gsIHldKTsKCSAgICB9OwoJICAgIEJpdE1hdHJpeC5wcm90b3R5cGUuZ2V0Qm90dG9tUmlnaHRPbkJpdCA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgdmFyIHJvd1NpemUgPSB0aGlzLnJvd1NpemU7CgkgICAgICAgIHZhciBiaXRzID0gdGhpcy5iaXRzOwoJICAgICAgICB2YXIgYml0c09mZnNldCA9IGJpdHMubGVuZ3RoIC0gMTsKCSAgICAgICAgd2hpbGUgKGJpdHNPZmZzZXQgPj0gMCAmJiBiaXRzW2JpdHNPZmZzZXRdID09PSAwKSB7CgkgICAgICAgICAgICBiaXRzT2Zmc2V0LS07CgkgICAgICAgIH0KCSAgICAgICAgaWYgKGJpdHNPZmZzZXQgPCAwKSB7CgkgICAgICAgICAgICByZXR1cm4gbnVsbDsKCSAgICAgICAgfQoJICAgICAgICB2YXIgeSA9IE1hdGguZmxvb3IoYml0c09mZnNldCAvIHJvd1NpemUpOwoJICAgICAgICB2YXIgeCA9IE1hdGguZmxvb3IoYml0c09mZnNldCAlIHJvd1NpemUpICogMzI7CgkgICAgICAgIHZhciB0aGVCaXRzID0gYml0c1tiaXRzT2Zmc2V0XTsKCSAgICAgICAgdmFyIGJpdCA9IDMxOwoJICAgICAgICB3aGlsZSAoKHRoZUJpdHMgPj4+IGJpdCkgPT09IDApIHsKCSAgICAgICAgICAgIGJpdC0tOwoJICAgICAgICB9CgkgICAgICAgIHggKz0gYml0OwoJICAgICAgICByZXR1cm4gSW50MzJBcnJheS5mcm9tKFt4LCB5XSk7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcmV0dXJuIFRoZSB3aWR0aCBvZiB0aGUgbWF0cml4CgkgICAgICovCgkgICAgQml0TWF0cml4LnByb3RvdHlwZS5nZXRXaWR0aCA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMud2lkdGg7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcmV0dXJuIFRoZSBoZWlnaHQgb2YgdGhlIG1hdHJpeAoJICAgICAqLwoJICAgIEJpdE1hdHJpeC5wcm90b3R5cGUuZ2V0SGVpZ2h0ID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5oZWlnaHQ7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcmV0dXJuIFRoZSByb3cgc2l6ZSBvZiB0aGUgbWF0cml4CgkgICAgICovCgkgICAgQml0TWF0cml4LnByb3RvdHlwZS5nZXRSb3dTaXplID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5yb3dTaXplOwoJICAgIH07CgkgICAgLypAT3ZlcnJpZGUqLwoJICAgIEJpdE1hdHJpeC5wcm90b3R5cGUuZXF1YWxzID0gZnVuY3Rpb24gKG8pIHsKCSAgICAgICAgaWYgKCEobyBpbnN0YW5jZW9mIEJpdE1hdHJpeCkpIHsKCSAgICAgICAgICAgIHJldHVybiBmYWxzZTsKCSAgICAgICAgfQoJICAgICAgICB2YXIgb3RoZXIgPSBvOwoJICAgICAgICByZXR1cm4gdGhpcy53aWR0aCA9PT0gb3RoZXIud2lkdGggJiYgdGhpcy5oZWlnaHQgPT09IG90aGVyLmhlaWdodCAmJiB0aGlzLnJvd1NpemUgPT09IG90aGVyLnJvd1NpemUgJiYKCSAgICAgICAgICAgIEFycmF5c18xLmRlZmF1bHQuZXF1YWxzKHRoaXMuYml0cywgb3RoZXIuYml0cyk7CgkgICAgfTsKCSAgICAvKkBPdmVycmlkZSovCgkgICAgQml0TWF0cml4LnByb3RvdHlwZS5oYXNoQ29kZSA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgdmFyIGhhc2ggPSB0aGlzLndpZHRoOwoJICAgICAgICBoYXNoID0gMzEgKiBoYXNoICsgdGhpcy53aWR0aDsKCSAgICAgICAgaGFzaCA9IDMxICogaGFzaCArIHRoaXMuaGVpZ2h0OwoJICAgICAgICBoYXNoID0gMzEgKiBoYXNoICsgdGhpcy5yb3dTaXplOwoJICAgICAgICBoYXNoID0gMzEgKiBoYXNoICsgQXJyYXlzXzEuZGVmYXVsdC5oYXNoQ29kZSh0aGlzLmJpdHMpOwoJICAgICAgICByZXR1cm4gaGFzaDsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEByZXR1cm4gc3RyaW5nIHJlcHJlc2VudGF0aW9uIHVzaW5nICJYIiBmb3Igc2V0IGFuZCAiICIgZm9yIHVuc2V0IGJpdHMKCSAgICAgKi8KCSAgICAvKkBPdmVycmlkZSovCgkgICAgLy8gcHVibGljIHRvU3RyaW5nKCk6IHN0cmluZyB7CgkgICAgLy8gICByZXR1cm4gdG9TdHJpbmcoIjogIlgsICIgICIpCgkgICAgLy8gfQoJICAgIC8qKgoJICAgICAqIEBwYXJhbSBzZXRTdHJpbmcgcmVwcmVzZW50YXRpb24gb2YgYSBzZXQgYml0CgkgICAgICogQHBhcmFtIHVuc2V0U3RyaW5nIHJlcHJlc2VudGF0aW9uIG9mIGFuIHVuc2V0IGJpdAoJICAgICAqIEByZXR1cm4gc3RyaW5nIHJlcHJlc2VudGF0aW9uIG9mIGVudGlyZSBtYXRyaXggdXRpbGl6aW5nIGdpdmVuIHN0cmluZ3MKCSAgICAgKi8KCSAgICAvLyBwdWJsaWMgdG9TdHJpbmcoc2V0U3RyaW5nOiBzdHJpbmcgPSAiWCAiLCB1bnNldFN0cmluZzogc3RyaW5nID0gIiAgIik6IHN0cmluZyB7CgkgICAgLy8gICByZXR1cm4gdGhpcy5idWlsZFRvU3RyaW5nKHNldFN0cmluZywgdW5zZXRTdHJpbmcsICJcbiIpCgkgICAgLy8gfQoJICAgIC8qKgoJICAgICAqIEBwYXJhbSBzZXRTdHJpbmcgcmVwcmVzZW50YXRpb24gb2YgYSBzZXQgYml0CgkgICAgICogQHBhcmFtIHVuc2V0U3RyaW5nIHJlcHJlc2VudGF0aW9uIG9mIGFuIHVuc2V0IGJpdAoJICAgICAqIEBwYXJhbSBsaW5lU2VwYXJhdG9yIG5ld2xpbmUgY2hhcmFjdGVyIGluIHN0cmluZyByZXByZXNlbnRhdGlvbgoJICAgICAqIEByZXR1cm4gc3RyaW5nIHJlcHJlc2VudGF0aW9uIG9mIGVudGlyZSBtYXRyaXggdXRpbGl6aW5nIGdpdmVuIHN0cmluZ3MgYW5kIGxpbmUgc2VwYXJhdG9yCgkgICAgICogQGRlcHJlY2F0ZWQgY2FsbCB7QGxpbmsgI3RvU3RyaW5nKFN0cmluZyxTdHJpbmcpfSBvbmx5LCB3aGljaCB1c2VzIFxuIGxpbmUgc2VwYXJhdG9yIGFsd2F5cwoJICAgICAqLwoJICAgIC8vIEBEZXByZWNhdGVkCgkgICAgQml0TWF0cml4LnByb3RvdHlwZS50b1N0cmluZyA9IGZ1bmN0aW9uIChzZXRTdHJpbmcsIHVuc2V0U3RyaW5nLCBsaW5lU2VwYXJhdG9yKSB7CgkgICAgICAgIGlmIChzZXRTdHJpbmcgPT09IHZvaWQgMCkgeyBzZXRTdHJpbmcgPSAnWCAnOyB9CgkgICAgICAgIGlmICh1bnNldFN0cmluZyA9PT0gdm9pZCAwKSB7IHVuc2V0U3RyaW5nID0gJyAgJzsgfQoJICAgICAgICBpZiAobGluZVNlcGFyYXRvciA9PT0gdm9pZCAwKSB7IGxpbmVTZXBhcmF0b3IgPSAnXG4nOyB9CgkgICAgICAgIHJldHVybiB0aGlzLmJ1aWxkVG9TdHJpbmcoc2V0U3RyaW5nLCB1bnNldFN0cmluZywgbGluZVNlcGFyYXRvcik7CgkgICAgfTsKCSAgICBCaXRNYXRyaXgucHJvdG90eXBlLmJ1aWxkVG9TdHJpbmcgPSBmdW5jdGlvbiAoc2V0U3RyaW5nLCB1bnNldFN0cmluZywgbGluZVNlcGFyYXRvcikgewoJICAgICAgICB2YXIgcmVzdWx0ID0gbmV3IFN0cmluZ0J1aWxkZXJfMSQyLmRlZmF1bHQoKTsKCSAgICAgICAgLy8gcmVzdWx0LmFwcGVuZChsaW5lU2VwYXJhdG9yKTsKCSAgICAgICAgZm9yICh2YXIgeSA9IDAsIGhlaWdodCA9IHRoaXMuaGVpZ2h0OyB5IDwgaGVpZ2h0OyB5KyspIHsKCSAgICAgICAgICAgIGZvciAodmFyIHggPSAwLCB3aWR0aCA9IHRoaXMud2lkdGg7IHggPCB3aWR0aDsgeCsrKSB7CgkgICAgICAgICAgICAgICAgcmVzdWx0LmFwcGVuZCh0aGlzLmdldCh4LCB5KSA/IHNldFN0cmluZyA6IHVuc2V0U3RyaW5nKTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIHJlc3VsdC5hcHBlbmQobGluZVNlcGFyYXRvcik7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIHJlc3VsdC50b1N0cmluZygpOwoJICAgIH07CgkgICAgLypAT3ZlcnJpZGUqLwoJICAgIEJpdE1hdHJpeC5wcm90b3R5cGUuY2xvbmUgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiBuZXcgQml0TWF0cml4KHRoaXMud2lkdGgsIHRoaXMuaGVpZ2h0LCB0aGlzLnJvd1NpemUsIHRoaXMuYml0cy5zbGljZSgpKTsKCSAgICB9OwoJICAgIHJldHVybiBCaXRNYXRyaXg7Cgl9KCkpOwoJQml0TWF0cml4JDEuZGVmYXVsdCA9IEJpdE1hdHJpeDsKCgl2YXIgTm90Rm91bmRFeGNlcHRpb24kMSA9IHt9OwoKCXZhciBfX2V4dGVuZHMkZCA9IChjb21tb25qc0dsb2JhbCAmJiBjb21tb25qc0dsb2JhbC5fX2V4dGVuZHMpIHx8IChmdW5jdGlvbiAoKSB7CgkgICAgdmFyIGV4dGVuZFN0YXRpY3MgPSBmdW5jdGlvbiAoZCwgYikgewoJICAgICAgICBleHRlbmRTdGF0aWNzID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8CgkgICAgICAgICAgICAoeyBfX3Byb3RvX186IFtdIH0gaW5zdGFuY2VvZiBBcnJheSAmJiBmdW5jdGlvbiAoZCwgYikgeyBkLl9fcHJvdG9fXyA9IGI7IH0pIHx8CgkgICAgICAgICAgICBmdW5jdGlvbiAoZCwgYikgeyBmb3IgKHZhciBwIGluIGIpIGlmIChiLmhhc093blByb3BlcnR5KHApKSBkW3BdID0gYltwXTsgfTsKCSAgICAgICAgcmV0dXJuIGV4dGVuZFN0YXRpY3MoZCwgYik7CgkgICAgfTsKCSAgICByZXR1cm4gZnVuY3Rpb24gKGQsIGIpIHsKCSAgICAgICAgZXh0ZW5kU3RhdGljcyhkLCBiKTsKCSAgICAgICAgZnVuY3Rpb24gX18oKSB7IHRoaXMuY29uc3RydWN0b3IgPSBkOyB9CgkgICAgICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTsKCSAgICB9OwoJfSkoKTsKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShOb3RGb3VuZEV4Y2VwdGlvbiQxLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7Cgl2YXIgRXhjZXB0aW9uXzEkNSA9IEV4Y2VwdGlvbiQxOwoJLyoqCgkgKiBDdXN0b20gRXJyb3IgY2xhc3Mgb2YgdHlwZSBFeGNlcHRpb24uCgkgKi8KCXZhciBOb3RGb3VuZEV4Y2VwdGlvbiA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHsKCSAgICBfX2V4dGVuZHMkZChOb3RGb3VuZEV4Y2VwdGlvbiwgX3N1cGVyKTsKCSAgICBmdW5jdGlvbiBOb3RGb3VuZEV4Y2VwdGlvbigpIHsKCSAgICAgICAgcmV0dXJuIF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzOwoJICAgIH0KCSAgICBOb3RGb3VuZEV4Y2VwdGlvbi5nZXROb3RGb3VuZEluc3RhbmNlID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gbmV3IE5vdEZvdW5kRXhjZXB0aW9uKCk7CgkgICAgfTsKCSAgICBOb3RGb3VuZEV4Y2VwdGlvbi5raW5kID0gJ05vdEZvdW5kRXhjZXB0aW9uJzsKCSAgICByZXR1cm4gTm90Rm91bmRFeGNlcHRpb247Cgl9KEV4Y2VwdGlvbl8xJDUuZGVmYXVsdCkpOwoJTm90Rm91bmRFeGNlcHRpb24kMS5kZWZhdWx0ID0gTm90Rm91bmRFeGNlcHRpb247CgoJLyoKCSAqIENvcHlyaWdodCAyMDA5IFpYaW5nIGF1dGhvcnMKCSAqCgkgKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKCSAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4KCSAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdAoJICoKCSAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wCgkgKgoJICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZQoJICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gIkFTIElTIiBCQVNJUywKCSAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLgoJICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZAoJICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuCgkgKi8KCXZhciBfX2V4dGVuZHMkYyA9IChjb21tb25qc0dsb2JhbCAmJiBjb21tb25qc0dsb2JhbC5fX2V4dGVuZHMpIHx8IChmdW5jdGlvbiAoKSB7CgkgICAgdmFyIGV4dGVuZFN0YXRpY3MgPSBmdW5jdGlvbiAoZCwgYikgewoJICAgICAgICBleHRlbmRTdGF0aWNzID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8CgkgICAgICAgICAgICAoeyBfX3Byb3RvX186IFtdIH0gaW5zdGFuY2VvZiBBcnJheSAmJiBmdW5jdGlvbiAoZCwgYikgeyBkLl9fcHJvdG9fXyA9IGI7IH0pIHx8CgkgICAgICAgICAgICBmdW5jdGlvbiAoZCwgYikgeyBmb3IgKHZhciBwIGluIGIpIGlmIChiLmhhc093blByb3BlcnR5KHApKSBkW3BdID0gYltwXTsgfTsKCSAgICAgICAgcmV0dXJuIGV4dGVuZFN0YXRpY3MoZCwgYik7CgkgICAgfTsKCSAgICByZXR1cm4gZnVuY3Rpb24gKGQsIGIpIHsKCSAgICAgICAgZXh0ZW5kU3RhdGljcyhkLCBiKTsKCSAgICAgICAgZnVuY3Rpb24gX18oKSB7IHRoaXMuY29uc3RydWN0b3IgPSBkOyB9CgkgICAgICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTsKCSAgICB9OwoJfSkoKTsKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShHbG9iYWxIaXN0b2dyYW1CaW5hcml6ZXIkMSwgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJLypuYW1lc3BhY2UgY29tLmdvb2dsZS56eGluZy5jb21tb24geyovCgl2YXIgQmluYXJpemVyXzEgPSBCaW5hcml6ZXIkMTsKCXZhciBCaXRBcnJheV8xID0gQml0QXJyYXkkMTsKCXZhciBCaXRNYXRyaXhfMSQ1ID0gQml0TWF0cml4JDE7Cgl2YXIgTm90Rm91bmRFeGNlcHRpb25fMSQ2ID0gTm90Rm91bmRFeGNlcHRpb24kMTsKCS8qKgoJICogVGhpcyBCaW5hcml6ZXIgaW1wbGVtZW50YXRpb24gdXNlcyB0aGUgb2xkIFpYaW5nIGdsb2JhbCBoaXN0b2dyYW0gYXBwcm9hY2guIEl0IGlzIHN1aXRhYmxlCgkgKiBmb3IgbG93LWVuZCBtb2JpbGUgZGV2aWNlcyB3aGljaCBkb24ndCBoYXZlIGVub3VnaCBDUFUgb3IgbWVtb3J5IHRvIHVzZSBhIGxvY2FsIHRocmVzaG9sZGluZwoJICogYWxnb3JpdGhtLiBIb3dldmVyLCBiZWNhdXNlIGl0IHBpY2tzIGEgZ2xvYmFsIGJsYWNrIHBvaW50LCBpdCBjYW5ub3QgaGFuZGxlIGRpZmZpY3VsdCBzaGFkb3dzCgkgKiBhbmQgZ3JhZGllbnRzLgoJICoKCSAqIEZhc3RlciBtb2JpbGUgZGV2aWNlcyBhbmQgYWxsIGRlc2t0b3AgYXBwbGljYXRpb25zIHNob3VsZCBwcm9iYWJseSB1c2UgSHlicmlkQmluYXJpemVyIGluc3RlYWQuCgkgKgoJICogQGF1dGhvciBkc3dpdGtpbkBnb29nbGUuY29tIChEYW5pZWwgU3dpdGtpbikKCSAqIEBhdXRob3IgU2VhbiBPd2VuCgkgKi8KCXZhciBHbG9iYWxIaXN0b2dyYW1CaW5hcml6ZXIgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7CgkgICAgX19leHRlbmRzJGMoR2xvYmFsSGlzdG9ncmFtQmluYXJpemVyLCBfc3VwZXIpOwoJICAgIGZ1bmN0aW9uIEdsb2JhbEhpc3RvZ3JhbUJpbmFyaXplcihzb3VyY2UpIHsKCSAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcywgc291cmNlKSB8fCB0aGlzOwoJICAgICAgICBfdGhpcy5sdW1pbmFuY2VzID0gR2xvYmFsSGlzdG9ncmFtQmluYXJpemVyLkVNUFRZOwoJICAgICAgICBfdGhpcy5idWNrZXRzID0gbmV3IEludDMyQXJyYXkoR2xvYmFsSGlzdG9ncmFtQmluYXJpemVyLkxVTUlOQU5DRV9CVUNLRVRTKTsKCSAgICAgICAgcmV0dXJuIF90aGlzOwoJICAgIH0KCSAgICAvLyBBcHBsaWVzIHNpbXBsZSBzaGFycGVuaW5nIHRvIHRoZSByb3cgZGF0YSB0byBpbXByb3ZlIHBlcmZvcm1hbmNlIG9mIHRoZSAxRCBSZWFkZXJzLgoJICAgIC8qQE92ZXJyaWRlKi8KCSAgICBHbG9iYWxIaXN0b2dyYW1CaW5hcml6ZXIucHJvdG90eXBlLmdldEJsYWNrUm93ID0gZnVuY3Rpb24gKHkgLyppbnQqLywgcm93KSB7CgkgICAgICAgIHZhciBzb3VyY2UgPSB0aGlzLmdldEx1bWluYW5jZVNvdXJjZSgpOwoJICAgICAgICB2YXIgd2lkdGggPSBzb3VyY2UuZ2V0V2lkdGgoKTsKCSAgICAgICAgaWYgKHJvdyA9PT0gdW5kZWZpbmVkIHx8IHJvdyA9PT0gbnVsbCB8fCByb3cuZ2V0U2l6ZSgpIDwgd2lkdGgpIHsKCSAgICAgICAgICAgIHJvdyA9IG5ldyBCaXRBcnJheV8xLmRlZmF1bHQod2lkdGgpOwoJICAgICAgICB9CgkgICAgICAgIGVsc2UgewoJICAgICAgICAgICAgcm93LmNsZWFyKCk7CgkgICAgICAgIH0KCSAgICAgICAgdGhpcy5pbml0QXJyYXlzKHdpZHRoKTsKCSAgICAgICAgdmFyIGxvY2FsTHVtaW5hbmNlcyA9IHNvdXJjZS5nZXRSb3coeSwgdGhpcy5sdW1pbmFuY2VzKTsKCSAgICAgICAgdmFyIGxvY2FsQnVja2V0cyA9IHRoaXMuYnVja2V0czsKCSAgICAgICAgZm9yICh2YXIgeCA9IDA7IHggPCB3aWR0aDsgeCsrKSB7CgkgICAgICAgICAgICBsb2NhbEJ1Y2tldHNbKGxvY2FsTHVtaW5hbmNlc1t4XSAmIDB4ZmYpID4+IEdsb2JhbEhpc3RvZ3JhbUJpbmFyaXplci5MVU1JTkFOQ0VfU0hJRlRdKys7CgkgICAgICAgIH0KCSAgICAgICAgdmFyIGJsYWNrUG9pbnQgPSBHbG9iYWxIaXN0b2dyYW1CaW5hcml6ZXIuZXN0aW1hdGVCbGFja1BvaW50KGxvY2FsQnVja2V0cyk7CgkgICAgICAgIGlmICh3aWR0aCA8IDMpIHsKCSAgICAgICAgICAgIC8vIFNwZWNpYWwgY2FzZSBmb3IgdmVyeSBzbWFsbCBpbWFnZXMKCSAgICAgICAgICAgIGZvciAodmFyIHggPSAwOyB4IDwgd2lkdGg7IHgrKykgewoJICAgICAgICAgICAgICAgIGlmICgobG9jYWxMdW1pbmFuY2VzW3hdICYgMHhmZikgPCBibGFja1BvaW50KSB7CgkgICAgICAgICAgICAgICAgICAgIHJvdy5zZXQoeCk7CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIGVsc2UgewoJICAgICAgICAgICAgdmFyIGxlZnQgPSBsb2NhbEx1bWluYW5jZXNbMF0gJiAweGZmOwoJICAgICAgICAgICAgdmFyIGNlbnRlciA9IGxvY2FsTHVtaW5hbmNlc1sxXSAmIDB4ZmY7CgkgICAgICAgICAgICBmb3IgKHZhciB4ID0gMTsgeCA8IHdpZHRoIC0gMTsgeCsrKSB7CgkgICAgICAgICAgICAgICAgdmFyIHJpZ2h0ID0gbG9jYWxMdW1pbmFuY2VzW3ggKyAxXSAmIDB4ZmY7CgkgICAgICAgICAgICAgICAgLy8gQSBzaW1wbGUgLTEgNCAtMSBib3ggZmlsdGVyIHdpdGggYSB3ZWlnaHQgb2YgMi4KCSAgICAgICAgICAgICAgICBpZiAoKChjZW50ZXIgKiA0KSAtIGxlZnQgLSByaWdodCkgLyAyIDwgYmxhY2tQb2ludCkgewoJICAgICAgICAgICAgICAgICAgICByb3cuc2V0KHgpOwoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICBsZWZ0ID0gY2VudGVyOwoJICAgICAgICAgICAgICAgIGNlbnRlciA9IHJpZ2h0OwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIHJldHVybiByb3c7CgkgICAgfTsKCSAgICAvLyBEb2VzIG5vdCBzaGFycGVuIHRoZSBkYXRhLCBhcyB0aGlzIGNhbGwgaXMgaW50ZW5kZWQgdG8gb25seSBiZSB1c2VkIGJ5IDJEIFJlYWRlcnMuCgkgICAgLypAT3ZlcnJpZGUqLwoJICAgIEdsb2JhbEhpc3RvZ3JhbUJpbmFyaXplci5wcm90b3R5cGUuZ2V0QmxhY2tNYXRyaXggPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHZhciBzb3VyY2UgPSB0aGlzLmdldEx1bWluYW5jZVNvdXJjZSgpOwoJICAgICAgICB2YXIgd2lkdGggPSBzb3VyY2UuZ2V0V2lkdGgoKTsKCSAgICAgICAgdmFyIGhlaWdodCA9IHNvdXJjZS5nZXRIZWlnaHQoKTsKCSAgICAgICAgdmFyIG1hdHJpeCA9IG5ldyBCaXRNYXRyaXhfMSQ1LmRlZmF1bHQod2lkdGgsIGhlaWdodCk7CgkgICAgICAgIC8vIFF1aWNrbHkgY2FsY3VsYXRlcyB0aGUgaGlzdG9ncmFtIGJ5IHNhbXBsaW5nIGZvdXIgcm93cyBmcm9tIHRoZSBpbWFnZS4gVGhpcyBwcm92ZWQgdG8gYmUKCSAgICAgICAgLy8gbW9yZSByb2J1c3Qgb24gdGhlIGJsYWNrYm94IHRlc3RzIHRoYW4gc2FtcGxpbmcgYSBkaWFnb25hbCBhcyB3ZSB1c2VkIHRvIGRvLgoJICAgICAgICB0aGlzLmluaXRBcnJheXMod2lkdGgpOwoJICAgICAgICB2YXIgbG9jYWxCdWNrZXRzID0gdGhpcy5idWNrZXRzOwoJICAgICAgICBmb3IgKHZhciB5ID0gMTsgeSA8IDU7IHkrKykgewoJICAgICAgICAgICAgdmFyIHJvdyA9IE1hdGguZmxvb3IoKGhlaWdodCAqIHkpIC8gNSk7CgkgICAgICAgICAgICB2YXIgbG9jYWxMdW1pbmFuY2VzXzEgPSBzb3VyY2UuZ2V0Um93KHJvdywgdGhpcy5sdW1pbmFuY2VzKTsKCSAgICAgICAgICAgIHZhciByaWdodCA9IE1hdGguZmxvb3IoKHdpZHRoICogNCkgLyA1KTsKCSAgICAgICAgICAgIGZvciAodmFyIHggPSBNYXRoLmZsb29yKHdpZHRoIC8gNSk7IHggPCByaWdodDsgeCsrKSB7CgkgICAgICAgICAgICAgICAgdmFyIHBpeGVsID0gbG9jYWxMdW1pbmFuY2VzXzFbeF0gJiAweGZmOwoJICAgICAgICAgICAgICAgIGxvY2FsQnVja2V0c1twaXhlbCA+PiBHbG9iYWxIaXN0b2dyYW1CaW5hcml6ZXIuTFVNSU5BTkNFX1NISUZUXSsrOwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIHZhciBibGFja1BvaW50ID0gR2xvYmFsSGlzdG9ncmFtQmluYXJpemVyLmVzdGltYXRlQmxhY2tQb2ludChsb2NhbEJ1Y2tldHMpOwoJICAgICAgICAvLyBXZSBkZWxheSByZWFkaW5nIHRoZSBlbnRpcmUgaW1hZ2UgbHVtaW5hbmNlIHVudGlsIHRoZSBibGFjayBwb2ludCBlc3RpbWF0aW9uIHN1Y2NlZWRzLgoJICAgICAgICAvLyBBbHRob3VnaCB3ZSBlbmQgdXAgcmVhZGluZyBmb3VyIHJvd3MgdHdpY2UsIGl0IGlzIGNvbnNpc3RlbnQgd2l0aCBvdXIgbW90dG8gb2YKCSAgICAgICAgLy8gImZhaWwgcXVpY2tseSIgd2hpY2ggaXMgbmVjZXNzYXJ5IGZvciBjb250aW51b3VzIHNjYW5uaW5nLgoJICAgICAgICB2YXIgbG9jYWxMdW1pbmFuY2VzID0gc291cmNlLmdldE1hdHJpeCgpOwoJICAgICAgICBmb3IgKHZhciB5ID0gMDsgeSA8IGhlaWdodDsgeSsrKSB7CgkgICAgICAgICAgICB2YXIgb2Zmc2V0ID0geSAqIHdpZHRoOwoJICAgICAgICAgICAgZm9yICh2YXIgeCA9IDA7IHggPCB3aWR0aDsgeCsrKSB7CgkgICAgICAgICAgICAgICAgdmFyIHBpeGVsID0gbG9jYWxMdW1pbmFuY2VzW29mZnNldCArIHhdICYgMHhmZjsKCSAgICAgICAgICAgICAgICBpZiAocGl4ZWwgPCBibGFja1BvaW50KSB7CgkgICAgICAgICAgICAgICAgICAgIG1hdHJpeC5zZXQoeCwgeSk7CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIHJldHVybiBtYXRyaXg7CgkgICAgfTsKCSAgICAvKkBPdmVycmlkZSovCgkgICAgR2xvYmFsSGlzdG9ncmFtQmluYXJpemVyLnByb3RvdHlwZS5jcmVhdGVCaW5hcml6ZXIgPSBmdW5jdGlvbiAoc291cmNlKSB7CgkgICAgICAgIHJldHVybiBuZXcgR2xvYmFsSGlzdG9ncmFtQmluYXJpemVyKHNvdXJjZSk7CgkgICAgfTsKCSAgICBHbG9iYWxIaXN0b2dyYW1CaW5hcml6ZXIucHJvdG90eXBlLmluaXRBcnJheXMgPSBmdW5jdGlvbiAobHVtaW5hbmNlU2l6ZSAvKmludCovKSB7CgkgICAgICAgIGlmICh0aGlzLmx1bWluYW5jZXMubGVuZ3RoIDwgbHVtaW5hbmNlU2l6ZSkgewoJICAgICAgICAgICAgdGhpcy5sdW1pbmFuY2VzID0gbmV3IFVpbnQ4Q2xhbXBlZEFycmF5KGx1bWluYW5jZVNpemUpOwoJICAgICAgICB9CgkgICAgICAgIHZhciBidWNrZXRzID0gdGhpcy5idWNrZXRzOwoJICAgICAgICBmb3IgKHZhciB4ID0gMDsgeCA8IEdsb2JhbEhpc3RvZ3JhbUJpbmFyaXplci5MVU1JTkFOQ0VfQlVDS0VUUzsgeCsrKSB7CgkgICAgICAgICAgICBidWNrZXRzW3hdID0gMDsKCSAgICAgICAgfQoJICAgIH07CgkgICAgR2xvYmFsSGlzdG9ncmFtQmluYXJpemVyLmVzdGltYXRlQmxhY2tQb2ludCA9IGZ1bmN0aW9uIChidWNrZXRzKSB7CgkgICAgICAgIC8vIEZpbmQgdGhlIHRhbGxlc3QgcGVhayBpbiB0aGUgaGlzdG9ncmFtLgoJICAgICAgICB2YXIgbnVtQnVja2V0cyA9IGJ1Y2tldHMubGVuZ3RoOwoJICAgICAgICB2YXIgbWF4QnVja2V0Q291bnQgPSAwOwoJICAgICAgICB2YXIgZmlyc3RQZWFrID0gMDsKCSAgICAgICAgdmFyIGZpcnN0UGVha1NpemUgPSAwOwoJICAgICAgICBmb3IgKHZhciB4ID0gMDsgeCA8IG51bUJ1Y2tldHM7IHgrKykgewoJICAgICAgICAgICAgaWYgKGJ1Y2tldHNbeF0gPiBmaXJzdFBlYWtTaXplKSB7CgkgICAgICAgICAgICAgICAgZmlyc3RQZWFrID0geDsKCSAgICAgICAgICAgICAgICBmaXJzdFBlYWtTaXplID0gYnVja2V0c1t4XTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIGlmIChidWNrZXRzW3hdID4gbWF4QnVja2V0Q291bnQpIHsKCSAgICAgICAgICAgICAgICBtYXhCdWNrZXRDb3VudCA9IGJ1Y2tldHNbeF07CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICAgICAgLy8gRmluZCB0aGUgc2Vjb25kLXRhbGxlc3QgcGVhayB3aGljaCBpcyBzb21ld2hhdCBmYXIgZnJvbSB0aGUgdGFsbGVzdCBwZWFrLgoJICAgICAgICB2YXIgc2Vjb25kUGVhayA9IDA7CgkgICAgICAgIHZhciBzZWNvbmRQZWFrU2NvcmUgPSAwOwoJICAgICAgICBmb3IgKHZhciB4ID0gMDsgeCA8IG51bUJ1Y2tldHM7IHgrKykgewoJICAgICAgICAgICAgdmFyIGRpc3RhbmNlVG9CaWdnZXN0ID0geCAtIGZpcnN0UGVhazsKCSAgICAgICAgICAgIC8vIEVuY291cmFnZSBtb3JlIGRpc3RhbnQgc2Vjb25kIHBlYWtzIGJ5IG11bHRpcGx5aW5nIGJ5IHNxdWFyZSBvZiBkaXN0YW5jZS4KCSAgICAgICAgICAgIHZhciBzY29yZSA9IGJ1Y2tldHNbeF0gKiBkaXN0YW5jZVRvQmlnZ2VzdCAqIGRpc3RhbmNlVG9CaWdnZXN0OwoJICAgICAgICAgICAgaWYgKHNjb3JlID4gc2Vjb25kUGVha1Njb3JlKSB7CgkgICAgICAgICAgICAgICAgc2Vjb25kUGVhayA9IHg7CgkgICAgICAgICAgICAgICAgc2Vjb25kUGVha1Njb3JlID0gc2NvcmU7CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICAgICAgLy8gTWFrZSBzdXJlIGZpcnN0UGVhayBjb3JyZXNwb25kcyB0byB0aGUgYmxhY2sgcGVhay4KCSAgICAgICAgaWYgKGZpcnN0UGVhayA+IHNlY29uZFBlYWspIHsKCSAgICAgICAgICAgIHZhciB0ZW1wID0gZmlyc3RQZWFrOwoJICAgICAgICAgICAgZmlyc3RQZWFrID0gc2Vjb25kUGVhazsKCSAgICAgICAgICAgIHNlY29uZFBlYWsgPSB0ZW1wOwoJICAgICAgICB9CgkgICAgICAgIC8vIElmIHRoZXJlIGlzIHRvbyBsaXR0bGUgY29udHJhc3QgaW4gdGhlIGltYWdlIHRvIHBpY2sgYSBtZWFuaW5nZnVsIGJsYWNrIHBvaW50LCB0aHJvdyByYXRoZXIKCSAgICAgICAgLy8gdGhhbiB3YXN0ZSB0aW1lIHRyeWluZyB0byBkZWNvZGUgdGhlIGltYWdlLCBhbmQgcmlzayBmYWxzZSBwb3NpdGl2ZXMuCgkgICAgICAgIGlmIChzZWNvbmRQZWFrIC0gZmlyc3RQZWFrIDw9IG51bUJ1Y2tldHMgLyAxNikgewoJICAgICAgICAgICAgdGhyb3cgbmV3IE5vdEZvdW5kRXhjZXB0aW9uXzEkNi5kZWZhdWx0KCk7CgkgICAgICAgIH0KCSAgICAgICAgLy8gRmluZCBhIHZhbGxleSBiZXR3ZWVuIHRoZW0gdGhhdCBpcyBsb3cgYW5kIGNsb3NlciB0byB0aGUgd2hpdGUgcGVhay4KCSAgICAgICAgdmFyIGJlc3RWYWxsZXkgPSBzZWNvbmRQZWFrIC0gMTsKCSAgICAgICAgdmFyIGJlc3RWYWxsZXlTY29yZSA9IC0xOwoJICAgICAgICBmb3IgKHZhciB4ID0gc2Vjb25kUGVhayAtIDE7IHggPiBmaXJzdFBlYWs7IHgtLSkgewoJICAgICAgICAgICAgdmFyIGZyb21GaXJzdCA9IHggLSBmaXJzdFBlYWs7CgkgICAgICAgICAgICB2YXIgc2NvcmUgPSBmcm9tRmlyc3QgKiBmcm9tRmlyc3QgKiAoc2Vjb25kUGVhayAtIHgpICogKG1heEJ1Y2tldENvdW50IC0gYnVja2V0c1t4XSk7CgkgICAgICAgICAgICBpZiAoc2NvcmUgPiBiZXN0VmFsbGV5U2NvcmUpIHsKCSAgICAgICAgICAgICAgICBiZXN0VmFsbGV5ID0geDsKCSAgICAgICAgICAgICAgICBiZXN0VmFsbGV5U2NvcmUgPSBzY29yZTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gYmVzdFZhbGxleSA8PCBHbG9iYWxIaXN0b2dyYW1CaW5hcml6ZXIuTFVNSU5BTkNFX1NISUZUOwoJICAgIH07CgkgICAgR2xvYmFsSGlzdG9ncmFtQmluYXJpemVyLkxVTUlOQU5DRV9CSVRTID0gNTsKCSAgICBHbG9iYWxIaXN0b2dyYW1CaW5hcml6ZXIuTFVNSU5BTkNFX1NISUZUID0gOCAtIEdsb2JhbEhpc3RvZ3JhbUJpbmFyaXplci5MVU1JTkFOQ0VfQklUUzsKCSAgICBHbG9iYWxIaXN0b2dyYW1CaW5hcml6ZXIuTFVNSU5BTkNFX0JVQ0tFVFMgPSAxIDw8IEdsb2JhbEhpc3RvZ3JhbUJpbmFyaXplci5MVU1JTkFOQ0VfQklUUzsKCSAgICBHbG9iYWxIaXN0b2dyYW1CaW5hcml6ZXIuRU1QVFkgPSBVaW50OENsYW1wZWRBcnJheS5mcm9tKFswXSk7CgkgICAgcmV0dXJuIEdsb2JhbEhpc3RvZ3JhbUJpbmFyaXplcjsKCX0oQmluYXJpemVyXzEuZGVmYXVsdCkpOwoJR2xvYmFsSGlzdG9ncmFtQmluYXJpemVyJDEuZGVmYXVsdCA9IEdsb2JhbEhpc3RvZ3JhbUJpbmFyaXplcjsKCgkvKgoJICogQ29weXJpZ2h0IDIwMDkgWlhpbmcgYXV0aG9ycwoJICoKCSAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoJICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoJICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkgKgoJICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKCSAqCgkgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCgkgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoJICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCgkgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCSAqLwoJdmFyIF9fZXh0ZW5kcyRiID0gKGNvbW1vbmpzR2xvYmFsICYmIGNvbW1vbmpzR2xvYmFsLl9fZXh0ZW5kcykgfHwgKGZ1bmN0aW9uICgpIHsKCSAgICB2YXIgZXh0ZW5kU3RhdGljcyA9IGZ1bmN0aW9uIChkLCBiKSB7CgkgICAgICAgIGV4dGVuZFN0YXRpY3MgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgfHwKCSAgICAgICAgICAgICh7IF9fcHJvdG9fXzogW10gfSBpbnN0YW5jZW9mIEFycmF5ICYmIGZ1bmN0aW9uIChkLCBiKSB7IGQuX19wcm90b19fID0gYjsgfSkgfHwKCSAgICAgICAgICAgIGZ1bmN0aW9uIChkLCBiKSB7IGZvciAodmFyIHAgaW4gYikgaWYgKGIuaGFzT3duUHJvcGVydHkocCkpIGRbcF0gPSBiW3BdOyB9OwoJICAgICAgICByZXR1cm4gZXh0ZW5kU3RhdGljcyhkLCBiKTsKCSAgICB9OwoJICAgIHJldHVybiBmdW5jdGlvbiAoZCwgYikgewoJICAgICAgICBleHRlbmRTdGF0aWNzKGQsIGIpOwoJICAgICAgICBmdW5jdGlvbiBfXygpIHsgdGhpcy5jb25zdHJ1Y3RvciA9IGQ7IH0KCSAgICAgICAgZC5wcm90b3R5cGUgPSBiID09PSBudWxsID8gT2JqZWN0LmNyZWF0ZShiKSA6IChfXy5wcm90b3R5cGUgPSBiLnByb3RvdHlwZSwgbmV3IF9fKCkpOwoJICAgIH07Cgl9KSgpOwoJT2JqZWN0LmRlZmluZVByb3BlcnR5KEh5YnJpZEJpbmFyaXplciQxLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7Cgl2YXIgR2xvYmFsSGlzdG9ncmFtQmluYXJpemVyXzEgPSBHbG9iYWxIaXN0b2dyYW1CaW5hcml6ZXIkMTsKCXZhciBCaXRNYXRyaXhfMSQ0ID0gQml0TWF0cml4JDE7CgkvKioKCSAqIFRoaXMgY2xhc3MgaW1wbGVtZW50cyBhIGxvY2FsIHRocmVzaG9sZGluZyBhbGdvcml0aG0sIHdoaWNoIHdoaWxlIHNsb3dlciB0aGFuIHRoZQoJICogR2xvYmFsSGlzdG9ncmFtQmluYXJpemVyLCBpcyBmYWlybHkgZWZmaWNpZW50IGZvciB3aGF0IGl0IGRvZXMuIEl0IGlzIGRlc2lnbmVkIGZvcgoJICogaGlnaCBmcmVxdWVuY3kgaW1hZ2VzIG9mIGJhcmNvZGVzIHdpdGggYmxhY2sgZGF0YSBvbiB3aGl0ZSBiYWNrZ3JvdW5kcy4gRm9yIHRoaXMgYXBwbGljYXRpb24sCgkgKiBpdCBkb2VzIGEgbXVjaCBiZXR0ZXIgam9iIHRoYW4gYSBnbG9iYWwgYmxhY2twb2ludCB3aXRoIHNldmVyZSBzaGFkb3dzIGFuZCBncmFkaWVudHMuCgkgKiBIb3dldmVyIGl0IHRlbmRzIHRvIHByb2R1Y2UgYXJ0aWZhY3RzIG9uIGxvd2VyIGZyZXF1ZW5jeSBpbWFnZXMgYW5kIGlzIHRoZXJlZm9yZSBub3QKCSAqIGEgZ29vZCBnZW5lcmFsIHB1cnBvc2UgYmluYXJpemVyIGZvciB1c2VzIG91dHNpZGUgWlhpbmcuCgkgKgoJICogVGhpcyBjbGFzcyBleHRlbmRzIEdsb2JhbEhpc3RvZ3JhbUJpbmFyaXplciwgdXNpbmcgdGhlIG9sZGVyIGhpc3RvZ3JhbSBhcHByb2FjaCBmb3IgMUQgcmVhZGVycywKCSAqIGFuZCB0aGUgbmV3ZXIgbG9jYWwgYXBwcm9hY2ggZm9yIDJEIHJlYWRlcnMuIDFEIGRlY29kaW5nIHVzaW5nIGEgcGVyLXJvdyBoaXN0b2dyYW0gaXMgYWxyZWFkeQoJICogaW5oZXJlbnRseSBsb2NhbCwgYW5kIG9ubHkgZmFpbHMgZm9yIGhvcml6b250YWwgZ3JhZGllbnRzLiBXZSBjYW4gcmV2aXNpdCB0aGF0IHByb2JsZW0gbGF0ZXIsCgkgKiBidXQgZm9yIG5vdyBpdCB3YXMgbm90IGEgd2luIHRvIHVzZSBsb2NhbCBibG9ja3MgZm9yIDFELgoJICoKCSAqIFRoaXMgQmluYXJpemVyIGlzIHRoZSBkZWZhdWx0IGZvciB0aGUgdW5pdCB0ZXN0cyBhbmQgdGhlIHJlY29tbWVuZGVkIGNsYXNzIGZvciBsaWJyYXJ5IHVzZXJzLgoJICoKCSAqIEBhdXRob3IgZHN3aXRraW5AZ29vZ2xlLmNvbSAoRGFuaWVsIFN3aXRraW4pCgkgKi8KCXZhciBIeWJyaWRCaW5hcml6ZXIgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7CgkgICAgX19leHRlbmRzJGIoSHlicmlkQmluYXJpemVyLCBfc3VwZXIpOwoJICAgIGZ1bmN0aW9uIEh5YnJpZEJpbmFyaXplcihzb3VyY2UpIHsKCSAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcywgc291cmNlKSB8fCB0aGlzOwoJICAgICAgICBfdGhpcy5tYXRyaXggPSBudWxsOwoJICAgICAgICByZXR1cm4gX3RoaXM7CgkgICAgfQoJICAgIC8qKgoJICAgICAqIENhbGN1bGF0ZXMgdGhlIGZpbmFsIEJpdE1hdHJpeCBvbmNlIGZvciBhbGwgcmVxdWVzdHMuIFRoaXMgY291bGQgYmUgY2FsbGVkIG9uY2UgZnJvbSB0aGUKCSAgICAgKiBjb25zdHJ1Y3RvciBpbnN0ZWFkLCBidXQgdGhlcmUgYXJlIHNvbWUgYWR2YW50YWdlcyB0byBkb2luZyBpdCBsYXppbHksIHN1Y2ggYXMgbWFraW5nCgkgICAgICogcHJvZmlsaW5nIGVhc2llciwgYW5kIG5vdCBkb2luZyBoZWF2eSBsaWZ0aW5nIHdoZW4gY2FsbGVycyBkb24ndCBleHBlY3QgaXQuCgkgICAgICovCgkgICAgLypAT3ZlcnJpZGUqLwoJICAgIEh5YnJpZEJpbmFyaXplci5wcm90b3R5cGUuZ2V0QmxhY2tNYXRyaXggPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIGlmICh0aGlzLm1hdHJpeCAhPT0gbnVsbCkgewoJICAgICAgICAgICAgcmV0dXJuIHRoaXMubWF0cml4OwoJICAgICAgICB9CgkgICAgICAgIHZhciBzb3VyY2UgPSB0aGlzLmdldEx1bWluYW5jZVNvdXJjZSgpOwoJICAgICAgICB2YXIgd2lkdGggPSBzb3VyY2UuZ2V0V2lkdGgoKTsKCSAgICAgICAgdmFyIGhlaWdodCA9IHNvdXJjZS5nZXRIZWlnaHQoKTsKCSAgICAgICAgaWYgKHdpZHRoID49IEh5YnJpZEJpbmFyaXplci5NSU5JTVVNX0RJTUVOU0lPTiAmJiBoZWlnaHQgPj0gSHlicmlkQmluYXJpemVyLk1JTklNVU1fRElNRU5TSU9OKSB7CgkgICAgICAgICAgICB2YXIgbHVtaW5hbmNlcyA9IHNvdXJjZS5nZXRNYXRyaXgoKTsKCSAgICAgICAgICAgIHZhciBzdWJXaWR0aCA9IHdpZHRoID4+IEh5YnJpZEJpbmFyaXplci5CTE9DS19TSVpFX1BPV0VSOwoJICAgICAgICAgICAgaWYgKCh3aWR0aCAmIEh5YnJpZEJpbmFyaXplci5CTE9DS19TSVpFX01BU0spICE9PSAwKSB7CgkgICAgICAgICAgICAgICAgc3ViV2lkdGgrKzsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIHZhciBzdWJIZWlnaHQgPSBoZWlnaHQgPj4gSHlicmlkQmluYXJpemVyLkJMT0NLX1NJWkVfUE9XRVI7CgkgICAgICAgICAgICBpZiAoKGhlaWdodCAmIEh5YnJpZEJpbmFyaXplci5CTE9DS19TSVpFX01BU0spICE9PSAwKSB7CgkgICAgICAgICAgICAgICAgc3ViSGVpZ2h0Kys7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICB2YXIgYmxhY2tQb2ludHMgPSBIeWJyaWRCaW5hcml6ZXIuY2FsY3VsYXRlQmxhY2tQb2ludHMobHVtaW5hbmNlcywgc3ViV2lkdGgsIHN1YkhlaWdodCwgd2lkdGgsIGhlaWdodCk7CgkgICAgICAgICAgICB2YXIgbmV3TWF0cml4ID0gbmV3IEJpdE1hdHJpeF8xJDQuZGVmYXVsdCh3aWR0aCwgaGVpZ2h0KTsKCSAgICAgICAgICAgIEh5YnJpZEJpbmFyaXplci5jYWxjdWxhdGVUaHJlc2hvbGRGb3JCbG9jayhsdW1pbmFuY2VzLCBzdWJXaWR0aCwgc3ViSGVpZ2h0LCB3aWR0aCwgaGVpZ2h0LCBibGFja1BvaW50cywgbmV3TWF0cml4KTsKCSAgICAgICAgICAgIHRoaXMubWF0cml4ID0gbmV3TWF0cml4OwoJICAgICAgICB9CgkgICAgICAgIGVsc2UgewoJICAgICAgICAgICAgLy8gSWYgdGhlIGltYWdlIGlzIHRvbyBzbWFsbCwgZmFsbCBiYWNrIHRvIHRoZSBnbG9iYWwgaGlzdG9ncmFtIGFwcHJvYWNoLgoJICAgICAgICAgICAgdGhpcy5tYXRyaXggPSBfc3VwZXIucHJvdG90eXBlLmdldEJsYWNrTWF0cml4LmNhbGwodGhpcyk7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIHRoaXMubWF0cml4OwoJICAgIH07CgkgICAgLypAT3ZlcnJpZGUqLwoJICAgIEh5YnJpZEJpbmFyaXplci5wcm90b3R5cGUuY3JlYXRlQmluYXJpemVyID0gZnVuY3Rpb24gKHNvdXJjZSkgewoJICAgICAgICByZXR1cm4gbmV3IEh5YnJpZEJpbmFyaXplcihzb3VyY2UpOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogRm9yIGVhY2ggYmxvY2sgaW4gdGhlIGltYWdlLCBjYWxjdWxhdGUgdGhlIGF2ZXJhZ2UgYmxhY2sgcG9pbnQgdXNpbmcgYSA1eDUgZ3JpZAoJICAgICAqIG9mIHRoZSBibG9ja3MgYXJvdW5kIGl0LiBBbHNvIGhhbmRsZXMgdGhlIGNvcm5lciBjYXNlcyAoZnJhY3Rpb25hbCBibG9ja3MgYXJlIGNvbXB1dGVkIGJhc2VkCgkgICAgICogb24gdGhlIGxhc3QgcGl4ZWxzIGluIHRoZSByb3cvY29sdW1uIHdoaWNoIGFyZSBhbHNvIHVzZWQgaW4gdGhlIHByZXZpb3VzIGJsb2NrKS4KCSAgICAgKi8KCSAgICBIeWJyaWRCaW5hcml6ZXIuY2FsY3VsYXRlVGhyZXNob2xkRm9yQmxvY2sgPSBmdW5jdGlvbiAobHVtaW5hbmNlcywgc3ViV2lkdGggLyppbnQqLywgc3ViSGVpZ2h0IC8qaW50Ki8sIHdpZHRoIC8qaW50Ki8sIGhlaWdodCAvKmludCovLCBibGFja1BvaW50cywgbWF0cml4KSB7CgkgICAgICAgIHZhciBtYXhZT2Zmc2V0ID0gaGVpZ2h0IC0gSHlicmlkQmluYXJpemVyLkJMT0NLX1NJWkU7CgkgICAgICAgIHZhciBtYXhYT2Zmc2V0ID0gd2lkdGggLSBIeWJyaWRCaW5hcml6ZXIuQkxPQ0tfU0laRTsKCSAgICAgICAgZm9yICh2YXIgeSA9IDA7IHkgPCBzdWJIZWlnaHQ7IHkrKykgewoJICAgICAgICAgICAgdmFyIHlvZmZzZXQgPSB5IDw8IEh5YnJpZEJpbmFyaXplci5CTE9DS19TSVpFX1BPV0VSOwoJICAgICAgICAgICAgaWYgKHlvZmZzZXQgPiBtYXhZT2Zmc2V0KSB7CgkgICAgICAgICAgICAgICAgeW9mZnNldCA9IG1heFlPZmZzZXQ7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICB2YXIgdG9wXzEgPSBIeWJyaWRCaW5hcml6ZXIuY2FwKHksIDIsIHN1YkhlaWdodCAtIDMpOwoJICAgICAgICAgICAgZm9yICh2YXIgeCA9IDA7IHggPCBzdWJXaWR0aDsgeCsrKSB7CgkgICAgICAgICAgICAgICAgdmFyIHhvZmZzZXQgPSB4IDw8IEh5YnJpZEJpbmFyaXplci5CTE9DS19TSVpFX1BPV0VSOwoJICAgICAgICAgICAgICAgIGlmICh4b2Zmc2V0ID4gbWF4WE9mZnNldCkgewoJICAgICAgICAgICAgICAgICAgICB4b2Zmc2V0ID0gbWF4WE9mZnNldDsKCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgdmFyIGxlZnQgPSBIeWJyaWRCaW5hcml6ZXIuY2FwKHgsIDIsIHN1YldpZHRoIC0gMyk7CgkgICAgICAgICAgICAgICAgdmFyIHN1bSA9IDA7CgkgICAgICAgICAgICAgICAgZm9yICh2YXIgeiA9IC0yOyB6IDw9IDI7IHorKykgewoJICAgICAgICAgICAgICAgICAgICB2YXIgYmxhY2tSb3cgPSBibGFja1BvaW50c1t0b3BfMSArIHpdOwoJICAgICAgICAgICAgICAgICAgICBzdW0gKz0gYmxhY2tSb3dbbGVmdCAtIDJdICsgYmxhY2tSb3dbbGVmdCAtIDFdICsgYmxhY2tSb3dbbGVmdF0gKyBibGFja1Jvd1tsZWZ0ICsgMV0gKyBibGFja1Jvd1tsZWZ0ICsgMl07CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgIHZhciBhdmVyYWdlID0gc3VtIC8gMjU7CgkgICAgICAgICAgICAgICAgSHlicmlkQmluYXJpemVyLnRocmVzaG9sZEJsb2NrKGx1bWluYW5jZXMsIHhvZmZzZXQsIHlvZmZzZXQsIGF2ZXJhZ2UsIHdpZHRoLCBtYXRyaXgpOwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgfTsKCSAgICBIeWJyaWRCaW5hcml6ZXIuY2FwID0gZnVuY3Rpb24gKHZhbHVlIC8qaW50Ki8sIG1pbiAvKmludCovLCBtYXggLyppbnQqLykgewoJICAgICAgICByZXR1cm4gdmFsdWUgPCBtaW4gPyBtaW4gOiB2YWx1ZSA+IG1heCA/IG1heCA6IHZhbHVlOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQXBwbGllcyBhIHNpbmdsZSB0aHJlc2hvbGQgdG8gYSBibG9jayBvZiBwaXhlbHMuCgkgICAgICovCgkgICAgSHlicmlkQmluYXJpemVyLnRocmVzaG9sZEJsb2NrID0gZnVuY3Rpb24gKGx1bWluYW5jZXMsIHhvZmZzZXQgLyppbnQqLywgeW9mZnNldCAvKmludCovLCB0aHJlc2hvbGQgLyppbnQqLywgc3RyaWRlIC8qaW50Ki8sIG1hdHJpeCkgewoJICAgICAgICBmb3IgKHZhciB5ID0gMCwgb2Zmc2V0ID0geW9mZnNldCAqIHN0cmlkZSArIHhvZmZzZXQ7IHkgPCBIeWJyaWRCaW5hcml6ZXIuQkxPQ0tfU0laRTsgeSsrLCBvZmZzZXQgKz0gc3RyaWRlKSB7CgkgICAgICAgICAgICBmb3IgKHZhciB4ID0gMDsgeCA8IEh5YnJpZEJpbmFyaXplci5CTE9DS19TSVpFOyB4KyspIHsKCSAgICAgICAgICAgICAgICAvLyBDb21wYXJpc29uIG5lZWRzIHRvIGJlIDw9IHNvIHRoYXQgYmxhY2sgPT0gMCBwaXhlbHMgYXJlIGJsYWNrIGV2ZW4gaWYgdGhlIHRocmVzaG9sZCBpcyAwLgoJICAgICAgICAgICAgICAgIGlmICgobHVtaW5hbmNlc1tvZmZzZXQgKyB4XSAmIDB4RkYpIDw9IHRocmVzaG9sZCkgewoJICAgICAgICAgICAgICAgICAgICBtYXRyaXguc2V0KHhvZmZzZXQgKyB4LCB5b2Zmc2V0ICsgeSk7CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBDYWxjdWxhdGVzIGEgc2luZ2xlIGJsYWNrIHBvaW50IGZvciBlYWNoIGJsb2NrIG9mIHBpeGVscyBhbmQgc2F2ZXMgaXQgYXdheS4KCSAgICAgKiBTZWUgdGhlIGZvbGxvd2luZyB0aHJlYWQgZm9yIGEgZGlzY3Vzc2lvbiBvZiB0aGlzIGFsZ29yaXRobToKCSAgICAgKiAgaHR0cDovL2dyb3Vwcy5nb29nbGUuY29tL2dyb3VwL3p4aW5nL2Jyb3dzZV90aHJlYWQvdGhyZWFkL2QwNmVmYTJjMzVhN2RkYzAKCSAgICAgKi8KCSAgICBIeWJyaWRCaW5hcml6ZXIuY2FsY3VsYXRlQmxhY2tQb2ludHMgPSBmdW5jdGlvbiAobHVtaW5hbmNlcywgc3ViV2lkdGggLyppbnQqLywgc3ViSGVpZ2h0IC8qaW50Ki8sIHdpZHRoIC8qaW50Ki8sIGhlaWdodCAvKmludCovKSB7CgkgICAgICAgIHZhciBtYXhZT2Zmc2V0ID0gaGVpZ2h0IC0gSHlicmlkQmluYXJpemVyLkJMT0NLX1NJWkU7CgkgICAgICAgIHZhciBtYXhYT2Zmc2V0ID0gd2lkdGggLSBIeWJyaWRCaW5hcml6ZXIuQkxPQ0tfU0laRTsKCSAgICAgICAgLy8gdHNsaW50OmRpc2FibGUtbmV4dC1saW5lOndoaXRlc3BhY2UKCSAgICAgICAgdmFyIGJsYWNrUG9pbnRzID0gbmV3IEFycmF5KHN1YkhlaWdodCk7IC8vIHN1YldpZHRoCgkgICAgICAgIGZvciAodmFyIHkgPSAwOyB5IDwgc3ViSGVpZ2h0OyB5KyspIHsKCSAgICAgICAgICAgIGJsYWNrUG9pbnRzW3ldID0gbmV3IEludDMyQXJyYXkoc3ViV2lkdGgpOwoJICAgICAgICAgICAgdmFyIHlvZmZzZXQgPSB5IDw8IEh5YnJpZEJpbmFyaXplci5CTE9DS19TSVpFX1BPV0VSOwoJICAgICAgICAgICAgaWYgKHlvZmZzZXQgPiBtYXhZT2Zmc2V0KSB7CgkgICAgICAgICAgICAgICAgeW9mZnNldCA9IG1heFlPZmZzZXQ7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBmb3IgKHZhciB4ID0gMDsgeCA8IHN1YldpZHRoOyB4KyspIHsKCSAgICAgICAgICAgICAgICB2YXIgeG9mZnNldCA9IHggPDwgSHlicmlkQmluYXJpemVyLkJMT0NLX1NJWkVfUE9XRVI7CgkgICAgICAgICAgICAgICAgaWYgKHhvZmZzZXQgPiBtYXhYT2Zmc2V0KSB7CgkgICAgICAgICAgICAgICAgICAgIHhvZmZzZXQgPSBtYXhYT2Zmc2V0OwoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICB2YXIgc3VtID0gMDsKCSAgICAgICAgICAgICAgICB2YXIgbWluID0gMHhGRjsKCSAgICAgICAgICAgICAgICB2YXIgbWF4ID0gMDsKCSAgICAgICAgICAgICAgICBmb3IgKHZhciB5eSA9IDAsIG9mZnNldCA9IHlvZmZzZXQgKiB3aWR0aCArIHhvZmZzZXQ7IHl5IDwgSHlicmlkQmluYXJpemVyLkJMT0NLX1NJWkU7IHl5KyssIG9mZnNldCArPSB3aWR0aCkgewoJICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciB4eCA9IDA7IHh4IDwgSHlicmlkQmluYXJpemVyLkJMT0NLX1NJWkU7IHh4KyspIHsKCSAgICAgICAgICAgICAgICAgICAgICAgIHZhciBwaXhlbCA9IGx1bWluYW5jZXNbb2Zmc2V0ICsgeHhdICYgMHhGRjsKCSAgICAgICAgICAgICAgICAgICAgICAgIHN1bSArPSBwaXhlbDsKCSAgICAgICAgICAgICAgICAgICAgICAgIC8vIHN0aWxsIGxvb2tpbmcgZm9yIGdvb2QgY29udHJhc3QKCSAgICAgICAgICAgICAgICAgICAgICAgIGlmIChwaXhlbCA8IG1pbikgewoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1pbiA9IHBpeGVsOwoJICAgICAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHBpeGVsID4gbWF4KSB7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWF4ID0gcGl4ZWw7CgkgICAgICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICAgICAgLy8gc2hvcnQtY2lyY3VpdCBtaW4vbWF4IHRlc3RzIG9uY2UgZHluYW1pYyByYW5nZSBpcyBtZXQKCSAgICAgICAgICAgICAgICAgICAgaWYgKG1heCAtIG1pbiA+IEh5YnJpZEJpbmFyaXplci5NSU5fRFlOQU1JQ19SQU5HRSkgewoJICAgICAgICAgICAgICAgICAgICAgICAgLy8gZmluaXNoIHRoZSByZXN0IG9mIHRoZSByb3dzIHF1aWNrbHkKCSAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoeXkrKywgb2Zmc2V0ICs9IHdpZHRoOyB5eSA8IEh5YnJpZEJpbmFyaXplci5CTE9DS19TSVpFOyB5eSsrLCBvZmZzZXQgKz0gd2lkdGgpIHsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciB4eCA9IDA7IHh4IDwgSHlicmlkQmluYXJpemVyLkJMT0NLX1NJWkU7IHh4KyspIHsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3VtICs9IGx1bWluYW5jZXNbb2Zmc2V0ICsgeHhdICYgMHhGRjsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgLy8gVGhlIGRlZmF1bHQgZXN0aW1hdGUgaXMgdGhlIGF2ZXJhZ2Ugb2YgdGhlIHZhbHVlcyBpbiB0aGUgYmxvY2suCgkgICAgICAgICAgICAgICAgdmFyIGF2ZXJhZ2UgPSBzdW0gPj4gKEh5YnJpZEJpbmFyaXplci5CTE9DS19TSVpFX1BPV0VSICogMik7CgkgICAgICAgICAgICAgICAgaWYgKG1heCAtIG1pbiA8PSBIeWJyaWRCaW5hcml6ZXIuTUlOX0RZTkFNSUNfUkFOR0UpIHsKCSAgICAgICAgICAgICAgICAgICAgLy8gSWYgdmFyaWF0aW9uIHdpdGhpbiB0aGUgYmxvY2sgaXMgbG93LCBhc3N1bWUgdGhpcyBpcyBhIGJsb2NrIHdpdGggb25seSBsaWdodCBvciBvbmx5CgkgICAgICAgICAgICAgICAgICAgIC8vIGRhcmsgcGl4ZWxzLiBJbiB0aGF0IGNhc2Ugd2UgZG8gbm90IHdhbnQgdG8gdXNlIHRoZSBhdmVyYWdlLCBhcyBpdCB3b3VsZCBkaXZpZGUgdGhpcwoJICAgICAgICAgICAgICAgICAgICAvLyBsb3cgY29udHJhc3QgYXJlYSBpbnRvIGJsYWNrIGFuZCB3aGl0ZSBwaXhlbHMsIGVzc2VudGlhbGx5IGNyZWF0aW5nIGRhdGEgb3V0IG9mIG5vaXNlLgoJICAgICAgICAgICAgICAgICAgICAvLwoJICAgICAgICAgICAgICAgICAgICAvLyBUaGUgZGVmYXVsdCBhc3N1bXB0aW9uIGlzIHRoYXQgdGhlIGJsb2NrIGlzIGxpZ2h0L2JhY2tncm91bmQuIFNpbmNlIG5vIGVzdGltYXRlIGZvcgoJICAgICAgICAgICAgICAgICAgICAvLyB0aGUgbGV2ZWwgb2YgZGFyayBwaXhlbHMgZXhpc3RzIGxvY2FsbHksIHVzZSBoYWxmIHRoZSBtaW4gZm9yIHRoZSBibG9jay4KCSAgICAgICAgICAgICAgICAgICAgYXZlcmFnZSA9IG1pbiAvIDI7CgkgICAgICAgICAgICAgICAgICAgIGlmICh5ID4gMCAmJiB4ID4gMCkgewoJICAgICAgICAgICAgICAgICAgICAgICAgLy8gQ29ycmVjdCB0aGUgIndoaXRlIGJhY2tncm91bmQiIGFzc3VtcHRpb24gZm9yIGJsb2NrcyB0aGF0IGhhdmUgbmVpZ2hib3JzIGJ5IGNvbXBhcmluZwoJICAgICAgICAgICAgICAgICAgICAgICAgLy8gdGhlIHBpeGVscyBpbiB0aGlzIGJsb2NrIHRvIHRoZSBwcmV2aW91c2x5IGNhbGN1bGF0ZWQgYmxhY2sgcG9pbnRzLiBUaGlzIGlzIGJhc2VkIG9uCgkgICAgICAgICAgICAgICAgICAgICAgICAvLyB0aGUgZmFjdCB0aGF0IGRhcmsgYmFyY29kZSBzeW1ib2xvZ3kgaXMgYWx3YXlzIHN1cnJvdW5kZWQgYnkgc29tZSBhbW91bnQgb2YgbGlnaHQKCSAgICAgICAgICAgICAgICAgICAgICAgIC8vIGJhY2tncm91bmQgZm9yIHdoaWNoIHJlYXNvbmFibGUgYmxhY2sgcG9pbnQgZXN0aW1hdGVzIHdlcmUgbWFkZS4gVGhlIGJwIGVzdGltYXRlZCBhdAoJICAgICAgICAgICAgICAgICAgICAgICAgLy8gdGhlIGJvdW5kYXJpZXMgaXMgdXNlZCBmb3IgdGhlIGludGVyaW9yLgoJICAgICAgICAgICAgICAgICAgICAgICAgLy8gVGhlIChtaW4gPCBicCkgaXMgYXJiaXRyYXJ5IGJ1dCB3b3JrcyBiZXR0ZXIgdGhhbiBvdGhlciBoZXVyaXN0aWNzIHRoYXQgd2VyZSB0cmllZC4KCSAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhdmVyYWdlTmVpZ2hib3JCbGFja1BvaW50ID0gKGJsYWNrUG9pbnRzW3kgLSAxXVt4XSArICgyICogYmxhY2tQb2ludHNbeV1beCAtIDFdKSArIGJsYWNrUG9pbnRzW3kgLSAxXVt4IC0gMV0pIC8gNDsKCSAgICAgICAgICAgICAgICAgICAgICAgIGlmIChtaW4gPCBhdmVyYWdlTmVpZ2hib3JCbGFja1BvaW50KSB7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXZlcmFnZSA9IGF2ZXJhZ2VOZWlnaGJvckJsYWNrUG9pbnQ7CgkgICAgICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgYmxhY2tQb2ludHNbeV1beF0gPSBhdmVyYWdlOwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIHJldHVybiBibGFja1BvaW50czsKCSAgICB9OwoJICAgIC8vIFRoaXMgY2xhc3MgdXNlcyA1eDUgYmxvY2tzIHRvIGNvbXB1dGUgbG9jYWwgbHVtaW5hbmNlLCB3aGVyZSBlYWNoIGJsb2NrIGlzIDh4OCBwaXhlbHMuCgkgICAgLy8gU28gdGhpcyBpcyB0aGUgc21hbGxlc3QgZGltZW5zaW9uIGluIGVhY2ggYXhpcyB3ZSBjYW4gYWNjZXB0LgoJICAgIEh5YnJpZEJpbmFyaXplci5CTE9DS19TSVpFX1BPV0VSID0gMzsKCSAgICBIeWJyaWRCaW5hcml6ZXIuQkxPQ0tfU0laRSA9IDEgPDwgSHlicmlkQmluYXJpemVyLkJMT0NLX1NJWkVfUE9XRVI7IC8vIC4uLjAxMDAuLi4wMAoJICAgIEh5YnJpZEJpbmFyaXplci5CTE9DS19TSVpFX01BU0sgPSBIeWJyaWRCaW5hcml6ZXIuQkxPQ0tfU0laRSAtIDE7IC8vIC4uLjAwMTEuLi4xMQoJICAgIEh5YnJpZEJpbmFyaXplci5NSU5JTVVNX0RJTUVOU0lPTiA9IEh5YnJpZEJpbmFyaXplci5CTE9DS19TSVpFICogNTsKCSAgICBIeWJyaWRCaW5hcml6ZXIuTUlOX0RZTkFNSUNfUkFOR0UgPSAyNDsKCSAgICByZXR1cm4gSHlicmlkQmluYXJpemVyOwoJfShHbG9iYWxIaXN0b2dyYW1CaW5hcml6ZXJfMS5kZWZhdWx0KSk7Cgl2YXIgX2RlZmF1bHQkMiA9IEh5YnJpZEJpbmFyaXplciQxLmRlZmF1bHQgPSBIeWJyaWRCaW5hcml6ZXI7CgoJdmFyIFJHQkx1bWluYW5jZVNvdXJjZSQxID0ge307CgoJdmFyIEludmVydGVkTHVtaW5hbmNlU291cmNlJDEgPSB7fTsKCgl2YXIgTHVtaW5hbmNlU291cmNlJDEgPSB7fTsKCgkvKgoJICogQ29weXJpZ2h0IDIwMDkgWlhpbmcgYXV0aG9ycwoJICoKCSAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoJICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoJICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkgKgoJICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKCSAqCgkgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCgkgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoJICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCgkgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCSAqLwoJT2JqZWN0LmRlZmluZVByb3BlcnR5KEx1bWluYW5jZVNvdXJjZSQxLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7Cgl2YXIgU3RyaW5nQnVpbGRlcl8xJDEgPSBTdHJpbmdCdWlsZGVyJDE7Cgl2YXIgVW5zdXBwb3J0ZWRPcGVyYXRpb25FeGNlcHRpb25fMSA9IFVuc3VwcG9ydGVkT3BlcmF0aW9uRXhjZXB0aW9uJDE7CgkvKm5hbWVzcGFjZSBjb20uZ29vZ2xlLnp4aW5nIHsqLwoJLyoqCgkgKiBUaGUgcHVycG9zZSBvZiB0aGlzIGNsYXNzIGhpZXJhcmNoeSBpcyB0byBhYnN0cmFjdCBkaWZmZXJlbnQgYml0bWFwIGltcGxlbWVudGF0aW9ucyBhY3Jvc3MKCSAqIHBsYXRmb3JtcyBpbnRvIGEgc3RhbmRhcmQgaW50ZXJmYWNlIGZvciByZXF1ZXN0aW5nIGdyZXlzY2FsZSBsdW1pbmFuY2UgdmFsdWVzLiBUaGUgaW50ZXJmYWNlCgkgKiBvbmx5IHByb3ZpZGVzIGltbXV0YWJsZSBtZXRob2RzOyB0aGVyZWZvcmUgY3JvcCBhbmQgcm90YXRpb24gY3JlYXRlIGNvcGllcy4gVGhpcyBpcyB0byBlbnN1cmUKCSAqIHRoYXQgb25lIFJlYWRlciBkb2VzIG5vdCBtb2RpZnkgdGhlIG9yaWdpbmFsIGx1bWluYW5jZSBzb3VyY2UgYW5kIGxlYXZlIGl0IGluIGFuIHVua25vd24gc3RhdGUKCSAqIGZvciBvdGhlciBSZWFkZXJzIGluIHRoZSBjaGFpbi4KCSAqCgkgKiBAYXV0aG9yIGRzd2l0a2luQGdvb2dsZS5jb20gKERhbmllbCBTd2l0a2luKQoJICovCgl2YXIgTHVtaW5hbmNlU291cmNlID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkgewoJICAgIGZ1bmN0aW9uIEx1bWluYW5jZVNvdXJjZSh3aWR0aCAvKmludCovLCBoZWlnaHQgLyppbnQqLykgewoJICAgICAgICB0aGlzLndpZHRoID0gd2lkdGg7CgkgICAgICAgIHRoaXMuaGVpZ2h0ID0gaGVpZ2h0OwoJICAgIH0KCSAgICAvKioKCSAgICAgKiBAcmV0dXJuIFRoZSB3aWR0aCBvZiB0aGUgYml0bWFwLgoJICAgICAqLwoJICAgIEx1bWluYW5jZVNvdXJjZS5wcm90b3R5cGUuZ2V0V2lkdGggPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLndpZHRoOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQHJldHVybiBUaGUgaGVpZ2h0IG9mIHRoZSBiaXRtYXAuCgkgICAgICovCgkgICAgTHVtaW5hbmNlU291cmNlLnByb3RvdHlwZS5nZXRIZWlnaHQgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLmhlaWdodDsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEByZXR1cm4gV2hldGhlciB0aGlzIHN1YmNsYXNzIHN1cHBvcnRzIGNyb3BwaW5nLgoJICAgICAqLwoJICAgIEx1bWluYW5jZVNvdXJjZS5wcm90b3R5cGUuaXNDcm9wU3VwcG9ydGVkID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gZmFsc2U7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBSZXR1cm5zIGEgbmV3IG9iamVjdCB3aXRoIGNyb3BwZWQgaW1hZ2UgZGF0YS4gSW1wbGVtZW50YXRpb25zIG1heSBrZWVwIGEgcmVmZXJlbmNlIHRvIHRoZQoJICAgICAqIG9yaWdpbmFsIGRhdGEgcmF0aGVyIHRoYW4gYSBjb3B5LiBPbmx5IGNhbGxhYmxlIGlmIGlzQ3JvcFN1cHBvcnRlZCgpIGlzIHRydWUuCgkgICAgICoKCSAgICAgKiBAcGFyYW0gbGVmdCBUaGUgbGVmdCBjb29yZGluYXRlLCB3aGljaCBtdXN0IGJlIGluIFswLGdldFdpZHRoKCkpCgkgICAgICogQHBhcmFtIHRvcCBUaGUgdG9wIGNvb3JkaW5hdGUsIHdoaWNoIG11c3QgYmUgaW4gWzAsZ2V0SGVpZ2h0KCkpCgkgICAgICogQHBhcmFtIHdpZHRoIFRoZSB3aWR0aCBvZiB0aGUgcmVjdGFuZ2xlIHRvIGNyb3AuCgkgICAgICogQHBhcmFtIGhlaWdodCBUaGUgaGVpZ2h0IG9mIHRoZSByZWN0YW5nbGUgdG8gY3JvcC4KCSAgICAgKiBAcmV0dXJuIEEgY3JvcHBlZCB2ZXJzaW9uIG9mIHRoaXMgb2JqZWN0LgoJICAgICAqLwoJICAgIEx1bWluYW5jZVNvdXJjZS5wcm90b3R5cGUuY3JvcCA9IGZ1bmN0aW9uIChsZWZ0IC8qaW50Ki8sIHRvcCAvKmludCovLCB3aWR0aCAvKmludCovLCBoZWlnaHQgLyppbnQqLykgewoJICAgICAgICB0aHJvdyBuZXcgVW5zdXBwb3J0ZWRPcGVyYXRpb25FeGNlcHRpb25fMS5kZWZhdWx0KCdUaGlzIGx1bWluYW5jZSBzb3VyY2UgZG9lcyBub3Qgc3VwcG9ydCBjcm9wcGluZy4nKTsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEByZXR1cm4gV2hldGhlciB0aGlzIHN1YmNsYXNzIHN1cHBvcnRzIGNvdW50ZXItY2xvY2t3aXNlIHJvdGF0aW9uLgoJICAgICAqLwoJICAgIEx1bWluYW5jZVNvdXJjZS5wcm90b3R5cGUuaXNSb3RhdGVTdXBwb3J0ZWQgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiBmYWxzZTsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIFJldHVybnMgYSBuZXcgb2JqZWN0IHdpdGggcm90YXRlZCBpbWFnZSBkYXRhIGJ5IDkwIGRlZ3JlZXMgY291bnRlcmNsb2Nrd2lzZS4KCSAgICAgKiBPbmx5IGNhbGxhYmxlIGlmIHtAbGluayAjaXNSb3RhdGVTdXBwb3J0ZWQoKX0gaXMgdHJ1ZS4KCSAgICAgKgoJICAgICAqIEByZXR1cm4gQSByb3RhdGVkIHZlcnNpb24gb2YgdGhpcyBvYmplY3QuCgkgICAgICovCgkgICAgTHVtaW5hbmNlU291cmNlLnByb3RvdHlwZS5yb3RhdGVDb3VudGVyQ2xvY2t3aXNlID0gZnVuY3Rpb24gKCkgewoJICAgICAgICB0aHJvdyBuZXcgVW5zdXBwb3J0ZWRPcGVyYXRpb25FeGNlcHRpb25fMS5kZWZhdWx0KCdUaGlzIGx1bWluYW5jZSBzb3VyY2UgZG9lcyBub3Qgc3VwcG9ydCByb3RhdGlvbiBieSA5MCBkZWdyZWVzLicpOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogUmV0dXJucyBhIG5ldyBvYmplY3Qgd2l0aCByb3RhdGVkIGltYWdlIGRhdGEgYnkgNDUgZGVncmVlcyBjb3VudGVyY2xvY2t3aXNlLgoJICAgICAqIE9ubHkgY2FsbGFibGUgaWYge0BsaW5rICNpc1JvdGF0ZVN1cHBvcnRlZCgpfSBpcyB0cnVlLgoJICAgICAqCgkgICAgICogQHJldHVybiBBIHJvdGF0ZWQgdmVyc2lvbiBvZiB0aGlzIG9iamVjdC4KCSAgICAgKi8KCSAgICBMdW1pbmFuY2VTb3VyY2UucHJvdG90eXBlLnJvdGF0ZUNvdW50ZXJDbG9ja3dpc2U0NSA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgdGhyb3cgbmV3IFVuc3VwcG9ydGVkT3BlcmF0aW9uRXhjZXB0aW9uXzEuZGVmYXVsdCgnVGhpcyBsdW1pbmFuY2Ugc291cmNlIGRvZXMgbm90IHN1cHBvcnQgcm90YXRpb24gYnkgNDUgZGVncmVlcy4nKTsKCSAgICB9OwoJICAgIC8qQE92ZXJyaWRlKi8KCSAgICBMdW1pbmFuY2VTb3VyY2UucHJvdG90eXBlLnRvU3RyaW5nID0gZnVuY3Rpb24gKCkgewoJICAgICAgICB2YXIgcm93ID0gbmV3IFVpbnQ4Q2xhbXBlZEFycmF5KHRoaXMud2lkdGgpOwoJICAgICAgICB2YXIgcmVzdWx0ID0gbmV3IFN0cmluZ0J1aWxkZXJfMSQxLmRlZmF1bHQoKTsKCSAgICAgICAgZm9yICh2YXIgeSA9IDA7IHkgPCB0aGlzLmhlaWdodDsgeSsrKSB7CgkgICAgICAgICAgICB2YXIgc291cmNlUm93ID0gdGhpcy5nZXRSb3coeSwgcm93KTsKCSAgICAgICAgICAgIGZvciAodmFyIHggPSAwOyB4IDwgdGhpcy53aWR0aDsgeCsrKSB7CgkgICAgICAgICAgICAgICAgdmFyIGx1bWluYW5jZSA9IHNvdXJjZVJvd1t4XSAmIDB4RkY7CgkgICAgICAgICAgICAgICAgdmFyIGMgPSB2b2lkIDA7CgkgICAgICAgICAgICAgICAgaWYgKGx1bWluYW5jZSA8IDB4NDApIHsKCSAgICAgICAgICAgICAgICAgICAgYyA9ICcjJzsKCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgZWxzZSBpZiAobHVtaW5hbmNlIDwgMHg4MCkgewoJICAgICAgICAgICAgICAgICAgICBjID0gJysnOwoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICBlbHNlIGlmIChsdW1pbmFuY2UgPCAweEMwKSB7CgkgICAgICAgICAgICAgICAgICAgIGMgPSAnLic7CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgIGVsc2UgewoJICAgICAgICAgICAgICAgICAgICBjID0gJyAnOwoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICByZXN1bHQuYXBwZW5kKGMpOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgcmVzdWx0LmFwcGVuZCgnXG4nKTsKCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gcmVzdWx0LnRvU3RyaW5nKCk7CgkgICAgfTsKCSAgICByZXR1cm4gTHVtaW5hbmNlU291cmNlOwoJfSgpKTsKCUx1bWluYW5jZVNvdXJjZSQxLmRlZmF1bHQgPSBMdW1pbmFuY2VTb3VyY2U7CgoJLyoKCSAqIENvcHlyaWdodCAyMDA5IFpYaW5nIGF1dGhvcnMKCSAqCgkgKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKCSAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4KCSAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdAoJICoKCSAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wCgkgKgoJICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZQoJICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gIkFTIElTIiBCQVNJUywKCSAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLgoJICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZAoJICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuCgkgKi8KCXZhciBfX2V4dGVuZHMkYSA9IChjb21tb25qc0dsb2JhbCAmJiBjb21tb25qc0dsb2JhbC5fX2V4dGVuZHMpIHx8IChmdW5jdGlvbiAoKSB7CgkgICAgdmFyIGV4dGVuZFN0YXRpY3MgPSBmdW5jdGlvbiAoZCwgYikgewoJICAgICAgICBleHRlbmRTdGF0aWNzID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8CgkgICAgICAgICAgICAoeyBfX3Byb3RvX186IFtdIH0gaW5zdGFuY2VvZiBBcnJheSAmJiBmdW5jdGlvbiAoZCwgYikgeyBkLl9fcHJvdG9fXyA9IGI7IH0pIHx8CgkgICAgICAgICAgICBmdW5jdGlvbiAoZCwgYikgeyBmb3IgKHZhciBwIGluIGIpIGlmIChiLmhhc093blByb3BlcnR5KHApKSBkW3BdID0gYltwXTsgfTsKCSAgICAgICAgcmV0dXJuIGV4dGVuZFN0YXRpY3MoZCwgYik7CgkgICAgfTsKCSAgICByZXR1cm4gZnVuY3Rpb24gKGQsIGIpIHsKCSAgICAgICAgZXh0ZW5kU3RhdGljcyhkLCBiKTsKCSAgICAgICAgZnVuY3Rpb24gX18oKSB7IHRoaXMuY29uc3RydWN0b3IgPSBkOyB9CgkgICAgICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTsKCSAgICB9OwoJfSkoKTsKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShJbnZlcnRlZEx1bWluYW5jZVNvdXJjZSQxLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7Cgl2YXIgTHVtaW5hbmNlU291cmNlXzEkMSA9IEx1bWluYW5jZVNvdXJjZSQxOwoJLypuYW1lc3BhY2UgY29tLmdvb2dsZS56eGluZyB7Ki8KCS8qKgoJICogQSB3cmFwcGVyIGltcGxlbWVudGF0aW9uIG9mIHtAbGluayBMdW1pbmFuY2VTb3VyY2V9IHdoaWNoIGludmVydHMgdGhlIGx1bWluYW5jZXMgaXQgcmV0dXJucyAtLSBibGFjayBiZWNvbWVzCgkgKiB3aGl0ZSBhbmQgdmljZSB2ZXJzYSwgYW5kIGVhY2ggdmFsdWUgYmVjb21lcyAoMjU1LXZhbHVlKS4KCSAqCgkgKiBAYXV0aG9yIFNlYW4gT3dlbgoJICovCgl2YXIgSW52ZXJ0ZWRMdW1pbmFuY2VTb3VyY2UgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7CgkgICAgX19leHRlbmRzJGEoSW52ZXJ0ZWRMdW1pbmFuY2VTb3VyY2UsIF9zdXBlcik7CgkgICAgZnVuY3Rpb24gSW52ZXJ0ZWRMdW1pbmFuY2VTb3VyY2UoZGVsZWdhdGUpIHsKCSAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcywgZGVsZWdhdGUuZ2V0V2lkdGgoKSwgZGVsZWdhdGUuZ2V0SGVpZ2h0KCkpIHx8IHRoaXM7CgkgICAgICAgIF90aGlzLmRlbGVnYXRlID0gZGVsZWdhdGU7CgkgICAgICAgIHJldHVybiBfdGhpczsKCSAgICB9CgkgICAgLypAT3ZlcnJpZGUqLwoJICAgIEludmVydGVkTHVtaW5hbmNlU291cmNlLnByb3RvdHlwZS5nZXRSb3cgPSBmdW5jdGlvbiAoeSAvKmludCovLCByb3cpIHsKCSAgICAgICAgdmFyIHNvdXJjZVJvdyA9IHRoaXMuZGVsZWdhdGUuZ2V0Um93KHksIHJvdyk7CgkgICAgICAgIHZhciB3aWR0aCA9IHRoaXMuZ2V0V2lkdGgoKTsKCSAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB3aWR0aDsgaSsrKSB7CgkgICAgICAgICAgICBzb3VyY2VSb3dbaV0gPSAvKihieXRlKSovICgyNTUgLSAoc291cmNlUm93W2ldICYgMHhGRikpOwoJICAgICAgICB9CgkgICAgICAgIHJldHVybiBzb3VyY2VSb3c7CgkgICAgfTsKCSAgICAvKkBPdmVycmlkZSovCgkgICAgSW52ZXJ0ZWRMdW1pbmFuY2VTb3VyY2UucHJvdG90eXBlLmdldE1hdHJpeCA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgdmFyIG1hdHJpeCA9IHRoaXMuZGVsZWdhdGUuZ2V0TWF0cml4KCk7CgkgICAgICAgIHZhciBsZW5ndGggPSB0aGlzLmdldFdpZHRoKCkgKiB0aGlzLmdldEhlaWdodCgpOwoJICAgICAgICB2YXIgaW52ZXJ0ZWRNYXRyaXggPSBuZXcgVWludDhDbGFtcGVkQXJyYXkobGVuZ3RoKTsKCSAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW5ndGg7IGkrKykgewoJICAgICAgICAgICAgaW52ZXJ0ZWRNYXRyaXhbaV0gPSAvKihieXRlKSovICgyNTUgLSAobWF0cml4W2ldICYgMHhGRikpOwoJICAgICAgICB9CgkgICAgICAgIHJldHVybiBpbnZlcnRlZE1hdHJpeDsKCSAgICB9OwoJICAgIC8qQE92ZXJyaWRlKi8KCSAgICBJbnZlcnRlZEx1bWluYW5jZVNvdXJjZS5wcm90b3R5cGUuaXNDcm9wU3VwcG9ydGVkID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5kZWxlZ2F0ZS5pc0Nyb3BTdXBwb3J0ZWQoKTsKCSAgICB9OwoJICAgIC8qQE92ZXJyaWRlKi8KCSAgICBJbnZlcnRlZEx1bWluYW5jZVNvdXJjZS5wcm90b3R5cGUuY3JvcCA9IGZ1bmN0aW9uIChsZWZ0IC8qaW50Ki8sIHRvcCAvKmludCovLCB3aWR0aCAvKmludCovLCBoZWlnaHQgLyppbnQqLykgewoJICAgICAgICByZXR1cm4gbmV3IEludmVydGVkTHVtaW5hbmNlU291cmNlKHRoaXMuZGVsZWdhdGUuY3JvcChsZWZ0LCB0b3AsIHdpZHRoLCBoZWlnaHQpKTsKCSAgICB9OwoJICAgIC8qQE92ZXJyaWRlKi8KCSAgICBJbnZlcnRlZEx1bWluYW5jZVNvdXJjZS5wcm90b3R5cGUuaXNSb3RhdGVTdXBwb3J0ZWQgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLmRlbGVnYXRlLmlzUm90YXRlU3VwcG9ydGVkKCk7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcmV0dXJuIG9yaWdpbmFsIGRlbGVnYXRlIHtAbGluayBMdW1pbmFuY2VTb3VyY2V9IHNpbmNlIGludmVydCB1bmRvZXMgaXRzZWxmCgkgICAgICovCgkgICAgLypAT3ZlcnJpZGUqLwoJICAgIEludmVydGVkTHVtaW5hbmNlU291cmNlLnByb3RvdHlwZS5pbnZlcnQgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLmRlbGVnYXRlOwoJICAgIH07CgkgICAgLypAT3ZlcnJpZGUqLwoJICAgIEludmVydGVkTHVtaW5hbmNlU291cmNlLnByb3RvdHlwZS5yb3RhdGVDb3VudGVyQ2xvY2t3aXNlID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gbmV3IEludmVydGVkTHVtaW5hbmNlU291cmNlKHRoaXMuZGVsZWdhdGUucm90YXRlQ291bnRlckNsb2Nrd2lzZSgpKTsKCSAgICB9OwoJICAgIC8qQE92ZXJyaWRlKi8KCSAgICBJbnZlcnRlZEx1bWluYW5jZVNvdXJjZS5wcm90b3R5cGUucm90YXRlQ291bnRlckNsb2Nrd2lzZTQ1ID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gbmV3IEludmVydGVkTHVtaW5hbmNlU291cmNlKHRoaXMuZGVsZWdhdGUucm90YXRlQ291bnRlckNsb2Nrd2lzZTQ1KCkpOwoJICAgIH07CgkgICAgcmV0dXJuIEludmVydGVkTHVtaW5hbmNlU291cmNlOwoJfShMdW1pbmFuY2VTb3VyY2VfMSQxLmRlZmF1bHQpKTsKCUludmVydGVkTHVtaW5hbmNlU291cmNlJDEuZGVmYXVsdCA9IEludmVydGVkTHVtaW5hbmNlU291cmNlOwoKCS8qCgkgKiBDb3B5cmlnaHQgMjAwOSBaWGluZyBhdXRob3JzCgkgKgoJICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIik7CgkgKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCgkgKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKCSAqCgkgKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAoJICoKCSAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKCSAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCgkgKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4KCSAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKCSAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgoJICovCgl2YXIgX19leHRlbmRzJDkgPSAoY29tbW9uanNHbG9iYWwgJiYgY29tbW9uanNHbG9iYWwuX19leHRlbmRzKSB8fCAoZnVuY3Rpb24gKCkgewoJICAgIHZhciBleHRlbmRTdGF0aWNzID0gZnVuY3Rpb24gKGQsIGIpIHsKCSAgICAgICAgZXh0ZW5kU3RhdGljcyA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fAoJICAgICAgICAgICAgKHsgX19wcm90b19fOiBbXSB9IGluc3RhbmNlb2YgQXJyYXkgJiYgZnVuY3Rpb24gKGQsIGIpIHsgZC5fX3Byb3RvX18gPSBiOyB9KSB8fAoJICAgICAgICAgICAgZnVuY3Rpb24gKGQsIGIpIHsgZm9yICh2YXIgcCBpbiBiKSBpZiAoYi5oYXNPd25Qcm9wZXJ0eShwKSkgZFtwXSA9IGJbcF07IH07CgkgICAgICAgIHJldHVybiBleHRlbmRTdGF0aWNzKGQsIGIpOwoJICAgIH07CgkgICAgcmV0dXJuIGZ1bmN0aW9uIChkLCBiKSB7CgkgICAgICAgIGV4dGVuZFN0YXRpY3MoZCwgYik7CgkgICAgICAgIGZ1bmN0aW9uIF9fKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gZDsgfQoJICAgICAgICBkLnByb3RvdHlwZSA9IGIgPT09IG51bGwgPyBPYmplY3QuY3JlYXRlKGIpIDogKF9fLnByb3RvdHlwZSA9IGIucHJvdG90eXBlLCBuZXcgX18oKSk7CgkgICAgfTsKCX0pKCk7CglPYmplY3QuZGVmaW5lUHJvcGVydHkoUkdCTHVtaW5hbmNlU291cmNlJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCS8qbmFtZXNwYWNlIGNvbS5nb29nbGUuenhpbmcgeyovCgkgLy8gcmVxdWlyZWQgYmVjYXVzZSBvZiBjaXJjdWxhciBkZXBlbmRlbmNpZXMgYmV0d2VlbiBMdW1pbmFuY2VTb3VyY2UgYW5kIEludmVydGVkTHVtaW5hbmNlU291cmNlCgl2YXIgSW52ZXJ0ZWRMdW1pbmFuY2VTb3VyY2VfMSA9IEludmVydGVkTHVtaW5hbmNlU291cmNlJDE7Cgl2YXIgTHVtaW5hbmNlU291cmNlXzEgPSBMdW1pbmFuY2VTb3VyY2UkMTsKCXZhciBTeXN0ZW1fMSQyID0gU3lzdGVtJDE7Cgl2YXIgSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uXzEkNiA9IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbiQxOwoJLyoqCgkgKiBUaGlzIGNsYXNzIGlzIHVzZWQgdG8gaGVscCBkZWNvZGUgaW1hZ2VzIGZyb20gZmlsZXMgd2hpY2ggYXJyaXZlIGFzIFJHQiBkYXRhIGZyb20KCSAqIGFuIEFSR0IgcGl4ZWwgYXJyYXkuIEl0IGRvZXMgbm90IHN1cHBvcnQgcm90YXRpb24uCgkgKgoJICogQGF1dGhvciBkc3dpdGtpbkBnb29nbGUuY29tIChEYW5pZWwgU3dpdGtpbikKCSAqIEBhdXRob3IgQmV0YW1pbm9zCgkgKi8KCXZhciBSR0JMdW1pbmFuY2VTb3VyY2UgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7CgkgICAgX19leHRlbmRzJDkoUkdCTHVtaW5hbmNlU291cmNlLCBfc3VwZXIpOwoJICAgIGZ1bmN0aW9uIFJHQkx1bWluYW5jZVNvdXJjZShsdW1pbmFuY2VzLCB3aWR0aCAvKmludCovLCBoZWlnaHQgLyppbnQqLywgZGF0YVdpZHRoIC8qaW50Ki8sIGRhdGFIZWlnaHQgLyppbnQqLywgbGVmdCAvKmludCovLCB0b3AgLyppbnQqLykgewoJICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzLCB3aWR0aCwgaGVpZ2h0KSB8fCB0aGlzOwoJICAgICAgICBfdGhpcy5kYXRhV2lkdGggPSBkYXRhV2lkdGg7CgkgICAgICAgIF90aGlzLmRhdGFIZWlnaHQgPSBkYXRhSGVpZ2h0OwoJICAgICAgICBfdGhpcy5sZWZ0ID0gbGVmdDsKCSAgICAgICAgX3RoaXMudG9wID0gdG9wOwoJICAgICAgICBpZiAobHVtaW5hbmNlcy5CWVRFU19QRVJfRUxFTUVOVCA9PT0gNCkgeyAvLyBJbnQzMkFycmF5CgkgICAgICAgICAgICB2YXIgc2l6ZSA9IHdpZHRoICogaGVpZ2h0OwoJICAgICAgICAgICAgdmFyIGx1bWluYW5jZXNVaW50OEFycmF5ID0gbmV3IFVpbnQ4Q2xhbXBlZEFycmF5KHNpemUpOwoJICAgICAgICAgICAgZm9yICh2YXIgb2Zmc2V0ID0gMDsgb2Zmc2V0IDwgc2l6ZTsgb2Zmc2V0KyspIHsKCSAgICAgICAgICAgICAgICB2YXIgcGl4ZWwgPSBsdW1pbmFuY2VzW29mZnNldF07CgkgICAgICAgICAgICAgICAgdmFyIHIgPSAocGl4ZWwgPj4gMTYpICYgMHhmZjsgLy8gcmVkCgkgICAgICAgICAgICAgICAgdmFyIGcyID0gKHBpeGVsID4+IDcpICYgMHgxZmU7IC8vIDIgKiBncmVlbgoJICAgICAgICAgICAgICAgIHZhciBiID0gcGl4ZWwgJiAweGZmOyAvLyBibHVlCgkgICAgICAgICAgICAgICAgLy8gQ2FsY3VsYXRlIGdyZWVuLWZhdm91cmluZyBhdmVyYWdlIGNoZWFwbHkKCSAgICAgICAgICAgICAgICBsdW1pbmFuY2VzVWludDhBcnJheVtvZmZzZXRdID0gLyooYnl0ZSkgKi8gKChyICsgZzIgKyBiKSAvIDQpICYgMHhGRjsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIF90aGlzLmx1bWluYW5jZXMgPSBsdW1pbmFuY2VzVWludDhBcnJheTsKCSAgICAgICAgfQoJICAgICAgICBlbHNlIHsKCSAgICAgICAgICAgIF90aGlzLmx1bWluYW5jZXMgPSBsdW1pbmFuY2VzOwoJICAgICAgICB9CgkgICAgICAgIGlmICh1bmRlZmluZWQgPT09IGRhdGFXaWR0aCkgewoJICAgICAgICAgICAgX3RoaXMuZGF0YVdpZHRoID0gd2lkdGg7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKHVuZGVmaW5lZCA9PT0gZGF0YUhlaWdodCkgewoJICAgICAgICAgICAgX3RoaXMuZGF0YUhlaWdodCA9IGhlaWdodDsKCSAgICAgICAgfQoJICAgICAgICBpZiAodW5kZWZpbmVkID09PSBsZWZ0KSB7CgkgICAgICAgICAgICBfdGhpcy5sZWZ0ID0gMDsKCSAgICAgICAgfQoJICAgICAgICBpZiAodW5kZWZpbmVkID09PSB0b3ApIHsKCSAgICAgICAgICAgIF90aGlzLnRvcCA9IDA7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKF90aGlzLmxlZnQgKyB3aWR0aCA+IF90aGlzLmRhdGFXaWR0aCB8fCBfdGhpcy50b3AgKyBoZWlnaHQgPiBfdGhpcy5kYXRhSGVpZ2h0KSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uXzEkNi5kZWZhdWx0KCdDcm9wIHJlY3RhbmdsZSBkb2VzIG5vdCBmaXQgd2l0aGluIGltYWdlIGRhdGEuJyk7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIF90aGlzOwoJICAgIH0KCSAgICAvKkBPdmVycmlkZSovCgkgICAgUkdCTHVtaW5hbmNlU291cmNlLnByb3RvdHlwZS5nZXRSb3cgPSBmdW5jdGlvbiAoeSAvKmludCovLCByb3cpIHsKCSAgICAgICAgaWYgKHkgPCAwIHx8IHkgPj0gdGhpcy5nZXRIZWlnaHQoKSkgewoJICAgICAgICAgICAgdGhyb3cgbmV3IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbl8xJDYuZGVmYXVsdCgnUmVxdWVzdGVkIHJvdyBpcyBvdXRzaWRlIHRoZSBpbWFnZTogJyArIHkpOwoJICAgICAgICB9CgkgICAgICAgIHZhciB3aWR0aCA9IHRoaXMuZ2V0V2lkdGgoKTsKCSAgICAgICAgaWYgKHJvdyA9PT0gbnVsbCB8fCByb3cgPT09IHVuZGVmaW5lZCB8fCByb3cubGVuZ3RoIDwgd2lkdGgpIHsKCSAgICAgICAgICAgIHJvdyA9IG5ldyBVaW50OENsYW1wZWRBcnJheSh3aWR0aCk7CgkgICAgICAgIH0KCSAgICAgICAgdmFyIG9mZnNldCA9ICh5ICsgdGhpcy50b3ApICogdGhpcy5kYXRhV2lkdGggKyB0aGlzLmxlZnQ7CgkgICAgICAgIFN5c3RlbV8xJDIuZGVmYXVsdC5hcnJheWNvcHkodGhpcy5sdW1pbmFuY2VzLCBvZmZzZXQsIHJvdywgMCwgd2lkdGgpOwoJICAgICAgICByZXR1cm4gcm93OwoJICAgIH07CgkgICAgLypAT3ZlcnJpZGUqLwoJICAgIFJHQkx1bWluYW5jZVNvdXJjZS5wcm90b3R5cGUuZ2V0TWF0cml4ID0gZnVuY3Rpb24gKCkgewoJICAgICAgICB2YXIgd2lkdGggPSB0aGlzLmdldFdpZHRoKCk7CgkgICAgICAgIHZhciBoZWlnaHQgPSB0aGlzLmdldEhlaWdodCgpOwoJICAgICAgICAvLyBJZiB0aGUgY2FsbGVyIGFza3MgZm9yIHRoZSBlbnRpcmUgdW5kZXJseWluZyBpbWFnZSwgc2F2ZSB0aGUgY29weSBhbmQgZ2l2ZSB0aGVtIHRoZQoJICAgICAgICAvLyBvcmlnaW5hbCBkYXRhLiBUaGUgZG9jcyBzcGVjaWZpY2FsbHkgd2FybiB0aGF0IHJlc3VsdC5sZW5ndGggbXVzdCBiZSBpZ25vcmVkLgoJICAgICAgICBpZiAod2lkdGggPT09IHRoaXMuZGF0YVdpZHRoICYmIGhlaWdodCA9PT0gdGhpcy5kYXRhSGVpZ2h0KSB7CgkgICAgICAgICAgICByZXR1cm4gdGhpcy5sdW1pbmFuY2VzOwoJICAgICAgICB9CgkgICAgICAgIHZhciBhcmVhID0gd2lkdGggKiBoZWlnaHQ7CgkgICAgICAgIHZhciBtYXRyaXggPSBuZXcgVWludDhDbGFtcGVkQXJyYXkoYXJlYSk7CgkgICAgICAgIHZhciBpbnB1dE9mZnNldCA9IHRoaXMudG9wICogdGhpcy5kYXRhV2lkdGggKyB0aGlzLmxlZnQ7CgkgICAgICAgIC8vIElmIHRoZSB3aWR0aCBtYXRjaGVzIHRoZSBmdWxsIHdpZHRoIG9mIHRoZSB1bmRlcmx5aW5nIGRhdGEsIHBlcmZvcm0gYSBzaW5nbGUgY29weS4KCSAgICAgICAgaWYgKHdpZHRoID09PSB0aGlzLmRhdGFXaWR0aCkgewoJICAgICAgICAgICAgU3lzdGVtXzEkMi5kZWZhdWx0LmFycmF5Y29weSh0aGlzLmx1bWluYW5jZXMsIGlucHV0T2Zmc2V0LCBtYXRyaXgsIDAsIGFyZWEpOwoJICAgICAgICAgICAgcmV0dXJuIG1hdHJpeDsKCSAgICAgICAgfQoJICAgICAgICAvLyBPdGhlcndpc2UgY29weSBvbmUgY3JvcHBlZCByb3cgYXQgYSB0aW1lLgoJICAgICAgICBmb3IgKHZhciB5ID0gMDsgeSA8IGhlaWdodDsgeSsrKSB7CgkgICAgICAgICAgICB2YXIgb3V0cHV0T2Zmc2V0ID0geSAqIHdpZHRoOwoJICAgICAgICAgICAgU3lzdGVtXzEkMi5kZWZhdWx0LmFycmF5Y29weSh0aGlzLmx1bWluYW5jZXMsIGlucHV0T2Zmc2V0LCBtYXRyaXgsIG91dHB1dE9mZnNldCwgd2lkdGgpOwoJICAgICAgICAgICAgaW5wdXRPZmZzZXQgKz0gdGhpcy5kYXRhV2lkdGg7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIG1hdHJpeDsKCSAgICB9OwoJICAgIC8qQE92ZXJyaWRlKi8KCSAgICBSR0JMdW1pbmFuY2VTb3VyY2UucHJvdG90eXBlLmlzQ3JvcFN1cHBvcnRlZCA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRydWU7CgkgICAgfTsKCSAgICAvKkBPdmVycmlkZSovCgkgICAgUkdCTHVtaW5hbmNlU291cmNlLnByb3RvdHlwZS5jcm9wID0gZnVuY3Rpb24gKGxlZnQgLyppbnQqLywgdG9wIC8qaW50Ki8sIHdpZHRoIC8qaW50Ki8sIGhlaWdodCAvKmludCovKSB7CgkgICAgICAgIHJldHVybiBuZXcgUkdCTHVtaW5hbmNlU291cmNlKHRoaXMubHVtaW5hbmNlcywgd2lkdGgsIGhlaWdodCwgdGhpcy5kYXRhV2lkdGgsIHRoaXMuZGF0YUhlaWdodCwgdGhpcy5sZWZ0ICsgbGVmdCwgdGhpcy50b3AgKyB0b3ApOwoJICAgIH07CgkgICAgUkdCTHVtaW5hbmNlU291cmNlLnByb3RvdHlwZS5pbnZlcnQgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiBuZXcgSW52ZXJ0ZWRMdW1pbmFuY2VTb3VyY2VfMS5kZWZhdWx0KHRoaXMpOwoJICAgIH07CgkgICAgcmV0dXJuIFJHQkx1bWluYW5jZVNvdXJjZTsKCX0oTHVtaW5hbmNlU291cmNlXzEuZGVmYXVsdCkpOwoJdmFyIF9kZWZhdWx0JDEgPSBSR0JMdW1pbmFuY2VTb3VyY2UkMS5kZWZhdWx0ID0gUkdCTHVtaW5hbmNlU291cmNlOwoKCXZhciBRUkNvZGVSZWFkZXIkMSA9IHt9OwoKCXZhciBCYXJjb2RlRm9ybWF0JDEgPSB7fTsKCgkvKgoJICogRGlyZWN0IHBvcnQgdG8gVHlwZVNjcmlwdCBvZiBaWGluZyBieSBBZHJpYW4gVG/ImWPEgwoJICovCglPYmplY3QuZGVmaW5lUHJvcGVydHkoQmFyY29kZUZvcm1hdCQxLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7CgkvKgoJICogQ29weXJpZ2h0IDIwMDkgWlhpbmcgYXV0aG9ycwoJICoKCSAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoJICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoJICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkgKgoJICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKCSAqCgkgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCgkgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoJICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCgkgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCSAqLwoJLypuYW1lc3BhY2UgY29tLmdvb2dsZS56eGluZyB7Ki8KCS8qKgoJICogRW51bWVyYXRlcyBiYXJjb2RlIGZvcm1hdHMga25vd24gdG8gdGhpcyBwYWNrYWdlLiBQbGVhc2Uga2VlcCBhbHBoYWJldGl6ZWQuCgkgKgoJICogQGF1dGhvciBTZWFuIE93ZW4KCSAqLwoJdmFyIEJhcmNvZGVGb3JtYXQ7CgkoZnVuY3Rpb24gKEJhcmNvZGVGb3JtYXQpIHsKCSAgICAvKiogQXp0ZWMgMkQgYmFyY29kZSBmb3JtYXQuICovCgkgICAgQmFyY29kZUZvcm1hdFtCYXJjb2RlRm9ybWF0WyJBWlRFQyJdID0gMF0gPSAiQVpURUMiOwoJICAgIC8qKiBDT0RBQkFSIDFEIGZvcm1hdC4gKi8KCSAgICBCYXJjb2RlRm9ybWF0W0JhcmNvZGVGb3JtYXRbIkNPREFCQVIiXSA9IDFdID0gIkNPREFCQVIiOwoJICAgIC8qKiBDb2RlIDM5IDFEIGZvcm1hdC4gKi8KCSAgICBCYXJjb2RlRm9ybWF0W0JhcmNvZGVGb3JtYXRbIkNPREVfMzkiXSA9IDJdID0gIkNPREVfMzkiOwoJICAgIC8qKiBDb2RlIDkzIDFEIGZvcm1hdC4gKi8KCSAgICBCYXJjb2RlRm9ybWF0W0JhcmNvZGVGb3JtYXRbIkNPREVfOTMiXSA9IDNdID0gIkNPREVfOTMiOwoJICAgIC8qKiBDb2RlIDEyOCAxRCBmb3JtYXQuICovCgkgICAgQmFyY29kZUZvcm1hdFtCYXJjb2RlRm9ybWF0WyJDT0RFXzEyOCJdID0gNF0gPSAiQ09ERV8xMjgiOwoJICAgIC8qKiBEYXRhIE1hdHJpeCAyRCBiYXJjb2RlIGZvcm1hdC4gKi8KCSAgICBCYXJjb2RlRm9ybWF0W0JhcmNvZGVGb3JtYXRbIkRBVEFfTUFUUklYIl0gPSA1XSA9ICJEQVRBX01BVFJJWCI7CgkgICAgLyoqIEVBTi04IDFEIGZvcm1hdC4gKi8KCSAgICBCYXJjb2RlRm9ybWF0W0JhcmNvZGVGb3JtYXRbIkVBTl84Il0gPSA2XSA9ICJFQU5fOCI7CgkgICAgLyoqIEVBTi0xMyAxRCBmb3JtYXQuICovCgkgICAgQmFyY29kZUZvcm1hdFtCYXJjb2RlRm9ybWF0WyJFQU5fMTMiXSA9IDddID0gIkVBTl8xMyI7CgkgICAgLyoqIElURiAoSW50ZXJsZWF2ZWQgVHdvIG9mIEZpdmUpIDFEIGZvcm1hdC4gKi8KCSAgICBCYXJjb2RlRm9ybWF0W0JhcmNvZGVGb3JtYXRbIklURiJdID0gOF0gPSAiSVRGIjsKCSAgICAvKiogTWF4aUNvZGUgMkQgYmFyY29kZSBmb3JtYXQuICovCgkgICAgQmFyY29kZUZvcm1hdFtCYXJjb2RlRm9ybWF0WyJNQVhJQ09ERSJdID0gOV0gPSAiTUFYSUNPREUiOwoJICAgIC8qKiBQREY0MTcgZm9ybWF0LiAqLwoJICAgIEJhcmNvZGVGb3JtYXRbQmFyY29kZUZvcm1hdFsiUERGXzQxNyJdID0gMTBdID0gIlBERl80MTciOwoJICAgIC8qKiBRUiBDb2RlIDJEIGJhcmNvZGUgZm9ybWF0LiAqLwoJICAgIEJhcmNvZGVGb3JtYXRbQmFyY29kZUZvcm1hdFsiUVJfQ09ERSJdID0gMTFdID0gIlFSX0NPREUiOwoJICAgIC8qKiBSU1MgMTQgKi8KCSAgICBCYXJjb2RlRm9ybWF0W0JhcmNvZGVGb3JtYXRbIlJTU18xNCJdID0gMTJdID0gIlJTU18xNCI7CgkgICAgLyoqIFJTUyBFWFBBTkRFRCAqLwoJICAgIEJhcmNvZGVGb3JtYXRbQmFyY29kZUZvcm1hdFsiUlNTX0VYUEFOREVEIl0gPSAxM10gPSAiUlNTX0VYUEFOREVEIjsKCSAgICAvKiogVVBDLUEgMUQgZm9ybWF0LiAqLwoJICAgIEJhcmNvZGVGb3JtYXRbQmFyY29kZUZvcm1hdFsiVVBDX0EiXSA9IDE0XSA9ICJVUENfQSI7CgkgICAgLyoqIFVQQy1FIDFEIGZvcm1hdC4gKi8KCSAgICBCYXJjb2RlRm9ybWF0W0JhcmNvZGVGb3JtYXRbIlVQQ19FIl0gPSAxNV0gPSAiVVBDX0UiOwoJICAgIC8qKiBVUEMvRUFOIGV4dGVuc2lvbiBmb3JtYXQuIE5vdCBhIHN0YW5kLWFsb25lIGZvcm1hdC4gKi8KCSAgICBCYXJjb2RlRm9ybWF0W0JhcmNvZGVGb3JtYXRbIlVQQ19FQU5fRVhURU5TSU9OIl0gPSAxNl0gPSAiVVBDX0VBTl9FWFRFTlNJT04iOwoJfSkoQmFyY29kZUZvcm1hdCB8fCAoQmFyY29kZUZvcm1hdCA9IHt9KSk7CglCYXJjb2RlRm9ybWF0JDEuZGVmYXVsdCA9IEJhcmNvZGVGb3JtYXQ7CgoJdmFyIFJlc3VsdCQxID0ge307CgoJLyoKCSAqIENvcHlyaWdodCAyMDA3IFpYaW5nIGF1dGhvcnMKCSAqCgkgKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKCSAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4KCSAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdAoJICoKCSAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wCgkgKgoJICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZQoJICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gIkFTIElTIiBCQVNJUywKCSAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLgoJICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZAoJICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuCgkgKi8KCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShSZXN1bHQkMSwgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJdmFyIFN5c3RlbV8xJDEgPSBTeXN0ZW0kMTsKCS8qKgoJICogPHA+RW5jYXBzdWxhdGVzIHRoZSByZXN1bHQgb2YgZGVjb2RpbmcgYSBiYXJjb2RlIHdpdGhpbiBhbiBpbWFnZS48L3A+CgkgKgoJICogQGF1dGhvciBTZWFuIE93ZW4KCSAqLwoJdmFyIFJlc3VsdCA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHsKCSAgICAvLyBwdWJsaWMgY29uc3RydWN0b3IocHJpdmF0ZSB0ZXh0OiBzdHJpbmcsCgkgICAgLy8gICAgICAgICAgICAgICBVaW50OEFycmF5IHJhd0J5dGVzLAoJICAgIC8vICAgICAgICAgICAgICAgUmVzdWx0UG9jb25zdCByZXN1bHRQb2ludHM6IEludDMyQXJyYXksCgkgICAgLy8gICAgICAgICAgICAgICBCYXJjb2RlRm9ybWF0IGZvcm1hdCkgewoJICAgIC8vICAgdGhpcyh0ZXh0LCByYXdCeXRlcywgcmVzdWx0UG9pbnRzLCBmb3JtYXQsIFN5c3RlbS5jdXJyZW50VGltZU1pbGxpcygpKQoJICAgIC8vIH0KCSAgICAvLyBwdWJsaWMgY29uc3RydWN0b3IodGV4dDogc3RyaW5nLAoJICAgIC8vICAgICAgICAgICAgICAgVWludDhBcnJheSByYXdCeXRlcywKCSAgICAvLyAgICAgICAgICAgICAgIFJlc3VsdFBvY29uc3QgcmVzdWx0UG9pbnRzOiBJbnQzMkFycmF5LAoJICAgIC8vICAgICAgICAgICAgICAgQmFyY29kZUZvcm1hdCBmb3JtYXQsCgkgICAgLy8gICAgICAgICAgICAgICBsb25nIHRpbWVzdGFtcCkgewoJICAgIC8vICAgdGhpcyh0ZXh0LCByYXdCeXRlcywgcmF3Qnl0ZXMgPT0gbnVsbCA/IDAgOiA4ICogcmF3Qnl0ZXMubGVuZ3RoLAoJICAgIC8vICAgICAgICByZXN1bHRQb2ludHMsIGZvcm1hdCwgdGltZXN0YW1wKQoJICAgIC8vIH0KCSAgICBmdW5jdGlvbiBSZXN1bHQodGV4dCwgcmF3Qnl0ZXMsIG51bUJpdHMsIHJlc3VsdFBvaW50cywgZm9ybWF0LCB0aW1lc3RhbXApIHsKCSAgICAgICAgaWYgKG51bUJpdHMgPT09IHZvaWQgMCkgeyBudW1CaXRzID0gcmF3Qnl0ZXMgPT0gbnVsbCA/IDAgOiA4ICogcmF3Qnl0ZXMubGVuZ3RoOyB9CgkgICAgICAgIGlmICh0aW1lc3RhbXAgPT09IHZvaWQgMCkgeyB0aW1lc3RhbXAgPSBTeXN0ZW1fMSQxLmRlZmF1bHQuY3VycmVudFRpbWVNaWxsaXMoKTsgfQoJICAgICAgICB0aGlzLnRleHQgPSB0ZXh0OwoJICAgICAgICB0aGlzLnJhd0J5dGVzID0gcmF3Qnl0ZXM7CgkgICAgICAgIHRoaXMubnVtQml0cyA9IG51bUJpdHM7CgkgICAgICAgIHRoaXMucmVzdWx0UG9pbnRzID0gcmVzdWx0UG9pbnRzOwoJICAgICAgICB0aGlzLmZvcm1hdCA9IGZvcm1hdDsKCSAgICAgICAgdGhpcy50aW1lc3RhbXAgPSB0aW1lc3RhbXA7CgkgICAgICAgIHRoaXMudGV4dCA9IHRleHQ7CgkgICAgICAgIHRoaXMucmF3Qnl0ZXMgPSByYXdCeXRlczsKCSAgICAgICAgaWYgKHVuZGVmaW5lZCA9PT0gbnVtQml0cyB8fCBudWxsID09PSBudW1CaXRzKSB7CgkgICAgICAgICAgICB0aGlzLm51bUJpdHMgPSAocmF3Qnl0ZXMgPT09IG51bGwgfHwgcmF3Qnl0ZXMgPT09IHVuZGVmaW5lZCkgPyAwIDogOCAqIHJhd0J5dGVzLmxlbmd0aDsKCSAgICAgICAgfQoJICAgICAgICBlbHNlIHsKCSAgICAgICAgICAgIHRoaXMubnVtQml0cyA9IG51bUJpdHM7CgkgICAgICAgIH0KCSAgICAgICAgdGhpcy5yZXN1bHRQb2ludHMgPSByZXN1bHRQb2ludHM7CgkgICAgICAgIHRoaXMuZm9ybWF0ID0gZm9ybWF0OwoJICAgICAgICB0aGlzLnJlc3VsdE1ldGFkYXRhID0gbnVsbDsKCSAgICAgICAgaWYgKHVuZGVmaW5lZCA9PT0gdGltZXN0YW1wIHx8IG51bGwgPT09IHRpbWVzdGFtcCkgewoJICAgICAgICAgICAgdGhpcy50aW1lc3RhbXAgPSBTeXN0ZW1fMSQxLmRlZmF1bHQuY3VycmVudFRpbWVNaWxsaXMoKTsKCSAgICAgICAgfQoJICAgICAgICBlbHNlIHsKCSAgICAgICAgICAgIHRoaXMudGltZXN0YW1wID0gdGltZXN0YW1wOwoJICAgICAgICB9CgkgICAgfQoJICAgIC8qKgoJICAgICAqIEByZXR1cm4gcmF3IHRleHQgZW5jb2RlZCBieSB0aGUgYmFyY29kZQoJICAgICAqLwoJICAgIFJlc3VsdC5wcm90b3R5cGUuZ2V0VGV4dCA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMudGV4dDsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEByZXR1cm4gcmF3IGJ5dGVzIGVuY29kZWQgYnkgdGhlIGJhcmNvZGUsIGlmIGFwcGxpY2FibGUsIG90aGVyd2lzZSB7QGNvZGUgbnVsbH0KCSAgICAgKi8KCSAgICBSZXN1bHQucHJvdG90eXBlLmdldFJhd0J5dGVzID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5yYXdCeXRlczsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEByZXR1cm4gaG93IG1hbnkgYml0cyBvZiB7QGxpbmsgI2dldFJhd0J5dGVzKCl9IGFyZSB2YWxpZDsgdHlwaWNhbGx5IDggdGltZXMgaXRzIGxlbmd0aAoJICAgICAqIEBzaW5jZSAzLjMuMAoJICAgICAqLwoJICAgIFJlc3VsdC5wcm90b3R5cGUuZ2V0TnVtQml0cyA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMubnVtQml0czsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEByZXR1cm4gcG9pbnRzIHJlbGF0ZWQgdG8gdGhlIGJhcmNvZGUgaW4gdGhlIGltYWdlLiBUaGVzZSBhcmUgdHlwaWNhbGx5IHBvaW50cwoJICAgICAqICAgICAgICAgaWRlbnRpZnlpbmcgZmluZGVyIHBhdHRlcm5zIG9yIHRoZSBjb3JuZXJzIG9mIHRoZSBiYXJjb2RlLiBUaGUgZXhhY3QgbWVhbmluZyBpcwoJICAgICAqICAgICAgICAgc3BlY2lmaWMgdG8gdGhlIHR5cGUgb2YgYmFyY29kZSB0aGF0IHdhcyBkZWNvZGVkLgoJICAgICAqLwoJICAgIFJlc3VsdC5wcm90b3R5cGUuZ2V0UmVzdWx0UG9pbnRzID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5yZXN1bHRQb2ludHM7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcmV0dXJuIHtAbGluayBCYXJjb2RlRm9ybWF0fSByZXByZXNlbnRpbmcgdGhlIGZvcm1hdCBvZiB0aGUgYmFyY29kZSB0aGF0IHdhcyBkZWNvZGVkCgkgICAgICovCgkgICAgUmVzdWx0LnByb3RvdHlwZS5nZXRCYXJjb2RlRm9ybWF0ID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5mb3JtYXQ7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcmV0dXJuIHtAbGluayBNYXB9IG1hcHBpbmcge0BsaW5rIFJlc3VsdE1ldGFkYXRhVHlwZX0ga2V5cyB0byB2YWx1ZXMuIE1heSBiZQoJICAgICAqICAge0Bjb2RlIG51bGx9LiBUaGlzIGNvbnRhaW5zIG9wdGlvbmFsIG1ldGFkYXRhIGFib3V0IHdoYXQgd2FzIGRldGVjdGVkIGFib3V0IHRoZSBiYXJjb2RlLAoJICAgICAqICAgbGlrZSBvcmllbnRhdGlvbi4KCSAgICAgKi8KCSAgICBSZXN1bHQucHJvdG90eXBlLmdldFJlc3VsdE1ldGFkYXRhID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5yZXN1bHRNZXRhZGF0YTsKCSAgICB9OwoJICAgIFJlc3VsdC5wcm90b3R5cGUucHV0TWV0YWRhdGEgPSBmdW5jdGlvbiAodHlwZSwgdmFsdWUpIHsKCSAgICAgICAgaWYgKHRoaXMucmVzdWx0TWV0YWRhdGEgPT09IG51bGwpIHsKCSAgICAgICAgICAgIHRoaXMucmVzdWx0TWV0YWRhdGEgPSBuZXcgTWFwKCk7CgkgICAgICAgIH0KCSAgICAgICAgdGhpcy5yZXN1bHRNZXRhZGF0YS5zZXQodHlwZSwgdmFsdWUpOwoJICAgIH07CgkgICAgUmVzdWx0LnByb3RvdHlwZS5wdXRBbGxNZXRhZGF0YSA9IGZ1bmN0aW9uIChtZXRhZGF0YSkgewoJICAgICAgICBpZiAobWV0YWRhdGEgIT09IG51bGwpIHsKCSAgICAgICAgICAgIGlmICh0aGlzLnJlc3VsdE1ldGFkYXRhID09PSBudWxsKSB7CgkgICAgICAgICAgICAgICAgdGhpcy5yZXN1bHRNZXRhZGF0YSA9IG1ldGFkYXRhOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgZWxzZSB7CgkgICAgICAgICAgICAgICAgdGhpcy5yZXN1bHRNZXRhZGF0YSA9IG5ldyBNYXAobWV0YWRhdGEpOwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgfTsKCSAgICBSZXN1bHQucHJvdG90eXBlLmFkZFJlc3VsdFBvaW50cyA9IGZ1bmN0aW9uIChuZXdQb2ludHMpIHsKCSAgICAgICAgdmFyIG9sZFBvaW50cyA9IHRoaXMucmVzdWx0UG9pbnRzOwoJICAgICAgICBpZiAob2xkUG9pbnRzID09PSBudWxsKSB7CgkgICAgICAgICAgICB0aGlzLnJlc3VsdFBvaW50cyA9IG5ld1BvaW50czsKCSAgICAgICAgfQoJICAgICAgICBlbHNlIGlmIChuZXdQb2ludHMgIT09IG51bGwgJiYgbmV3UG9pbnRzLmxlbmd0aCA+IDApIHsKCSAgICAgICAgICAgIHZhciBhbGxQb2ludHMgPSBuZXcgQXJyYXkob2xkUG9pbnRzLmxlbmd0aCArIG5ld1BvaW50cy5sZW5ndGgpOwoJICAgICAgICAgICAgU3lzdGVtXzEkMS5kZWZhdWx0LmFycmF5Y29weShvbGRQb2ludHMsIDAsIGFsbFBvaW50cywgMCwgb2xkUG9pbnRzLmxlbmd0aCk7CgkgICAgICAgICAgICBTeXN0ZW1fMSQxLmRlZmF1bHQuYXJyYXljb3B5KG5ld1BvaW50cywgMCwgYWxsUG9pbnRzLCBvbGRQb2ludHMubGVuZ3RoLCBuZXdQb2ludHMubGVuZ3RoKTsKCSAgICAgICAgICAgIHRoaXMucmVzdWx0UG9pbnRzID0gYWxsUG9pbnRzOwoJICAgICAgICB9CgkgICAgfTsKCSAgICBSZXN1bHQucHJvdG90eXBlLmdldFRpbWVzdGFtcCA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMudGltZXN0YW1wOwoJICAgIH07CgkgICAgLypAT3ZlcnJpZGUqLwoJICAgIFJlc3VsdC5wcm90b3R5cGUudG9TdHJpbmcgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLnRleHQ7CgkgICAgfTsKCSAgICByZXR1cm4gUmVzdWx0OwoJfSgpKTsKCVJlc3VsdCQxLmRlZmF1bHQgPSBSZXN1bHQ7CgoJdmFyIFJlc3VsdE1ldGFkYXRhVHlwZSQxID0ge307CgoJLyoKCSAqIENvcHlyaWdodCAyMDA4IFpYaW5nIGF1dGhvcnMKCSAqCgkgKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKCSAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4KCSAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdAoJICoKCSAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wCgkgKgoJICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZQoJICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gIkFTIElTIiBCQVNJUywKCSAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLgoJICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZAoJICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuCgkgKi8KCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShSZXN1bHRNZXRhZGF0YVR5cGUkMSwgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJLypuYW1lc3BhY2UgY29tLmdvb2dsZS56eGluZyB7Ki8KCS8qKgoJICogUmVwcmVzZW50cyBzb21lIHR5cGUgb2YgbWV0YWRhdGEgYWJvdXQgdGhlIHJlc3VsdCBvZiB0aGUgZGVjb2RpbmcgdGhhdCB0aGUgZGVjb2RlcgoJICogd2lzaGVzIHRvIGNvbW11bmljYXRlIGJhY2sgdG8gdGhlIGNhbGxlci4KCSAqCgkgKiBAYXV0aG9yIFNlYW4gT3dlbgoJICovCgl2YXIgUmVzdWx0TWV0YWRhdGFUeXBlOwoJKGZ1bmN0aW9uIChSZXN1bHRNZXRhZGF0YVR5cGUpIHsKCSAgICAvKioKCSAgICAgKiBVbnNwZWNpZmllZCwgYXBwbGljYXRpb24tc3BlY2lmaWMgbWV0YWRhdGEuIE1hcHMgdG8gYW4gdW5zcGVjaWZpZWQge0BsaW5rIE9iamVjdH0uCgkgICAgICovCgkgICAgUmVzdWx0TWV0YWRhdGFUeXBlW1Jlc3VsdE1ldGFkYXRhVHlwZVsiT1RIRVIiXSA9IDBdID0gIk9USEVSIjsKCSAgICAvKioKCSAgICAgKiBEZW5vdGVzIHRoZSBsaWtlbHkgYXBwcm94aW1hdGUgb3JpZW50YXRpb24gb2YgdGhlIGJhcmNvZGUgaW4gdGhlIGltYWdlLiBUaGlzIHZhbHVlCgkgICAgICogaXMgZ2l2ZW4gYXMgZGVncmVlcyByb3RhdGVkIGNsb2Nrd2lzZSBmcm9tIHRoZSBub3JtYWwsIHVwcmlnaHQgb3JpZW50YXRpb24uCgkgICAgICogRm9yIGV4YW1wbGUgYSAxRCBiYXJjb2RlIHdoaWNoIHdhcyBmb3VuZCBieSByZWFkaW5nIHRvcC10by1ib3R0b20gd291bGQgYmUKCSAgICAgKiBzYWlkIHRvIGhhdmUgb3JpZW50YXRpb24gIjkwIi4gVGhpcyBrZXkgbWFwcyB0byBhbiB7QGxpbmsgSW50ZWdlcn0gd2hvc2UKCSAgICAgKiB2YWx1ZSBpcyBpbiB0aGUgcmFuZ2UgWzAsMzYwKS4KCSAgICAgKi8KCSAgICBSZXN1bHRNZXRhZGF0YVR5cGVbUmVzdWx0TWV0YWRhdGFUeXBlWyJPUklFTlRBVElPTiJdID0gMV0gPSAiT1JJRU5UQVRJT04iOwoJICAgIC8qKgoJICAgICAqIDxwPjJEIGJhcmNvZGUgZm9ybWF0cyB0eXBpY2FsbHkgZW5jb2RlIHRleHQsIGJ1dCBhbGxvdyBmb3IgYSBzb3J0IG9mICdieXRlIG1vZGUnCgkgICAgICogd2hpY2ggaXMgc29tZXRpbWVzIHVzZWQgdG8gZW5jb2RlIGJpbmFyeSBkYXRhLiBXaGlsZSB7QGxpbmsgUmVzdWx0fSBtYWtlcyBhdmFpbGFibGUKCSAgICAgKiB0aGUgY29tcGxldGUgcmF3IGJ5dGVzIGluIHRoZSBiYXJjb2RlIGZvciB0aGVzZSBmb3JtYXRzLCBpdCBkb2VzIG5vdCBvZmZlciB0aGUgYnl0ZXMKCSAgICAgKiBmcm9tIHRoZSBieXRlIHNlZ21lbnRzIGFsb25lLjwvcD4KCSAgICAgKgoJICAgICAqIDxwPlRoaXMgbWFwcyB0byBhIHtAbGluayBqYXZhLnV0aWwuTGlzdH0gb2YgYnl0ZSBhcnJheXMgY29ycmVzcG9uZGluZyB0byB0aGUKCSAgICAgKiByYXcgYnl0ZXMgaW4gdGhlIGJ5dGUgc2VnbWVudHMgaW4gdGhlIGJhcmNvZGUsIGluIG9yZGVyLjwvcD4KCSAgICAgKi8KCSAgICBSZXN1bHRNZXRhZGF0YVR5cGVbUmVzdWx0TWV0YWRhdGFUeXBlWyJCWVRFX1NFR01FTlRTIl0gPSAyXSA9ICJCWVRFX1NFR01FTlRTIjsKCSAgICAvKioKCSAgICAgKiBFcnJvciBjb3JyZWN0aW9uIGxldmVsIHVzZWQsIGlmIGFwcGxpY2FibGUuIFRoZSB2YWx1ZSB0eXBlIGRlcGVuZHMgb24gdGhlCgkgICAgICogZm9ybWF0LCBidXQgaXMgdHlwaWNhbGx5IGEgU3RyaW5nLgoJICAgICAqLwoJICAgIFJlc3VsdE1ldGFkYXRhVHlwZVtSZXN1bHRNZXRhZGF0YVR5cGVbIkVSUk9SX0NPUlJFQ1RJT05fTEVWRUwiXSA9IDNdID0gIkVSUk9SX0NPUlJFQ1RJT05fTEVWRUwiOwoJICAgIC8qKgoJICAgICAqIEZvciBzb21lIHBlcmlvZGljYWxzLCBpbmRpY2F0ZXMgdGhlIGlzc3VlIG51bWJlciBhcyBhbiB7QGxpbmsgSW50ZWdlcn0uCgkgICAgICovCgkgICAgUmVzdWx0TWV0YWRhdGFUeXBlW1Jlc3VsdE1ldGFkYXRhVHlwZVsiSVNTVUVfTlVNQkVSIl0gPSA0XSA9ICJJU1NVRV9OVU1CRVIiOwoJICAgIC8qKgoJICAgICAqIEZvciBzb21lIHByb2R1Y3RzLCBpbmRpY2F0ZXMgdGhlIHN1Z2dlc3RlZCByZXRhaWwgcHJpY2UgaW4gdGhlIGJhcmNvZGUgYXMgYQoJICAgICAqIGZvcm1hdHRlZCB7QGxpbmsgU3RyaW5nfS4KCSAgICAgKi8KCSAgICBSZXN1bHRNZXRhZGF0YVR5cGVbUmVzdWx0TWV0YWRhdGFUeXBlWyJTVUdHRVNURURfUFJJQ0UiXSA9IDVdID0gIlNVR0dFU1RFRF9QUklDRSI7CgkgICAgLyoqCgkgICAgICogRm9yIHNvbWUgcHJvZHVjdHMsIHRoZSBwb3NzaWJsZSBjb3VudHJ5IG9mIG1hbnVmYWN0dXJlIGFzIGEge0BsaW5rIFN0cmluZ30gZGVub3RpbmcgdGhlCgkgICAgICogSVNPIGNvdW50cnkgY29kZS4gU29tZSBtYXAgdG8gbXVsdGlwbGUgcG9zc2libGUgY291bnRyaWVzLCBsaWtlICJVUy9DQSIuCgkgICAgICovCgkgICAgUmVzdWx0TWV0YWRhdGFUeXBlW1Jlc3VsdE1ldGFkYXRhVHlwZVsiUE9TU0lCTEVfQ09VTlRSWSJdID0gNl0gPSAiUE9TU0lCTEVfQ09VTlRSWSI7CgkgICAgLyoqCgkgICAgICogRm9yIHNvbWUgcHJvZHVjdHMsIHRoZSBleHRlbnNpb24gdGV4dAoJICAgICAqLwoJICAgIFJlc3VsdE1ldGFkYXRhVHlwZVtSZXN1bHRNZXRhZGF0YVR5cGVbIlVQQ19FQU5fRVhURU5TSU9OIl0gPSA3XSA9ICJVUENfRUFOX0VYVEVOU0lPTiI7CgkgICAgLyoqCgkgICAgICogUERGNDE3LXNwZWNpZmljIG1ldGFkYXRhCgkgICAgICovCgkgICAgUmVzdWx0TWV0YWRhdGFUeXBlW1Jlc3VsdE1ldGFkYXRhVHlwZVsiUERGNDE3X0VYVFJBX01FVEFEQVRBIl0gPSA4XSA9ICJQREY0MTdfRVhUUkFfTUVUQURBVEEiOwoJICAgIC8qKgoJICAgICAqIElmIHRoZSBjb2RlIGZvcm1hdCBzdXBwb3J0cyBzdHJ1Y3R1cmVkIGFwcGVuZCBhbmQgdGhlIGN1cnJlbnQgc2Nhbm5lZCBjb2RlIGlzIHBhcnQgb2Ygb25lIHRoZW4gdGhlCgkgICAgICogc2VxdWVuY2UgbnVtYmVyIGlzIGdpdmVuIHdpdGggaXQuCgkgICAgICovCgkgICAgUmVzdWx0TWV0YWRhdGFUeXBlW1Jlc3VsdE1ldGFkYXRhVHlwZVsiU1RSVUNUVVJFRF9BUFBFTkRfU0VRVUVOQ0UiXSA9IDldID0gIlNUUlVDVFVSRURfQVBQRU5EX1NFUVVFTkNFIjsKCSAgICAvKioKCSAgICAgKiBJZiB0aGUgY29kZSBmb3JtYXQgc3VwcG9ydHMgc3RydWN0dXJlZCBhcHBlbmQgYW5kIHRoZSBjdXJyZW50IHNjYW5uZWQgY29kZSBpcyBwYXJ0IG9mIG9uZSB0aGVuIHRoZQoJICAgICAqIHBhcml0eSBpcyBnaXZlbiB3aXRoIGl0LgoJICAgICAqLwoJICAgIFJlc3VsdE1ldGFkYXRhVHlwZVtSZXN1bHRNZXRhZGF0YVR5cGVbIlNUUlVDVFVSRURfQVBQRU5EX1BBUklUWSJdID0gMTBdID0gIlNUUlVDVFVSRURfQVBQRU5EX1BBUklUWSI7Cgl9KShSZXN1bHRNZXRhZGF0YVR5cGUgfHwgKFJlc3VsdE1ldGFkYXRhVHlwZSA9IHt9KSk7CglSZXN1bHRNZXRhZGF0YVR5cGUkMS5kZWZhdWx0ID0gUmVzdWx0TWV0YWRhdGFUeXBlOwoKCXZhciBEZWNvZGVyJDEgPSB7fTsKCgl2YXIgQ2hlY2tzdW1FeGNlcHRpb24kMSA9IHt9OwoKCXZhciBfX2V4dGVuZHMkOCA9IChjb21tb25qc0dsb2JhbCAmJiBjb21tb25qc0dsb2JhbC5fX2V4dGVuZHMpIHx8IChmdW5jdGlvbiAoKSB7CgkgICAgdmFyIGV4dGVuZFN0YXRpY3MgPSBmdW5jdGlvbiAoZCwgYikgewoJICAgICAgICBleHRlbmRTdGF0aWNzID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8CgkgICAgICAgICAgICAoeyBfX3Byb3RvX186IFtdIH0gaW5zdGFuY2VvZiBBcnJheSAmJiBmdW5jdGlvbiAoZCwgYikgeyBkLl9fcHJvdG9fXyA9IGI7IH0pIHx8CgkgICAgICAgICAgICBmdW5jdGlvbiAoZCwgYikgeyBmb3IgKHZhciBwIGluIGIpIGlmIChiLmhhc093blByb3BlcnR5KHApKSBkW3BdID0gYltwXTsgfTsKCSAgICAgICAgcmV0dXJuIGV4dGVuZFN0YXRpY3MoZCwgYik7CgkgICAgfTsKCSAgICByZXR1cm4gZnVuY3Rpb24gKGQsIGIpIHsKCSAgICAgICAgZXh0ZW5kU3RhdGljcyhkLCBiKTsKCSAgICAgICAgZnVuY3Rpb24gX18oKSB7IHRoaXMuY29uc3RydWN0b3IgPSBkOyB9CgkgICAgICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTsKCSAgICB9OwoJfSkoKTsKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShDaGVja3N1bUV4Y2VwdGlvbiQxLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7Cgl2YXIgRXhjZXB0aW9uXzEkNCA9IEV4Y2VwdGlvbiQxOwoJLyoqCgkgKiBDdXN0b20gRXJyb3IgY2xhc3Mgb2YgdHlwZSBFeGNlcHRpb24uCgkgKi8KCXZhciBDaGVja3N1bUV4Y2VwdGlvbiA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHsKCSAgICBfX2V4dGVuZHMkOChDaGVja3N1bUV4Y2VwdGlvbiwgX3N1cGVyKTsKCSAgICBmdW5jdGlvbiBDaGVja3N1bUV4Y2VwdGlvbigpIHsKCSAgICAgICAgcmV0dXJuIF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzOwoJICAgIH0KCSAgICBDaGVja3N1bUV4Y2VwdGlvbi5nZXRDaGVja3N1bUluc3RhbmNlID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gbmV3IENoZWNrc3VtRXhjZXB0aW9uKCk7CgkgICAgfTsKCSAgICBDaGVja3N1bUV4Y2VwdGlvbi5raW5kID0gJ0NoZWNrc3VtRXhjZXB0aW9uJzsKCSAgICByZXR1cm4gQ2hlY2tzdW1FeGNlcHRpb247Cgl9KEV4Y2VwdGlvbl8xJDQuZGVmYXVsdCkpOwoJQ2hlY2tzdW1FeGNlcHRpb24kMS5kZWZhdWx0ID0gQ2hlY2tzdW1FeGNlcHRpb247CgoJdmFyIEdlbmVyaWNHRiQxID0ge307CgoJdmFyIEdlbmVyaWNHRlBvbHkkMSA9IHt9OwoKCXZhciBBYnN0cmFjdEdlbmVyaWNHRiQxID0ge307CgoJLyoKCSAqIENvcHlyaWdodCAyMDA3IFpYaW5nIGF1dGhvcnMKCSAqCgkgKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKCSAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4KCSAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdAoJICoKCSAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wCgkgKgoJICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZQoJICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gIkFTIElTIiBCQVNJUywKCSAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLgoJICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZAoJICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuCgkgKi8KCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShBYnN0cmFjdEdlbmVyaWNHRiQxLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7Cgl2YXIgSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uXzEkNSA9IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbiQxOwoJLyoqCgkgKiA8cD5UaGlzIGNsYXNzIGNvbnRhaW5zIHV0aWxpdHkgbWV0aG9kcyBmb3IgcGVyZm9ybWluZyBtYXRoZW1hdGljYWwgb3BlcmF0aW9ucyBvdmVyCgkgKiB0aGUgR2Fsb2lzIEZpZWxkcy4gT3BlcmF0aW9ucyB1c2UgYSBnaXZlbiBwcmltaXRpdmUgcG9seW5vbWlhbCBpbiBjYWxjdWxhdGlvbnMuPC9wPgoJICoKCSAqIDxwPlRocm91Z2hvdXQgdGhpcyBwYWNrYWdlLCBlbGVtZW50cyBvZiB0aGUgR0YgYXJlIHJlcHJlc2VudGVkIGFzIGFuIHtAY29kZSBpbnR9CgkgKiBmb3IgY29udmVuaWVuY2UgYW5kIHNwZWVkIChidXQgYXQgdGhlIGNvc3Qgb2YgbWVtb3J5KS4KCSAqIDwvcD4KCSAqCgkgKiBAYXV0aG9yIFNlYW4gT3dlbgoJICogQGF1dGhvciBEYXZpZCBPbGl2aWVyCgkgKi8KCXZhciBBYnN0cmFjdEdlbmVyaWNHRiA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHsKCSAgICBmdW5jdGlvbiBBYnN0cmFjdEdlbmVyaWNHRigpIHsKCSAgICB9CgkgICAgLyoqCgkgICAgICogQHJldHVybiAyIHRvIHRoZSBwb3dlciBvZiBhIGluIEdGKHNpemUpCgkgICAgICovCgkgICAgQWJzdHJhY3RHZW5lcmljR0YucHJvdG90eXBlLmV4cCA9IGZ1bmN0aW9uIChhKSB7CgkgICAgICAgIHJldHVybiB0aGlzLmV4cFRhYmxlW2FdOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQHJldHVybiBiYXNlIDIgbG9nIG9mIGEgaW4gR0Yoc2l6ZSkKCSAgICAgKi8KCSAgICBBYnN0cmFjdEdlbmVyaWNHRi5wcm90b3R5cGUubG9nID0gZnVuY3Rpb24gKGEgLyppbnQqLykgewoJICAgICAgICBpZiAoYSA9PT0gMCkgewoJICAgICAgICAgICAgdGhyb3cgbmV3IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbl8xJDUuZGVmYXVsdCgpOwoJICAgICAgICB9CgkgICAgICAgIHJldHVybiB0aGlzLmxvZ1RhYmxlW2FdOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogSW1wbGVtZW50cyBib3RoIGFkZGl0aW9uIGFuZCBzdWJ0cmFjdGlvbiAtLSB0aGV5IGFyZSB0aGUgc2FtZSBpbiBHRihzaXplKS4KCSAgICAgKgoJICAgICAqIEByZXR1cm4gc3VtL2RpZmZlcmVuY2Ugb2YgYSBhbmQgYgoJICAgICAqLwoJICAgIEFic3RyYWN0R2VuZXJpY0dGLmFkZE9yU3VidHJhY3QgPSBmdW5jdGlvbiAoYSAvKmludCovLCBiIC8qaW50Ki8pIHsKCSAgICAgICAgcmV0dXJuIGEgXiBiOwoJICAgIH07CgkgICAgcmV0dXJuIEFic3RyYWN0R2VuZXJpY0dGOwoJfSgpKTsKCUFic3RyYWN0R2VuZXJpY0dGJDEuZGVmYXVsdCA9IEFic3RyYWN0R2VuZXJpY0dGOwoKCS8qCgkgKiBDb3B5cmlnaHQgMjAwNyBaWGluZyBhdXRob3JzCgkgKgoJICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIik7CgkgKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCgkgKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKCSAqCgkgKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAoJICoKCSAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKCSAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCgkgKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4KCSAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKCSAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgoJICovCglPYmplY3QuZGVmaW5lUHJvcGVydHkoR2VuZXJpY0dGUG9seSQxLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7CgkvKm5hbWVzcGFjZSBjb20uZ29vZ2xlLnp4aW5nLmNvbW1vbi5yZWVkc29sb21vbiB7Ki8KCXZhciBBYnN0cmFjdEdlbmVyaWNHRl8xJDEgPSBBYnN0cmFjdEdlbmVyaWNHRiQxOwoJdmFyIFN5c3RlbV8xID0gU3lzdGVtJDE7Cgl2YXIgSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uXzEkNCA9IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbiQxOwoJLyoqCgkgKiA8cD5SZXByZXNlbnRzIGEgcG9seW5vbWlhbCB3aG9zZSBjb2VmZmljaWVudHMgYXJlIGVsZW1lbnRzIG9mIGEgR0YuCgkgKiBJbnN0YW5jZXMgb2YgdGhpcyBjbGFzcyBhcmUgaW1tdXRhYmxlLjwvcD4KCSAqCgkgKiA8cD5NdWNoIGNyZWRpdCBpcyBkdWUgdG8gV2lsbGlhbSBSdWNrbGlkZ2Ugc2luY2UgcG9ydGlvbnMgb2YgdGhpcyBjb2RlIGFyZSBhbiBpbmRpcmVjdAoJICogcG9ydCBvZiBoaXMgQysrIFJlZWQtU29sb21vbiBpbXBsZW1lbnRhdGlvbi48L3A+CgkgKgoJICogQGF1dGhvciBTZWFuIE93ZW4KCSAqLwoJdmFyIEdlbmVyaWNHRlBvbHkgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7CgkgICAgLyoqCgkgICAgICogQHBhcmFtIGZpZWxkIHRoZSB7QGxpbmsgR2VuZXJpY0dGfSBpbnN0YW5jZSByZXByZXNlbnRpbmcgdGhlIGZpZWxkIHRvIHVzZQoJICAgICAqIHRvIHBlcmZvcm0gY29tcHV0YXRpb25zCgkgICAgICogQHBhcmFtIGNvZWZmaWNpZW50cyBjb2VmZmljaWVudHMgYXMgaW50cyByZXByZXNlbnRpbmcgZWxlbWVudHMgb2YgR0Yoc2l6ZSksIGFycmFuZ2VkCgkgICAgICogZnJvbSBtb3N0IHNpZ25pZmljYW50IChoaWdoZXN0LXBvd2VyIHRlcm0pIGNvZWZmaWNpZW50IHRvIGxlYXN0IHNpZ25pZmljYW50CgkgICAgICogQHRocm93cyBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb24gaWYgYXJndW1lbnQgaXMgbnVsbCBvciBlbXB0eSwKCSAgICAgKiBvciBpZiBsZWFkaW5nIGNvZWZmaWNpZW50IGlzIDAgYW5kIHRoaXMgaXMgbm90IGEKCSAgICAgKiBjb25zdGFudCBwb2x5bm9taWFsICh0aGF0IGlzLCBpdCBpcyBub3QgdGhlIG1vbm9taWFsICIwIikKCSAgICAgKi8KCSAgICBmdW5jdGlvbiBHZW5lcmljR0ZQb2x5KGZpZWxkLCBjb2VmZmljaWVudHMpIHsKCSAgICAgICAgaWYgKGNvZWZmaWNpZW50cy5sZW5ndGggPT09IDApIHsKCSAgICAgICAgICAgIHRocm93IG5ldyBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb25fMSQ0LmRlZmF1bHQoKTsKCSAgICAgICAgfQoJICAgICAgICB0aGlzLmZpZWxkID0gZmllbGQ7CgkgICAgICAgIHZhciBjb2VmZmljaWVudHNMZW5ndGggPSBjb2VmZmljaWVudHMubGVuZ3RoOwoJICAgICAgICBpZiAoY29lZmZpY2llbnRzTGVuZ3RoID4gMSAmJiBjb2VmZmljaWVudHNbMF0gPT09IDApIHsKCSAgICAgICAgICAgIC8vIExlYWRpbmcgdGVybSBtdXN0IGJlIG5vbi16ZXJvIGZvciBhbnl0aGluZyBleGNlcHQgdGhlIGNvbnN0YW50IHBvbHlub21pYWwgIjAiCgkgICAgICAgICAgICB2YXIgZmlyc3ROb25aZXJvID0gMTsKCSAgICAgICAgICAgIHdoaWxlIChmaXJzdE5vblplcm8gPCBjb2VmZmljaWVudHNMZW5ndGggJiYgY29lZmZpY2llbnRzW2ZpcnN0Tm9uWmVyb10gPT09IDApIHsKCSAgICAgICAgICAgICAgICBmaXJzdE5vblplcm8rKzsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIGlmIChmaXJzdE5vblplcm8gPT09IGNvZWZmaWNpZW50c0xlbmd0aCkgewoJICAgICAgICAgICAgICAgIHRoaXMuY29lZmZpY2llbnRzID0gSW50MzJBcnJheS5mcm9tKFswXSk7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBlbHNlIHsKCSAgICAgICAgICAgICAgICB0aGlzLmNvZWZmaWNpZW50cyA9IG5ldyBJbnQzMkFycmF5KGNvZWZmaWNpZW50c0xlbmd0aCAtIGZpcnN0Tm9uWmVybyk7CgkgICAgICAgICAgICAgICAgU3lzdGVtXzEuZGVmYXVsdC5hcnJheWNvcHkoY29lZmZpY2llbnRzLCBmaXJzdE5vblplcm8sIHRoaXMuY29lZmZpY2llbnRzLCAwLCB0aGlzLmNvZWZmaWNpZW50cy5sZW5ndGgpOwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIGVsc2UgewoJICAgICAgICAgICAgdGhpcy5jb2VmZmljaWVudHMgPSBjb2VmZmljaWVudHM7CgkgICAgICAgIH0KCSAgICB9CgkgICAgR2VuZXJpY0dGUG9seS5wcm90b3R5cGUuZ2V0Q29lZmZpY2llbnRzID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5jb2VmZmljaWVudHM7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcmV0dXJuIGRlZ3JlZSBvZiB0aGlzIHBvbHlub21pYWwKCSAgICAgKi8KCSAgICBHZW5lcmljR0ZQb2x5LnByb3RvdHlwZS5nZXREZWdyZWUgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLmNvZWZmaWNpZW50cy5sZW5ndGggLSAxOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQHJldHVybiB0cnVlIGlmZiB0aGlzIHBvbHlub21pYWwgaXMgdGhlIG1vbm9taWFsICIwIgoJICAgICAqLwoJICAgIEdlbmVyaWNHRlBvbHkucHJvdG90eXBlLmlzWmVybyA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMuY29lZmZpY2llbnRzWzBdID09PSAwOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQHJldHVybiBjb2VmZmljaWVudCBvZiB4XmRlZ3JlZSB0ZXJtIGluIHRoaXMgcG9seW5vbWlhbAoJICAgICAqLwoJICAgIEdlbmVyaWNHRlBvbHkucHJvdG90eXBlLmdldENvZWZmaWNpZW50ID0gZnVuY3Rpb24gKGRlZ3JlZSAvKmludCovKSB7CgkgICAgICAgIHJldHVybiB0aGlzLmNvZWZmaWNpZW50c1t0aGlzLmNvZWZmaWNpZW50cy5sZW5ndGggLSAxIC0gZGVncmVlXTsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEByZXR1cm4gZXZhbHVhdGlvbiBvZiB0aGlzIHBvbHlub21pYWwgYXQgYSBnaXZlbiBwb2ludAoJICAgICAqLwoJICAgIEdlbmVyaWNHRlBvbHkucHJvdG90eXBlLmV2YWx1YXRlQXQgPSBmdW5jdGlvbiAoYSAvKmludCovKSB7CgkgICAgICAgIGlmIChhID09PSAwKSB7CgkgICAgICAgICAgICAvLyBKdXN0IHJldHVybiB0aGUgeF4wIGNvZWZmaWNpZW50CgkgICAgICAgICAgICByZXR1cm4gdGhpcy5nZXRDb2VmZmljaWVudCgwKTsKCSAgICAgICAgfQoJICAgICAgICB2YXIgY29lZmZpY2llbnRzID0gdGhpcy5jb2VmZmljaWVudHM7CgkgICAgICAgIHZhciByZXN1bHQ7CgkgICAgICAgIGlmIChhID09PSAxKSB7CgkgICAgICAgICAgICAvLyBKdXN0IHRoZSBzdW0gb2YgdGhlIGNvZWZmaWNpZW50cwoJICAgICAgICAgICAgcmVzdWx0ID0gMDsKCSAgICAgICAgICAgIGZvciAodmFyIGkgPSAwLCBsZW5ndGhfMSA9IGNvZWZmaWNpZW50cy5sZW5ndGg7IGkgIT09IGxlbmd0aF8xOyBpKyspIHsKCSAgICAgICAgICAgICAgICB2YXIgY29lZmZpY2llbnQgPSBjb2VmZmljaWVudHNbaV07CgkgICAgICAgICAgICAgICAgcmVzdWx0ID0gQWJzdHJhY3RHZW5lcmljR0ZfMSQxLmRlZmF1bHQuYWRkT3JTdWJ0cmFjdChyZXN1bHQsIGNvZWZmaWNpZW50KTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIHJldHVybiByZXN1bHQ7CgkgICAgICAgIH0KCSAgICAgICAgcmVzdWx0ID0gY29lZmZpY2llbnRzWzBdOwoJICAgICAgICB2YXIgc2l6ZSA9IGNvZWZmaWNpZW50cy5sZW5ndGg7CgkgICAgICAgIHZhciBmaWVsZCA9IHRoaXMuZmllbGQ7CgkgICAgICAgIGZvciAodmFyIGkgPSAxOyBpIDwgc2l6ZTsgaSsrKSB7CgkgICAgICAgICAgICByZXN1bHQgPSBBYnN0cmFjdEdlbmVyaWNHRl8xJDEuZGVmYXVsdC5hZGRPclN1YnRyYWN0KGZpZWxkLm11bHRpcGx5KGEsIHJlc3VsdCksIGNvZWZmaWNpZW50c1tpXSk7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIHJlc3VsdDsKCSAgICB9OwoJICAgIEdlbmVyaWNHRlBvbHkucHJvdG90eXBlLmFkZE9yU3VidHJhY3QgPSBmdW5jdGlvbiAob3RoZXIpIHsKCSAgICAgICAgaWYgKCF0aGlzLmZpZWxkLmVxdWFscyhvdGhlci5maWVsZCkpIHsKCSAgICAgICAgICAgIHRocm93IG5ldyBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb25fMSQ0LmRlZmF1bHQoJ0dlbmVyaWNHRlBvbHlzIGRvIG5vdCBoYXZlIHNhbWUgR2VuZXJpY0dGIGZpZWxkJyk7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKHRoaXMuaXNaZXJvKCkpIHsKCSAgICAgICAgICAgIHJldHVybiBvdGhlcjsKCSAgICAgICAgfQoJICAgICAgICBpZiAob3RoZXIuaXNaZXJvKCkpIHsKCSAgICAgICAgICAgIHJldHVybiB0aGlzOwoJICAgICAgICB9CgkgICAgICAgIHZhciBzbWFsbGVyQ29lZmZpY2llbnRzID0gdGhpcy5jb2VmZmljaWVudHM7CgkgICAgICAgIHZhciBsYXJnZXJDb2VmZmljaWVudHMgPSBvdGhlci5jb2VmZmljaWVudHM7CgkgICAgICAgIGlmIChzbWFsbGVyQ29lZmZpY2llbnRzLmxlbmd0aCA+IGxhcmdlckNvZWZmaWNpZW50cy5sZW5ndGgpIHsKCSAgICAgICAgICAgIHZhciB0ZW1wID0gc21hbGxlckNvZWZmaWNpZW50czsKCSAgICAgICAgICAgIHNtYWxsZXJDb2VmZmljaWVudHMgPSBsYXJnZXJDb2VmZmljaWVudHM7CgkgICAgICAgICAgICBsYXJnZXJDb2VmZmljaWVudHMgPSB0ZW1wOwoJICAgICAgICB9CgkgICAgICAgIHZhciBzdW1EaWZmID0gbmV3IEludDMyQXJyYXkobGFyZ2VyQ29lZmZpY2llbnRzLmxlbmd0aCk7CgkgICAgICAgIHZhciBsZW5ndGhEaWZmID0gbGFyZ2VyQ29lZmZpY2llbnRzLmxlbmd0aCAtIHNtYWxsZXJDb2VmZmljaWVudHMubGVuZ3RoOwoJICAgICAgICAvLyBDb3B5IGhpZ2gtb3JkZXIgdGVybXMgb25seSBmb3VuZCBpbiBoaWdoZXItZGVncmVlIHBvbHlub21pYWwncyBjb2VmZmljaWVudHMKCSAgICAgICAgU3lzdGVtXzEuZGVmYXVsdC5hcnJheWNvcHkobGFyZ2VyQ29lZmZpY2llbnRzLCAwLCBzdW1EaWZmLCAwLCBsZW5ndGhEaWZmKTsKCSAgICAgICAgZm9yICh2YXIgaSA9IGxlbmd0aERpZmY7IGkgPCBsYXJnZXJDb2VmZmljaWVudHMubGVuZ3RoOyBpKyspIHsKCSAgICAgICAgICAgIHN1bURpZmZbaV0gPSBBYnN0cmFjdEdlbmVyaWNHRl8xJDEuZGVmYXVsdC5hZGRPclN1YnRyYWN0KHNtYWxsZXJDb2VmZmljaWVudHNbaSAtIGxlbmd0aERpZmZdLCBsYXJnZXJDb2VmZmljaWVudHNbaV0pOwoJICAgICAgICB9CgkgICAgICAgIHJldHVybiBuZXcgR2VuZXJpY0dGUG9seSh0aGlzLmZpZWxkLCBzdW1EaWZmKTsKCSAgICB9OwoJICAgIEdlbmVyaWNHRlBvbHkucHJvdG90eXBlLm11bHRpcGx5ID0gZnVuY3Rpb24gKG90aGVyKSB7CgkgICAgICAgIGlmICghdGhpcy5maWVsZC5lcXVhbHMob3RoZXIuZmllbGQpKSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uXzEkNC5kZWZhdWx0KCdHZW5lcmljR0ZQb2x5cyBkbyBub3QgaGF2ZSBzYW1lIEdlbmVyaWNHRiBmaWVsZCcpOwoJICAgICAgICB9CgkgICAgICAgIGlmICh0aGlzLmlzWmVybygpIHx8IG90aGVyLmlzWmVybygpKSB7CgkgICAgICAgICAgICByZXR1cm4gdGhpcy5maWVsZC5nZXRaZXJvKCk7CgkgICAgICAgIH0KCSAgICAgICAgdmFyIGFDb2VmZmljaWVudHMgPSB0aGlzLmNvZWZmaWNpZW50czsKCSAgICAgICAgdmFyIGFMZW5ndGggPSBhQ29lZmZpY2llbnRzLmxlbmd0aDsKCSAgICAgICAgdmFyIGJDb2VmZmljaWVudHMgPSBvdGhlci5jb2VmZmljaWVudHM7CgkgICAgICAgIHZhciBiTGVuZ3RoID0gYkNvZWZmaWNpZW50cy5sZW5ndGg7CgkgICAgICAgIHZhciBwcm9kdWN0ID0gbmV3IEludDMyQXJyYXkoYUxlbmd0aCArIGJMZW5ndGggLSAxKTsKCSAgICAgICAgdmFyIGZpZWxkID0gdGhpcy5maWVsZDsKCSAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBhTGVuZ3RoOyBpKyspIHsKCSAgICAgICAgICAgIHZhciBhQ29lZmYgPSBhQ29lZmZpY2llbnRzW2ldOwoJICAgICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCBiTGVuZ3RoOyBqKyspIHsKCSAgICAgICAgICAgICAgICBwcm9kdWN0W2kgKyBqXSA9IEFic3RyYWN0R2VuZXJpY0dGXzEkMS5kZWZhdWx0LmFkZE9yU3VidHJhY3QocHJvZHVjdFtpICsgal0sIGZpZWxkLm11bHRpcGx5KGFDb2VmZiwgYkNvZWZmaWNpZW50c1tqXSkpOwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIHJldHVybiBuZXcgR2VuZXJpY0dGUG9seShmaWVsZCwgcHJvZHVjdCk7CgkgICAgfTsKCSAgICBHZW5lcmljR0ZQb2x5LnByb3RvdHlwZS5tdWx0aXBseVNjYWxhciA9IGZ1bmN0aW9uIChzY2FsYXIgLyppbnQqLykgewoJICAgICAgICBpZiAoc2NhbGFyID09PSAwKSB7CgkgICAgICAgICAgICByZXR1cm4gdGhpcy5maWVsZC5nZXRaZXJvKCk7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKHNjYWxhciA9PT0gMSkgewoJICAgICAgICAgICAgcmV0dXJuIHRoaXM7CgkgICAgICAgIH0KCSAgICAgICAgdmFyIHNpemUgPSB0aGlzLmNvZWZmaWNpZW50cy5sZW5ndGg7CgkgICAgICAgIHZhciBmaWVsZCA9IHRoaXMuZmllbGQ7CgkgICAgICAgIHZhciBwcm9kdWN0ID0gbmV3IEludDMyQXJyYXkoc2l6ZSk7CgkgICAgICAgIHZhciBjb2VmZmljaWVudHMgPSB0aGlzLmNvZWZmaWNpZW50czsKCSAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzaXplOyBpKyspIHsKCSAgICAgICAgICAgIHByb2R1Y3RbaV0gPSBmaWVsZC5tdWx0aXBseShjb2VmZmljaWVudHNbaV0sIHNjYWxhcik7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIG5ldyBHZW5lcmljR0ZQb2x5KGZpZWxkLCBwcm9kdWN0KTsKCSAgICB9OwoJICAgIEdlbmVyaWNHRlBvbHkucHJvdG90eXBlLm11bHRpcGx5QnlNb25vbWlhbCA9IGZ1bmN0aW9uIChkZWdyZWUgLyppbnQqLywgY29lZmZpY2llbnQgLyppbnQqLykgewoJICAgICAgICBpZiAoZGVncmVlIDwgMCkgewoJICAgICAgICAgICAgdGhyb3cgbmV3IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbl8xJDQuZGVmYXVsdCgpOwoJICAgICAgICB9CgkgICAgICAgIGlmIChjb2VmZmljaWVudCA9PT0gMCkgewoJICAgICAgICAgICAgcmV0dXJuIHRoaXMuZmllbGQuZ2V0WmVybygpOwoJICAgICAgICB9CgkgICAgICAgIHZhciBjb2VmZmljaWVudHMgPSB0aGlzLmNvZWZmaWNpZW50czsKCSAgICAgICAgdmFyIHNpemUgPSBjb2VmZmljaWVudHMubGVuZ3RoOwoJICAgICAgICB2YXIgcHJvZHVjdCA9IG5ldyBJbnQzMkFycmF5KHNpemUgKyBkZWdyZWUpOwoJICAgICAgICB2YXIgZmllbGQgPSB0aGlzLmZpZWxkOwoJICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHNpemU7IGkrKykgewoJICAgICAgICAgICAgcHJvZHVjdFtpXSA9IGZpZWxkLm11bHRpcGx5KGNvZWZmaWNpZW50c1tpXSwgY29lZmZpY2llbnQpOwoJICAgICAgICB9CgkgICAgICAgIHJldHVybiBuZXcgR2VuZXJpY0dGUG9seShmaWVsZCwgcHJvZHVjdCk7CgkgICAgfTsKCSAgICBHZW5lcmljR0ZQb2x5LnByb3RvdHlwZS5kaXZpZGUgPSBmdW5jdGlvbiAob3RoZXIpIHsKCSAgICAgICAgaWYgKCF0aGlzLmZpZWxkLmVxdWFscyhvdGhlci5maWVsZCkpIHsKCSAgICAgICAgICAgIHRocm93IG5ldyBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb25fMSQ0LmRlZmF1bHQoJ0dlbmVyaWNHRlBvbHlzIGRvIG5vdCBoYXZlIHNhbWUgR2VuZXJpY0dGIGZpZWxkJyk7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKG90aGVyLmlzWmVybygpKSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uXzEkNC5kZWZhdWx0KCdEaXZpZGUgYnkgMCcpOwoJICAgICAgICB9CgkgICAgICAgIHZhciBmaWVsZCA9IHRoaXMuZmllbGQ7CgkgICAgICAgIHZhciBxdW90aWVudCA9IGZpZWxkLmdldFplcm8oKTsKCSAgICAgICAgdmFyIHJlbWFpbmRlciA9IHRoaXM7CgkgICAgICAgIHZhciBkZW5vbWluYXRvckxlYWRpbmdUZXJtID0gb3RoZXIuZ2V0Q29lZmZpY2llbnQob3RoZXIuZ2V0RGVncmVlKCkpOwoJICAgICAgICB2YXIgaW52ZXJzZURlbm9taW5hdG9yTGVhZGluZ1Rlcm0gPSBmaWVsZC5pbnZlcnNlKGRlbm9taW5hdG9yTGVhZGluZ1Rlcm0pOwoJICAgICAgICB3aGlsZSAocmVtYWluZGVyLmdldERlZ3JlZSgpID49IG90aGVyLmdldERlZ3JlZSgpICYmICFyZW1haW5kZXIuaXNaZXJvKCkpIHsKCSAgICAgICAgICAgIHZhciBkZWdyZWVEaWZmZXJlbmNlID0gcmVtYWluZGVyLmdldERlZ3JlZSgpIC0gb3RoZXIuZ2V0RGVncmVlKCk7CgkgICAgICAgICAgICB2YXIgc2NhbGUgPSBmaWVsZC5tdWx0aXBseShyZW1haW5kZXIuZ2V0Q29lZmZpY2llbnQocmVtYWluZGVyLmdldERlZ3JlZSgpKSwgaW52ZXJzZURlbm9taW5hdG9yTGVhZGluZ1Rlcm0pOwoJICAgICAgICAgICAgdmFyIHRlcm0gPSBvdGhlci5tdWx0aXBseUJ5TW9ub21pYWwoZGVncmVlRGlmZmVyZW5jZSwgc2NhbGUpOwoJICAgICAgICAgICAgdmFyIGl0ZXJhdGlvblF1b3RpZW50ID0gZmllbGQuYnVpbGRNb25vbWlhbChkZWdyZWVEaWZmZXJlbmNlLCBzY2FsZSk7CgkgICAgICAgICAgICBxdW90aWVudCA9IHF1b3RpZW50LmFkZE9yU3VidHJhY3QoaXRlcmF0aW9uUXVvdGllbnQpOwoJICAgICAgICAgICAgcmVtYWluZGVyID0gcmVtYWluZGVyLmFkZE9yU3VidHJhY3QodGVybSk7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIFtxdW90aWVudCwgcmVtYWluZGVyXTsKCSAgICB9OwoJICAgIC8qQE92ZXJyaWRlKi8KCSAgICBHZW5lcmljR0ZQb2x5LnByb3RvdHlwZS50b1N0cmluZyA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgdmFyIHJlc3VsdCA9ICcnOwoJICAgICAgICBmb3IgKHZhciBkZWdyZWUgPSB0aGlzLmdldERlZ3JlZSgpOyBkZWdyZWUgPj0gMDsgZGVncmVlLS0pIHsKCSAgICAgICAgICAgIHZhciBjb2VmZmljaWVudCA9IHRoaXMuZ2V0Q29lZmZpY2llbnQoZGVncmVlKTsKCSAgICAgICAgICAgIGlmIChjb2VmZmljaWVudCAhPT0gMCkgewoJICAgICAgICAgICAgICAgIGlmIChjb2VmZmljaWVudCA8IDApIHsKCSAgICAgICAgICAgICAgICAgICAgcmVzdWx0ICs9ICcgLSAnOwoJICAgICAgICAgICAgICAgICAgICBjb2VmZmljaWVudCA9IC1jb2VmZmljaWVudDsKCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgZWxzZSB7CgkgICAgICAgICAgICAgICAgICAgIGlmIChyZXN1bHQubGVuZ3RoID4gMCkgewoJICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0ICs9ICcgKyAnOwoJICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgIGlmIChkZWdyZWUgPT09IDAgfHwgY29lZmZpY2llbnQgIT09IDEpIHsKCSAgICAgICAgICAgICAgICAgICAgdmFyIGFscGhhUG93ZXIgPSB0aGlzLmZpZWxkLmxvZyhjb2VmZmljaWVudCk7CgkgICAgICAgICAgICAgICAgICAgIGlmIChhbHBoYVBvd2VyID09PSAwKSB7CgkgICAgICAgICAgICAgICAgICAgICAgICByZXN1bHQgKz0gJzEnOwoJICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgIGVsc2UgaWYgKGFscGhhUG93ZXIgPT09IDEpIHsKCSAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdCArPSAnYSc7CgkgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICAgICAgZWxzZSB7CgkgICAgICAgICAgICAgICAgICAgICAgICByZXN1bHQgKz0gJ2FeJzsKCSAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdCArPSBhbHBoYVBvd2VyOwoJICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgIGlmIChkZWdyZWUgIT09IDApIHsKCSAgICAgICAgICAgICAgICAgICAgaWYgKGRlZ3JlZSA9PT0gMSkgewoJICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0ICs9ICd4JzsKCSAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICBlbHNlIHsKCSAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdCArPSAneF4nOwoJICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0ICs9IGRlZ3JlZTsKCSAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgIH0KCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gcmVzdWx0OwoJICAgIH07CgkgICAgcmV0dXJuIEdlbmVyaWNHRlBvbHk7Cgl9KCkpOwoJR2VuZXJpY0dGUG9seSQxLmRlZmF1bHQgPSBHZW5lcmljR0ZQb2x5OwoKCXZhciBBcml0aG1ldGljRXhjZXB0aW9uJDEgPSB7fTsKCgl2YXIgX19leHRlbmRzJDcgPSAoY29tbW9uanNHbG9iYWwgJiYgY29tbW9uanNHbG9iYWwuX19leHRlbmRzKSB8fCAoZnVuY3Rpb24gKCkgewoJICAgIHZhciBleHRlbmRTdGF0aWNzID0gZnVuY3Rpb24gKGQsIGIpIHsKCSAgICAgICAgZXh0ZW5kU3RhdGljcyA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fAoJICAgICAgICAgICAgKHsgX19wcm90b19fOiBbXSB9IGluc3RhbmNlb2YgQXJyYXkgJiYgZnVuY3Rpb24gKGQsIGIpIHsgZC5fX3Byb3RvX18gPSBiOyB9KSB8fAoJICAgICAgICAgICAgZnVuY3Rpb24gKGQsIGIpIHsgZm9yICh2YXIgcCBpbiBiKSBpZiAoYi5oYXNPd25Qcm9wZXJ0eShwKSkgZFtwXSA9IGJbcF07IH07CgkgICAgICAgIHJldHVybiBleHRlbmRTdGF0aWNzKGQsIGIpOwoJICAgIH07CgkgICAgcmV0dXJuIGZ1bmN0aW9uIChkLCBiKSB7CgkgICAgICAgIGV4dGVuZFN0YXRpY3MoZCwgYik7CgkgICAgICAgIGZ1bmN0aW9uIF9fKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gZDsgfQoJICAgICAgICBkLnByb3RvdHlwZSA9IGIgPT09IG51bGwgPyBPYmplY3QuY3JlYXRlKGIpIDogKF9fLnByb3RvdHlwZSA9IGIucHJvdG90eXBlLCBuZXcgX18oKSk7CgkgICAgfTsKCX0pKCk7CglPYmplY3QuZGVmaW5lUHJvcGVydHkoQXJpdGhtZXRpY0V4Y2VwdGlvbiQxLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7Cgl2YXIgRXhjZXB0aW9uXzEkMyA9IEV4Y2VwdGlvbiQxOwoJLyoqCgkgKiBDdXN0b20gRXJyb3IgY2xhc3Mgb2YgdHlwZSBFeGNlcHRpb24uCgkgKi8KCXZhciBBcml0aG1ldGljRXhjZXB0aW9uID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikgewoJICAgIF9fZXh0ZW5kcyQ3KEFyaXRobWV0aWNFeGNlcHRpb24sIF9zdXBlcik7CgkgICAgZnVuY3Rpb24gQXJpdGhtZXRpY0V4Y2VwdGlvbigpIHsKCSAgICAgICAgcmV0dXJuIF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzOwoJICAgIH0KCSAgICBBcml0aG1ldGljRXhjZXB0aW9uLmtpbmQgPSAnQXJpdGhtZXRpY0V4Y2VwdGlvbic7CgkgICAgcmV0dXJuIEFyaXRobWV0aWNFeGNlcHRpb247Cgl9KEV4Y2VwdGlvbl8xJDMuZGVmYXVsdCkpOwoJQXJpdGhtZXRpY0V4Y2VwdGlvbiQxLmRlZmF1bHQgPSBBcml0aG1ldGljRXhjZXB0aW9uOwoKCS8qCgkgKiBDb3B5cmlnaHQgMjAwNyBaWGluZyBhdXRob3JzCgkgKgoJICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIik7CgkgKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCgkgKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKCSAqCgkgKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAoJICoKCSAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKCSAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCgkgKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4KCSAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKCSAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgoJICovCgl2YXIgX19leHRlbmRzJDYgPSAoY29tbW9uanNHbG9iYWwgJiYgY29tbW9uanNHbG9iYWwuX19leHRlbmRzKSB8fCAoZnVuY3Rpb24gKCkgewoJICAgIHZhciBleHRlbmRTdGF0aWNzID0gZnVuY3Rpb24gKGQsIGIpIHsKCSAgICAgICAgZXh0ZW5kU3RhdGljcyA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fAoJICAgICAgICAgICAgKHsgX19wcm90b19fOiBbXSB9IGluc3RhbmNlb2YgQXJyYXkgJiYgZnVuY3Rpb24gKGQsIGIpIHsgZC5fX3Byb3RvX18gPSBiOyB9KSB8fAoJICAgICAgICAgICAgZnVuY3Rpb24gKGQsIGIpIHsgZm9yICh2YXIgcCBpbiBiKSBpZiAoYi5oYXNPd25Qcm9wZXJ0eShwKSkgZFtwXSA9IGJbcF07IH07CgkgICAgICAgIHJldHVybiBleHRlbmRTdGF0aWNzKGQsIGIpOwoJICAgIH07CgkgICAgcmV0dXJuIGZ1bmN0aW9uIChkLCBiKSB7CgkgICAgICAgIGV4dGVuZFN0YXRpY3MoZCwgYik7CgkgICAgICAgIGZ1bmN0aW9uIF9fKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gZDsgfQoJICAgICAgICBkLnByb3RvdHlwZSA9IGIgPT09IG51bGwgPyBPYmplY3QuY3JlYXRlKGIpIDogKF9fLnByb3RvdHlwZSA9IGIucHJvdG90eXBlLCBuZXcgX18oKSk7CgkgICAgfTsKCX0pKCk7CglPYmplY3QuZGVmaW5lUHJvcGVydHkoR2VuZXJpY0dGJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCS8qbmFtZXNwYWNlIGNvbS5nb29nbGUuenhpbmcuY29tbW9uLnJlZWRzb2xvbW9uIHsqLwoJdmFyIEdlbmVyaWNHRlBvbHlfMSQxID0gR2VuZXJpY0dGUG9seSQxOwoJdmFyIEFic3RyYWN0R2VuZXJpY0dGXzEgPSBBYnN0cmFjdEdlbmVyaWNHRiQxOwoJdmFyIEludGVnZXJfMSQxID0gSW50ZWdlciQxOwoJdmFyIElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbl8xJDMgPSBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb24kMTsKCXZhciBBcml0aG1ldGljRXhjZXB0aW9uXzEgPSBBcml0aG1ldGljRXhjZXB0aW9uJDE7CgkvKioKCSAqIDxwPlRoaXMgY2xhc3MgY29udGFpbnMgdXRpbGl0eSBtZXRob2RzIGZvciBwZXJmb3JtaW5nIG1hdGhlbWF0aWNhbCBvcGVyYXRpb25zIG92ZXIKCSAqIHRoZSBHYWxvaXMgRmllbGRzLiBPcGVyYXRpb25zIHVzZSBhIGdpdmVuIHByaW1pdGl2ZSBwb2x5bm9taWFsIGluIGNhbGN1bGF0aW9ucy48L3A+CgkgKgoJICogPHA+VGhyb3VnaG91dCB0aGlzIHBhY2thZ2UsIGVsZW1lbnRzIG9mIHRoZSBHRiBhcmUgcmVwcmVzZW50ZWQgYXMgYW4ge0Bjb2RlIGludH0KCSAqIGZvciBjb252ZW5pZW5jZSBhbmQgc3BlZWQgKGJ1dCBhdCB0aGUgY29zdCBvZiBtZW1vcnkpLgoJICogPC9wPgoJICoKCSAqIEBhdXRob3IgU2VhbiBPd2VuCgkgKiBAYXV0aG9yIERhdmlkIE9saXZpZXIKCSAqLwoJdmFyIEdlbmVyaWNHRiA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHsKCSAgICBfX2V4dGVuZHMkNihHZW5lcmljR0YsIF9zdXBlcik7CgkgICAgLyoqCgkgICAgICogQ3JlYXRlIGEgcmVwcmVzZW50YXRpb24gb2YgR0Yoc2l6ZSkgdXNpbmcgdGhlIGdpdmVuIHByaW1pdGl2ZSBwb2x5bm9taWFsLgoJICAgICAqCgkgICAgICogQHBhcmFtIHByaW1pdGl2ZSBpcnJlZHVjaWJsZSBwb2x5bm9taWFsIHdob3NlIGNvZWZmaWNpZW50cyBhcmUgcmVwcmVzZW50ZWQgYnkKCSAgICAgKiAgdGhlIGJpdHMgb2YgYW4gaW50LCB3aGVyZSB0aGUgbGVhc3Qtc2lnbmlmaWNhbnQgYml0IHJlcHJlc2VudHMgdGhlIGNvbnN0YW50CgkgICAgICogIGNvZWZmaWNpZW50CgkgICAgICogQHBhcmFtIHNpemUgdGhlIHNpemUgb2YgdGhlIGZpZWxkCgkgICAgICogQHBhcmFtIGIgdGhlIGZhY3RvciBiIGluIHRoZSBnZW5lcmF0b3IgcG9seW5vbWlhbCBjYW4gYmUgMC0gb3IgMS1iYXNlZAoJICAgICAqICAoZyh4KSA9ICh4K2FeYikoeCthXihiKzEpKS4uLih4K2FeKGIrMnQtMSkpKS4KCSAgICAgKiAgSW4gbW9zdCBjYXNlcyBpdCBzaG91bGQgYmUgMSwgYnV0IGZvciBRUiBjb2RlIGl0IGlzIDAuCgkgICAgICovCgkgICAgZnVuY3Rpb24gR2VuZXJpY0dGKHByaW1pdGl2ZSAvKmludCovLCBzaXplIC8qaW50Ki8sIGdlbmVyYXRvckJhc2UgLyppbnQqLykgewoJICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzKSB8fCB0aGlzOwoJICAgICAgICBfdGhpcy5wcmltaXRpdmUgPSBwcmltaXRpdmU7CgkgICAgICAgIF90aGlzLnNpemUgPSBzaXplOwoJICAgICAgICBfdGhpcy5nZW5lcmF0b3JCYXNlID0gZ2VuZXJhdG9yQmFzZTsKCSAgICAgICAgdmFyIGV4cFRhYmxlID0gbmV3IEludDMyQXJyYXkoc2l6ZSk7CgkgICAgICAgIHZhciB4ID0gMTsKCSAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzaXplOyBpKyspIHsKCSAgICAgICAgICAgIGV4cFRhYmxlW2ldID0geDsKCSAgICAgICAgICAgIHggKj0gMjsgLy8gd2UncmUgYXNzdW1pbmcgdGhlIGdlbmVyYXRvciBhbHBoYSBpcyAyCgkgICAgICAgICAgICBpZiAoeCA+PSBzaXplKSB7CgkgICAgICAgICAgICAgICAgeCBePSBwcmltaXRpdmU7CgkgICAgICAgICAgICAgICAgeCAmPSBzaXplIC0gMTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgfQoJICAgICAgICBfdGhpcy5leHBUYWJsZSA9IGV4cFRhYmxlOwoJICAgICAgICB2YXIgbG9nVGFibGUgPSBuZXcgSW50MzJBcnJheShzaXplKTsKCSAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzaXplIC0gMTsgaSsrKSB7CgkgICAgICAgICAgICBsb2dUYWJsZVtleHBUYWJsZVtpXV0gPSBpOwoJICAgICAgICB9CgkgICAgICAgIF90aGlzLmxvZ1RhYmxlID0gbG9nVGFibGU7CgkgICAgICAgIC8vIGxvZ1RhYmxlWzBdID09IDAgYnV0IHRoaXMgc2hvdWxkIG5ldmVyIGJlIHVzZWQKCSAgICAgICAgX3RoaXMuemVybyA9IG5ldyBHZW5lcmljR0ZQb2x5XzEkMS5kZWZhdWx0KF90aGlzLCBJbnQzMkFycmF5LmZyb20oWzBdKSk7CgkgICAgICAgIF90aGlzLm9uZSA9IG5ldyBHZW5lcmljR0ZQb2x5XzEkMS5kZWZhdWx0KF90aGlzLCBJbnQzMkFycmF5LmZyb20oWzFdKSk7CgkgICAgICAgIHJldHVybiBfdGhpczsKCSAgICB9CgkgICAgR2VuZXJpY0dGLnByb3RvdHlwZS5nZXRaZXJvID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy56ZXJvOwoJICAgIH07CgkgICAgR2VuZXJpY0dGLnByb3RvdHlwZS5nZXRPbmUgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLm9uZTsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEByZXR1cm4gdGhlIG1vbm9taWFsIHJlcHJlc2VudGluZyBjb2VmZmljaWVudCAqIHheZGVncmVlCgkgICAgICovCgkgICAgR2VuZXJpY0dGLnByb3RvdHlwZS5idWlsZE1vbm9taWFsID0gZnVuY3Rpb24gKGRlZ3JlZSAvKmludCovLCBjb2VmZmljaWVudCAvKmludCovKSB7CgkgICAgICAgIGlmIChkZWdyZWUgPCAwKSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uXzEkMy5kZWZhdWx0KCk7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKGNvZWZmaWNpZW50ID09PSAwKSB7CgkgICAgICAgICAgICByZXR1cm4gdGhpcy56ZXJvOwoJICAgICAgICB9CgkgICAgICAgIHZhciBjb2VmZmljaWVudHMgPSBuZXcgSW50MzJBcnJheShkZWdyZWUgKyAxKTsKCSAgICAgICAgY29lZmZpY2llbnRzWzBdID0gY29lZmZpY2llbnQ7CgkgICAgICAgIHJldHVybiBuZXcgR2VuZXJpY0dGUG9seV8xJDEuZGVmYXVsdCh0aGlzLCBjb2VmZmljaWVudHMpOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQHJldHVybiBtdWx0aXBsaWNhdGl2ZSBpbnZlcnNlIG9mIGEKCSAgICAgKi8KCSAgICBHZW5lcmljR0YucHJvdG90eXBlLmludmVyc2UgPSBmdW5jdGlvbiAoYSAvKmludCovKSB7CgkgICAgICAgIGlmIChhID09PSAwKSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgQXJpdGhtZXRpY0V4Y2VwdGlvbl8xLmRlZmF1bHQoKTsKCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gdGhpcy5leHBUYWJsZVt0aGlzLnNpemUgLSB0aGlzLmxvZ1RhYmxlW2FdIC0gMV07CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcmV0dXJuIHByb2R1Y3Qgb2YgYSBhbmQgYiBpbiBHRihzaXplKQoJICAgICAqLwoJICAgIEdlbmVyaWNHRi5wcm90b3R5cGUubXVsdGlwbHkgPSBmdW5jdGlvbiAoYSAvKmludCovLCBiIC8qaW50Ki8pIHsKCSAgICAgICAgaWYgKGEgPT09IDAgfHwgYiA9PT0gMCkgewoJICAgICAgICAgICAgcmV0dXJuIDA7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIHRoaXMuZXhwVGFibGVbKHRoaXMubG9nVGFibGVbYV0gKyB0aGlzLmxvZ1RhYmxlW2JdKSAlICh0aGlzLnNpemUgLSAxKV07CgkgICAgfTsKCSAgICBHZW5lcmljR0YucHJvdG90eXBlLmdldFNpemUgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLnNpemU7CgkgICAgfTsKCSAgICBHZW5lcmljR0YucHJvdG90eXBlLmdldEdlbmVyYXRvckJhc2UgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLmdlbmVyYXRvckJhc2U7CgkgICAgfTsKCSAgICAvKkBPdmVycmlkZSovCgkgICAgR2VuZXJpY0dGLnByb3RvdHlwZS50b1N0cmluZyA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuICgnR0YoMHgnICsgSW50ZWdlcl8xJDEuZGVmYXVsdC50b0hleFN0cmluZyh0aGlzLnByaW1pdGl2ZSkgKyAnLCcgKyB0aGlzLnNpemUgKyAnKScpOwoJICAgIH07CgkgICAgR2VuZXJpY0dGLnByb3RvdHlwZS5lcXVhbHMgPSBmdW5jdGlvbiAobykgewoJICAgICAgICByZXR1cm4gbyA9PT0gdGhpczsKCSAgICB9OwoJICAgIEdlbmVyaWNHRi5BWlRFQ19EQVRBXzEyID0gbmV3IEdlbmVyaWNHRigweDEwNjksIDQwOTYsIDEpOyAvLyB4XjEyICsgeF42ICsgeF41ICsgeF4zICsgMQoJICAgIEdlbmVyaWNHRi5BWlRFQ19EQVRBXzEwID0gbmV3IEdlbmVyaWNHRigweDQwOSwgMTAyNCwgMSk7IC8vIHheMTAgKyB4XjMgKyAxCgkgICAgR2VuZXJpY0dGLkFaVEVDX0RBVEFfNiA9IG5ldyBHZW5lcmljR0YoMHg0MywgNjQsIDEpOyAvLyB4XjYgKyB4ICsgMQoJICAgIEdlbmVyaWNHRi5BWlRFQ19QQVJBTSA9IG5ldyBHZW5lcmljR0YoMHgxMywgMTYsIDEpOyAvLyB4XjQgKyB4ICsgMQoJICAgIEdlbmVyaWNHRi5RUl9DT0RFX0ZJRUxEXzI1NiA9IG5ldyBHZW5lcmljR0YoMHgwMTFkLCAyNTYsIDApOyAvLyB4XjggKyB4XjQgKyB4XjMgKyB4XjIgKyAxCgkgICAgR2VuZXJpY0dGLkRBVEFfTUFUUklYX0ZJRUxEXzI1NiA9IG5ldyBHZW5lcmljR0YoMHgwMTJkLCAyNTYsIDEpOyAvLyB4XjggKyB4XjUgKyB4XjMgKyB4XjIgKyAxCgkgICAgR2VuZXJpY0dGLkFaVEVDX0RBVEFfOCA9IEdlbmVyaWNHRi5EQVRBX01BVFJJWF9GSUVMRF8yNTY7CgkgICAgR2VuZXJpY0dGLk1BWElDT0RFX0ZJRUxEXzY0ID0gR2VuZXJpY0dGLkFaVEVDX0RBVEFfNjsKCSAgICByZXR1cm4gR2VuZXJpY0dGOwoJfShBYnN0cmFjdEdlbmVyaWNHRl8xLmRlZmF1bHQpKTsKCUdlbmVyaWNHRiQxLmRlZmF1bHQgPSBHZW5lcmljR0Y7CgoJdmFyIFJlZWRTb2xvbW9uRGVjb2RlciQxID0ge307CgoJdmFyIFJlZWRTb2xvbW9uRXhjZXB0aW9uJDEgPSB7fTsKCgl2YXIgX19leHRlbmRzJDUgPSAoY29tbW9uanNHbG9iYWwgJiYgY29tbW9uanNHbG9iYWwuX19leHRlbmRzKSB8fCAoZnVuY3Rpb24gKCkgewoJICAgIHZhciBleHRlbmRTdGF0aWNzID0gZnVuY3Rpb24gKGQsIGIpIHsKCSAgICAgICAgZXh0ZW5kU3RhdGljcyA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fAoJICAgICAgICAgICAgKHsgX19wcm90b19fOiBbXSB9IGluc3RhbmNlb2YgQXJyYXkgJiYgZnVuY3Rpb24gKGQsIGIpIHsgZC5fX3Byb3RvX18gPSBiOyB9KSB8fAoJICAgICAgICAgICAgZnVuY3Rpb24gKGQsIGIpIHsgZm9yICh2YXIgcCBpbiBiKSBpZiAoYi5oYXNPd25Qcm9wZXJ0eShwKSkgZFtwXSA9IGJbcF07IH07CgkgICAgICAgIHJldHVybiBleHRlbmRTdGF0aWNzKGQsIGIpOwoJICAgIH07CgkgICAgcmV0dXJuIGZ1bmN0aW9uIChkLCBiKSB7CgkgICAgICAgIGV4dGVuZFN0YXRpY3MoZCwgYik7CgkgICAgICAgIGZ1bmN0aW9uIF9fKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gZDsgfQoJICAgICAgICBkLnByb3RvdHlwZSA9IGIgPT09IG51bGwgPyBPYmplY3QuY3JlYXRlKGIpIDogKF9fLnByb3RvdHlwZSA9IGIucHJvdG90eXBlLCBuZXcgX18oKSk7CgkgICAgfTsKCX0pKCk7CglPYmplY3QuZGVmaW5lUHJvcGVydHkoUmVlZFNvbG9tb25FeGNlcHRpb24kMSwgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJdmFyIEV4Y2VwdGlvbl8xJDIgPSBFeGNlcHRpb24kMTsKCS8qKgoJICogQ3VzdG9tIEVycm9yIGNsYXNzIG9mIHR5cGUgRXhjZXB0aW9uLgoJICovCgl2YXIgUmVlZFNvbG9tb25FeGNlcHRpb24gPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7CgkgICAgX19leHRlbmRzJDUoUmVlZFNvbG9tb25FeGNlcHRpb24sIF9zdXBlcik7CgkgICAgZnVuY3Rpb24gUmVlZFNvbG9tb25FeGNlcHRpb24oKSB7CgkgICAgICAgIHJldHVybiBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpczsKCSAgICB9CgkgICAgUmVlZFNvbG9tb25FeGNlcHRpb24ua2luZCA9ICdSZWVkU29sb21vbkV4Y2VwdGlvbic7CgkgICAgcmV0dXJuIFJlZWRTb2xvbW9uRXhjZXB0aW9uOwoJfShFeGNlcHRpb25fMSQyLmRlZmF1bHQpKTsKCVJlZWRTb2xvbW9uRXhjZXB0aW9uJDEuZGVmYXVsdCA9IFJlZWRTb2xvbW9uRXhjZXB0aW9uOwoKCXZhciBJbGxlZ2FsU3RhdGVFeGNlcHRpb24kMSA9IHt9OwoKCXZhciBfX2V4dGVuZHMkNCA9IChjb21tb25qc0dsb2JhbCAmJiBjb21tb25qc0dsb2JhbC5fX2V4dGVuZHMpIHx8IChmdW5jdGlvbiAoKSB7CgkgICAgdmFyIGV4dGVuZFN0YXRpY3MgPSBmdW5jdGlvbiAoZCwgYikgewoJICAgICAgICBleHRlbmRTdGF0aWNzID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8CgkgICAgICAgICAgICAoeyBfX3Byb3RvX186IFtdIH0gaW5zdGFuY2VvZiBBcnJheSAmJiBmdW5jdGlvbiAoZCwgYikgeyBkLl9fcHJvdG9fXyA9IGI7IH0pIHx8CgkgICAgICAgICAgICBmdW5jdGlvbiAoZCwgYikgeyBmb3IgKHZhciBwIGluIGIpIGlmIChiLmhhc093blByb3BlcnR5KHApKSBkW3BdID0gYltwXTsgfTsKCSAgICAgICAgcmV0dXJuIGV4dGVuZFN0YXRpY3MoZCwgYik7CgkgICAgfTsKCSAgICByZXR1cm4gZnVuY3Rpb24gKGQsIGIpIHsKCSAgICAgICAgZXh0ZW5kU3RhdGljcyhkLCBiKTsKCSAgICAgICAgZnVuY3Rpb24gX18oKSB7IHRoaXMuY29uc3RydWN0b3IgPSBkOyB9CgkgICAgICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTsKCSAgICB9OwoJfSkoKTsKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShJbGxlZ2FsU3RhdGVFeGNlcHRpb24kMSwgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJdmFyIEV4Y2VwdGlvbl8xJDEgPSBFeGNlcHRpb24kMTsKCS8qKgoJICogQ3VzdG9tIEVycm9yIGNsYXNzIG9mIHR5cGUgRXhjZXB0aW9uLgoJICovCgl2YXIgSWxsZWdhbFN0YXRlRXhjZXB0aW9uID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikgewoJICAgIF9fZXh0ZW5kcyQ0KElsbGVnYWxTdGF0ZUV4Y2VwdGlvbiwgX3N1cGVyKTsKCSAgICBmdW5jdGlvbiBJbGxlZ2FsU3RhdGVFeGNlcHRpb24oKSB7CgkgICAgICAgIHJldHVybiBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpczsKCSAgICB9CgkgICAgSWxsZWdhbFN0YXRlRXhjZXB0aW9uLmtpbmQgPSAnSWxsZWdhbFN0YXRlRXhjZXB0aW9uJzsKCSAgICByZXR1cm4gSWxsZWdhbFN0YXRlRXhjZXB0aW9uOwoJfShFeGNlcHRpb25fMSQxLmRlZmF1bHQpKTsKCUlsbGVnYWxTdGF0ZUV4Y2VwdGlvbiQxLmRlZmF1bHQgPSBJbGxlZ2FsU3RhdGVFeGNlcHRpb247CgoJLyoKCSAqIENvcHlyaWdodCAyMDA3IFpYaW5nIGF1dGhvcnMKCSAqCgkgKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKCSAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4KCSAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdAoJICoKCSAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wCgkgKgoJICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZQoJICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gIkFTIElTIiBCQVNJUywKCSAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLgoJICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZAoJICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuCgkgKi8KCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShSZWVkU29sb21vbkRlY29kZXIkMSwgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJLypuYW1lc3BhY2UgY29tLmdvb2dsZS56eGluZy5jb21tb24ucmVlZHNvbG9tb24geyovCgl2YXIgR2VuZXJpY0dGXzEkMSA9IEdlbmVyaWNHRiQxOwoJdmFyIEdlbmVyaWNHRlBvbHlfMSA9IEdlbmVyaWNHRlBvbHkkMTsKCXZhciBSZWVkU29sb21vbkV4Y2VwdGlvbl8xID0gUmVlZFNvbG9tb25FeGNlcHRpb24kMTsKCXZhciBJbGxlZ2FsU3RhdGVFeGNlcHRpb25fMSA9IElsbGVnYWxTdGF0ZUV4Y2VwdGlvbiQxOwoJLyoqCgkgKiA8cD5JbXBsZW1lbnRzIFJlZWQtU29sb21vbiBkZWNvZGluZywgYXMgdGhlIG5hbWUgaW1wbGllcy48L3A+CgkgKgoJICogPHA+VGhlIGFsZ29yaXRobSB3aWxsIG5vdCBiZSBleHBsYWluZWQgaGVyZSwgYnV0IHRoZSBmb2xsb3dpbmcgcmVmZXJlbmNlcyB3ZXJlIGhlbHBmdWwKCSAqIGluIGNyZWF0aW5nIHRoaXMgaW1wbGVtZW50YXRpb246PC9wPgoJICoKCSAqIDx1bD4KCSAqIDxsaT5CcnVjZSBNYWdncy4KCSAqIDxhIGhyZWY9Imh0dHA6Ly93d3cuY3MuY211LmVkdS9hZnMvY3MuY211LmVkdS9wcm9qZWN0L3BzY2ljby1ndXliL3JlYWx3b3JsZC93d3cvcnNfZGVjb2RlLnBzIj4KCSAqICJEZWNvZGluZyBSZWVkLVNvbG9tb24gQ29kZXMiPC9hPiAoc2VlIGRpc2N1c3Npb24gb2YgRm9ybmV5J3MgRm9ybXVsYSk8L2xpPgoJICogPGxpPkouSS4gSGFsbC4gPGEgaHJlZj0id3d3Lm10aC5tc3UuZWR1L35qaGFsbC9jbGFzc2VzL2NvZGVub3Rlcy9HUlMucGRmIj4KCSAqICJDaGFwdGVyIDUuIEdlbmVyYWxpemVkIFJlZWQtU29sb21vbiBDb2RlcyI8L2E+CgkgKiAoc2VlIGRpc2N1c3Npb24gb2YgRXVjbGlkZWFuIGFsZ29yaXRobSk8L2xpPgoJICogPC91bD4KCSAqCgkgKiA8cD5NdWNoIGNyZWRpdCBpcyBkdWUgdG8gV2lsbGlhbSBSdWNrbGlkZ2Ugc2luY2UgcG9ydGlvbnMgb2YgdGhpcyBjb2RlIGFyZSBhbiBpbmRpcmVjdAoJICogcG9ydCBvZiBoaXMgQysrIFJlZWQtU29sb21vbiBpbXBsZW1lbnRhdGlvbi48L3A+CgkgKgoJICogQGF1dGhvciBTZWFuIE93ZW4KCSAqIEBhdXRob3IgV2lsbGlhbSBSdWNrbGlkZ2UKCSAqIEBhdXRob3Igc2FuZm9yZHNxdWlyZXMKCSAqLwoJdmFyIFJlZWRTb2xvbW9uRGVjb2RlciA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHsKCSAgICBmdW5jdGlvbiBSZWVkU29sb21vbkRlY29kZXIoZmllbGQpIHsKCSAgICAgICAgdGhpcy5maWVsZCA9IGZpZWxkOwoJICAgIH0KCSAgICAvKioKCSAgICAgKiA8cD5EZWNvZGVzIGdpdmVuIHNldCBvZiByZWNlaXZlZCBjb2Rld29yZHMsIHdoaWNoIGluY2x1ZGUgYm90aCBkYXRhIGFuZCBlcnJvci1jb3JyZWN0aW9uCgkgICAgICogY29kZXdvcmRzLiBSZWFsbHksIHRoaXMgbWVhbnMgaXQgdXNlcyBSZWVkLVNvbG9tb24gdG8gZGV0ZWN0IGFuZCBjb3JyZWN0IGVycm9ycywgaW4tcGxhY2UsCgkgICAgICogaW4gdGhlIGlucHV0LjwvcD4KCSAgICAgKgoJICAgICAqIEBwYXJhbSByZWNlaXZlZCBkYXRhIGFuZCBlcnJvci1jb3JyZWN0aW9uIGNvZGV3b3JkcwoJICAgICAqIEBwYXJhbSB0d29TIG51bWJlciBvZiBlcnJvci1jb3JyZWN0aW9uIGNvZGV3b3JkcyBhdmFpbGFibGUKCSAgICAgKiBAdGhyb3dzIFJlZWRTb2xvbW9uRXhjZXB0aW9uIGlmIGRlY29kaW5nIGZhaWxzIGZvciBhbnkgcmVhc29uCgkgICAgICovCgkgICAgUmVlZFNvbG9tb25EZWNvZGVyLnByb3RvdHlwZS5kZWNvZGUgPSBmdW5jdGlvbiAocmVjZWl2ZWQsIHR3b1MgLyppbnQqLykgewoJICAgICAgICB2YXIgZmllbGQgPSB0aGlzLmZpZWxkOwoJICAgICAgICB2YXIgcG9seSA9IG5ldyBHZW5lcmljR0ZQb2x5XzEuZGVmYXVsdChmaWVsZCwgcmVjZWl2ZWQpOwoJICAgICAgICB2YXIgc3luZHJvbWVDb2VmZmljaWVudHMgPSBuZXcgSW50MzJBcnJheSh0d29TKTsKCSAgICAgICAgdmFyIG5vRXJyb3IgPSB0cnVlOwoJICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHR3b1M7IGkrKykgewoJICAgICAgICAgICAgdmFyIGV2YWxSZXN1bHQgPSBwb2x5LmV2YWx1YXRlQXQoZmllbGQuZXhwKGkgKyBmaWVsZC5nZXRHZW5lcmF0b3JCYXNlKCkpKTsKCSAgICAgICAgICAgIHN5bmRyb21lQ29lZmZpY2llbnRzW3N5bmRyb21lQ29lZmZpY2llbnRzLmxlbmd0aCAtIDEgLSBpXSA9IGV2YWxSZXN1bHQ7CgkgICAgICAgICAgICBpZiAoZXZhbFJlc3VsdCAhPT0gMCkgewoJICAgICAgICAgICAgICAgIG5vRXJyb3IgPSBmYWxzZTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgfQoJICAgICAgICBpZiAobm9FcnJvcikgewoJICAgICAgICAgICAgcmV0dXJuOwoJICAgICAgICB9CgkgICAgICAgIHZhciBzeW5kcm9tZSA9IG5ldyBHZW5lcmljR0ZQb2x5XzEuZGVmYXVsdChmaWVsZCwgc3luZHJvbWVDb2VmZmljaWVudHMpOwoJICAgICAgICB2YXIgc2lnbWFPbWVnYSA9IHRoaXMucnVuRXVjbGlkZWFuQWxnb3JpdGhtKGZpZWxkLmJ1aWxkTW9ub21pYWwodHdvUywgMSksIHN5bmRyb21lLCB0d29TKTsKCSAgICAgICAgdmFyIHNpZ21hID0gc2lnbWFPbWVnYVswXTsKCSAgICAgICAgdmFyIG9tZWdhID0gc2lnbWFPbWVnYVsxXTsKCSAgICAgICAgdmFyIGVycm9yTG9jYXRpb25zID0gdGhpcy5maW5kRXJyb3JMb2NhdGlvbnMoc2lnbWEpOwoJICAgICAgICB2YXIgZXJyb3JNYWduaXR1ZGVzID0gdGhpcy5maW5kRXJyb3JNYWduaXR1ZGVzKG9tZWdhLCBlcnJvckxvY2F0aW9ucyk7CgkgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgZXJyb3JMb2NhdGlvbnMubGVuZ3RoOyBpKyspIHsKCSAgICAgICAgICAgIHZhciBwb3NpdGlvbiA9IHJlY2VpdmVkLmxlbmd0aCAtIDEgLSBmaWVsZC5sb2coZXJyb3JMb2NhdGlvbnNbaV0pOwoJICAgICAgICAgICAgaWYgKHBvc2l0aW9uIDwgMCkgewoJICAgICAgICAgICAgICAgIHRocm93IG5ldyBSZWVkU29sb21vbkV4Y2VwdGlvbl8xLmRlZmF1bHQoJ0JhZCBlcnJvciBsb2NhdGlvbicpOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgcmVjZWl2ZWRbcG9zaXRpb25dID0gR2VuZXJpY0dGXzEkMS5kZWZhdWx0LmFkZE9yU3VidHJhY3QocmVjZWl2ZWRbcG9zaXRpb25dLCBlcnJvck1hZ25pdHVkZXNbaV0pOwoJICAgICAgICB9CgkgICAgfTsKCSAgICBSZWVkU29sb21vbkRlY29kZXIucHJvdG90eXBlLnJ1bkV1Y2xpZGVhbkFsZ29yaXRobSA9IGZ1bmN0aW9uIChhLCBiLCBSIC8qaW50Ki8pIHsKCSAgICAgICAgLy8gQXNzdW1lIGEncyBkZWdyZWUgaXMgPj0gYidzCgkgICAgICAgIGlmIChhLmdldERlZ3JlZSgpIDwgYi5nZXREZWdyZWUoKSkgewoJICAgICAgICAgICAgdmFyIHRlbXAgPSBhOwoJICAgICAgICAgICAgYSA9IGI7CgkgICAgICAgICAgICBiID0gdGVtcDsKCSAgICAgICAgfQoJICAgICAgICB2YXIgZmllbGQgPSB0aGlzLmZpZWxkOwoJICAgICAgICB2YXIgckxhc3QgPSBhOwoJICAgICAgICB2YXIgciA9IGI7CgkgICAgICAgIHZhciB0TGFzdCA9IGZpZWxkLmdldFplcm8oKTsKCSAgICAgICAgdmFyIHQgPSBmaWVsZC5nZXRPbmUoKTsKCSAgICAgICAgLy8gUnVuIEV1Y2xpZGVhbiBhbGdvcml0aG0gdW50aWwgcidzIGRlZ3JlZSBpcyBsZXNzIHRoYW4gUi8yCgkgICAgICAgIHdoaWxlIChyLmdldERlZ3JlZSgpID49IChSIC8gMiB8IDApKSB7CgkgICAgICAgICAgICB2YXIgckxhc3RMYXN0ID0gckxhc3Q7CgkgICAgICAgICAgICB2YXIgdExhc3RMYXN0ID0gdExhc3Q7CgkgICAgICAgICAgICByTGFzdCA9IHI7CgkgICAgICAgICAgICB0TGFzdCA9IHQ7CgkgICAgICAgICAgICAvLyBEaXZpZGUgckxhc3RMYXN0IGJ5IHJMYXN0LCB3aXRoIHF1b3RpZW50IGluIHEgYW5kIHJlbWFpbmRlciBpbiByCgkgICAgICAgICAgICBpZiAockxhc3QuaXNaZXJvKCkpIHsKCSAgICAgICAgICAgICAgICAvLyBPb3BzLCBFdWNsaWRlYW4gYWxnb3JpdGhtIGFscmVhZHkgdGVybWluYXRlZD8KCSAgICAgICAgICAgICAgICB0aHJvdyBuZXcgUmVlZFNvbG9tb25FeGNlcHRpb25fMS5kZWZhdWx0KCdyX3tpLTF9IHdhcyB6ZXJvJyk7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICByID0gckxhc3RMYXN0OwoJICAgICAgICAgICAgdmFyIHEgPSBmaWVsZC5nZXRaZXJvKCk7CgkgICAgICAgICAgICB2YXIgZGVub21pbmF0b3JMZWFkaW5nVGVybSA9IHJMYXN0LmdldENvZWZmaWNpZW50KHJMYXN0LmdldERlZ3JlZSgpKTsKCSAgICAgICAgICAgIHZhciBkbHRJbnZlcnNlID0gZmllbGQuaW52ZXJzZShkZW5vbWluYXRvckxlYWRpbmdUZXJtKTsKCSAgICAgICAgICAgIHdoaWxlIChyLmdldERlZ3JlZSgpID49IHJMYXN0LmdldERlZ3JlZSgpICYmICFyLmlzWmVybygpKSB7CgkgICAgICAgICAgICAgICAgdmFyIGRlZ3JlZURpZmYgPSByLmdldERlZ3JlZSgpIC0gckxhc3QuZ2V0RGVncmVlKCk7CgkgICAgICAgICAgICAgICAgdmFyIHNjYWxlID0gZmllbGQubXVsdGlwbHkoci5nZXRDb2VmZmljaWVudChyLmdldERlZ3JlZSgpKSwgZGx0SW52ZXJzZSk7CgkgICAgICAgICAgICAgICAgcSA9IHEuYWRkT3JTdWJ0cmFjdChmaWVsZC5idWlsZE1vbm9taWFsKGRlZ3JlZURpZmYsIHNjYWxlKSk7CgkgICAgICAgICAgICAgICAgciA9IHIuYWRkT3JTdWJ0cmFjdChyTGFzdC5tdWx0aXBseUJ5TW9ub21pYWwoZGVncmVlRGlmZiwgc2NhbGUpKTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIHQgPSBxLm11bHRpcGx5KHRMYXN0KS5hZGRPclN1YnRyYWN0KHRMYXN0TGFzdCk7CgkgICAgICAgICAgICBpZiAoci5nZXREZWdyZWUoKSA+PSByTGFzdC5nZXREZWdyZWUoKSkgewoJICAgICAgICAgICAgICAgIHRocm93IG5ldyBJbGxlZ2FsU3RhdGVFeGNlcHRpb25fMS5kZWZhdWx0KCdEaXZpc2lvbiBhbGdvcml0aG0gZmFpbGVkIHRvIHJlZHVjZSBwb2x5bm9taWFsPycpOwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIHZhciBzaWdtYVRpbGRlQXRaZXJvID0gdC5nZXRDb2VmZmljaWVudCgwKTsKCSAgICAgICAgaWYgKHNpZ21hVGlsZGVBdFplcm8gPT09IDApIHsKCSAgICAgICAgICAgIHRocm93IG5ldyBSZWVkU29sb21vbkV4Y2VwdGlvbl8xLmRlZmF1bHQoJ3NpZ21hVGlsZGUoMCkgd2FzIHplcm8nKTsKCSAgICAgICAgfQoJICAgICAgICB2YXIgaW52ZXJzZSA9IGZpZWxkLmludmVyc2Uoc2lnbWFUaWxkZUF0WmVybyk7CgkgICAgICAgIHZhciBzaWdtYSA9IHQubXVsdGlwbHlTY2FsYXIoaW52ZXJzZSk7CgkgICAgICAgIHZhciBvbWVnYSA9IHIubXVsdGlwbHlTY2FsYXIoaW52ZXJzZSk7CgkgICAgICAgIHJldHVybiBbc2lnbWEsIG9tZWdhXTsKCSAgICB9OwoJICAgIFJlZWRTb2xvbW9uRGVjb2Rlci5wcm90b3R5cGUuZmluZEVycm9yTG9jYXRpb25zID0gZnVuY3Rpb24gKGVycm9yTG9jYXRvcikgewoJICAgICAgICAvLyBUaGlzIGlzIGEgZGlyZWN0IGFwcGxpY2F0aW9uIG9mIENoaWVuJ3Mgc2VhcmNoCgkgICAgICAgIHZhciBudW1FcnJvcnMgPSBlcnJvckxvY2F0b3IuZ2V0RGVncmVlKCk7CgkgICAgICAgIGlmIChudW1FcnJvcnMgPT09IDEpIHsgLy8gc2hvcnRjdXQKCSAgICAgICAgICAgIHJldHVybiBJbnQzMkFycmF5LmZyb20oW2Vycm9yTG9jYXRvci5nZXRDb2VmZmljaWVudCgxKV0pOwoJICAgICAgICB9CgkgICAgICAgIHZhciByZXN1bHQgPSBuZXcgSW50MzJBcnJheShudW1FcnJvcnMpOwoJICAgICAgICB2YXIgZSA9IDA7CgkgICAgICAgIHZhciBmaWVsZCA9IHRoaXMuZmllbGQ7CgkgICAgICAgIGZvciAodmFyIGkgPSAxOyBpIDwgZmllbGQuZ2V0U2l6ZSgpICYmIGUgPCBudW1FcnJvcnM7IGkrKykgewoJICAgICAgICAgICAgaWYgKGVycm9yTG9jYXRvci5ldmFsdWF0ZUF0KGkpID09PSAwKSB7CgkgICAgICAgICAgICAgICAgcmVzdWx0W2VdID0gZmllbGQuaW52ZXJzZShpKTsKCSAgICAgICAgICAgICAgICBlKys7CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICAgICAgaWYgKGUgIT09IG51bUVycm9ycykgewoJICAgICAgICAgICAgdGhyb3cgbmV3IFJlZWRTb2xvbW9uRXhjZXB0aW9uXzEuZGVmYXVsdCgnRXJyb3IgbG9jYXRvciBkZWdyZWUgZG9lcyBub3QgbWF0Y2ggbnVtYmVyIG9mIHJvb3RzJyk7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIHJlc3VsdDsKCSAgICB9OwoJICAgIFJlZWRTb2xvbW9uRGVjb2Rlci5wcm90b3R5cGUuZmluZEVycm9yTWFnbml0dWRlcyA9IGZ1bmN0aW9uIChlcnJvckV2YWx1YXRvciwgZXJyb3JMb2NhdGlvbnMpIHsKCSAgICAgICAgLy8gVGhpcyBpcyBkaXJlY3RseSBhcHBseWluZyBGb3JuZXkncyBGb3JtdWxhCgkgICAgICAgIHZhciBzID0gZXJyb3JMb2NhdGlvbnMubGVuZ3RoOwoJICAgICAgICB2YXIgcmVzdWx0ID0gbmV3IEludDMyQXJyYXkocyk7CgkgICAgICAgIHZhciBmaWVsZCA9IHRoaXMuZmllbGQ7CgkgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgczsgaSsrKSB7CgkgICAgICAgICAgICB2YXIgeGlJbnZlcnNlID0gZmllbGQuaW52ZXJzZShlcnJvckxvY2F0aW9uc1tpXSk7CgkgICAgICAgICAgICB2YXIgZGVub21pbmF0b3IgPSAxOwoJICAgICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCBzOyBqKyspIHsKCSAgICAgICAgICAgICAgICBpZiAoaSAhPT0gaikgewoJICAgICAgICAgICAgICAgICAgICAvLyBkZW5vbWluYXRvciA9IGZpZWxkLm11bHRpcGx5KGRlbm9taW5hdG9yLAoJICAgICAgICAgICAgICAgICAgICAvLyAgICBHZW5lcmljR0YuYWRkT3JTdWJ0cmFjdCgxLCBmaWVsZC5tdWx0aXBseShlcnJvckxvY2F0aW9uc1tqXSwgeGlJbnZlcnNlKSkpCgkgICAgICAgICAgICAgICAgICAgIC8vIEFib3ZlIHNob3VsZCB3b3JrIGJ1dCBmYWlscyBvbiBzb21lIEFwcGxlIGFuZCBMaW51eCBKREtzIGR1ZSB0byBhIEhvdHNwb3QgYnVnLgoJICAgICAgICAgICAgICAgICAgICAvLyBCZWxvdyBpcyBhIGZ1bm55LWxvb2tpbmcgd29ya2Fyb3VuZCBmcm9tIFN0ZXZlbiBQYXJrZXMKCSAgICAgICAgICAgICAgICAgICAgdmFyIHRlcm0gPSBmaWVsZC5tdWx0aXBseShlcnJvckxvY2F0aW9uc1tqXSwgeGlJbnZlcnNlKTsKCSAgICAgICAgICAgICAgICAgICAgdmFyIHRlcm1QbHVzMSA9ICh0ZXJtICYgMHgxKSA9PT0gMCA/IHRlcm0gfCAxIDogdGVybSAmIH4xOwoJICAgICAgICAgICAgICAgICAgICBkZW5vbWluYXRvciA9IGZpZWxkLm11bHRpcGx5KGRlbm9taW5hdG9yLCB0ZXJtUGx1czEpOwoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIHJlc3VsdFtpXSA9IGZpZWxkLm11bHRpcGx5KGVycm9yRXZhbHVhdG9yLmV2YWx1YXRlQXQoeGlJbnZlcnNlKSwgZmllbGQuaW52ZXJzZShkZW5vbWluYXRvcikpOwoJICAgICAgICAgICAgaWYgKGZpZWxkLmdldEdlbmVyYXRvckJhc2UoKSAhPT0gMCkgewoJICAgICAgICAgICAgICAgIHJlc3VsdFtpXSA9IGZpZWxkLm11bHRpcGx5KHJlc3VsdFtpXSwgeGlJbnZlcnNlKTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gcmVzdWx0OwoJICAgIH07CgkgICAgcmV0dXJuIFJlZWRTb2xvbW9uRGVjb2RlcjsKCX0oKSk7CglSZWVkU29sb21vbkRlY29kZXIkMS5kZWZhdWx0ID0gUmVlZFNvbG9tb25EZWNvZGVyOwoKCXZhciBCaXRNYXRyaXhQYXJzZXIkMSA9IHt9OwoKCXZhciBWZXJzaW9uJDEgPSB7fTsKCgl2YXIgRm9ybWF0SW5mb3JtYXRpb24kMSA9IHt9OwoKCXZhciBFcnJvckNvcnJlY3Rpb25MZXZlbCA9IHt9OwoKCXZhciBBcmd1bWVudEV4Y2VwdGlvbiQxID0ge307CgoJdmFyIF9fZXh0ZW5kcyQzID0gKGNvbW1vbmpzR2xvYmFsICYmIGNvbW1vbmpzR2xvYmFsLl9fZXh0ZW5kcykgfHwgKGZ1bmN0aW9uICgpIHsKCSAgICB2YXIgZXh0ZW5kU3RhdGljcyA9IGZ1bmN0aW9uIChkLCBiKSB7CgkgICAgICAgIGV4dGVuZFN0YXRpY3MgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgfHwKCSAgICAgICAgICAgICh7IF9fcHJvdG9fXzogW10gfSBpbnN0YW5jZW9mIEFycmF5ICYmIGZ1bmN0aW9uIChkLCBiKSB7IGQuX19wcm90b19fID0gYjsgfSkgfHwKCSAgICAgICAgICAgIGZ1bmN0aW9uIChkLCBiKSB7IGZvciAodmFyIHAgaW4gYikgaWYgKGIuaGFzT3duUHJvcGVydHkocCkpIGRbcF0gPSBiW3BdOyB9OwoJICAgICAgICByZXR1cm4gZXh0ZW5kU3RhdGljcyhkLCBiKTsKCSAgICB9OwoJICAgIHJldHVybiBmdW5jdGlvbiAoZCwgYikgewoJICAgICAgICBleHRlbmRTdGF0aWNzKGQsIGIpOwoJICAgICAgICBmdW5jdGlvbiBfXygpIHsgdGhpcy5jb25zdHJ1Y3RvciA9IGQ7IH0KCSAgICAgICAgZC5wcm90b3R5cGUgPSBiID09PSBudWxsID8gT2JqZWN0LmNyZWF0ZShiKSA6IChfXy5wcm90b3R5cGUgPSBiLnByb3RvdHlwZSwgbmV3IF9fKCkpOwoJICAgIH07Cgl9KSgpOwoJT2JqZWN0LmRlZmluZVByb3BlcnR5KEFyZ3VtZW50RXhjZXB0aW9uJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCXZhciBFeGNlcHRpb25fMSA9IEV4Y2VwdGlvbiQxOwoJLyoqCgkgKiBDdXN0b20gRXJyb3IgY2xhc3Mgb2YgdHlwZSBFeGNlcHRpb24uCgkgKi8KCXZhciBBcmd1bWVudEV4Y2VwdGlvbiA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHsKCSAgICBfX2V4dGVuZHMkMyhBcmd1bWVudEV4Y2VwdGlvbiwgX3N1cGVyKTsKCSAgICBmdW5jdGlvbiBBcmd1bWVudEV4Y2VwdGlvbigpIHsKCSAgICAgICAgcmV0dXJuIF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzOwoJICAgIH0KCSAgICBBcmd1bWVudEV4Y2VwdGlvbi5raW5kID0gJ0FyZ3VtZW50RXhjZXB0aW9uJzsKCSAgICByZXR1cm4gQXJndW1lbnRFeGNlcHRpb247Cgl9KEV4Y2VwdGlvbl8xLmRlZmF1bHQpKTsKCUFyZ3VtZW50RXhjZXB0aW9uJDEuZGVmYXVsdCA9IEFyZ3VtZW50RXhjZXB0aW9uOwoKCShmdW5jdGlvbiAoZXhwb3J0cykgewoJLyoKCSAqIENvcHlyaWdodCAyMDA3IFpYaW5nIGF1dGhvcnMKCSAqCgkgKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKCSAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4KCSAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdAoJICoKCSAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wCgkgKgoJICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZQoJICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gIkFTIElTIiBCQVNJUywKCSAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLgoJICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZAoJICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuCgkgKi8KCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7CglleHBvcnRzLkVycm9yQ29ycmVjdGlvbkxldmVsVmFsdWVzID0gdm9pZCAwOwoJLypuYW1lc3BhY2UgY29tLmdvb2dsZS56eGluZy5xcmNvZGUuZGVjb2RlciB7Ki8KCXZhciBBcmd1bWVudEV4Y2VwdGlvbl8xID0gQXJndW1lbnRFeGNlcHRpb24kMTsKCXZhciBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb25fMSA9IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbiQxOwoJdmFyIEVycm9yQ29ycmVjdGlvbkxldmVsVmFsdWVzOwoJKGZ1bmN0aW9uIChFcnJvckNvcnJlY3Rpb25MZXZlbFZhbHVlcykgewoJICAgIEVycm9yQ29ycmVjdGlvbkxldmVsVmFsdWVzW0Vycm9yQ29ycmVjdGlvbkxldmVsVmFsdWVzWyJMIl0gPSAwXSA9ICJMIjsKCSAgICBFcnJvckNvcnJlY3Rpb25MZXZlbFZhbHVlc1tFcnJvckNvcnJlY3Rpb25MZXZlbFZhbHVlc1siTSJdID0gMV0gPSAiTSI7CgkgICAgRXJyb3JDb3JyZWN0aW9uTGV2ZWxWYWx1ZXNbRXJyb3JDb3JyZWN0aW9uTGV2ZWxWYWx1ZXNbIlEiXSA9IDJdID0gIlEiOwoJICAgIEVycm9yQ29ycmVjdGlvbkxldmVsVmFsdWVzW0Vycm9yQ29ycmVjdGlvbkxldmVsVmFsdWVzWyJIIl0gPSAzXSA9ICJIIjsKCX0pKEVycm9yQ29ycmVjdGlvbkxldmVsVmFsdWVzID0gZXhwb3J0cy5FcnJvckNvcnJlY3Rpb25MZXZlbFZhbHVlcyB8fCAoZXhwb3J0cy5FcnJvckNvcnJlY3Rpb25MZXZlbFZhbHVlcyA9IHt9KSk7CgkvKioKCSAqIDxwPlNlZSBJU08gMTgwMDQ6MjAwNiwgNi41LjEuIFRoaXMgZW51bSBlbmNhcHN1bGF0ZXMgdGhlIGZvdXIgZXJyb3IgY29ycmVjdGlvbiBsZXZlbHMKCSAqIGRlZmluZWQgYnkgdGhlIFFSIGNvZGUgc3RhbmRhcmQuPC9wPgoJICoKCSAqIEBhdXRob3IgU2VhbiBPd2VuCgkgKi8KCXZhciBFcnJvckNvcnJlY3Rpb25MZXZlbCA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHsKCSAgICBmdW5jdGlvbiBFcnJvckNvcnJlY3Rpb25MZXZlbCh2YWx1ZSwgc3RyaW5nVmFsdWUsIGJpdHMgLyppbnQqLykgewoJICAgICAgICB0aGlzLnZhbHVlID0gdmFsdWU7CgkgICAgICAgIHRoaXMuc3RyaW5nVmFsdWUgPSBzdHJpbmdWYWx1ZTsKCSAgICAgICAgdGhpcy5iaXRzID0gYml0czsKCSAgICAgICAgRXJyb3JDb3JyZWN0aW9uTGV2ZWwuRk9SX0JJVFMuc2V0KGJpdHMsIHRoaXMpOwoJICAgICAgICBFcnJvckNvcnJlY3Rpb25MZXZlbC5GT1JfVkFMVUUuc2V0KHZhbHVlLCB0aGlzKTsKCSAgICB9CgkgICAgRXJyb3JDb3JyZWN0aW9uTGV2ZWwucHJvdG90eXBlLmdldFZhbHVlID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy52YWx1ZTsKCSAgICB9OwoJICAgIEVycm9yQ29ycmVjdGlvbkxldmVsLnByb3RvdHlwZS5nZXRCaXRzID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5iaXRzOwoJICAgIH07CgkgICAgRXJyb3JDb3JyZWN0aW9uTGV2ZWwuZnJvbVN0cmluZyA9IGZ1bmN0aW9uIChzKSB7CgkgICAgICAgIHN3aXRjaCAocykgewoJICAgICAgICAgICAgY2FzZSAnTCc6IHJldHVybiBFcnJvckNvcnJlY3Rpb25MZXZlbC5MOwoJICAgICAgICAgICAgY2FzZSAnTSc6IHJldHVybiBFcnJvckNvcnJlY3Rpb25MZXZlbC5NOwoJICAgICAgICAgICAgY2FzZSAnUSc6IHJldHVybiBFcnJvckNvcnJlY3Rpb25MZXZlbC5ROwoJICAgICAgICAgICAgY2FzZSAnSCc6IHJldHVybiBFcnJvckNvcnJlY3Rpb25MZXZlbC5IOwoJICAgICAgICAgICAgZGVmYXVsdDogdGhyb3cgbmV3IEFyZ3VtZW50RXhjZXB0aW9uXzEuZGVmYXVsdChzICsgJ25vdCBhdmFpbGFibGUnKTsKCSAgICAgICAgfQoJICAgIH07CgkgICAgRXJyb3JDb3JyZWN0aW9uTGV2ZWwucHJvdG90eXBlLnRvU3RyaW5nID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5zdHJpbmdWYWx1ZTsKCSAgICB9OwoJICAgIEVycm9yQ29ycmVjdGlvbkxldmVsLnByb3RvdHlwZS5lcXVhbHMgPSBmdW5jdGlvbiAobykgewoJICAgICAgICBpZiAoIShvIGluc3RhbmNlb2YgRXJyb3JDb3JyZWN0aW9uTGV2ZWwpKSB7CgkgICAgICAgICAgICByZXR1cm4gZmFsc2U7CgkgICAgICAgIH0KCSAgICAgICAgdmFyIG90aGVyID0gbzsKCSAgICAgICAgcmV0dXJuIHRoaXMudmFsdWUgPT09IG90aGVyLnZhbHVlOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQHBhcmFtIGJpdHMgaW50IGNvbnRhaW5pbmcgdGhlIHR3byBiaXRzIGVuY29kaW5nIGEgUVIgQ29kZSdzIGVycm9yIGNvcnJlY3Rpb24gbGV2ZWwKCSAgICAgKiBAcmV0dXJuIEVycm9yQ29ycmVjdGlvbkxldmVsIHJlcHJlc2VudGluZyB0aGUgZW5jb2RlZCBlcnJvciBjb3JyZWN0aW9uIGxldmVsCgkgICAgICovCgkgICAgRXJyb3JDb3JyZWN0aW9uTGV2ZWwuZm9yQml0cyA9IGZ1bmN0aW9uIChiaXRzIC8qaW50Ki8pIHsKCSAgICAgICAgaWYgKGJpdHMgPCAwIHx8IGJpdHMgPj0gRXJyb3JDb3JyZWN0aW9uTGV2ZWwuRk9SX0JJVFMuc2l6ZSkgewoJICAgICAgICAgICAgdGhyb3cgbmV3IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbl8xLmRlZmF1bHQoKTsKCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gRXJyb3JDb3JyZWN0aW9uTGV2ZWwuRk9SX0JJVFMuZ2V0KGJpdHMpOwoJICAgIH07CgkgICAgRXJyb3JDb3JyZWN0aW9uTGV2ZWwuRk9SX0JJVFMgPSBuZXcgTWFwKCk7CgkgICAgRXJyb3JDb3JyZWN0aW9uTGV2ZWwuRk9SX1ZBTFVFID0gbmV3IE1hcCgpOwoJICAgIC8qKiBMID0gfjclIGNvcnJlY3Rpb24gKi8KCSAgICBFcnJvckNvcnJlY3Rpb25MZXZlbC5MID0gbmV3IEVycm9yQ29ycmVjdGlvbkxldmVsKEVycm9yQ29ycmVjdGlvbkxldmVsVmFsdWVzLkwsICdMJywgMHgwMSk7CgkgICAgLyoqIE0gPSB+MTUlIGNvcnJlY3Rpb24gKi8KCSAgICBFcnJvckNvcnJlY3Rpb25MZXZlbC5NID0gbmV3IEVycm9yQ29ycmVjdGlvbkxldmVsKEVycm9yQ29ycmVjdGlvbkxldmVsVmFsdWVzLk0sICdNJywgMHgwMCk7CgkgICAgLyoqIFEgPSB+MjUlIGNvcnJlY3Rpb24gKi8KCSAgICBFcnJvckNvcnJlY3Rpb25MZXZlbC5RID0gbmV3IEVycm9yQ29ycmVjdGlvbkxldmVsKEVycm9yQ29ycmVjdGlvbkxldmVsVmFsdWVzLlEsICdRJywgMHgwMyk7CgkgICAgLyoqIEggPSB+MzAlIGNvcnJlY3Rpb24gKi8KCSAgICBFcnJvckNvcnJlY3Rpb25MZXZlbC5IID0gbmV3IEVycm9yQ29ycmVjdGlvbkxldmVsKEVycm9yQ29ycmVjdGlvbkxldmVsVmFsdWVzLkgsICdIJywgMHgwMik7CgkgICAgcmV0dXJuIEVycm9yQ29ycmVjdGlvbkxldmVsOwoJfSgpKTsKCWV4cG9ydHMuZGVmYXVsdCA9IEVycm9yQ29ycmVjdGlvbkxldmVsOwoKCX0oRXJyb3JDb3JyZWN0aW9uTGV2ZWwpKTsKCgkvKgoJICogQ29weXJpZ2h0IDIwMDcgWlhpbmcgYXV0aG9ycwoJICoKCSAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoJICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoJICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkgKgoJICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKCSAqCgkgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCgkgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoJICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCgkgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCSAqLwoJdmFyIF9fdmFsdWVzJDYgPSAoY29tbW9uanNHbG9iYWwgJiYgY29tbW9uanNHbG9iYWwuX192YWx1ZXMpIHx8IGZ1bmN0aW9uKG8pIHsKCSAgICB2YXIgcyA9IHR5cGVvZiBTeW1ib2wgPT09ICJmdW5jdGlvbiIgJiYgU3ltYm9sLml0ZXJhdG9yLCBtID0gcyAmJiBvW3NdLCBpID0gMDsKCSAgICBpZiAobSkgcmV0dXJuIG0uY2FsbChvKTsKCSAgICBpZiAobyAmJiB0eXBlb2Ygby5sZW5ndGggPT09ICJudW1iZXIiKSByZXR1cm4gewoJICAgICAgICBuZXh0OiBmdW5jdGlvbiAoKSB7CgkgICAgICAgICAgICBpZiAobyAmJiBpID49IG8ubGVuZ3RoKSBvID0gdm9pZCAwOwoJICAgICAgICAgICAgcmV0dXJuIHsgdmFsdWU6IG8gJiYgb1tpKytdLCBkb25lOiAhbyB9OwoJICAgICAgICB9CgkgICAgfTsKCSAgICB0aHJvdyBuZXcgVHlwZUVycm9yKHMgPyAiT2JqZWN0IGlzIG5vdCBpdGVyYWJsZS4iIDogIlN5bWJvbC5pdGVyYXRvciBpcyBub3QgZGVmaW5lZC4iKTsKCX07CglPYmplY3QuZGVmaW5lUHJvcGVydHkoRm9ybWF0SW5mb3JtYXRpb24kMSwgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJLypuYW1lc3BhY2UgY29tLmdvb2dsZS56eGluZy5xcmNvZGUuZGVjb2RlciB7Ki8KCXZhciBFcnJvckNvcnJlY3Rpb25MZXZlbF8xID0gRXJyb3JDb3JyZWN0aW9uTGV2ZWw7Cgl2YXIgSW50ZWdlcl8xID0gSW50ZWdlciQxOwoJLyoqCgkgKiA8cD5FbmNhcHN1bGF0ZXMgYSBRUiBDb2RlJ3MgZm9ybWF0IGluZm9ybWF0aW9uLCBpbmNsdWRpbmcgdGhlIGRhdGEgbWFzayB1c2VkIGFuZAoJICogZXJyb3IgY29ycmVjdGlvbiBsZXZlbC48L3A+CgkgKgoJICogQGF1dGhvciBTZWFuIE93ZW4KCSAqIEBzZWUgRGF0YU1hc2sKCSAqIEBzZWUgRXJyb3JDb3JyZWN0aW9uTGV2ZWwKCSAqLwoJdmFyIEZvcm1hdEluZm9ybWF0aW9uID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkgewoJICAgIGZ1bmN0aW9uIEZvcm1hdEluZm9ybWF0aW9uKGZvcm1hdEluZm8gLyppbnQqLykgewoJICAgICAgICAvLyBCaXRzIDMsNAoJICAgICAgICB0aGlzLmVycm9yQ29ycmVjdGlvbkxldmVsID0gRXJyb3JDb3JyZWN0aW9uTGV2ZWxfMS5kZWZhdWx0LmZvckJpdHMoKGZvcm1hdEluZm8gPj4gMykgJiAweDAzKTsKCSAgICAgICAgLy8gQm90dG9tIDMgYml0cwoJICAgICAgICB0aGlzLmRhdGFNYXNrID0gLyooYnl0ZSkgKi8gKGZvcm1hdEluZm8gJiAweDA3KTsKCSAgICB9CgkgICAgRm9ybWF0SW5mb3JtYXRpb24ubnVtQml0c0RpZmZlcmluZyA9IGZ1bmN0aW9uIChhIC8qaW50Ki8sIGIgLyppbnQqLykgewoJICAgICAgICByZXR1cm4gSW50ZWdlcl8xLmRlZmF1bHQuYml0Q291bnQoYSBeIGIpOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQHBhcmFtIG1hc2tlZEZvcm1hdEluZm8xIGZvcm1hdCBpbmZvIGluZGljYXRvciwgd2l0aCBtYXNrIHN0aWxsIGFwcGxpZWQKCSAgICAgKiBAcGFyYW0gbWFza2VkRm9ybWF0SW5mbzIgc2Vjb25kIGNvcHkgb2Ygc2FtZSBpbmZvOyBib3RoIGFyZSBjaGVja2VkIGF0IHRoZSBzYW1lIHRpbWUKCSAgICAgKiAgdG8gZXN0YWJsaXNoIGJlc3QgbWF0Y2gKCSAgICAgKiBAcmV0dXJuIGluZm9ybWF0aW9uIGFib3V0IHRoZSBmb3JtYXQgaXQgc3BlY2lmaWVzLCBvciB7QGNvZGUgbnVsbH0KCSAgICAgKiAgaWYgZG9lc24ndCBzZWVtIHRvIG1hdGNoIGFueSBrbm93biBwYXR0ZXJuCgkgICAgICovCgkgICAgRm9ybWF0SW5mb3JtYXRpb24uZGVjb2RlRm9ybWF0SW5mb3JtYXRpb24gPSBmdW5jdGlvbiAobWFza2VkRm9ybWF0SW5mbzEgLyppbnQqLywgbWFza2VkRm9ybWF0SW5mbzIgLyppbnQqLykgewoJICAgICAgICB2YXIgZm9ybWF0SW5mbyA9IEZvcm1hdEluZm9ybWF0aW9uLmRvRGVjb2RlRm9ybWF0SW5mb3JtYXRpb24obWFza2VkRm9ybWF0SW5mbzEsIG1hc2tlZEZvcm1hdEluZm8yKTsKCSAgICAgICAgaWYgKGZvcm1hdEluZm8gIT09IG51bGwpIHsKCSAgICAgICAgICAgIHJldHVybiBmb3JtYXRJbmZvOwoJICAgICAgICB9CgkgICAgICAgIC8vIFNob3VsZCByZXR1cm4gbnVsbCwgYnV0LCBzb21lIFFSIGNvZGVzIGFwcGFyZW50bHkKCSAgICAgICAgLy8gZG8gbm90IG1hc2sgdGhpcyBpbmZvLiBUcnkgYWdhaW4gYnkgYWN0dWFsbHkgbWFza2luZyB0aGUgcGF0dGVybgoJICAgICAgICAvLyBmaXJzdAoJICAgICAgICByZXR1cm4gRm9ybWF0SW5mb3JtYXRpb24uZG9EZWNvZGVGb3JtYXRJbmZvcm1hdGlvbihtYXNrZWRGb3JtYXRJbmZvMSBeIEZvcm1hdEluZm9ybWF0aW9uLkZPUk1BVF9JTkZPX01BU0tfUVIsIG1hc2tlZEZvcm1hdEluZm8yIF4gRm9ybWF0SW5mb3JtYXRpb24uRk9STUFUX0lORk9fTUFTS19RUik7CgkgICAgfTsKCSAgICBGb3JtYXRJbmZvcm1hdGlvbi5kb0RlY29kZUZvcm1hdEluZm9ybWF0aW9uID0gZnVuY3Rpb24gKG1hc2tlZEZvcm1hdEluZm8xIC8qaW50Ki8sIG1hc2tlZEZvcm1hdEluZm8yIC8qaW50Ki8pIHsKCSAgICAgICAgdmFyIGVfMSwgX2E7CgkgICAgICAgIC8vIEZpbmQgdGhlIGludCBpbiBGT1JNQVRfSU5GT19ERUNPREVfTE9PS1VQIHdpdGggZmV3ZXN0IGJpdHMgZGlmZmVyaW5nCgkgICAgICAgIHZhciBiZXN0RGlmZmVyZW5jZSA9IE51bWJlci5NQVhfU0FGRV9JTlRFR0VSOwoJICAgICAgICB2YXIgYmVzdEZvcm1hdEluZm8gPSAwOwoJICAgICAgICB0cnkgewoJICAgICAgICAgICAgZm9yICh2YXIgX2IgPSBfX3ZhbHVlcyQ2KEZvcm1hdEluZm9ybWF0aW9uLkZPUk1BVF9JTkZPX0RFQ09ERV9MT09LVVApLCBfYyA9IF9iLm5leHQoKTsgIV9jLmRvbmU7IF9jID0gX2IubmV4dCgpKSB7CgkgICAgICAgICAgICAgICAgdmFyIGRlY29kZUluZm8gPSBfYy52YWx1ZTsKCSAgICAgICAgICAgICAgICB2YXIgdGFyZ2V0SW5mbyA9IGRlY29kZUluZm9bMF07CgkgICAgICAgICAgICAgICAgaWYgKHRhcmdldEluZm8gPT09IG1hc2tlZEZvcm1hdEluZm8xIHx8IHRhcmdldEluZm8gPT09IG1hc2tlZEZvcm1hdEluZm8yKSB7CgkgICAgICAgICAgICAgICAgICAgIC8vIEZvdW5kIGFuIGV4YWN0IG1hdGNoCgkgICAgICAgICAgICAgICAgICAgIHJldHVybiBuZXcgRm9ybWF0SW5mb3JtYXRpb24oZGVjb2RlSW5mb1sxXSk7CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgIHZhciBiaXRzRGlmZmVyZW5jZSA9IEZvcm1hdEluZm9ybWF0aW9uLm51bUJpdHNEaWZmZXJpbmcobWFza2VkRm9ybWF0SW5mbzEsIHRhcmdldEluZm8pOwoJICAgICAgICAgICAgICAgIGlmIChiaXRzRGlmZmVyZW5jZSA8IGJlc3REaWZmZXJlbmNlKSB7CgkgICAgICAgICAgICAgICAgICAgIGJlc3RGb3JtYXRJbmZvID0gZGVjb2RlSW5mb1sxXTsKCSAgICAgICAgICAgICAgICAgICAgYmVzdERpZmZlcmVuY2UgPSBiaXRzRGlmZmVyZW5jZTsKCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgaWYgKG1hc2tlZEZvcm1hdEluZm8xICE9PSBtYXNrZWRGb3JtYXRJbmZvMikgewoJICAgICAgICAgICAgICAgICAgICAvLyBhbHNvIHRyeSB0aGUgb3RoZXIgb3B0aW9uCgkgICAgICAgICAgICAgICAgICAgIGJpdHNEaWZmZXJlbmNlID0gRm9ybWF0SW5mb3JtYXRpb24ubnVtQml0c0RpZmZlcmluZyhtYXNrZWRGb3JtYXRJbmZvMiwgdGFyZ2V0SW5mbyk7CgkgICAgICAgICAgICAgICAgICAgIGlmIChiaXRzRGlmZmVyZW5jZSA8IGJlc3REaWZmZXJlbmNlKSB7CgkgICAgICAgICAgICAgICAgICAgICAgICBiZXN0Rm9ybWF0SW5mbyA9IGRlY29kZUluZm9bMV07CgkgICAgICAgICAgICAgICAgICAgICAgICBiZXN0RGlmZmVyZW5jZSA9IGJpdHNEaWZmZXJlbmNlOwoJICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIGNhdGNoIChlXzFfMSkgeyBlXzEgPSB7IGVycm9yOiBlXzFfMSB9OyB9CgkgICAgICAgIGZpbmFsbHkgewoJICAgICAgICAgICAgdHJ5IHsKCSAgICAgICAgICAgICAgICBpZiAoX2MgJiYgIV9jLmRvbmUgJiYgKF9hID0gX2IucmV0dXJuKSkgX2EuY2FsbChfYik7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBmaW5hbGx5IHsgaWYgKGVfMSkgdGhyb3cgZV8xLmVycm9yOyB9CgkgICAgICAgIH0KCSAgICAgICAgLy8gSGFtbWluZyBkaXN0YW5jZSBvZiB0aGUgMzIgbWFza2VkIGNvZGVzIGlzIDcsIGJ5IGNvbnN0cnVjdGlvbiwgc28gPD0gMyBiaXRzCgkgICAgICAgIC8vIGRpZmZlcmluZyBtZWFucyB3ZSBmb3VuZCBhIG1hdGNoCgkgICAgICAgIGlmIChiZXN0RGlmZmVyZW5jZSA8PSAzKSB7CgkgICAgICAgICAgICByZXR1cm4gbmV3IEZvcm1hdEluZm9ybWF0aW9uKGJlc3RGb3JtYXRJbmZvKTsKCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gbnVsbDsKCSAgICB9OwoJICAgIEZvcm1hdEluZm9ybWF0aW9uLnByb3RvdHlwZS5nZXRFcnJvckNvcnJlY3Rpb25MZXZlbCA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMuZXJyb3JDb3JyZWN0aW9uTGV2ZWw7CgkgICAgfTsKCSAgICBGb3JtYXRJbmZvcm1hdGlvbi5wcm90b3R5cGUuZ2V0RGF0YU1hc2sgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLmRhdGFNYXNrOwoJICAgIH07CgkgICAgLypAT3ZlcnJpZGUqLwoJICAgIEZvcm1hdEluZm9ybWF0aW9uLnByb3RvdHlwZS5oYXNoQ29kZSA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuICh0aGlzLmVycm9yQ29ycmVjdGlvbkxldmVsLmdldEJpdHMoKSA8PCAzKSB8IHRoaXMuZGF0YU1hc2s7CgkgICAgfTsKCSAgICAvKkBPdmVycmlkZSovCgkgICAgRm9ybWF0SW5mb3JtYXRpb24ucHJvdG90eXBlLmVxdWFscyA9IGZ1bmN0aW9uIChvKSB7CgkgICAgICAgIGlmICghKG8gaW5zdGFuY2VvZiBGb3JtYXRJbmZvcm1hdGlvbikpIHsKCSAgICAgICAgICAgIHJldHVybiBmYWxzZTsKCSAgICAgICAgfQoJICAgICAgICB2YXIgb3RoZXIgPSBvOwoJICAgICAgICByZXR1cm4gdGhpcy5lcnJvckNvcnJlY3Rpb25MZXZlbCA9PT0gb3RoZXIuZXJyb3JDb3JyZWN0aW9uTGV2ZWwgJiYKCSAgICAgICAgICAgIHRoaXMuZGF0YU1hc2sgPT09IG90aGVyLmRhdGFNYXNrOwoJICAgIH07CgkgICAgRm9ybWF0SW5mb3JtYXRpb24uRk9STUFUX0lORk9fTUFTS19RUiA9IDB4NTQxMjsKCSAgICAvKioKCSAgICAgKiBTZWUgSVNPIDE4MDA0OjIwMDYsIEFubmV4IEMsIFRhYmxlIEMuMQoJICAgICAqLwoJICAgIEZvcm1hdEluZm9ybWF0aW9uLkZPUk1BVF9JTkZPX0RFQ09ERV9MT09LVVAgPSBbCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHg1NDEyLCAweDAwXSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHg1MTI1LCAweDAxXSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHg1RTdDLCAweDAyXSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHg1QjRCLCAweDAzXSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHg0NUY5LCAweDA0XSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHg0MENFLCAweDA1XSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHg0Rjk3LCAweDA2XSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHg0QUEwLCAweDA3XSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHg3N0M0LCAweDA4XSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHg3MkYzLCAweDA5XSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHg3REFBLCAweDBBXSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHg3ODlELCAweDBCXSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHg2NjJGLCAweDBDXSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHg2MzE4LCAweDBEXSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHg2QzQxLCAweDBFXSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHg2OTc2LCAweDBGXSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHgxNjg5LCAweDEwXSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHgxM0JFLCAweDExXSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHgxQ0U3LCAweDEyXSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHgxOUQwLCAweDEzXSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHgwNzYyLCAweDE0XSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHgwMjU1LCAweDE1XSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHgwRDBDLCAweDE2XSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHgwODNCLCAweDE3XSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHgzNTVGLCAweDE4XSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHgzMDY4LCAweDE5XSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHgzRjMxLCAweDFBXSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHgzQTA2LCAweDFCXSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHgyNEI0LCAweDFDXSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHgyMTgzLCAweDFEXSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHgyRURBLCAweDFFXSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHgyQkVELCAweDFGXSksCgkgICAgXTsKCSAgICByZXR1cm4gRm9ybWF0SW5mb3JtYXRpb247Cgl9KCkpOwoJRm9ybWF0SW5mb3JtYXRpb24kMS5kZWZhdWx0ID0gRm9ybWF0SW5mb3JtYXRpb247CgoJdmFyIEVDQmxvY2tzJDEgPSB7fTsKCgl2YXIgX192YWx1ZXMkNSA9IChjb21tb25qc0dsb2JhbCAmJiBjb21tb25qc0dsb2JhbC5fX3ZhbHVlcykgfHwgZnVuY3Rpb24obykgewoJICAgIHZhciBzID0gdHlwZW9mIFN5bWJvbCA9PT0gImZ1bmN0aW9uIiAmJiBTeW1ib2wuaXRlcmF0b3IsIG0gPSBzICYmIG9bc10sIGkgPSAwOwoJICAgIGlmIChtKSByZXR1cm4gbS5jYWxsKG8pOwoJICAgIGlmIChvICYmIHR5cGVvZiBvLmxlbmd0aCA9PT0gIm51bWJlciIpIHJldHVybiB7CgkgICAgICAgIG5leHQ6IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgICAgIGlmIChvICYmIGkgPj0gby5sZW5ndGgpIG8gPSB2b2lkIDA7CgkgICAgICAgICAgICByZXR1cm4geyB2YWx1ZTogbyAmJiBvW2krK10sIGRvbmU6ICFvIH07CgkgICAgICAgIH0KCSAgICB9OwoJICAgIHRocm93IG5ldyBUeXBlRXJyb3IocyA/ICJPYmplY3QgaXMgbm90IGl0ZXJhYmxlLiIgOiAiU3ltYm9sLml0ZXJhdG9yIGlzIG5vdCBkZWZpbmVkLiIpOwoJfTsKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShFQ0Jsb2NrcyQxLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7CgkvKioKCSAqIDxwPkVuY2Fwc3VsYXRlcyBhIHNldCBvZiBlcnJvci1jb3JyZWN0aW9uIGJsb2NrcyBpbiBvbmUgc3ltYm9sIHZlcnNpb24uIE1vc3QgdmVyc2lvbnMgd2lsbAoJICogdXNlIGJsb2NrcyBvZiBkaWZmZXJpbmcgc2l6ZXMgd2l0aGluIG9uZSB2ZXJzaW9uLCBzbywgdGhpcyBlbmNhcHN1bGF0ZXMgdGhlIHBhcmFtZXRlcnMgZm9yCgkgKiBlYWNoIHNldCBvZiBibG9ja3MuIEl0IGFsc28gaG9sZHMgdGhlIG51bWJlciBvZiBlcnJvci1jb3JyZWN0aW9uIGNvZGV3b3JkcyBwZXIgYmxvY2sgc2luY2UgaXQKCSAqIHdpbGwgYmUgdGhlIHNhbWUgYWNyb3NzIGFsbCBibG9ja3Mgd2l0aGluIG9uZSB2ZXJzaW9uLjwvcD4KCSAqLwoJdmFyIEVDQmxvY2tzID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkgewoJICAgIGZ1bmN0aW9uIEVDQmxvY2tzKGVjQ29kZXdvcmRzUGVyQmxvY2sgLyppbnQqLykgewoJICAgICAgICB2YXIgZWNCbG9ja3MgPSBbXTsKCSAgICAgICAgZm9yICh2YXIgX2kgPSAxOyBfaSA8IGFyZ3VtZW50cy5sZW5ndGg7IF9pKyspIHsKCSAgICAgICAgICAgIGVjQmxvY2tzW19pIC0gMV0gPSBhcmd1bWVudHNbX2ldOwoJICAgICAgICB9CgkgICAgICAgIHRoaXMuZWNDb2Rld29yZHNQZXJCbG9jayA9IGVjQ29kZXdvcmRzUGVyQmxvY2s7CgkgICAgICAgIHRoaXMuZWNCbG9ja3MgPSBlY0Jsb2NrczsKCSAgICB9CgkgICAgRUNCbG9ja3MucHJvdG90eXBlLmdldEVDQ29kZXdvcmRzUGVyQmxvY2sgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLmVjQ29kZXdvcmRzUGVyQmxvY2s7CgkgICAgfTsKCSAgICBFQ0Jsb2Nrcy5wcm90b3R5cGUuZ2V0TnVtQmxvY2tzID0gZnVuY3Rpb24gKCkgewoJICAgICAgICB2YXIgZV8xLCBfYTsKCSAgICAgICAgdmFyIHRvdGFsID0gMDsKCSAgICAgICAgdmFyIGVjQmxvY2tzID0gdGhpcy5lY0Jsb2NrczsKCSAgICAgICAgdHJ5IHsKCSAgICAgICAgICAgIGZvciAodmFyIGVjQmxvY2tzXzEgPSBfX3ZhbHVlcyQ1KGVjQmxvY2tzKSwgZWNCbG9ja3NfMV8xID0gZWNCbG9ja3NfMS5uZXh0KCk7ICFlY0Jsb2Nrc18xXzEuZG9uZTsgZWNCbG9ja3NfMV8xID0gZWNCbG9ja3NfMS5uZXh0KCkpIHsKCSAgICAgICAgICAgICAgICB2YXIgZWNCbG9jayA9IGVjQmxvY2tzXzFfMS52YWx1ZTsKCSAgICAgICAgICAgICAgICB0b3RhbCArPSBlY0Jsb2NrLmdldENvdW50KCk7CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICAgICAgY2F0Y2ggKGVfMV8xKSB7IGVfMSA9IHsgZXJyb3I6IGVfMV8xIH07IH0KCSAgICAgICAgZmluYWxseSB7CgkgICAgICAgICAgICB0cnkgewoJICAgICAgICAgICAgICAgIGlmIChlY0Jsb2Nrc18xXzEgJiYgIWVjQmxvY2tzXzFfMS5kb25lICYmIChfYSA9IGVjQmxvY2tzXzEucmV0dXJuKSkgX2EuY2FsbChlY0Jsb2Nrc18xKTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIGZpbmFsbHkgeyBpZiAoZV8xKSB0aHJvdyBlXzEuZXJyb3I7IH0KCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gdG90YWw7CgkgICAgfTsKCSAgICBFQ0Jsb2Nrcy5wcm90b3R5cGUuZ2V0VG90YWxFQ0NvZGV3b3JkcyA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMuZWNDb2Rld29yZHNQZXJCbG9jayAqIHRoaXMuZ2V0TnVtQmxvY2tzKCk7CgkgICAgfTsKCSAgICBFQ0Jsb2Nrcy5wcm90b3R5cGUuZ2V0RUNCbG9ja3MgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLmVjQmxvY2tzOwoJICAgIH07CgkgICAgcmV0dXJuIEVDQmxvY2tzOwoJfSgpKTsKCUVDQmxvY2tzJDEuZGVmYXVsdCA9IEVDQmxvY2tzOwoKCXZhciBFQ0IkMSA9IHt9OwoKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShFQ0IkMSwgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJLyoqCgkgKiA8cD5FbmNhcHN1bGF0ZXMgdGhlIHBhcmFtZXRlcnMgZm9yIG9uZSBlcnJvci1jb3JyZWN0aW9uIGJsb2NrIGluIG9uZSBzeW1ib2wgdmVyc2lvbi4KCSAqIFRoaXMgaW5jbHVkZXMgdGhlIG51bWJlciBvZiBkYXRhIGNvZGV3b3JkcywgYW5kIHRoZSBudW1iZXIgb2YgdGltZXMgYSBibG9jayB3aXRoIHRoZXNlCgkgKiBwYXJhbWV0ZXJzIGlzIHVzZWQgY29uc2VjdXRpdmVseSBpbiB0aGUgUVIgY29kZSB2ZXJzaW9uJ3MgZm9ybWF0LjwvcD4KCSAqLwoJdmFyIEVDQiA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHsKCSAgICBmdW5jdGlvbiBFQ0IoY291bnQgLyppbnQqLywgZGF0YUNvZGV3b3JkcyAvKmludCovKSB7CgkgICAgICAgIHRoaXMuY291bnQgPSBjb3VudDsKCSAgICAgICAgdGhpcy5kYXRhQ29kZXdvcmRzID0gZGF0YUNvZGV3b3JkczsKCSAgICB9CgkgICAgRUNCLnByb3RvdHlwZS5nZXRDb3VudCA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMuY291bnQ7CgkgICAgfTsKCSAgICBFQ0IucHJvdG90eXBlLmdldERhdGFDb2Rld29yZHMgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLmRhdGFDb2Rld29yZHM7CgkgICAgfTsKCSAgICByZXR1cm4gRUNCOwoJfSgpKTsKCUVDQiQxLmRlZmF1bHQgPSBFQ0I7CgoJLyoKCSAqIENvcHlyaWdodCAyMDA3IFpYaW5nIGF1dGhvcnMKCSAqCgkgKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKCSAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4KCSAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdAoJICoKCSAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wCgkgKgoJICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZQoJICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gIkFTIElTIiBCQVNJUywKCSAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLgoJICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZAoJICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuCgkgKi8KCXZhciBfX3ZhbHVlcyQ0ID0gKGNvbW1vbmpzR2xvYmFsICYmIGNvbW1vbmpzR2xvYmFsLl9fdmFsdWVzKSB8fCBmdW5jdGlvbihvKSB7CgkgICAgdmFyIHMgPSB0eXBlb2YgU3ltYm9sID09PSAiZnVuY3Rpb24iICYmIFN5bWJvbC5pdGVyYXRvciwgbSA9IHMgJiYgb1tzXSwgaSA9IDA7CgkgICAgaWYgKG0pIHJldHVybiBtLmNhbGwobyk7CgkgICAgaWYgKG8gJiYgdHlwZW9mIG8ubGVuZ3RoID09PSAibnVtYmVyIikgcmV0dXJuIHsKCSAgICAgICAgbmV4dDogZnVuY3Rpb24gKCkgewoJICAgICAgICAgICAgaWYgKG8gJiYgaSA+PSBvLmxlbmd0aCkgbyA9IHZvaWQgMDsKCSAgICAgICAgICAgIHJldHVybiB7IHZhbHVlOiBvICYmIG9baSsrXSwgZG9uZTogIW8gfTsKCSAgICAgICAgfQoJICAgIH07CgkgICAgdGhyb3cgbmV3IFR5cGVFcnJvcihzID8gIk9iamVjdCBpcyBub3QgaXRlcmFibGUuIiA6ICJTeW1ib2wuaXRlcmF0b3IgaXMgbm90IGRlZmluZWQuIik7Cgl9OwoJT2JqZWN0LmRlZmluZVByb3BlcnR5KFZlcnNpb24kMSwgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJLypuYW1lc3BhY2UgY29tLmdvb2dsZS56eGluZy5xcmNvZGUuZGVjb2RlciB7Ki8KCXZhciBCaXRNYXRyaXhfMSQzID0gQml0TWF0cml4JDE7Cgl2YXIgRm9ybWF0SW5mb3JtYXRpb25fMSQxID0gRm9ybWF0SW5mb3JtYXRpb24kMTsKCXZhciBFQ0Jsb2Nrc18xID0gRUNCbG9ja3MkMTsKCXZhciBFQ0JfMSA9IEVDQiQxOwoJdmFyIEZvcm1hdEV4Y2VwdGlvbl8xJDIgPSBGb3JtYXRFeGNlcHRpb24kMTsKCXZhciBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb25fMSQyID0gSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uJDE7CgkvKioKCSAqIFNlZSBJU08gMTgwMDQ6MjAwNiBBbm5leCBECgkgKgoJICogQGF1dGhvciBTZWFuIE93ZW4KCSAqLwoJdmFyIFZlcnNpb24gPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7CgkgICAgZnVuY3Rpb24gVmVyc2lvbih2ZXJzaW9uTnVtYmVyIC8qaW50Ki8sIGFsaWdubWVudFBhdHRlcm5DZW50ZXJzKSB7CgkgICAgICAgIHZhciBlXzEsIF9hOwoJICAgICAgICB2YXIgZWNCbG9ja3MgPSBbXTsKCSAgICAgICAgZm9yICh2YXIgX2kgPSAyOyBfaSA8IGFyZ3VtZW50cy5sZW5ndGg7IF9pKyspIHsKCSAgICAgICAgICAgIGVjQmxvY2tzW19pIC0gMl0gPSBhcmd1bWVudHNbX2ldOwoJICAgICAgICB9CgkgICAgICAgIHRoaXMudmVyc2lvbk51bWJlciA9IHZlcnNpb25OdW1iZXI7CgkgICAgICAgIHRoaXMuYWxpZ25tZW50UGF0dGVybkNlbnRlcnMgPSBhbGlnbm1lbnRQYXR0ZXJuQ2VudGVyczsKCSAgICAgICAgdGhpcy5lY0Jsb2NrcyA9IGVjQmxvY2tzOwoJICAgICAgICB2YXIgdG90YWwgPSAwOwoJICAgICAgICB2YXIgZWNDb2Rld29yZHMgPSBlY0Jsb2Nrc1swXS5nZXRFQ0NvZGV3b3Jkc1BlckJsb2NrKCk7CgkgICAgICAgIHZhciBlY2JBcnJheSA9IGVjQmxvY2tzWzBdLmdldEVDQmxvY2tzKCk7CgkgICAgICAgIHRyeSB7CgkgICAgICAgICAgICBmb3IgKHZhciBlY2JBcnJheV8xID0gX192YWx1ZXMkNChlY2JBcnJheSksIGVjYkFycmF5XzFfMSA9IGVjYkFycmF5XzEubmV4dCgpOyAhZWNiQXJyYXlfMV8xLmRvbmU7IGVjYkFycmF5XzFfMSA9IGVjYkFycmF5XzEubmV4dCgpKSB7CgkgICAgICAgICAgICAgICAgdmFyIGVjQmxvY2sgPSBlY2JBcnJheV8xXzEudmFsdWU7CgkgICAgICAgICAgICAgICAgdG90YWwgKz0gZWNCbG9jay5nZXRDb3VudCgpICogKGVjQmxvY2suZ2V0RGF0YUNvZGV3b3JkcygpICsgZWNDb2Rld29yZHMpOwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIGNhdGNoIChlXzFfMSkgeyBlXzEgPSB7IGVycm9yOiBlXzFfMSB9OyB9CgkgICAgICAgIGZpbmFsbHkgewoJICAgICAgICAgICAgdHJ5IHsKCSAgICAgICAgICAgICAgICBpZiAoZWNiQXJyYXlfMV8xICYmICFlY2JBcnJheV8xXzEuZG9uZSAmJiAoX2EgPSBlY2JBcnJheV8xLnJldHVybikpIF9hLmNhbGwoZWNiQXJyYXlfMSk7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBmaW5hbGx5IHsgaWYgKGVfMSkgdGhyb3cgZV8xLmVycm9yOyB9CgkgICAgICAgIH0KCSAgICAgICAgdGhpcy50b3RhbENvZGV3b3JkcyA9IHRvdGFsOwoJICAgIH0KCSAgICBWZXJzaW9uLnByb3RvdHlwZS5nZXRWZXJzaW9uTnVtYmVyID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy52ZXJzaW9uTnVtYmVyOwoJICAgIH07CgkgICAgVmVyc2lvbi5wcm90b3R5cGUuZ2V0QWxpZ25tZW50UGF0dGVybkNlbnRlcnMgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLmFsaWdubWVudFBhdHRlcm5DZW50ZXJzOwoJICAgIH07CgkgICAgVmVyc2lvbi5wcm90b3R5cGUuZ2V0VG90YWxDb2Rld29yZHMgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLnRvdGFsQ29kZXdvcmRzOwoJICAgIH07CgkgICAgVmVyc2lvbi5wcm90b3R5cGUuZ2V0RGltZW5zaW9uRm9yVmVyc2lvbiA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIDE3ICsgNCAqIHRoaXMudmVyc2lvbk51bWJlcjsKCSAgICB9OwoJICAgIFZlcnNpb24ucHJvdG90eXBlLmdldEVDQmxvY2tzRm9yTGV2ZWwgPSBmdW5jdGlvbiAoZWNMZXZlbCkgewoJICAgICAgICByZXR1cm4gdGhpcy5lY0Jsb2Nrc1tlY0xldmVsLmdldFZhbHVlKCldOwoJICAgICAgICAvLyBUWVBFU0NSSVBUUE9SVDogb3JpZ2luYWwgd2FzIHVzaW5nIG9yZGluYWwsIGFuZCB1c2luZyB0aGUgb3JkZXIgb2YgbGV2ZWxzIGFzIGRlZmluZWQgaW4gRXJyb3JDb3JyZWN0aW9uTGV2ZWwgZW51bSAoTE1RSCkKCSAgICAgICAgLy8gSSB3aWxsIHVzZSB0aGUgZGlyZWN0IHZhbHVlIGZyb20gRXJyb3JDb3JyZWN0aW9uTGV2ZWxWYWx1ZXMgZW51bSB3aGljaCBpbiB0eXBlc2NyaXB0IGdvZXMgdG8gYSBudW1iZXIKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIDxwPkRlZHVjZXMgdmVyc2lvbiBpbmZvcm1hdGlvbiBwdXJlbHkgZnJvbSBRUiBDb2RlIGRpbWVuc2lvbnMuPC9wPgoJICAgICAqCgkgICAgICogQHBhcmFtIGRpbWVuc2lvbiBkaW1lbnNpb24gaW4gbW9kdWxlcwoJICAgICAqIEByZXR1cm4gVmVyc2lvbiBmb3IgYSBRUiBDb2RlIG9mIHRoYXQgZGltZW5zaW9uCgkgICAgICogQHRocm93cyBGb3JtYXRFeGNlcHRpb24gaWYgZGltZW5zaW9uIGlzIG5vdCAxIG1vZCA0CgkgICAgICovCgkgICAgVmVyc2lvbi5nZXRQcm92aXNpb25hbFZlcnNpb25Gb3JEaW1lbnNpb24gPSBmdW5jdGlvbiAoZGltZW5zaW9uIC8qaW50Ki8pIHsKCSAgICAgICAgaWYgKGRpbWVuc2lvbiAlIDQgIT09IDEpIHsKCSAgICAgICAgICAgIHRocm93IG5ldyBGb3JtYXRFeGNlcHRpb25fMSQyLmRlZmF1bHQoKTsKCSAgICAgICAgfQoJICAgICAgICB0cnkgewoJICAgICAgICAgICAgcmV0dXJuIHRoaXMuZ2V0VmVyc2lvbkZvck51bWJlcigoZGltZW5zaW9uIC0gMTcpIC8gNCk7CgkgICAgICAgIH0KCSAgICAgICAgY2F0Y2ggKGlnbm9yZWQgLyo6IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbiovKSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgRm9ybWF0RXhjZXB0aW9uXzEkMi5kZWZhdWx0KCk7CgkgICAgICAgIH0KCSAgICB9OwoJICAgIFZlcnNpb24uZ2V0VmVyc2lvbkZvck51bWJlciA9IGZ1bmN0aW9uICh2ZXJzaW9uTnVtYmVyIC8qaW50Ki8pIHsKCSAgICAgICAgaWYgKHZlcnNpb25OdW1iZXIgPCAxIHx8IHZlcnNpb25OdW1iZXIgPiA0MCkgewoJICAgICAgICAgICAgdGhyb3cgbmV3IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbl8xJDIuZGVmYXVsdCgpOwoJICAgICAgICB9CgkgICAgICAgIHJldHVybiBWZXJzaW9uLlZFUlNJT05TW3ZlcnNpb25OdW1iZXIgLSAxXTsKCSAgICB9OwoJICAgIFZlcnNpb24uZGVjb2RlVmVyc2lvbkluZm9ybWF0aW9uID0gZnVuY3Rpb24gKHZlcnNpb25CaXRzIC8qaW50Ki8pIHsKCSAgICAgICAgdmFyIGJlc3REaWZmZXJlbmNlID0gTnVtYmVyLk1BWF9TQUZFX0lOVEVHRVI7CgkgICAgICAgIHZhciBiZXN0VmVyc2lvbiA9IDA7CgkgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgVmVyc2lvbi5WRVJTSU9OX0RFQ09ERV9JTkZPLmxlbmd0aDsgaSsrKSB7CgkgICAgICAgICAgICB2YXIgdGFyZ2V0VmVyc2lvbiA9IFZlcnNpb24uVkVSU0lPTl9ERUNPREVfSU5GT1tpXTsKCSAgICAgICAgICAgIC8vIERvIHRoZSB2ZXJzaW9uIGluZm8gYml0cyBtYXRjaCBleGFjdGx5PyBkb25lLgoJICAgICAgICAgICAgaWYgKHRhcmdldFZlcnNpb24gPT09IHZlcnNpb25CaXRzKSB7CgkgICAgICAgICAgICAgICAgcmV0dXJuIFZlcnNpb24uZ2V0VmVyc2lvbkZvck51bWJlcihpICsgNyk7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICAvLyBPdGhlcndpc2Ugc2VlIGlmIHRoaXMgaXMgdGhlIGNsb3Nlc3QgdG8gYSByZWFsIHZlcnNpb24gaW5mbyBiaXQgc3RyaW5nCgkgICAgICAgICAgICAvLyB3ZSBoYXZlIHNlZW4gc28gZmFyCgkgICAgICAgICAgICB2YXIgYml0c0RpZmZlcmVuY2UgPSBGb3JtYXRJbmZvcm1hdGlvbl8xJDEuZGVmYXVsdC5udW1CaXRzRGlmZmVyaW5nKHZlcnNpb25CaXRzLCB0YXJnZXRWZXJzaW9uKTsKCSAgICAgICAgICAgIGlmIChiaXRzRGlmZmVyZW5jZSA8IGJlc3REaWZmZXJlbmNlKSB7CgkgICAgICAgICAgICAgICAgYmVzdFZlcnNpb24gPSBpICsgNzsKCSAgICAgICAgICAgICAgICBiZXN0RGlmZmVyZW5jZSA9IGJpdHNEaWZmZXJlbmNlOwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIC8vIFdlIGNhbiB0b2xlcmF0ZSB1cCB0byAzIGJpdHMgb2YgZXJyb3Igc2luY2Ugbm8gdHdvIHZlcnNpb24gaW5mbyBjb2Rld29yZHMgd2lsbAoJICAgICAgICAvLyBkaWZmZXIgaW4gbGVzcyB0aGFuIDggYml0cy4KCSAgICAgICAgaWYgKGJlc3REaWZmZXJlbmNlIDw9IDMpIHsKCSAgICAgICAgICAgIHJldHVybiBWZXJzaW9uLmdldFZlcnNpb25Gb3JOdW1iZXIoYmVzdFZlcnNpb24pOwoJICAgICAgICB9CgkgICAgICAgIC8vIElmIHdlIGRpZG4ndCBmaW5kIGEgY2xvc2UgZW5vdWdoIG1hdGNoLCBmYWlsCgkgICAgICAgIHJldHVybiBudWxsOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogU2VlIElTTyAxODAwNDoyMDA2IEFubmV4IEUKCSAgICAgKi8KCSAgICBWZXJzaW9uLnByb3RvdHlwZS5idWlsZEZ1bmN0aW9uUGF0dGVybiA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgdmFyIGRpbWVuc2lvbiA9IHRoaXMuZ2V0RGltZW5zaW9uRm9yVmVyc2lvbigpOwoJICAgICAgICB2YXIgYml0TWF0cml4ID0gbmV3IEJpdE1hdHJpeF8xJDMuZGVmYXVsdChkaW1lbnNpb24pOwoJICAgICAgICAvLyBUb3AgbGVmdCBmaW5kZXIgcGF0dGVybiArIHNlcGFyYXRvciArIGZvcm1hdAoJICAgICAgICBiaXRNYXRyaXguc2V0UmVnaW9uKDAsIDAsIDksIDkpOwoJICAgICAgICAvLyBUb3AgcmlnaHQgZmluZGVyIHBhdHRlcm4gKyBzZXBhcmF0b3IgKyBmb3JtYXQKCSAgICAgICAgYml0TWF0cml4LnNldFJlZ2lvbihkaW1lbnNpb24gLSA4LCAwLCA4LCA5KTsKCSAgICAgICAgLy8gQm90dG9tIGxlZnQgZmluZGVyIHBhdHRlcm4gKyBzZXBhcmF0b3IgKyBmb3JtYXQKCSAgICAgICAgYml0TWF0cml4LnNldFJlZ2lvbigwLCBkaW1lbnNpb24gLSA4LCA5LCA4KTsKCSAgICAgICAgLy8gQWxpZ25tZW50IHBhdHRlcm5zCgkgICAgICAgIHZhciBtYXggPSB0aGlzLmFsaWdubWVudFBhdHRlcm5DZW50ZXJzLmxlbmd0aDsKCSAgICAgICAgZm9yICh2YXIgeCA9IDA7IHggPCBtYXg7IHgrKykgewoJICAgICAgICAgICAgdmFyIGkgPSB0aGlzLmFsaWdubWVudFBhdHRlcm5DZW50ZXJzW3hdIC0gMjsKCSAgICAgICAgICAgIGZvciAodmFyIHkgPSAwOyB5IDwgbWF4OyB5KyspIHsKCSAgICAgICAgICAgICAgICBpZiAoKHggPT09IDAgJiYgKHkgPT09IDAgfHwgeSA9PT0gbWF4IC0gMSkpIHx8ICh4ID09PSBtYXggLSAxICYmIHkgPT09IDApKSB7CgkgICAgICAgICAgICAgICAgICAgIC8vIE5vIGFsaWdubWVudCBwYXR0ZXJucyBuZWFyIHRoZSB0aHJlZSBmaW5kZXIgcGF0dGVybnMKCSAgICAgICAgICAgICAgICAgICAgY29udGludWU7CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgIGJpdE1hdHJpeC5zZXRSZWdpb24odGhpcy5hbGlnbm1lbnRQYXR0ZXJuQ2VudGVyc1t5XSAtIDIsIGksIDUsIDUpOwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIC8vIFZlcnRpY2FsIHRpbWluZyBwYXR0ZXJuCgkgICAgICAgIGJpdE1hdHJpeC5zZXRSZWdpb24oNiwgOSwgMSwgZGltZW5zaW9uIC0gMTcpOwoJICAgICAgICAvLyBIb3Jpem9udGFsIHRpbWluZyBwYXR0ZXJuCgkgICAgICAgIGJpdE1hdHJpeC5zZXRSZWdpb24oOSwgNiwgZGltZW5zaW9uIC0gMTcsIDEpOwoJICAgICAgICBpZiAodGhpcy52ZXJzaW9uTnVtYmVyID4gNikgewoJICAgICAgICAgICAgLy8gVmVyc2lvbiBpbmZvLCB0b3AgcmlnaHQKCSAgICAgICAgICAgIGJpdE1hdHJpeC5zZXRSZWdpb24oZGltZW5zaW9uIC0gMTEsIDAsIDMsIDYpOwoJICAgICAgICAgICAgLy8gVmVyc2lvbiBpbmZvLCBib3R0b20gbGVmdAoJICAgICAgICAgICAgYml0TWF0cml4LnNldFJlZ2lvbigwLCBkaW1lbnNpb24gLSAxMSwgNiwgMyk7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIGJpdE1hdHJpeDsKCSAgICB9OwoJICAgIC8qQE92ZXJyaWRlKi8KCSAgICBWZXJzaW9uLnByb3RvdHlwZS50b1N0cmluZyA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuICcnICsgdGhpcy52ZXJzaW9uTnVtYmVyOwoJICAgIH07CgkgICAgLyoqCgkgICAgICAgKiBTZWUgSVNPIDE4MDA0OjIwMDYgQW5uZXggRC4KCSAgICAgICAqIEVsZW1lbnQgaSByZXByZXNlbnRzIHRoZSByYXcgdmVyc2lvbiBiaXRzIHRoYXQgc3BlY2lmeSB2ZXJzaW9uIGkgKyA3CgkgICAgICAgKi8KCSAgICBWZXJzaW9uLlZFUlNJT05fREVDT0RFX0lORk8gPSBJbnQzMkFycmF5LmZyb20oWwoJICAgICAgICAweDA3Qzk0LCAweDA4NUJDLCAweDA5QTk5LCAweDBBNEQzLCAweDBCQkY2LAoJICAgICAgICAweDBDNzYyLCAweDBEODQ3LCAweDBFNjBELCAweDBGOTI4LCAweDEwQjc4LAoJICAgICAgICAweDExNDVELCAweDEyQTE3LCAweDEzNTMyLCAweDE0OUE2LCAweDE1NjgzLAoJICAgICAgICAweDE2OEM5LCAweDE3N0VDLCAweDE4RUM0LCAweDE5MUUxLCAweDFBRkFCLAoJICAgICAgICAweDFCMDhFLCAweDFDQzFBLCAweDFEMzNGLCAweDFFRDc1LCAweDFGMjUwLAoJICAgICAgICAweDIwOUQ1LCAweDIxNkYwLCAweDIyOEJBLCAweDIzNzlGLCAweDI0QjBCLAoJICAgICAgICAweDI1NDJFLCAweDI2QTY0LCAweDI3NTQxLCAweDI4QzY5CgkgICAgXSk7CgkgICAgLyoqCgkgICAgICAgKiBTZWUgSVNPIDE4MDA0OjIwMDYgNi41LjEgVGFibGUgOQoJICAgICAgICovCgkgICAgVmVyc2lvbi5WRVJTSU9OUyA9IFsKCSAgICAgICAgbmV3IFZlcnNpb24oMSwgbmV3IEludDMyQXJyYXkoMCksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoNywgbmV3IEVDQl8xLmRlZmF1bHQoMSwgMTkpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgxMCwgbmV3IEVDQl8xLmRlZmF1bHQoMSwgMTYpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgxMywgbmV3IEVDQl8xLmRlZmF1bHQoMSwgMTMpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgxNywgbmV3IEVDQl8xLmRlZmF1bHQoMSwgOSkpKSwKCSAgICAgICAgbmV3IFZlcnNpb24oMiwgSW50MzJBcnJheS5mcm9tKFs2LCAxOF0pLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDEwLCBuZXcgRUNCXzEuZGVmYXVsdCgxLCAzNCkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDE2LCBuZXcgRUNCXzEuZGVmYXVsdCgxLCAyOCkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDIyLCBuZXcgRUNCXzEuZGVmYXVsdCgxLCAyMikpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI4LCBuZXcgRUNCXzEuZGVmYXVsdCgxLCAxNikpKSwKCSAgICAgICAgbmV3IFZlcnNpb24oMywgSW50MzJBcnJheS5mcm9tKFs2LCAyMl0pLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDE1LCBuZXcgRUNCXzEuZGVmYXVsdCgxLCA1NSkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI2LCBuZXcgRUNCXzEuZGVmYXVsdCgxLCA0NCkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDE4LCBuZXcgRUNCXzEuZGVmYXVsdCgyLCAxNykpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDIyLCBuZXcgRUNCXzEuZGVmYXVsdCgyLCAxMykpKSwKCSAgICAgICAgbmV3IFZlcnNpb24oNCwgSW50MzJBcnJheS5mcm9tKFs2LCAyNl0pLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDIwLCBuZXcgRUNCXzEuZGVmYXVsdCgxLCA4MCkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDE4LCBuZXcgRUNCXzEuZGVmYXVsdCgyLCAzMikpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI2LCBuZXcgRUNCXzEuZGVmYXVsdCgyLCAyNCkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDE2LCBuZXcgRUNCXzEuZGVmYXVsdCg0LCA5KSkpLAoJICAgICAgICBuZXcgVmVyc2lvbig1LCBJbnQzMkFycmF5LmZyb20oWzYsIDMwXSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjYsIG5ldyBFQ0JfMS5kZWZhdWx0KDEsIDEwOCkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI0LCBuZXcgRUNCXzEuZGVmYXVsdCgyLCA0MykpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDE4LCBuZXcgRUNCXzEuZGVmYXVsdCgyLCAxNSksIG5ldyBFQ0JfMS5kZWZhdWx0KDIsIDE2KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjIsIG5ldyBFQ0JfMS5kZWZhdWx0KDIsIDExKSwgbmV3IEVDQl8xLmRlZmF1bHQoMiwgMTIpKSksCgkgICAgICAgIG5ldyBWZXJzaW9uKDYsIEludDMyQXJyYXkuZnJvbShbNiwgMzRdKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgxOCwgbmV3IEVDQl8xLmRlZmF1bHQoMiwgNjgpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgxNiwgbmV3IEVDQl8xLmRlZmF1bHQoNCwgMjcpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyNCwgbmV3IEVDQl8xLmRlZmF1bHQoNCwgMTkpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyOCwgbmV3IEVDQl8xLmRlZmF1bHQoNCwgMTUpKSksCgkgICAgICAgIG5ldyBWZXJzaW9uKDcsIEludDMyQXJyYXkuZnJvbShbNiwgMjIsIDM4XSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjAsIG5ldyBFQ0JfMS5kZWZhdWx0KDIsIDc4KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMTgsIG5ldyBFQ0JfMS5kZWZhdWx0KDQsIDMxKSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMTgsIG5ldyBFQ0JfMS5kZWZhdWx0KDIsIDE0KSwgbmV3IEVDQl8xLmRlZmF1bHQoNCwgMTUpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyNiwgbmV3IEVDQl8xLmRlZmF1bHQoNCwgMTMpLCBuZXcgRUNCXzEuZGVmYXVsdCgxLCAxNCkpKSwKCSAgICAgICAgbmV3IFZlcnNpb24oOCwgSW50MzJBcnJheS5mcm9tKFs2LCAyNCwgNDJdKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyNCwgbmV3IEVDQl8xLmRlZmF1bHQoMiwgOTcpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyMiwgbmV3IEVDQl8xLmRlZmF1bHQoMiwgMzgpLCBuZXcgRUNCXzEuZGVmYXVsdCgyLCAzOSkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDIyLCBuZXcgRUNCXzEuZGVmYXVsdCg0LCAxOCksIG5ldyBFQ0JfMS5kZWZhdWx0KDIsIDE5KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjYsIG5ldyBFQ0JfMS5kZWZhdWx0KDQsIDE0KSwgbmV3IEVDQl8xLmRlZmF1bHQoMiwgMTUpKSksCgkgICAgICAgIG5ldyBWZXJzaW9uKDksIEludDMyQXJyYXkuZnJvbShbNiwgMjYsIDQ2XSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMzAsIG5ldyBFQ0JfMS5kZWZhdWx0KDIsIDExNikpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDIyLCBuZXcgRUNCXzEuZGVmYXVsdCgzLCAzNiksIG5ldyBFQ0JfMS5kZWZhdWx0KDIsIDM3KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjAsIG5ldyBFQ0JfMS5kZWZhdWx0KDQsIDE2KSwgbmV3IEVDQl8xLmRlZmF1bHQoNCwgMTcpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyNCwgbmV3IEVDQl8xLmRlZmF1bHQoNCwgMTIpLCBuZXcgRUNCXzEuZGVmYXVsdCg0LCAxMykpKSwKCSAgICAgICAgbmV3IFZlcnNpb24oMTAsIEludDMyQXJyYXkuZnJvbShbNiwgMjgsIDUwXSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMTgsIG5ldyBFQ0JfMS5kZWZhdWx0KDIsIDY4KSwgbmV3IEVDQl8xLmRlZmF1bHQoMiwgNjkpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyNiwgbmV3IEVDQl8xLmRlZmF1bHQoNCwgNDMpLCBuZXcgRUNCXzEuZGVmYXVsdCgxLCA0NCkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI0LCBuZXcgRUNCXzEuZGVmYXVsdCg2LCAxOSksIG5ldyBFQ0JfMS5kZWZhdWx0KDIsIDIwKSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjgsIG5ldyBFQ0JfMS5kZWZhdWx0KDYsIDE1KSwgbmV3IEVDQl8xLmRlZmF1bHQoMiwgMTYpKSksCgkgICAgICAgIG5ldyBWZXJzaW9uKDExLCBJbnQzMkFycmF5LmZyb20oWzYsIDMwLCA1NF0pLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDIwLCBuZXcgRUNCXzEuZGVmYXVsdCg0LCA4MSkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDMwLCBuZXcgRUNCXzEuZGVmYXVsdCgxLCA1MCksIG5ldyBFQ0JfMS5kZWZhdWx0KDQsIDUxKSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjgsIG5ldyBFQ0JfMS5kZWZhdWx0KDQsIDIyKSwgbmV3IEVDQl8xLmRlZmF1bHQoNCwgMjMpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyNCwgbmV3IEVDQl8xLmRlZmF1bHQoMywgMTIpLCBuZXcgRUNCXzEuZGVmYXVsdCg4LCAxMykpKSwKCSAgICAgICAgbmV3IFZlcnNpb24oMTIsIEludDMyQXJyYXkuZnJvbShbNiwgMzIsIDU4XSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjQsIG5ldyBFQ0JfMS5kZWZhdWx0KDIsIDkyKSwgbmV3IEVDQl8xLmRlZmF1bHQoMiwgOTMpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyMiwgbmV3IEVDQl8xLmRlZmF1bHQoNiwgMzYpLCBuZXcgRUNCXzEuZGVmYXVsdCgyLCAzNykpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI2LCBuZXcgRUNCXzEuZGVmYXVsdCg0LCAyMCksIG5ldyBFQ0JfMS5kZWZhdWx0KDYsIDIxKSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjgsIG5ldyBFQ0JfMS5kZWZhdWx0KDcsIDE0KSwgbmV3IEVDQl8xLmRlZmF1bHQoNCwgMTUpKSksCgkgICAgICAgIG5ldyBWZXJzaW9uKDEzLCBJbnQzMkFycmF5LmZyb20oWzYsIDM0LCA2Ml0pLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI2LCBuZXcgRUNCXzEuZGVmYXVsdCg0LCAxMDcpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyMiwgbmV3IEVDQl8xLmRlZmF1bHQoOCwgMzcpLCBuZXcgRUNCXzEuZGVmYXVsdCgxLCAzOCkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI0LCBuZXcgRUNCXzEuZGVmYXVsdCg4LCAyMCksIG5ldyBFQ0JfMS5kZWZhdWx0KDQsIDIxKSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjIsIG5ldyBFQ0JfMS5kZWZhdWx0KDEyLCAxMSksIG5ldyBFQ0JfMS5kZWZhdWx0KDQsIDEyKSkpLAoJICAgICAgICBuZXcgVmVyc2lvbigxNCwgSW50MzJBcnJheS5mcm9tKFs2LCAyNiwgNDYsIDY2XSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMzAsIG5ldyBFQ0JfMS5kZWZhdWx0KDMsIDExNSksIG5ldyBFQ0JfMS5kZWZhdWx0KDEsIDExNikpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI0LCBuZXcgRUNCXzEuZGVmYXVsdCg0LCA0MCksIG5ldyBFQ0JfMS5kZWZhdWx0KDUsIDQxKSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjAsIG5ldyBFQ0JfMS5kZWZhdWx0KDExLCAxNiksIG5ldyBFQ0JfMS5kZWZhdWx0KDUsIDE3KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjQsIG5ldyBFQ0JfMS5kZWZhdWx0KDExLCAxMiksIG5ldyBFQ0JfMS5kZWZhdWx0KDUsIDEzKSkpLAoJICAgICAgICBuZXcgVmVyc2lvbigxNSwgSW50MzJBcnJheS5mcm9tKFs2LCAyNiwgNDgsIDcwXSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjIsIG5ldyBFQ0JfMS5kZWZhdWx0KDUsIDg3KSwgbmV3IEVDQl8xLmRlZmF1bHQoMSwgODgpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyNCwgbmV3IEVDQl8xLmRlZmF1bHQoNSwgNDEpLCBuZXcgRUNCXzEuZGVmYXVsdCg1LCA0MikpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDMwLCBuZXcgRUNCXzEuZGVmYXVsdCg1LCAyNCksIG5ldyBFQ0JfMS5kZWZhdWx0KDcsIDI1KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjQsIG5ldyBFQ0JfMS5kZWZhdWx0KDExLCAxMiksIG5ldyBFQ0JfMS5kZWZhdWx0KDcsIDEzKSkpLAoJICAgICAgICBuZXcgVmVyc2lvbigxNiwgSW50MzJBcnJheS5mcm9tKFs2LCAyNiwgNTAsIDc0XSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjQsIG5ldyBFQ0JfMS5kZWZhdWx0KDUsIDk4KSwgbmV3IEVDQl8xLmRlZmF1bHQoMSwgOTkpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyOCwgbmV3IEVDQl8xLmRlZmF1bHQoNywgNDUpLCBuZXcgRUNCXzEuZGVmYXVsdCgzLCA0NikpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI0LCBuZXcgRUNCXzEuZGVmYXVsdCgxNSwgMTkpLCBuZXcgRUNCXzEuZGVmYXVsdCgyLCAyMCkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDMwLCBuZXcgRUNCXzEuZGVmYXVsdCgzLCAxNSksIG5ldyBFQ0JfMS5kZWZhdWx0KDEzLCAxNikpKSwKCSAgICAgICAgbmV3IFZlcnNpb24oMTcsIEludDMyQXJyYXkuZnJvbShbNiwgMzAsIDU0LCA3OF0pLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI4LCBuZXcgRUNCXzEuZGVmYXVsdCgxLCAxMDcpLCBuZXcgRUNCXzEuZGVmYXVsdCg1LCAxMDgpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyOCwgbmV3IEVDQl8xLmRlZmF1bHQoMTAsIDQ2KSwgbmV3IEVDQl8xLmRlZmF1bHQoMSwgNDcpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyOCwgbmV3IEVDQl8xLmRlZmF1bHQoMSwgMjIpLCBuZXcgRUNCXzEuZGVmYXVsdCgxNSwgMjMpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyOCwgbmV3IEVDQl8xLmRlZmF1bHQoMiwgMTQpLCBuZXcgRUNCXzEuZGVmYXVsdCgxNywgMTUpKSksCgkgICAgICAgIG5ldyBWZXJzaW9uKDE4LCBJbnQzMkFycmF5LmZyb20oWzYsIDMwLCA1NiwgODJdKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoNSwgMTIwKSwgbmV3IEVDQl8xLmRlZmF1bHQoMSwgMTIxKSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjYsIG5ldyBFQ0JfMS5kZWZhdWx0KDksIDQzKSwgbmV3IEVDQl8xLmRlZmF1bHQoNCwgNDQpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyOCwgbmV3IEVDQl8xLmRlZmF1bHQoMTcsIDIyKSwgbmV3IEVDQl8xLmRlZmF1bHQoMSwgMjMpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyOCwgbmV3IEVDQl8xLmRlZmF1bHQoMiwgMTQpLCBuZXcgRUNCXzEuZGVmYXVsdCgxOSwgMTUpKSksCgkgICAgICAgIG5ldyBWZXJzaW9uKDE5LCBJbnQzMkFycmF5LmZyb20oWzYsIDMwLCA1OCwgODZdKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyOCwgbmV3IEVDQl8xLmRlZmF1bHQoMywgMTEzKSwgbmV3IEVDQl8xLmRlZmF1bHQoNCwgMTE0KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjYsIG5ldyBFQ0JfMS5kZWZhdWx0KDMsIDQ0KSwgbmV3IEVDQl8xLmRlZmF1bHQoMTEsIDQ1KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjYsIG5ldyBFQ0JfMS5kZWZhdWx0KDE3LCAyMSksIG5ldyBFQ0JfMS5kZWZhdWx0KDQsIDIyKSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjYsIG5ldyBFQ0JfMS5kZWZhdWx0KDksIDEzKSwgbmV3IEVDQl8xLmRlZmF1bHQoMTYsIDE0KSkpLAoJICAgICAgICBuZXcgVmVyc2lvbigyMCwgSW50MzJBcnJheS5mcm9tKFs2LCAzNCwgNjIsIDkwXSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjgsIG5ldyBFQ0JfMS5kZWZhdWx0KDMsIDEwNyksIG5ldyBFQ0JfMS5kZWZhdWx0KDUsIDEwOCkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI2LCBuZXcgRUNCXzEuZGVmYXVsdCgzLCA0MSksIG5ldyBFQ0JfMS5kZWZhdWx0KDEzLCA0MikpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDMwLCBuZXcgRUNCXzEuZGVmYXVsdCgxNSwgMjQpLCBuZXcgRUNCXzEuZGVmYXVsdCg1LCAyNSkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI4LCBuZXcgRUNCXzEuZGVmYXVsdCgxNSwgMTUpLCBuZXcgRUNCXzEuZGVmYXVsdCgxMCwgMTYpKSksCgkgICAgICAgIG5ldyBWZXJzaW9uKDIxLCBJbnQzMkFycmF5LmZyb20oWzYsIDI4LCA1MCwgNzIsIDk0XSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjgsIG5ldyBFQ0JfMS5kZWZhdWx0KDQsIDExNiksIG5ldyBFQ0JfMS5kZWZhdWx0KDQsIDExNykpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI2LCBuZXcgRUNCXzEuZGVmYXVsdCgxNywgNDIpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyOCwgbmV3IEVDQl8xLmRlZmF1bHQoMTcsIDIyKSwgbmV3IEVDQl8xLmRlZmF1bHQoNiwgMjMpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoMTksIDE2KSwgbmV3IEVDQl8xLmRlZmF1bHQoNiwgMTcpKSksCgkgICAgICAgIG5ldyBWZXJzaW9uKDIyLCBJbnQzMkFycmF5LmZyb20oWzYsIDI2LCA1MCwgNzQsIDk4XSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjgsIG5ldyBFQ0JfMS5kZWZhdWx0KDIsIDExMSksIG5ldyBFQ0JfMS5kZWZhdWx0KDcsIDExMikpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI4LCBuZXcgRUNCXzEuZGVmYXVsdCgxNywgNDYpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoNywgMjQpLCBuZXcgRUNCXzEuZGVmYXVsdCgxNiwgMjUpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyNCwgbmV3IEVDQl8xLmRlZmF1bHQoMzQsIDEzKSkpLAoJICAgICAgICBuZXcgVmVyc2lvbigyMywgSW50MzJBcnJheS5mcm9tKFs2LCAzMCwgNTQsIDc4LCAxMDJdKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoNCwgMTIxKSwgbmV3IEVDQl8xLmRlZmF1bHQoNSwgMTIyKSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjgsIG5ldyBFQ0JfMS5kZWZhdWx0KDQsIDQ3KSwgbmV3IEVDQl8xLmRlZmF1bHQoMTQsIDQ4KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMzAsIG5ldyBFQ0JfMS5kZWZhdWx0KDExLCAyNCksIG5ldyBFQ0JfMS5kZWZhdWx0KDE0LCAyNSkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDMwLCBuZXcgRUNCXzEuZGVmYXVsdCgxNiwgMTUpLCBuZXcgRUNCXzEuZGVmYXVsdCgxNCwgMTYpKSksCgkgICAgICAgIG5ldyBWZXJzaW9uKDI0LCBJbnQzMkFycmF5LmZyb20oWzYsIDI4LCA1NCwgODAsIDEwNl0pLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDMwLCBuZXcgRUNCXzEuZGVmYXVsdCg2LCAxMTcpLCBuZXcgRUNCXzEuZGVmYXVsdCg0LCAxMTgpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyOCwgbmV3IEVDQl8xLmRlZmF1bHQoNiwgNDUpLCBuZXcgRUNCXzEuZGVmYXVsdCgxNCwgNDYpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoMTEsIDI0KSwgbmV3IEVDQl8xLmRlZmF1bHQoMTYsIDI1KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMzAsIG5ldyBFQ0JfMS5kZWZhdWx0KDMwLCAxNiksIG5ldyBFQ0JfMS5kZWZhdWx0KDIsIDE3KSkpLAoJICAgICAgICBuZXcgVmVyc2lvbigyNSwgSW50MzJBcnJheS5mcm9tKFs2LCAzMiwgNTgsIDg0LCAxMTBdKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyNiwgbmV3IEVDQl8xLmRlZmF1bHQoOCwgMTA2KSwgbmV3IEVDQl8xLmRlZmF1bHQoNCwgMTA3KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjgsIG5ldyBFQ0JfMS5kZWZhdWx0KDgsIDQ3KSwgbmV3IEVDQl8xLmRlZmF1bHQoMTMsIDQ4KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMzAsIG5ldyBFQ0JfMS5kZWZhdWx0KDcsIDI0KSwgbmV3IEVDQl8xLmRlZmF1bHQoMjIsIDI1KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMzAsIG5ldyBFQ0JfMS5kZWZhdWx0KDIyLCAxNSksIG5ldyBFQ0JfMS5kZWZhdWx0KDEzLCAxNikpKSwKCSAgICAgICAgbmV3IFZlcnNpb24oMjYsIEludDMyQXJyYXkuZnJvbShbNiwgMzAsIDU4LCA4NiwgMTE0XSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjgsIG5ldyBFQ0JfMS5kZWZhdWx0KDEwLCAxMTQpLCBuZXcgRUNCXzEuZGVmYXVsdCgyLCAxMTUpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyOCwgbmV3IEVDQl8xLmRlZmF1bHQoMTksIDQ2KSwgbmV3IEVDQl8xLmRlZmF1bHQoNCwgNDcpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyOCwgbmV3IEVDQl8xLmRlZmF1bHQoMjgsIDIyKSwgbmV3IEVDQl8xLmRlZmF1bHQoNiwgMjMpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoMzMsIDE2KSwgbmV3IEVDQl8xLmRlZmF1bHQoNCwgMTcpKSksCgkgICAgICAgIG5ldyBWZXJzaW9uKDI3LCBJbnQzMkFycmF5LmZyb20oWzYsIDM0LCA2MiwgOTAsIDExOF0pLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDMwLCBuZXcgRUNCXzEuZGVmYXVsdCg4LCAxMjIpLCBuZXcgRUNCXzEuZGVmYXVsdCg0LCAxMjMpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyOCwgbmV3IEVDQl8xLmRlZmF1bHQoMjIsIDQ1KSwgbmV3IEVDQl8xLmRlZmF1bHQoMywgNDYpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoOCwgMjMpLCBuZXcgRUNCXzEuZGVmYXVsdCgyNiwgMjQpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoMTIsIDE1KSwgbmV3IEVDQl8xLmRlZmF1bHQoMjgsIDE2KSkpLAoJICAgICAgICBuZXcgVmVyc2lvbigyOCwgSW50MzJBcnJheS5mcm9tKFs2LCAyNiwgNTAsIDc0LCA5OCwgMTIyXSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMzAsIG5ldyBFQ0JfMS5kZWZhdWx0KDMsIDExNyksIG5ldyBFQ0JfMS5kZWZhdWx0KDEwLCAxMTgpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyOCwgbmV3IEVDQl8xLmRlZmF1bHQoMywgNDUpLCBuZXcgRUNCXzEuZGVmYXVsdCgyMywgNDYpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoNCwgMjQpLCBuZXcgRUNCXzEuZGVmYXVsdCgzMSwgMjUpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoMTEsIDE1KSwgbmV3IEVDQl8xLmRlZmF1bHQoMzEsIDE2KSkpLAoJICAgICAgICBuZXcgVmVyc2lvbigyOSwgSW50MzJBcnJheS5mcm9tKFs2LCAzMCwgNTQsIDc4LCAxMDIsIDEyNl0pLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDMwLCBuZXcgRUNCXzEuZGVmYXVsdCg3LCAxMTYpLCBuZXcgRUNCXzEuZGVmYXVsdCg3LCAxMTcpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyOCwgbmV3IEVDQl8xLmRlZmF1bHQoMjEsIDQ1KSwgbmV3IEVDQl8xLmRlZmF1bHQoNywgNDYpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoMSwgMjMpLCBuZXcgRUNCXzEuZGVmYXVsdCgzNywgMjQpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoMTksIDE1KSwgbmV3IEVDQl8xLmRlZmF1bHQoMjYsIDE2KSkpLAoJICAgICAgICBuZXcgVmVyc2lvbigzMCwgSW50MzJBcnJheS5mcm9tKFs2LCAyNiwgNTIsIDc4LCAxMDQsIDEzMF0pLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDMwLCBuZXcgRUNCXzEuZGVmYXVsdCg1LCAxMTUpLCBuZXcgRUNCXzEuZGVmYXVsdCgxMCwgMTE2KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjgsIG5ldyBFQ0JfMS5kZWZhdWx0KDE5LCA0NyksIG5ldyBFQ0JfMS5kZWZhdWx0KDEwLCA0OCkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDMwLCBuZXcgRUNCXzEuZGVmYXVsdCgxNSwgMjQpLCBuZXcgRUNCXzEuZGVmYXVsdCgyNSwgMjUpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoMjMsIDE1KSwgbmV3IEVDQl8xLmRlZmF1bHQoMjUsIDE2KSkpLAoJICAgICAgICBuZXcgVmVyc2lvbigzMSwgSW50MzJBcnJheS5mcm9tKFs2LCAzMCwgNTYsIDgyLCAxMDgsIDEzNF0pLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDMwLCBuZXcgRUNCXzEuZGVmYXVsdCgxMywgMTE1KSwgbmV3IEVDQl8xLmRlZmF1bHQoMywgMTE2KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjgsIG5ldyBFQ0JfMS5kZWZhdWx0KDIsIDQ2KSwgbmV3IEVDQl8xLmRlZmF1bHQoMjksIDQ3KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMzAsIG5ldyBFQ0JfMS5kZWZhdWx0KDQyLCAyNCksIG5ldyBFQ0JfMS5kZWZhdWx0KDEsIDI1KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMzAsIG5ldyBFQ0JfMS5kZWZhdWx0KDIzLCAxNSksIG5ldyBFQ0JfMS5kZWZhdWx0KDI4LCAxNikpKSwKCSAgICAgICAgbmV3IFZlcnNpb24oMzIsIEludDMyQXJyYXkuZnJvbShbNiwgMzQsIDYwLCA4NiwgMTEyLCAxMzhdKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoMTcsIDExNSkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI4LCBuZXcgRUNCXzEuZGVmYXVsdCgxMCwgNDYpLCBuZXcgRUNCXzEuZGVmYXVsdCgyMywgNDcpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoMTAsIDI0KSwgbmV3IEVDQl8xLmRlZmF1bHQoMzUsIDI1KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMzAsIG5ldyBFQ0JfMS5kZWZhdWx0KDE5LCAxNSksIG5ldyBFQ0JfMS5kZWZhdWx0KDM1LCAxNikpKSwKCSAgICAgICAgbmV3IFZlcnNpb24oMzMsIEludDMyQXJyYXkuZnJvbShbNiwgMzAsIDU4LCA4NiwgMTE0LCAxNDJdKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoMTcsIDExNSksIG5ldyBFQ0JfMS5kZWZhdWx0KDEsIDExNikpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI4LCBuZXcgRUNCXzEuZGVmYXVsdCgxNCwgNDYpLCBuZXcgRUNCXzEuZGVmYXVsdCgyMSwgNDcpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoMjksIDI0KSwgbmV3IEVDQl8xLmRlZmF1bHQoMTksIDI1KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMzAsIG5ldyBFQ0JfMS5kZWZhdWx0KDExLCAxNSksIG5ldyBFQ0JfMS5kZWZhdWx0KDQ2LCAxNikpKSwKCSAgICAgICAgbmV3IFZlcnNpb24oMzQsIEludDMyQXJyYXkuZnJvbShbNiwgMzQsIDYyLCA5MCwgMTE4LCAxNDZdKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoMTMsIDExNSksIG5ldyBFQ0JfMS5kZWZhdWx0KDYsIDExNikpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI4LCBuZXcgRUNCXzEuZGVmYXVsdCgxNCwgNDYpLCBuZXcgRUNCXzEuZGVmYXVsdCgyMywgNDcpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoNDQsIDI0KSwgbmV3IEVDQl8xLmRlZmF1bHQoNywgMjUpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoNTksIDE2KSwgbmV3IEVDQl8xLmRlZmF1bHQoMSwgMTcpKSksCgkgICAgICAgIG5ldyBWZXJzaW9uKDM1LCBJbnQzMkFycmF5LmZyb20oWzYsIDMwLCA1NCwgNzgsIDEwMiwgMTI2LCAxNTBdKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoMTIsIDEyMSksIG5ldyBFQ0JfMS5kZWZhdWx0KDcsIDEyMikpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI4LCBuZXcgRUNCXzEuZGVmYXVsdCgxMiwgNDcpLCBuZXcgRUNCXzEuZGVmYXVsdCgyNiwgNDgpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoMzksIDI0KSwgbmV3IEVDQl8xLmRlZmF1bHQoMTQsIDI1KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMzAsIG5ldyBFQ0JfMS5kZWZhdWx0KDIyLCAxNSksIG5ldyBFQ0JfMS5kZWZhdWx0KDQxLCAxNikpKSwKCSAgICAgICAgbmV3IFZlcnNpb24oMzYsIEludDMyQXJyYXkuZnJvbShbNiwgMjQsIDUwLCA3NiwgMTAyLCAxMjgsIDE1NF0pLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDMwLCBuZXcgRUNCXzEuZGVmYXVsdCg2LCAxMjEpLCBuZXcgRUNCXzEuZGVmYXVsdCgxNCwgMTIyKSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjgsIG5ldyBFQ0JfMS5kZWZhdWx0KDYsIDQ3KSwgbmV3IEVDQl8xLmRlZmF1bHQoMzQsIDQ4KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMzAsIG5ldyBFQ0JfMS5kZWZhdWx0KDQ2LCAyNCksIG5ldyBFQ0JfMS5kZWZhdWx0KDEwLCAyNSkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDMwLCBuZXcgRUNCXzEuZGVmYXVsdCgyLCAxNSksIG5ldyBFQ0JfMS5kZWZhdWx0KDY0LCAxNikpKSwKCSAgICAgICAgbmV3IFZlcnNpb24oMzcsIEludDMyQXJyYXkuZnJvbShbNiwgMjgsIDU0LCA4MCwgMTA2LCAxMzIsIDE1OF0pLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDMwLCBuZXcgRUNCXzEuZGVmYXVsdCgxNywgMTIyKSwgbmV3IEVDQl8xLmRlZmF1bHQoNCwgMTIzKSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjgsIG5ldyBFQ0JfMS5kZWZhdWx0KDI5LCA0NiksIG5ldyBFQ0JfMS5kZWZhdWx0KDE0LCA0NykpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDMwLCBuZXcgRUNCXzEuZGVmYXVsdCg0OSwgMjQpLCBuZXcgRUNCXzEuZGVmYXVsdCgxMCwgMjUpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoMjQsIDE1KSwgbmV3IEVDQl8xLmRlZmF1bHQoNDYsIDE2KSkpLAoJICAgICAgICBuZXcgVmVyc2lvbigzOCwgSW50MzJBcnJheS5mcm9tKFs2LCAzMiwgNTgsIDg0LCAxMTAsIDEzNiwgMTYyXSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMzAsIG5ldyBFQ0JfMS5kZWZhdWx0KDQsIDEyMiksIG5ldyBFQ0JfMS5kZWZhdWx0KDE4LCAxMjMpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyOCwgbmV3IEVDQl8xLmRlZmF1bHQoMTMsIDQ2KSwgbmV3IEVDQl8xLmRlZmF1bHQoMzIsIDQ3KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMzAsIG5ldyBFQ0JfMS5kZWZhdWx0KDQ4LCAyNCksIG5ldyBFQ0JfMS5kZWZhdWx0KDE0LCAyNSkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDMwLCBuZXcgRUNCXzEuZGVmYXVsdCg0MiwgMTUpLCBuZXcgRUNCXzEuZGVmYXVsdCgzMiwgMTYpKSksCgkgICAgICAgIG5ldyBWZXJzaW9uKDM5LCBJbnQzMkFycmF5LmZyb20oWzYsIDI2LCA1NCwgODIsIDExMCwgMTM4LCAxNjZdKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoMjAsIDExNyksIG5ldyBFQ0JfMS5kZWZhdWx0KDQsIDExOCkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI4LCBuZXcgRUNCXzEuZGVmYXVsdCg0MCwgNDcpLCBuZXcgRUNCXzEuZGVmYXVsdCg3LCA0OCkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDMwLCBuZXcgRUNCXzEuZGVmYXVsdCg0MywgMjQpLCBuZXcgRUNCXzEuZGVmYXVsdCgyMiwgMjUpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoMTAsIDE1KSwgbmV3IEVDQl8xLmRlZmF1bHQoNjcsIDE2KSkpLAoJICAgICAgICBuZXcgVmVyc2lvbig0MCwgSW50MzJBcnJheS5mcm9tKFs2LCAzMCwgNTgsIDg2LCAxMTQsIDE0MiwgMTcwXSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMzAsIG5ldyBFQ0JfMS5kZWZhdWx0KDE5LCAxMTgpLCBuZXcgRUNCXzEuZGVmYXVsdCg2LCAxMTkpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyOCwgbmV3IEVDQl8xLmRlZmF1bHQoMTgsIDQ3KSwgbmV3IEVDQl8xLmRlZmF1bHQoMzEsIDQ4KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMzAsIG5ldyBFQ0JfMS5kZWZhdWx0KDM0LCAyNCksIG5ldyBFQ0JfMS5kZWZhdWx0KDM0LCAyNSkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDMwLCBuZXcgRUNCXzEuZGVmYXVsdCgyMCwgMTUpLCBuZXcgRUNCXzEuZGVmYXVsdCg2MSwgMTYpKSkKCSAgICBdOwoJICAgIHJldHVybiBWZXJzaW9uOwoJfSgpKTsKCVZlcnNpb24kMS5kZWZhdWx0ID0gVmVyc2lvbjsKCgl2YXIgRGF0YU1hc2sgPSB7fTsKCgkoZnVuY3Rpb24gKGV4cG9ydHMpIHsKCS8qCgkgKiBDb3B5cmlnaHQgMjAwNyBaWGluZyBhdXRob3JzCgkgKgoJICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIik7CgkgKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCgkgKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKCSAqCgkgKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAoJICoKCSAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKCSAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCgkgKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4KCSAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKCSAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgoJICovCglPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJZXhwb3J0cy5EYXRhTWFza1ZhbHVlcyA9IHZvaWQgMDsKCXZhciBEYXRhTWFza1ZhbHVlczsKCShmdW5jdGlvbiAoRGF0YU1hc2tWYWx1ZXMpIHsKCSAgICBEYXRhTWFza1ZhbHVlc1tEYXRhTWFza1ZhbHVlc1siREFUQV9NQVNLXzAwMCJdID0gMF0gPSAiREFUQV9NQVNLXzAwMCI7CgkgICAgRGF0YU1hc2tWYWx1ZXNbRGF0YU1hc2tWYWx1ZXNbIkRBVEFfTUFTS18wMDEiXSA9IDFdID0gIkRBVEFfTUFTS18wMDEiOwoJICAgIERhdGFNYXNrVmFsdWVzW0RhdGFNYXNrVmFsdWVzWyJEQVRBX01BU0tfMDEwIl0gPSAyXSA9ICJEQVRBX01BU0tfMDEwIjsKCSAgICBEYXRhTWFza1ZhbHVlc1tEYXRhTWFza1ZhbHVlc1siREFUQV9NQVNLXzAxMSJdID0gM10gPSAiREFUQV9NQVNLXzAxMSI7CgkgICAgRGF0YU1hc2tWYWx1ZXNbRGF0YU1hc2tWYWx1ZXNbIkRBVEFfTUFTS18xMDAiXSA9IDRdID0gIkRBVEFfTUFTS18xMDAiOwoJICAgIERhdGFNYXNrVmFsdWVzW0RhdGFNYXNrVmFsdWVzWyJEQVRBX01BU0tfMTAxIl0gPSA1XSA9ICJEQVRBX01BU0tfMTAxIjsKCSAgICBEYXRhTWFza1ZhbHVlc1tEYXRhTWFza1ZhbHVlc1siREFUQV9NQVNLXzExMCJdID0gNl0gPSAiREFUQV9NQVNLXzExMCI7CgkgICAgRGF0YU1hc2tWYWx1ZXNbRGF0YU1hc2tWYWx1ZXNbIkRBVEFfTUFTS18xMTEiXSA9IDddID0gIkRBVEFfTUFTS18xMTEiOwoJfSkoRGF0YU1hc2tWYWx1ZXMgPSBleHBvcnRzLkRhdGFNYXNrVmFsdWVzIHx8IChleHBvcnRzLkRhdGFNYXNrVmFsdWVzID0ge30pKTsKCS8qKgoJICogPHA+RW5jYXBzdWxhdGVzIGRhdGEgbWFza3MgZm9yIHRoZSBkYXRhIGJpdHMgaW4gYSBRUiBjb2RlLCBwZXIgSVNPIDE4MDA0OjIwMDYgNi44LiBJbXBsZW1lbnRhdGlvbnMKCSAqIG9mIHRoaXMgY2xhc3MgY2FuIHVuLW1hc2sgYSByYXcgQml0TWF0cml4LiBGb3Igc2ltcGxpY2l0eSwgdGhleSB3aWxsIHVubWFzayB0aGUgZW50aXJlIEJpdE1hdHJpeCwKCSAqIGluY2x1ZGluZyBhcmVhcyB1c2VkIGZvciBmaW5kZXIgcGF0dGVybnMsIHRpbWluZyBwYXR0ZXJucywgZXRjLiBUaGVzZSBhcmVhcyBzaG91bGQgYmUgdW51c2VkCgkgKiBhZnRlciB0aGUgcG9pbnQgdGhleSBhcmUgdW5tYXNrZWQgYW55d2F5LjwvcD4KCSAqCgkgKiA8cD5Ob3RlIHRoYXQgdGhlIGRpYWdyYW0gaW4gc2VjdGlvbiA2LjguMSBpcyBtaXNsZWFkaW5nIHNpbmNlIGl0IGluZGljYXRlcyB0aGF0IGkgaXMgY29sdW1uIHBvc2l0aW9uCgkgKiBhbmQgaiBpcyByb3cgcG9zaXRpb24uIEluIGZhY3QsIGFzIHRoZSB0ZXh0IHNheXMsIGkgaXMgcm93IHBvc2l0aW9uIGFuZCBqIGlzIGNvbHVtbiBwb3NpdGlvbi48L3A+CgkgKgoJICogQGF1dGhvciBTZWFuIE93ZW4KCSAqLwoJdmFyIERhdGFNYXNrID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkgewoJICAgIC8vIFNlZSBJU08gMTgwMDQ6MjAwNiA2LjguMQoJICAgIGZ1bmN0aW9uIERhdGFNYXNrKHZhbHVlLCBpc01hc2tlZCkgewoJICAgICAgICB0aGlzLnZhbHVlID0gdmFsdWU7CgkgICAgICAgIHRoaXMuaXNNYXNrZWQgPSBpc01hc2tlZDsKCSAgICB9CgkgICAgLy8gRW5kIG9mIGVudW0gY29uc3RhbnRzLgoJICAgIC8qKgoJICAgICAqIDxwPkltcGxlbWVudGF0aW9ucyBvZiB0aGlzIG1ldGhvZCByZXZlcnNlIHRoZSBkYXRhIG1hc2tpbmcgcHJvY2VzcyBhcHBsaWVkIHRvIGEgUVIgQ29kZSBhbmQKCSAgICAgKiBtYWtlIGl0cyBiaXRzIHJlYWR5IHRvIHJlYWQuPC9wPgoJICAgICAqCgkgICAgICogQHBhcmFtIGJpdHMgcmVwcmVzZW50YXRpb24gb2YgUVIgQ29kZSBiaXRzCgkgICAgICogQHBhcmFtIGRpbWVuc2lvbiBkaW1lbnNpb24gb2YgUVIgQ29kZSwgcmVwcmVzZW50ZWQgYnkgYml0cywgYmVpbmcgdW5tYXNrZWQKCSAgICAgKi8KCSAgICBEYXRhTWFzay5wcm90b3R5cGUudW5tYXNrQml0TWF0cml4ID0gZnVuY3Rpb24gKGJpdHMsIGRpbWVuc2lvbiAvKmludCovKSB7CgkgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgZGltZW5zaW9uOyBpKyspIHsKCSAgICAgICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgZGltZW5zaW9uOyBqKyspIHsKCSAgICAgICAgICAgICAgICBpZiAodGhpcy5pc01hc2tlZChpLCBqKSkgewoJICAgICAgICAgICAgICAgICAgICBiaXRzLmZsaXAoaiwgaSk7CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgfTsKCSAgICBEYXRhTWFzay52YWx1ZXMgPSBuZXcgTWFwKFsKCSAgICAgICAgLyoqCgkgICAgICAgICAqIDAwMDogbWFzayBiaXRzIGZvciB3aGljaCAoeCArIHkpIG1vZCAyID09IDAKCSAgICAgICAgICovCgkgICAgICAgIFtEYXRhTWFza1ZhbHVlcy5EQVRBX01BU0tfMDAwLCBuZXcgRGF0YU1hc2soRGF0YU1hc2tWYWx1ZXMuREFUQV9NQVNLXzAwMCwgZnVuY3Rpb24gKGkgLyppbnQqLywgaiAvKmludCovKSB7IHJldHVybiAoKGkgKyBqKSAmIDB4MDEpID09PSAwOyB9KV0sCgkgICAgICAgIC8qKgoJICAgICAgICAgKiAwMDE6IG1hc2sgYml0cyBmb3Igd2hpY2ggeCBtb2QgMiA9PSAwCgkgICAgICAgICAqLwoJICAgICAgICBbRGF0YU1hc2tWYWx1ZXMuREFUQV9NQVNLXzAwMSwgbmV3IERhdGFNYXNrKERhdGFNYXNrVmFsdWVzLkRBVEFfTUFTS18wMDEsIGZ1bmN0aW9uIChpIC8qaW50Ki8sIGogLyppbnQqLykgeyByZXR1cm4gKGkgJiAweDAxKSA9PT0gMDsgfSldLAoJICAgICAgICAvKioKCSAgICAgICAgICogMDEwOiBtYXNrIGJpdHMgZm9yIHdoaWNoIHkgbW9kIDMgPT0gMAoJICAgICAgICAgKi8KCSAgICAgICAgW0RhdGFNYXNrVmFsdWVzLkRBVEFfTUFTS18wMTAsIG5ldyBEYXRhTWFzayhEYXRhTWFza1ZhbHVlcy5EQVRBX01BU0tfMDEwLCBmdW5jdGlvbiAoaSAvKmludCovLCBqIC8qaW50Ki8pIHsgcmV0dXJuIGogJSAzID09PSAwOyB9KV0sCgkgICAgICAgIC8qKgoJICAgICAgICAgKiAwMTE6IG1hc2sgYml0cyBmb3Igd2hpY2ggKHggKyB5KSBtb2QgMyA9PSAwCgkgICAgICAgICAqLwoJICAgICAgICBbRGF0YU1hc2tWYWx1ZXMuREFUQV9NQVNLXzAxMSwgbmV3IERhdGFNYXNrKERhdGFNYXNrVmFsdWVzLkRBVEFfTUFTS18wMTEsIGZ1bmN0aW9uIChpIC8qaW50Ki8sIGogLyppbnQqLykgeyByZXR1cm4gKGkgKyBqKSAlIDMgPT09IDA7IH0pXSwKCSAgICAgICAgLyoqCgkgICAgICAgICAqIDEwMDogbWFzayBiaXRzIGZvciB3aGljaCAoeC8yICsgeS8zKSBtb2QgMiA9PSAwCgkgICAgICAgICAqLwoJICAgICAgICBbRGF0YU1hc2tWYWx1ZXMuREFUQV9NQVNLXzEwMCwgbmV3IERhdGFNYXNrKERhdGFNYXNrVmFsdWVzLkRBVEFfTUFTS18xMDAsIGZ1bmN0aW9uIChpIC8qaW50Ki8sIGogLyppbnQqLykgeyByZXR1cm4gKChNYXRoLmZsb29yKGkgLyAyKSArIE1hdGguZmxvb3IoaiAvIDMpKSAmIDB4MDEpID09PSAwOyB9KV0sCgkgICAgICAgIC8qKgoJICAgICAgICAgKiAxMDE6IG1hc2sgYml0cyBmb3Igd2hpY2ggeHkgbW9kIDIgKyB4eSBtb2QgMyA9PSAwCgkgICAgICAgICAqIGVxdWl2YWxlbnRseSwgc3VjaCB0aGF0IHh5IG1vZCA2ID09IDAKCSAgICAgICAgICovCgkgICAgICAgIFtEYXRhTWFza1ZhbHVlcy5EQVRBX01BU0tfMTAxLCBuZXcgRGF0YU1hc2soRGF0YU1hc2tWYWx1ZXMuREFUQV9NQVNLXzEwMSwgZnVuY3Rpb24gKGkgLyppbnQqLywgaiAvKmludCovKSB7IHJldHVybiAoaSAqIGopICUgNiA9PT0gMDsgfSldLAoJICAgICAgICAvKioKCSAgICAgICAgICogMTEwOiBtYXNrIGJpdHMgZm9yIHdoaWNoICh4eSBtb2QgMiArIHh5IG1vZCAzKSBtb2QgMiA9PSAwCgkgICAgICAgICAqIGVxdWl2YWxlbnRseSwgc3VjaCB0aGF0IHh5IG1vZCA2IDwgMwoJICAgICAgICAgKi8KCSAgICAgICAgW0RhdGFNYXNrVmFsdWVzLkRBVEFfTUFTS18xMTAsIG5ldyBEYXRhTWFzayhEYXRhTWFza1ZhbHVlcy5EQVRBX01BU0tfMTEwLCBmdW5jdGlvbiAoaSAvKmludCovLCBqIC8qaW50Ki8pIHsgcmV0dXJuICgoaSAqIGopICUgNikgPCAzOyB9KV0sCgkgICAgICAgIC8qKgoJICAgICAgICAgKiAxMTE6IG1hc2sgYml0cyBmb3Igd2hpY2ggKCh4K3kpbW9kIDIgKyB4eSBtb2QgMykgbW9kIDIgPT0gMAoJICAgICAgICAgKiBlcXVpdmFsZW50bHksIHN1Y2ggdGhhdCAoeCArIHkgKyB4eSBtb2QgMykgbW9kIDIgPT0gMAoJICAgICAgICAgKi8KCSAgICAgICAgW0RhdGFNYXNrVmFsdWVzLkRBVEFfTUFTS18xMTEsIG5ldyBEYXRhTWFzayhEYXRhTWFza1ZhbHVlcy5EQVRBX01BU0tfMTExLCBmdW5jdGlvbiAoaSAvKmludCovLCBqIC8qaW50Ki8pIHsgcmV0dXJuICgoaSArIGogKyAoKGkgKiBqKSAlIDMpKSAmIDB4MDEpID09PSAwOyB9KV0sCgkgICAgXSk7CgkgICAgcmV0dXJuIERhdGFNYXNrOwoJfSgpKTsKCWV4cG9ydHMuZGVmYXVsdCA9IERhdGFNYXNrOwoKCX0oRGF0YU1hc2spKTsKCgkvKgoJICogQ29weXJpZ2h0IDIwMDcgWlhpbmcgYXV0aG9ycwoJICoKCSAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoJICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoJICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkgKgoJICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKCSAqCgkgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCgkgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoJICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCgkgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCSAqLwoJT2JqZWN0LmRlZmluZVByb3BlcnR5KEJpdE1hdHJpeFBhcnNlciQxLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7Cgl2YXIgVmVyc2lvbl8xJDEgPSBWZXJzaW9uJDE7Cgl2YXIgRm9ybWF0SW5mb3JtYXRpb25fMSA9IEZvcm1hdEluZm9ybWF0aW9uJDE7Cgl2YXIgRGF0YU1hc2tfMSA9IERhdGFNYXNrOwoJdmFyIEZvcm1hdEV4Y2VwdGlvbl8xJDEgPSBGb3JtYXRFeGNlcHRpb24kMTsKCS8qKgoJICogQGF1dGhvciBTZWFuIE93ZW4KCSAqLwoJdmFyIEJpdE1hdHJpeFBhcnNlciA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHsKCSAgICAvKioKCSAgICAgKiBAcGFyYW0gYml0TWF0cml4IHtAbGluayBCaXRNYXRyaXh9IHRvIHBhcnNlCgkgICAgICogQHRocm93cyBGb3JtYXRFeGNlcHRpb24gaWYgZGltZW5zaW9uIGlzIG5vdCA+PSAyMSBhbmQgMSBtb2QgNAoJICAgICAqLwoJICAgIGZ1bmN0aW9uIEJpdE1hdHJpeFBhcnNlcihiaXRNYXRyaXgpIHsKCSAgICAgICAgdmFyIGRpbWVuc2lvbiA9IGJpdE1hdHJpeC5nZXRIZWlnaHQoKTsKCSAgICAgICAgaWYgKGRpbWVuc2lvbiA8IDIxIHx8IChkaW1lbnNpb24gJiAweDAzKSAhPT0gMSkgewoJICAgICAgICAgICAgdGhyb3cgbmV3IEZvcm1hdEV4Y2VwdGlvbl8xJDEuZGVmYXVsdCgpOwoJICAgICAgICB9CgkgICAgICAgIHRoaXMuYml0TWF0cml4ID0gYml0TWF0cml4OwoJICAgIH0KCSAgICAvKioKCSAgICAgKiA8cD5SZWFkcyBmb3JtYXQgaW5mb3JtYXRpb24gZnJvbSBvbmUgb2YgaXRzIHR3byBsb2NhdGlvbnMgd2l0aGluIHRoZSBRUiBDb2RlLjwvcD4KCSAgICAgKgoJICAgICAqIEByZXR1cm4ge0BsaW5rIEZvcm1hdEluZm9ybWF0aW9ufSBlbmNhcHN1bGF0aW5nIHRoZSBRUiBDb2RlJ3MgZm9ybWF0IGluZm8KCSAgICAgKiBAdGhyb3dzIEZvcm1hdEV4Y2VwdGlvbiBpZiBib3RoIGZvcm1hdCBpbmZvcm1hdGlvbiBsb2NhdGlvbnMgY2Fubm90IGJlIHBhcnNlZCBhcwoJICAgICAqIHRoZSB2YWxpZCBlbmNvZGluZyBvZiBmb3JtYXQgaW5mb3JtYXRpb24KCSAgICAgKi8KCSAgICBCaXRNYXRyaXhQYXJzZXIucHJvdG90eXBlLnJlYWRGb3JtYXRJbmZvcm1hdGlvbiA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgaWYgKHRoaXMucGFyc2VkRm9ybWF0SW5mbyAhPT0gbnVsbCAmJiB0aGlzLnBhcnNlZEZvcm1hdEluZm8gIT09IHVuZGVmaW5lZCkgewoJICAgICAgICAgICAgcmV0dXJuIHRoaXMucGFyc2VkRm9ybWF0SW5mbzsKCSAgICAgICAgfQoJICAgICAgICAvLyBSZWFkIHRvcC1sZWZ0IGZvcm1hdCBpbmZvIGJpdHMKCSAgICAgICAgdmFyIGZvcm1hdEluZm9CaXRzMSA9IDA7CgkgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgNjsgaSsrKSB7CgkgICAgICAgICAgICBmb3JtYXRJbmZvQml0czEgPSB0aGlzLmNvcHlCaXQoaSwgOCwgZm9ybWF0SW5mb0JpdHMxKTsKCSAgICAgICAgfQoJICAgICAgICAvLyAuLiBhbmQgc2tpcCBhIGJpdCBpbiB0aGUgdGltaW5nIHBhdHRlcm4gLi4uCgkgICAgICAgIGZvcm1hdEluZm9CaXRzMSA9IHRoaXMuY29weUJpdCg3LCA4LCBmb3JtYXRJbmZvQml0czEpOwoJICAgICAgICBmb3JtYXRJbmZvQml0czEgPSB0aGlzLmNvcHlCaXQoOCwgOCwgZm9ybWF0SW5mb0JpdHMxKTsKCSAgICAgICAgZm9ybWF0SW5mb0JpdHMxID0gdGhpcy5jb3B5Qml0KDgsIDcsIGZvcm1hdEluZm9CaXRzMSk7CgkgICAgICAgIC8vIC4uIGFuZCBza2lwIGEgYml0IGluIHRoZSB0aW1pbmcgcGF0dGVybiAuLi4KCSAgICAgICAgZm9yICh2YXIgaiA9IDU7IGogPj0gMDsgai0tKSB7CgkgICAgICAgICAgICBmb3JtYXRJbmZvQml0czEgPSB0aGlzLmNvcHlCaXQoOCwgaiwgZm9ybWF0SW5mb0JpdHMxKTsKCSAgICAgICAgfQoJICAgICAgICAvLyBSZWFkIHRoZSB0b3AtcmlnaHQvYm90dG9tLWxlZnQgcGF0dGVybiB0b28KCSAgICAgICAgdmFyIGRpbWVuc2lvbiA9IHRoaXMuYml0TWF0cml4LmdldEhlaWdodCgpOwoJICAgICAgICB2YXIgZm9ybWF0SW5mb0JpdHMyID0gMDsKCSAgICAgICAgdmFyIGpNaW4gPSBkaW1lbnNpb24gLSA3OwoJICAgICAgICBmb3IgKHZhciBqID0gZGltZW5zaW9uIC0gMTsgaiA+PSBqTWluOyBqLS0pIHsKCSAgICAgICAgICAgIGZvcm1hdEluZm9CaXRzMiA9IHRoaXMuY29weUJpdCg4LCBqLCBmb3JtYXRJbmZvQml0czIpOwoJICAgICAgICB9CgkgICAgICAgIGZvciAodmFyIGkgPSBkaW1lbnNpb24gLSA4OyBpIDwgZGltZW5zaW9uOyBpKyspIHsKCSAgICAgICAgICAgIGZvcm1hdEluZm9CaXRzMiA9IHRoaXMuY29weUJpdChpLCA4LCBmb3JtYXRJbmZvQml0czIpOwoJICAgICAgICB9CgkgICAgICAgIHRoaXMucGFyc2VkRm9ybWF0SW5mbyA9IEZvcm1hdEluZm9ybWF0aW9uXzEuZGVmYXVsdC5kZWNvZGVGb3JtYXRJbmZvcm1hdGlvbihmb3JtYXRJbmZvQml0czEsIGZvcm1hdEluZm9CaXRzMik7CgkgICAgICAgIGlmICh0aGlzLnBhcnNlZEZvcm1hdEluZm8gIT09IG51bGwpIHsKCSAgICAgICAgICAgIHJldHVybiB0aGlzLnBhcnNlZEZvcm1hdEluZm87CgkgICAgICAgIH0KCSAgICAgICAgdGhyb3cgbmV3IEZvcm1hdEV4Y2VwdGlvbl8xJDEuZGVmYXVsdCgpOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogPHA+UmVhZHMgdmVyc2lvbiBpbmZvcm1hdGlvbiBmcm9tIG9uZSBvZiBpdHMgdHdvIGxvY2F0aW9ucyB3aXRoaW4gdGhlIFFSIENvZGUuPC9wPgoJICAgICAqCgkgICAgICogQHJldHVybiB7QGxpbmsgVmVyc2lvbn0gZW5jYXBzdWxhdGluZyB0aGUgUVIgQ29kZSdzIHZlcnNpb24KCSAgICAgKiBAdGhyb3dzIEZvcm1hdEV4Y2VwdGlvbiBpZiBib3RoIHZlcnNpb24gaW5mb3JtYXRpb24gbG9jYXRpb25zIGNhbm5vdCBiZSBwYXJzZWQgYXMKCSAgICAgKiB0aGUgdmFsaWQgZW5jb2Rpbmcgb2YgdmVyc2lvbiBpbmZvcm1hdGlvbgoJICAgICAqLwoJICAgIEJpdE1hdHJpeFBhcnNlci5wcm90b3R5cGUucmVhZFZlcnNpb24gPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIGlmICh0aGlzLnBhcnNlZFZlcnNpb24gIT09IG51bGwgJiYgdGhpcy5wYXJzZWRWZXJzaW9uICE9PSB1bmRlZmluZWQpIHsKCSAgICAgICAgICAgIHJldHVybiB0aGlzLnBhcnNlZFZlcnNpb247CgkgICAgICAgIH0KCSAgICAgICAgdmFyIGRpbWVuc2lvbiA9IHRoaXMuYml0TWF0cml4LmdldEhlaWdodCgpOwoJICAgICAgICB2YXIgcHJvdmlzaW9uYWxWZXJzaW9uID0gTWF0aC5mbG9vcigoZGltZW5zaW9uIC0gMTcpIC8gNCk7CgkgICAgICAgIGlmIChwcm92aXNpb25hbFZlcnNpb24gPD0gNikgewoJICAgICAgICAgICAgcmV0dXJuIFZlcnNpb25fMSQxLmRlZmF1bHQuZ2V0VmVyc2lvbkZvck51bWJlcihwcm92aXNpb25hbFZlcnNpb24pOwoJICAgICAgICB9CgkgICAgICAgIC8vIFJlYWQgdG9wLXJpZ2h0IHZlcnNpb24gaW5mbzogMyB3aWRlIGJ5IDYgdGFsbAoJICAgICAgICB2YXIgdmVyc2lvbkJpdHMgPSAwOwoJICAgICAgICB2YXIgaWpNaW4gPSBkaW1lbnNpb24gLSAxMTsKCSAgICAgICAgZm9yICh2YXIgaiA9IDU7IGogPj0gMDsgai0tKSB7CgkgICAgICAgICAgICBmb3IgKHZhciBpID0gZGltZW5zaW9uIC0gOTsgaSA+PSBpak1pbjsgaS0tKSB7CgkgICAgICAgICAgICAgICAgdmVyc2lvbkJpdHMgPSB0aGlzLmNvcHlCaXQoaSwgaiwgdmVyc2lvbkJpdHMpOwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIHZhciB0aGVQYXJzZWRWZXJzaW9uID0gVmVyc2lvbl8xJDEuZGVmYXVsdC5kZWNvZGVWZXJzaW9uSW5mb3JtYXRpb24odmVyc2lvbkJpdHMpOwoJICAgICAgICBpZiAodGhlUGFyc2VkVmVyc2lvbiAhPT0gbnVsbCAmJiB0aGVQYXJzZWRWZXJzaW9uLmdldERpbWVuc2lvbkZvclZlcnNpb24oKSA9PT0gZGltZW5zaW9uKSB7CgkgICAgICAgICAgICB0aGlzLnBhcnNlZFZlcnNpb24gPSB0aGVQYXJzZWRWZXJzaW9uOwoJICAgICAgICAgICAgcmV0dXJuIHRoZVBhcnNlZFZlcnNpb247CgkgICAgICAgIH0KCSAgICAgICAgLy8gSG1tLCBmYWlsZWQuIFRyeSBib3R0b20gbGVmdDogNiB3aWRlIGJ5IDMgdGFsbAoJICAgICAgICB2ZXJzaW9uQml0cyA9IDA7CgkgICAgICAgIGZvciAodmFyIGkgPSA1OyBpID49IDA7IGktLSkgewoJICAgICAgICAgICAgZm9yICh2YXIgaiA9IGRpbWVuc2lvbiAtIDk7IGogPj0gaWpNaW47IGotLSkgewoJICAgICAgICAgICAgICAgIHZlcnNpb25CaXRzID0gdGhpcy5jb3B5Qml0KGksIGosIHZlcnNpb25CaXRzKTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgfQoJICAgICAgICB0aGVQYXJzZWRWZXJzaW9uID0gVmVyc2lvbl8xJDEuZGVmYXVsdC5kZWNvZGVWZXJzaW9uSW5mb3JtYXRpb24odmVyc2lvbkJpdHMpOwoJICAgICAgICBpZiAodGhlUGFyc2VkVmVyc2lvbiAhPT0gbnVsbCAmJiB0aGVQYXJzZWRWZXJzaW9uLmdldERpbWVuc2lvbkZvclZlcnNpb24oKSA9PT0gZGltZW5zaW9uKSB7CgkgICAgICAgICAgICB0aGlzLnBhcnNlZFZlcnNpb24gPSB0aGVQYXJzZWRWZXJzaW9uOwoJICAgICAgICAgICAgcmV0dXJuIHRoZVBhcnNlZFZlcnNpb247CgkgICAgICAgIH0KCSAgICAgICAgdGhyb3cgbmV3IEZvcm1hdEV4Y2VwdGlvbl8xJDEuZGVmYXVsdCgpOwoJICAgIH07CgkgICAgQml0TWF0cml4UGFyc2VyLnByb3RvdHlwZS5jb3B5Qml0ID0gZnVuY3Rpb24gKGkgLyppbnQqLywgaiAvKmludCovLCB2ZXJzaW9uQml0cyAvKmludCovKSB7CgkgICAgICAgIHZhciBiaXQgPSB0aGlzLmlzTWlycm9yID8gdGhpcy5iaXRNYXRyaXguZ2V0KGosIGkpIDogdGhpcy5iaXRNYXRyaXguZ2V0KGksIGopOwoJICAgICAgICByZXR1cm4gYml0ID8gKHZlcnNpb25CaXRzIDw8IDEpIHwgMHgxIDogdmVyc2lvbkJpdHMgPDwgMTsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIDxwPlJlYWRzIHRoZSBiaXRzIGluIHRoZSB7QGxpbmsgQml0TWF0cml4fSByZXByZXNlbnRpbmcgdGhlIGZpbmRlciBwYXR0ZXJuIGluIHRoZQoJICAgICAqIGNvcnJlY3Qgb3JkZXIgaW4gb3JkZXIgdG8gcmVjb25zdHJ1Y3QgdGhlIGNvZGV3b3JkcyBieXRlcyBjb250YWluZWQgd2l0aGluIHRoZQoJICAgICAqIFFSIENvZGUuPC9wPgoJICAgICAqCgkgICAgICogQHJldHVybiBieXRlcyBlbmNvZGVkIHdpdGhpbiB0aGUgUVIgQ29kZQoJICAgICAqIEB0aHJvd3MgRm9ybWF0RXhjZXB0aW9uIGlmIHRoZSBleGFjdCBudW1iZXIgb2YgYnl0ZXMgZXhwZWN0ZWQgaXMgbm90IHJlYWQKCSAgICAgKi8KCSAgICBCaXRNYXRyaXhQYXJzZXIucHJvdG90eXBlLnJlYWRDb2Rld29yZHMgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHZhciBmb3JtYXRJbmZvID0gdGhpcy5yZWFkRm9ybWF0SW5mb3JtYXRpb24oKTsKCSAgICAgICAgdmFyIHZlcnNpb24gPSB0aGlzLnJlYWRWZXJzaW9uKCk7CgkgICAgICAgIC8vIEdldCB0aGUgZGF0YSBtYXNrIGZvciB0aGUgZm9ybWF0IHVzZWQgaW4gdGhpcyBRUiBDb2RlLiBUaGlzIHdpbGwgZXhjbHVkZQoJICAgICAgICAvLyBzb21lIGJpdHMgZnJvbSByZWFkaW5nIGFzIHdlIHdpbmQgdGhyb3VnaCB0aGUgYml0IG1hdHJpeC4KCSAgICAgICAgdmFyIGRhdGFNYXNrID0gRGF0YU1hc2tfMS5kZWZhdWx0LnZhbHVlcy5nZXQoZm9ybWF0SW5mby5nZXREYXRhTWFzaygpKTsKCSAgICAgICAgdmFyIGRpbWVuc2lvbiA9IHRoaXMuYml0TWF0cml4LmdldEhlaWdodCgpOwoJICAgICAgICBkYXRhTWFzay51bm1hc2tCaXRNYXRyaXgodGhpcy5iaXRNYXRyaXgsIGRpbWVuc2lvbik7CgkgICAgICAgIHZhciBmdW5jdGlvblBhdHRlcm4gPSB2ZXJzaW9uLmJ1aWxkRnVuY3Rpb25QYXR0ZXJuKCk7CgkgICAgICAgIHZhciByZWFkaW5nVXAgPSB0cnVlOwoJICAgICAgICB2YXIgcmVzdWx0ID0gbmV3IFVpbnQ4QXJyYXkodmVyc2lvbi5nZXRUb3RhbENvZGV3b3JkcygpKTsKCSAgICAgICAgdmFyIHJlc3VsdE9mZnNldCA9IDA7CgkgICAgICAgIHZhciBjdXJyZW50Qnl0ZSA9IDA7CgkgICAgICAgIHZhciBiaXRzUmVhZCA9IDA7CgkgICAgICAgIC8vIFJlYWQgY29sdW1ucyBpbiBwYWlycywgZnJvbSByaWdodCB0byBsZWZ0CgkgICAgICAgIGZvciAodmFyIGogPSBkaW1lbnNpb24gLSAxOyBqID4gMDsgaiAtPSAyKSB7CgkgICAgICAgICAgICBpZiAoaiA9PT0gNikgewoJICAgICAgICAgICAgICAgIC8vIFNraXAgd2hvbGUgY29sdW1uIHdpdGggdmVydGljYWwgYWxpZ25tZW50IHBhdHRlcm4KCSAgICAgICAgICAgICAgICAvLyBzYXZlcyB0aW1lIGFuZCBtYWtlcyB0aGUgb3RoZXIgY29kZSBwcm9jZWVkIG1vcmUgY2xlYW5seQoJICAgICAgICAgICAgICAgIGotLTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIC8vIFJlYWQgYWx0ZXJuYXRpbmdseSBmcm9tIGJvdHRvbSB0byB0b3AgdGhlbiB0b3AgdG8gYm90dG9tCgkgICAgICAgICAgICBmb3IgKHZhciBjb3VudCA9IDA7IGNvdW50IDwgZGltZW5zaW9uOyBjb3VudCsrKSB7CgkgICAgICAgICAgICAgICAgdmFyIGkgPSByZWFkaW5nVXAgPyBkaW1lbnNpb24gLSAxIC0gY291bnQgOiBjb3VudDsKCSAgICAgICAgICAgICAgICBmb3IgKHZhciBjb2wgPSAwOyBjb2wgPCAyOyBjb2wrKykgewoJICAgICAgICAgICAgICAgICAgICAvLyBJZ25vcmUgYml0cyBjb3ZlcmVkIGJ5IHRoZSBmdW5jdGlvbiBwYXR0ZXJuCgkgICAgICAgICAgICAgICAgICAgIGlmICghZnVuY3Rpb25QYXR0ZXJuLmdldChqIC0gY29sLCBpKSkgewoJICAgICAgICAgICAgICAgICAgICAgICAgLy8gUmVhZCBhIGJpdAoJICAgICAgICAgICAgICAgICAgICAgICAgYml0c1JlYWQrKzsKCSAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJlbnRCeXRlIDw8PSAxOwoJICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuYml0TWF0cml4LmdldChqIC0gY29sLCBpKSkgewoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJlbnRCeXRlIHw9IDE7CgkgICAgICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgICAgICAvLyBJZiB3ZSd2ZSBtYWRlIGEgd2hvbGUgYnl0ZSwgc2F2ZSBpdCBvZmYKCSAgICAgICAgICAgICAgICAgICAgICAgIGlmIChiaXRzUmVhZCA9PT0gOCkgewoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdFtyZXN1bHRPZmZzZXQrK10gPSAvKihieXRlKSAqLyBjdXJyZW50Qnl0ZTsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICBiaXRzUmVhZCA9IDA7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgY3VycmVudEJ5dGUgPSAwOwoJICAgICAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgcmVhZGluZ1VwID0gIXJlYWRpbmdVcDsgLy8gcmVhZGluZ1VwIF49IHRydWU7IC8vIHJlYWRpbmdVcCA9ICFyZWFkaW5nVXA7IC8vIHN3aXRjaCBkaXJlY3Rpb25zCgkgICAgICAgIH0KCSAgICAgICAgaWYgKHJlc3VsdE9mZnNldCAhPT0gdmVyc2lvbi5nZXRUb3RhbENvZGV3b3JkcygpKSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgRm9ybWF0RXhjZXB0aW9uXzEkMS5kZWZhdWx0KCk7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIHJlc3VsdDsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIFJldmVydCB0aGUgbWFzayByZW1vdmFsIGRvbmUgd2hpbGUgcmVhZGluZyB0aGUgY29kZSB3b3Jkcy4gVGhlIGJpdCBtYXRyaXggc2hvdWxkIHJldmVydCB0byBpdHMgb3JpZ2luYWwgc3RhdGUuCgkgICAgICovCgkgICAgQml0TWF0cml4UGFyc2VyLnByb3RvdHlwZS5yZW1hc2sgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIGlmICh0aGlzLnBhcnNlZEZvcm1hdEluZm8gPT09IG51bGwpIHsKCSAgICAgICAgICAgIHJldHVybjsgLy8gV2UgaGF2ZSBubyBmb3JtYXQgaW5mb3JtYXRpb24sIGFuZCBoYXZlIG5vIGRhdGEgbWFzawoJICAgICAgICB9CgkgICAgICAgIHZhciBkYXRhTWFzayA9IERhdGFNYXNrXzEuZGVmYXVsdC52YWx1ZXNbdGhpcy5wYXJzZWRGb3JtYXRJbmZvLmdldERhdGFNYXNrKCldOwoJICAgICAgICB2YXIgZGltZW5zaW9uID0gdGhpcy5iaXRNYXRyaXguZ2V0SGVpZ2h0KCk7CgkgICAgICAgIGRhdGFNYXNrLnVubWFza0JpdE1hdHJpeCh0aGlzLmJpdE1hdHJpeCwgZGltZW5zaW9uKTsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIFByZXBhcmUgdGhlIHBhcnNlciBmb3IgYSBtaXJyb3JlZCBvcGVyYXRpb24uCgkgICAgICogVGhpcyBmbGFnIGhhcyBlZmZlY3Qgb25seSBvbiB0aGUge0BsaW5rICNyZWFkRm9ybWF0SW5mb3JtYXRpb24oKX0gYW5kIHRoZQoJICAgICAqIHtAbGluayAjcmVhZFZlcnNpb24oKX0uIEJlZm9yZSBwcm9jZWVkaW5nIHdpdGgge0BsaW5rICNyZWFkQ29kZXdvcmRzKCl9IHRoZQoJICAgICAqIHtAbGluayAjbWlycm9yKCl9IG1ldGhvZCBzaG91bGQgYmUgY2FsbGVkLgoJICAgICAqCgkgICAgICogQHBhcmFtIG1pcnJvciBXaGV0aGVyIHRvIHJlYWQgdmVyc2lvbiBhbmQgZm9ybWF0IGluZm9ybWF0aW9uIG1pcnJvcmVkLgoJICAgICAqLwoJICAgIEJpdE1hdHJpeFBhcnNlci5wcm90b3R5cGUuc2V0TWlycm9yID0gZnVuY3Rpb24gKGlzTWlycm9yKSB7CgkgICAgICAgIHRoaXMucGFyc2VkVmVyc2lvbiA9IG51bGw7CgkgICAgICAgIHRoaXMucGFyc2VkRm9ybWF0SW5mbyA9IG51bGw7CgkgICAgICAgIHRoaXMuaXNNaXJyb3IgPSBpc01pcnJvcjsKCSAgICB9OwoJICAgIC8qKiBNaXJyb3IgdGhlIGJpdCBtYXRyaXggaW4gb3JkZXIgdG8gYXR0ZW1wdCBhIHNlY29uZCByZWFkaW5nLiAqLwoJICAgIEJpdE1hdHJpeFBhcnNlci5wcm90b3R5cGUubWlycm9yID0gZnVuY3Rpb24gKCkgewoJICAgICAgICB2YXIgYml0TWF0cml4ID0gdGhpcy5iaXRNYXRyaXg7CgkgICAgICAgIGZvciAodmFyIHggPSAwLCB3aWR0aCA9IGJpdE1hdHJpeC5nZXRXaWR0aCgpOyB4IDwgd2lkdGg7IHgrKykgewoJICAgICAgICAgICAgZm9yICh2YXIgeSA9IHggKyAxLCBoZWlnaHQgPSBiaXRNYXRyaXguZ2V0SGVpZ2h0KCk7IHkgPCBoZWlnaHQ7IHkrKykgewoJICAgICAgICAgICAgICAgIGlmIChiaXRNYXRyaXguZ2V0KHgsIHkpICE9PSBiaXRNYXRyaXguZ2V0KHksIHgpKSB7CgkgICAgICAgICAgICAgICAgICAgIGJpdE1hdHJpeC5mbGlwKHksIHgpOwoJICAgICAgICAgICAgICAgICAgICBiaXRNYXRyaXguZmxpcCh4LCB5KTsKCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICB9OwoJICAgIHJldHVybiBCaXRNYXRyaXhQYXJzZXI7Cgl9KCkpOwoJQml0TWF0cml4UGFyc2VyJDEuZGVmYXVsdCA9IEJpdE1hdHJpeFBhcnNlcjsKCgl2YXIgRGF0YUJsb2NrJDEgPSB7fTsKCgkvKgoJICogQ29weXJpZ2h0IDIwMDcgWlhpbmcgYXV0aG9ycwoJICoKCSAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoJICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoJICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkgKgoJICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKCSAqCgkgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCgkgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoJICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCgkgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCSAqLwoJdmFyIF9fdmFsdWVzJDMgPSAoY29tbW9uanNHbG9iYWwgJiYgY29tbW9uanNHbG9iYWwuX192YWx1ZXMpIHx8IGZ1bmN0aW9uKG8pIHsKCSAgICB2YXIgcyA9IHR5cGVvZiBTeW1ib2wgPT09ICJmdW5jdGlvbiIgJiYgU3ltYm9sLml0ZXJhdG9yLCBtID0gcyAmJiBvW3NdLCBpID0gMDsKCSAgICBpZiAobSkgcmV0dXJuIG0uY2FsbChvKTsKCSAgICBpZiAobyAmJiB0eXBlb2Ygby5sZW5ndGggPT09ICJudW1iZXIiKSByZXR1cm4gewoJICAgICAgICBuZXh0OiBmdW5jdGlvbiAoKSB7CgkgICAgICAgICAgICBpZiAobyAmJiBpID49IG8ubGVuZ3RoKSBvID0gdm9pZCAwOwoJICAgICAgICAgICAgcmV0dXJuIHsgdmFsdWU6IG8gJiYgb1tpKytdLCBkb25lOiAhbyB9OwoJICAgICAgICB9CgkgICAgfTsKCSAgICB0aHJvdyBuZXcgVHlwZUVycm9yKHMgPyAiT2JqZWN0IGlzIG5vdCBpdGVyYWJsZS4iIDogIlN5bWJvbC5pdGVyYXRvciBpcyBub3QgZGVmaW5lZC4iKTsKCX07CglPYmplY3QuZGVmaW5lUHJvcGVydHkoRGF0YUJsb2NrJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCXZhciBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb25fMSQxID0gSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uJDE7CgkvKioKCSAqIDxwPkVuY2Fwc3VsYXRlcyBhIGJsb2NrIG9mIGRhdGEgd2l0aGluIGEgUVIgQ29kZS4gUVIgQ29kZXMgbWF5IHNwbGl0IHRoZWlyIGRhdGEgaW50bwoJICogbXVsdGlwbGUgYmxvY2tzLCBlYWNoIG9mIHdoaWNoIGlzIGEgdW5pdCBvZiBkYXRhIGFuZCBlcnJvci1jb3JyZWN0aW9uIGNvZGV3b3Jkcy4gRWFjaAoJICogaXMgcmVwcmVzZW50ZWQgYnkgYW4gaW5zdGFuY2Ugb2YgdGhpcyBjbGFzcy48L3A+CgkgKgoJICogQGF1dGhvciBTZWFuIE93ZW4KCSAqLwoJdmFyIERhdGFCbG9jayA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHsKCSAgICBmdW5jdGlvbiBEYXRhQmxvY2sobnVtRGF0YUNvZGV3b3JkcyAvKmludCovLCBjb2Rld29yZHMpIHsKCSAgICAgICAgdGhpcy5udW1EYXRhQ29kZXdvcmRzID0gbnVtRGF0YUNvZGV3b3JkczsKCSAgICAgICAgdGhpcy5jb2Rld29yZHMgPSBjb2Rld29yZHM7CgkgICAgfQoJICAgIC8qKgoJICAgICAqIDxwPldoZW4gUVIgQ29kZXMgdXNlIG11bHRpcGxlIGRhdGEgYmxvY2tzLCB0aGV5IGFyZSBhY3R1YWxseSBpbnRlcmxlYXZlZC4KCSAgICAgKiBUaGF0IGlzLCB0aGUgZmlyc3QgYnl0ZSBvZiBkYXRhIGJsb2NrIDEgdG8gbiBpcyB3cml0dGVuLCB0aGVuIHRoZSBzZWNvbmQgYnl0ZXMsIGFuZCBzbyBvbi4gVGhpcwoJICAgICAqIG1ldGhvZCB3aWxsIHNlcGFyYXRlIHRoZSBkYXRhIGludG8gb3JpZ2luYWwgYmxvY2tzLjwvcD4KCSAgICAgKgoJICAgICAqIEBwYXJhbSByYXdDb2Rld29yZHMgYnl0ZXMgYXMgcmVhZCBkaXJlY3RseSBmcm9tIHRoZSBRUiBDb2RlCgkgICAgICogQHBhcmFtIHZlcnNpb24gdmVyc2lvbiBvZiB0aGUgUVIgQ29kZQoJICAgICAqIEBwYXJhbSBlY0xldmVsIGVycm9yLWNvcnJlY3Rpb24gbGV2ZWwgb2YgdGhlIFFSIENvZGUKCSAgICAgKiBAcmV0dXJuIERhdGFCbG9ja3MgY29udGFpbmluZyBvcmlnaW5hbCBieXRlcywgImRlLWludGVybGVhdmVkIiBmcm9tIHJlcHJlc2VudGF0aW9uIGluIHRoZQoJICAgICAqICAgICAgICAgUVIgQ29kZQoJICAgICAqLwoJICAgIERhdGFCbG9jay5nZXREYXRhQmxvY2tzID0gZnVuY3Rpb24gKHJhd0NvZGV3b3JkcywgdmVyc2lvbiwgZWNMZXZlbCkgewoJICAgICAgICB2YXIgZV8xLCBfYSwgZV8yLCBfYjsKCSAgICAgICAgaWYgKHJhd0NvZGV3b3Jkcy5sZW5ndGggIT09IHZlcnNpb24uZ2V0VG90YWxDb2Rld29yZHMoKSkgewoJICAgICAgICAgICAgdGhyb3cgbmV3IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbl8xJDEuZGVmYXVsdCgpOwoJICAgICAgICB9CgkgICAgICAgIC8vIEZpZ3VyZSBvdXQgdGhlIG51bWJlciBhbmQgc2l6ZSBvZiBkYXRhIGJsb2NrcyB1c2VkIGJ5IHRoaXMgdmVyc2lvbiBhbmQKCSAgICAgICAgLy8gZXJyb3IgY29ycmVjdGlvbiBsZXZlbAoJICAgICAgICB2YXIgZWNCbG9ja3MgPSB2ZXJzaW9uLmdldEVDQmxvY2tzRm9yTGV2ZWwoZWNMZXZlbCk7CgkgICAgICAgIC8vIEZpcnN0IGNvdW50IHRoZSB0b3RhbCBudW1iZXIgb2YgZGF0YSBibG9ja3MKCSAgICAgICAgdmFyIHRvdGFsQmxvY2tzID0gMDsKCSAgICAgICAgdmFyIGVjQmxvY2tBcnJheSA9IGVjQmxvY2tzLmdldEVDQmxvY2tzKCk7CgkgICAgICAgIHRyeSB7CgkgICAgICAgICAgICBmb3IgKHZhciBlY0Jsb2NrQXJyYXlfMSA9IF9fdmFsdWVzJDMoZWNCbG9ja0FycmF5KSwgZWNCbG9ja0FycmF5XzFfMSA9IGVjQmxvY2tBcnJheV8xLm5leHQoKTsgIWVjQmxvY2tBcnJheV8xXzEuZG9uZTsgZWNCbG9ja0FycmF5XzFfMSA9IGVjQmxvY2tBcnJheV8xLm5leHQoKSkgewoJICAgICAgICAgICAgICAgIHZhciBlY0Jsb2NrID0gZWNCbG9ja0FycmF5XzFfMS52YWx1ZTsKCSAgICAgICAgICAgICAgICB0b3RhbEJsb2NrcyArPSBlY0Jsb2NrLmdldENvdW50KCk7CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICAgICAgY2F0Y2ggKGVfMV8xKSB7IGVfMSA9IHsgZXJyb3I6IGVfMV8xIH07IH0KCSAgICAgICAgZmluYWxseSB7CgkgICAgICAgICAgICB0cnkgewoJICAgICAgICAgICAgICAgIGlmIChlY0Jsb2NrQXJyYXlfMV8xICYmICFlY0Jsb2NrQXJyYXlfMV8xLmRvbmUgJiYgKF9hID0gZWNCbG9ja0FycmF5XzEucmV0dXJuKSkgX2EuY2FsbChlY0Jsb2NrQXJyYXlfMSk7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBmaW5hbGx5IHsgaWYgKGVfMSkgdGhyb3cgZV8xLmVycm9yOyB9CgkgICAgICAgIH0KCSAgICAgICAgLy8gTm93IGVzdGFibGlzaCBEYXRhQmxvY2tzIG9mIHRoZSBhcHByb3ByaWF0ZSBzaXplIGFuZCBudW1iZXIgb2YgZGF0YSBjb2Rld29yZHMKCSAgICAgICAgdmFyIHJlc3VsdCA9IG5ldyBBcnJheSh0b3RhbEJsb2Nrcyk7CgkgICAgICAgIHZhciBudW1SZXN1bHRCbG9ja3MgPSAwOwoJICAgICAgICB0cnkgewoJICAgICAgICAgICAgZm9yICh2YXIgZWNCbG9ja0FycmF5XzIgPSBfX3ZhbHVlcyQzKGVjQmxvY2tBcnJheSksIGVjQmxvY2tBcnJheV8yXzEgPSBlY0Jsb2NrQXJyYXlfMi5uZXh0KCk7ICFlY0Jsb2NrQXJyYXlfMl8xLmRvbmU7IGVjQmxvY2tBcnJheV8yXzEgPSBlY0Jsb2NrQXJyYXlfMi5uZXh0KCkpIHsKCSAgICAgICAgICAgICAgICB2YXIgZWNCbG9jayA9IGVjQmxvY2tBcnJheV8yXzEudmFsdWU7CgkgICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBlY0Jsb2NrLmdldENvdW50KCk7IGkrKykgewoJICAgICAgICAgICAgICAgICAgICB2YXIgbnVtRGF0YUNvZGV3b3JkcyA9IGVjQmxvY2suZ2V0RGF0YUNvZGV3b3JkcygpOwoJICAgICAgICAgICAgICAgICAgICB2YXIgbnVtQmxvY2tDb2Rld29yZHMgPSBlY0Jsb2Nrcy5nZXRFQ0NvZGV3b3Jkc1BlckJsb2NrKCkgKyBudW1EYXRhQ29kZXdvcmRzOwoJICAgICAgICAgICAgICAgICAgICByZXN1bHRbbnVtUmVzdWx0QmxvY2tzKytdID0gbmV3IERhdGFCbG9jayhudW1EYXRhQ29kZXdvcmRzLCBuZXcgVWludDhBcnJheShudW1CbG9ja0NvZGV3b3JkcykpOwoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgIH0KCSAgICAgICAgfQoJICAgICAgICBjYXRjaCAoZV8yXzEpIHsgZV8yID0geyBlcnJvcjogZV8yXzEgfTsgfQoJICAgICAgICBmaW5hbGx5IHsKCSAgICAgICAgICAgIHRyeSB7CgkgICAgICAgICAgICAgICAgaWYgKGVjQmxvY2tBcnJheV8yXzEgJiYgIWVjQmxvY2tBcnJheV8yXzEuZG9uZSAmJiAoX2IgPSBlY0Jsb2NrQXJyYXlfMi5yZXR1cm4pKSBfYi5jYWxsKGVjQmxvY2tBcnJheV8yKTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIGZpbmFsbHkgeyBpZiAoZV8yKSB0aHJvdyBlXzIuZXJyb3I7IH0KCSAgICAgICAgfQoJICAgICAgICAvLyBBbGwgYmxvY2tzIGhhdmUgdGhlIHNhbWUgYW1vdW50IG9mIGRhdGEsIGV4Y2VwdCB0aGF0IHRoZSBsYXN0IG4KCSAgICAgICAgLy8gKHdoZXJlIG4gbWF5IGJlIDApIGhhdmUgMSBtb3JlIGJ5dGUuIEZpZ3VyZSBvdXQgd2hlcmUgdGhlc2Ugc3RhcnQuCgkgICAgICAgIHZhciBzaG9ydGVyQmxvY2tzVG90YWxDb2Rld29yZHMgPSByZXN1bHRbMF0uY29kZXdvcmRzLmxlbmd0aDsKCSAgICAgICAgdmFyIGxvbmdlckJsb2Nrc1N0YXJ0QXQgPSByZXN1bHQubGVuZ3RoIC0gMTsKCSAgICAgICAgLy8gVFlQRVNDUklQVFBPUlQ6IGNoZWNrIGxlbmd0aCBpcyBjb3JyZWN0IGhlcmUKCSAgICAgICAgd2hpbGUgKGxvbmdlckJsb2Nrc1N0YXJ0QXQgPj0gMCkgewoJICAgICAgICAgICAgdmFyIG51bUNvZGV3b3JkcyA9IHJlc3VsdFtsb25nZXJCbG9ja3NTdGFydEF0XS5jb2Rld29yZHMubGVuZ3RoOwoJICAgICAgICAgICAgaWYgKG51bUNvZGV3b3JkcyA9PT0gc2hvcnRlckJsb2Nrc1RvdGFsQ29kZXdvcmRzKSB7CgkgICAgICAgICAgICAgICAgYnJlYWs7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBsb25nZXJCbG9ja3NTdGFydEF0LS07CgkgICAgICAgIH0KCSAgICAgICAgbG9uZ2VyQmxvY2tzU3RhcnRBdCsrOwoJICAgICAgICB2YXIgc2hvcnRlckJsb2Nrc051bURhdGFDb2Rld29yZHMgPSBzaG9ydGVyQmxvY2tzVG90YWxDb2Rld29yZHMgLSBlY0Jsb2Nrcy5nZXRFQ0NvZGV3b3Jkc1BlckJsb2NrKCk7CgkgICAgICAgIC8vIFRoZSBsYXN0IGVsZW1lbnRzIG9mIHJlc3VsdCBtYXkgYmUgMSBlbGVtZW50IGxvbmdlcgoJICAgICAgICAvLyBmaXJzdCBmaWxsIG91dCBhcyBtYW55IGVsZW1lbnRzIGFzIGFsbCBvZiB0aGVtIGhhdmUKCSAgICAgICAgdmFyIHJhd0NvZGV3b3Jkc09mZnNldCA9IDA7CgkgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc2hvcnRlckJsb2Nrc051bURhdGFDb2Rld29yZHM7IGkrKykgewoJICAgICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCBudW1SZXN1bHRCbG9ja3M7IGorKykgewoJICAgICAgICAgICAgICAgIHJlc3VsdFtqXS5jb2Rld29yZHNbaV0gPSByYXdDb2Rld29yZHNbcmF3Q29kZXdvcmRzT2Zmc2V0KytdOwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIC8vIEZpbGwgb3V0IHRoZSBsYXN0IGRhdGEgYmxvY2sgaW4gdGhlIGxvbmdlciBvbmVzCgkgICAgICAgIGZvciAodmFyIGogPSBsb25nZXJCbG9ja3NTdGFydEF0OyBqIDwgbnVtUmVzdWx0QmxvY2tzOyBqKyspIHsKCSAgICAgICAgICAgIHJlc3VsdFtqXS5jb2Rld29yZHNbc2hvcnRlckJsb2Nrc051bURhdGFDb2Rld29yZHNdID0gcmF3Q29kZXdvcmRzW3Jhd0NvZGV3b3Jkc09mZnNldCsrXTsKCSAgICAgICAgfQoJICAgICAgICAvLyBOb3cgYWRkIGluIGVycm9yIGNvcnJlY3Rpb24gYmxvY2tzCgkgICAgICAgIHZhciBtYXggPSByZXN1bHRbMF0uY29kZXdvcmRzLmxlbmd0aDsKCSAgICAgICAgZm9yICh2YXIgaSA9IHNob3J0ZXJCbG9ja3NOdW1EYXRhQ29kZXdvcmRzOyBpIDwgbWF4OyBpKyspIHsKCSAgICAgICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgbnVtUmVzdWx0QmxvY2tzOyBqKyspIHsKCSAgICAgICAgICAgICAgICB2YXIgaU9mZnNldCA9IGogPCBsb25nZXJCbG9ja3NTdGFydEF0ID8gaSA6IGkgKyAxOwoJICAgICAgICAgICAgICAgIHJlc3VsdFtqXS5jb2Rld29yZHNbaU9mZnNldF0gPSByYXdDb2Rld29yZHNbcmF3Q29kZXdvcmRzT2Zmc2V0KytdOwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIHJldHVybiByZXN1bHQ7CgkgICAgfTsKCSAgICBEYXRhQmxvY2sucHJvdG90eXBlLmdldE51bURhdGFDb2Rld29yZHMgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLm51bURhdGFDb2Rld29yZHM7CgkgICAgfTsKCSAgICBEYXRhQmxvY2sucHJvdG90eXBlLmdldENvZGV3b3JkcyA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMuY29kZXdvcmRzOwoJICAgIH07CgkgICAgcmV0dXJuIERhdGFCbG9jazsKCX0oKSk7CglEYXRhQmxvY2skMS5kZWZhdWx0ID0gRGF0YUJsb2NrOwoKCXZhciBEZWNvZGVkQml0U3RyZWFtUGFyc2VyJDEgPSB7fTsKCgl2YXIgQml0U291cmNlJDEgPSB7fTsKCgkvKgoJICogQ29weXJpZ2h0IDIwMDcgWlhpbmcgYXV0aG9ycwoJICoKCSAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoJICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoJICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkgKgoJICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKCSAqCgkgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCgkgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoJICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCgkgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCSAqLwoJT2JqZWN0LmRlZmluZVByb3BlcnR5KEJpdFNvdXJjZSQxLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7CgkvKm5hbWVzcGFjZSBjb20uZ29vZ2xlLnp4aW5nLmNvbW1vbiB7Ki8KCXZhciBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb25fMSA9IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbiQxOwoJLyoqCgkgKiA8cD5UaGlzIHByb3ZpZGVzIGFuIGVhc3kgYWJzdHJhY3Rpb24gdG8gcmVhZCBiaXRzIGF0IGEgdGltZSBmcm9tIGEgc2VxdWVuY2Ugb2YgYnl0ZXMsIHdoZXJlIHRoZQoJICogbnVtYmVyIG9mIGJpdHMgcmVhZCBpcyBub3Qgb2Z0ZW4gYSBtdWx0aXBsZSBvZiA4LjwvcD4KCSAqCgkgKiA8cD5UaGlzIGNsYXNzIGlzIHRocmVhZC1zYWZlIGJ1dCBub3QgcmVlbnRyYW50IC0tIHVubGVzcyB0aGUgY2FsbGVyIG1vZGlmaWVzIHRoZSBieXRlcyBhcnJheQoJICogaXQgcGFzc2VkIGluLCBpbiB3aGljaCBjYXNlIGFsbCBiZXRzIGFyZSBvZmYuPC9wPgoJICoKCSAqIEBhdXRob3IgU2VhbiBPd2VuCgkgKi8KCXZhciBCaXRTb3VyY2UgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7CgkgICAgLyoqCgkgICAgICogQHBhcmFtIGJ5dGVzIGJ5dGVzIGZyb20gd2hpY2ggdGhpcyB3aWxsIHJlYWQgYml0cy4gQml0cyB3aWxsIGJlIHJlYWQgZnJvbSB0aGUgZmlyc3QgYnl0ZSBmaXJzdC4KCSAgICAgKiBCaXRzIGFyZSByZWFkIHdpdGhpbiBhIGJ5dGUgZnJvbSBtb3N0LXNpZ25pZmljYW50IHRvIGxlYXN0LXNpZ25pZmljYW50IGJpdC4KCSAgICAgKi8KCSAgICBmdW5jdGlvbiBCaXRTb3VyY2UoYnl0ZXMpIHsKCSAgICAgICAgdGhpcy5ieXRlcyA9IGJ5dGVzOwoJICAgICAgICB0aGlzLmJ5dGVPZmZzZXQgPSAwOwoJICAgICAgICB0aGlzLmJpdE9mZnNldCA9IDA7CgkgICAgfQoJICAgIC8qKgoJICAgICAqIEByZXR1cm4gaW5kZXggb2YgbmV4dCBiaXQgaW4gY3VycmVudCBieXRlIHdoaWNoIHdvdWxkIGJlIHJlYWQgYnkgdGhlIG5leHQgY2FsbCB0byB7QGxpbmsgI3JlYWRCaXRzKGludCl9LgoJICAgICAqLwoJICAgIEJpdFNvdXJjZS5wcm90b3R5cGUuZ2V0Qml0T2Zmc2V0ID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5iaXRPZmZzZXQ7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcmV0dXJuIGluZGV4IG9mIG5leHQgYnl0ZSBpbiBpbnB1dCBieXRlIGFycmF5IHdoaWNoIHdvdWxkIGJlIHJlYWQgYnkgdGhlIG5leHQgY2FsbCB0byB7QGxpbmsgI3JlYWRCaXRzKGludCl9LgoJICAgICAqLwoJICAgIEJpdFNvdXJjZS5wcm90b3R5cGUuZ2V0Qnl0ZU9mZnNldCA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMuYnl0ZU9mZnNldDsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEBwYXJhbSBudW1CaXRzIG51bWJlciBvZiBiaXRzIHRvIHJlYWQKCSAgICAgKiBAcmV0dXJuIGludCByZXByZXNlbnRpbmcgdGhlIGJpdHMgcmVhZC4gVGhlIGJpdHMgd2lsbCBhcHBlYXIgYXMgdGhlIGxlYXN0LXNpZ25pZmljYW50CgkgICAgICogICAgICAgICBiaXRzIG9mIHRoZSBpbnQKCSAgICAgKiBAdGhyb3dzIElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbiBpZiBudW1CaXRzIGlzbid0IGluIFsxLDMyXSBvciBtb3JlIHRoYW4gaXMgYXZhaWxhYmxlCgkgICAgICovCgkgICAgQml0U291cmNlLnByb3RvdHlwZS5yZWFkQml0cyA9IGZ1bmN0aW9uIChudW1CaXRzIC8qaW50Ki8pIHsKCSAgICAgICAgaWYgKG51bUJpdHMgPCAxIHx8IG51bUJpdHMgPiAzMiB8fCBudW1CaXRzID4gdGhpcy5hdmFpbGFibGUoKSkgewoJICAgICAgICAgICAgdGhyb3cgbmV3IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbl8xLmRlZmF1bHQoJycgKyBudW1CaXRzKTsKCSAgICAgICAgfQoJICAgICAgICB2YXIgcmVzdWx0ID0gMDsKCSAgICAgICAgdmFyIGJpdE9mZnNldCA9IHRoaXMuYml0T2Zmc2V0OwoJICAgICAgICB2YXIgYnl0ZU9mZnNldCA9IHRoaXMuYnl0ZU9mZnNldDsKCSAgICAgICAgdmFyIGJ5dGVzID0gdGhpcy5ieXRlczsKCSAgICAgICAgLy8gRmlyc3QsIHJlYWQgcmVtYWluZGVyIGZyb20gY3VycmVudCBieXRlCgkgICAgICAgIGlmIChiaXRPZmZzZXQgPiAwKSB7CgkgICAgICAgICAgICB2YXIgYml0c0xlZnQgPSA4IC0gYml0T2Zmc2V0OwoJICAgICAgICAgICAgdmFyIHRvUmVhZCA9IG51bUJpdHMgPCBiaXRzTGVmdCA/IG51bUJpdHMgOiBiaXRzTGVmdDsKCSAgICAgICAgICAgIHZhciBiaXRzVG9Ob3RSZWFkID0gYml0c0xlZnQgLSB0b1JlYWQ7CgkgICAgICAgICAgICB2YXIgbWFzayA9ICgweEZGID4+ICg4IC0gdG9SZWFkKSkgPDwgYml0c1RvTm90UmVhZDsKCSAgICAgICAgICAgIHJlc3VsdCA9IChieXRlc1tieXRlT2Zmc2V0XSAmIG1hc2spID4+IGJpdHNUb05vdFJlYWQ7CgkgICAgICAgICAgICBudW1CaXRzIC09IHRvUmVhZDsKCSAgICAgICAgICAgIGJpdE9mZnNldCArPSB0b1JlYWQ7CgkgICAgICAgICAgICBpZiAoYml0T2Zmc2V0ID09PSA4KSB7CgkgICAgICAgICAgICAgICAgYml0T2Zmc2V0ID0gMDsKCSAgICAgICAgICAgICAgICBieXRlT2Zmc2V0Kys7CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICAgICAgLy8gTmV4dCByZWFkIHdob2xlIGJ5dGVzCgkgICAgICAgIGlmIChudW1CaXRzID4gMCkgewoJICAgICAgICAgICAgd2hpbGUgKG51bUJpdHMgPj0gOCkgewoJICAgICAgICAgICAgICAgIHJlc3VsdCA9IChyZXN1bHQgPDwgOCkgfCAoYnl0ZXNbYnl0ZU9mZnNldF0gJiAweEZGKTsKCSAgICAgICAgICAgICAgICBieXRlT2Zmc2V0Kys7CgkgICAgICAgICAgICAgICAgbnVtQml0cyAtPSA4OwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgLy8gRmluYWxseSByZWFkIGEgcGFydGlhbCBieXRlCgkgICAgICAgICAgICBpZiAobnVtQml0cyA+IDApIHsKCSAgICAgICAgICAgICAgICB2YXIgYml0c1RvTm90UmVhZCA9IDggLSBudW1CaXRzOwoJICAgICAgICAgICAgICAgIHZhciBtYXNrID0gKDB4RkYgPj4gYml0c1RvTm90UmVhZCkgPDwgYml0c1RvTm90UmVhZDsKCSAgICAgICAgICAgICAgICByZXN1bHQgPSAocmVzdWx0IDw8IG51bUJpdHMpIHwgKChieXRlc1tieXRlT2Zmc2V0XSAmIG1hc2spID4+IGJpdHNUb05vdFJlYWQpOwoJICAgICAgICAgICAgICAgIGJpdE9mZnNldCArPSBudW1CaXRzOwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIHRoaXMuYml0T2Zmc2V0ID0gYml0T2Zmc2V0OwoJICAgICAgICB0aGlzLmJ5dGVPZmZzZXQgPSBieXRlT2Zmc2V0OwoJICAgICAgICByZXR1cm4gcmVzdWx0OwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQHJldHVybiBudW1iZXIgb2YgYml0cyB0aGF0IGNhbiBiZSByZWFkIHN1Y2Nlc3NmdWxseQoJICAgICAqLwoJICAgIEJpdFNvdXJjZS5wcm90b3R5cGUuYXZhaWxhYmxlID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gOCAqICh0aGlzLmJ5dGVzLmxlbmd0aCAtIHRoaXMuYnl0ZU9mZnNldCkgLSB0aGlzLmJpdE9mZnNldDsKCSAgICB9OwoJICAgIHJldHVybiBCaXRTb3VyY2U7Cgl9KCkpOwoJQml0U291cmNlJDEuZGVmYXVsdCA9IEJpdFNvdXJjZTsKCgl2YXIgRGVjb2RlclJlc3VsdCQxID0ge307CgoJLyoKCSAqIENvcHlyaWdodCAyMDA3IFpYaW5nIGF1dGhvcnMKCSAqCgkgKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKCSAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4KCSAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdAoJICoKCSAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wCgkgKgoJICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZQoJICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gIkFTIElTIiBCQVNJUywKCSAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLgoJICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZAoJICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuCgkgKi8KCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShEZWNvZGVyUmVzdWx0JDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCS8qbmFtZXNwYWNlIGNvbS5nb29nbGUuenhpbmcuY29tbW9uIHsqLwoJLyppbXBvcnQgamF2YS51dGlsLkxpc3Q7Ki8KCS8qKgoJICogPHA+RW5jYXBzdWxhdGVzIHRoZSByZXN1bHQgb2YgZGVjb2RpbmcgYSBtYXRyaXggb2YgYml0cy4gVGhpcyB0eXBpY2FsbHkKCSAqIGFwcGxpZXMgdG8gMkQgYmFyY29kZSBmb3JtYXRzLiBGb3Igbm93IGl0IGNvbnRhaW5zIHRoZSByYXcgYnl0ZXMgb2J0YWluZWQsCgkgKiBhcyB3ZWxsIGFzIGEgU3RyaW5nIGludGVycHJldGF0aW9uIG9mIHRob3NlIGJ5dGVzLCBpZiBhcHBsaWNhYmxlLjwvcD4KCSAqCgkgKiBAYXV0aG9yIFNlYW4gT3dlbgoJICovCgl2YXIgRGVjb2RlclJlc3VsdCA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHsKCSAgICAvLyBwdWJsaWMgY29uc3RydWN0b3IocmF3Qnl0ZXM6IFVpbnQ4QXJyYXksCgkgICAgLy8gICAgICAgICAgICAgICAgICAgICAgdGV4dDogc3RyaW5nLAoJICAgIC8vICAgICAgICAgICAgICAgICAgICAgIExpc3Q8VWludDhBcnJheT4gYnl0ZVNlZ21lbnRzLAoJICAgIC8vICAgICAgICAgICAgICAgICAgICAgIFN0cmluZyBlY0xldmVsKSB7CgkgICAgLy8gICB0aGlzKHJhd0J5dGVzLCB0ZXh0LCBieXRlU2VnbWVudHMsIGVjTGV2ZWwsIC0xLCAtMSkKCSAgICAvLyB9CgkgICAgZnVuY3Rpb24gRGVjb2RlclJlc3VsdChyYXdCeXRlcywgdGV4dCwgYnl0ZVNlZ21lbnRzLCBlY0xldmVsLCBzdHJ1Y3R1cmVkQXBwZW5kU2VxdWVuY2VOdW1iZXIsIHN0cnVjdHVyZWRBcHBlbmRQYXJpdHkpIHsKCSAgICAgICAgaWYgKHN0cnVjdHVyZWRBcHBlbmRTZXF1ZW5jZU51bWJlciA9PT0gdm9pZCAwKSB7IHN0cnVjdHVyZWRBcHBlbmRTZXF1ZW5jZU51bWJlciA9IC0xOyB9CgkgICAgICAgIGlmIChzdHJ1Y3R1cmVkQXBwZW5kUGFyaXR5ID09PSB2b2lkIDApIHsgc3RydWN0dXJlZEFwcGVuZFBhcml0eSA9IC0xOyB9CgkgICAgICAgIHRoaXMucmF3Qnl0ZXMgPSByYXdCeXRlczsKCSAgICAgICAgdGhpcy50ZXh0ID0gdGV4dDsKCSAgICAgICAgdGhpcy5ieXRlU2VnbWVudHMgPSBieXRlU2VnbWVudHM7CgkgICAgICAgIHRoaXMuZWNMZXZlbCA9IGVjTGV2ZWw7CgkgICAgICAgIHRoaXMuc3RydWN0dXJlZEFwcGVuZFNlcXVlbmNlTnVtYmVyID0gc3RydWN0dXJlZEFwcGVuZFNlcXVlbmNlTnVtYmVyOwoJICAgICAgICB0aGlzLnN0cnVjdHVyZWRBcHBlbmRQYXJpdHkgPSBzdHJ1Y3R1cmVkQXBwZW5kUGFyaXR5OwoJICAgICAgICB0aGlzLm51bUJpdHMgPSAocmF3Qnl0ZXMgPT09IHVuZGVmaW5lZCB8fCByYXdCeXRlcyA9PT0gbnVsbCkgPyAwIDogOCAqIHJhd0J5dGVzLmxlbmd0aDsKCSAgICB9CgkgICAgLyoqCgkgICAgICogQHJldHVybiByYXcgYnl0ZXMgcmVwcmVzZW50aW5nIHRoZSByZXN1bHQsIG9yIHtAY29kZSBudWxsfSBpZiBub3QgYXBwbGljYWJsZQoJICAgICAqLwoJICAgIERlY29kZXJSZXN1bHQucHJvdG90eXBlLmdldFJhd0J5dGVzID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5yYXdCeXRlczsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEByZXR1cm4gaG93IG1hbnkgYml0cyBvZiB7QGxpbmsgI2dldFJhd0J5dGVzKCl9IGFyZSB2YWxpZDsgdHlwaWNhbGx5IDggdGltZXMgaXRzIGxlbmd0aAoJICAgICAqIEBzaW5jZSAzLjMuMAoJICAgICAqLwoJICAgIERlY29kZXJSZXN1bHQucHJvdG90eXBlLmdldE51bUJpdHMgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLm51bUJpdHM7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcGFyYW0gbnVtQml0cyBvdmVycmlkZXMgdGhlIG51bWJlciBvZiBiaXRzIHRoYXQgYXJlIHZhbGlkIGluIHtAbGluayAjZ2V0UmF3Qnl0ZXMoKX0KCSAgICAgKiBAc2luY2UgMy4zLjAKCSAgICAgKi8KCSAgICBEZWNvZGVyUmVzdWx0LnByb3RvdHlwZS5zZXROdW1CaXRzID0gZnVuY3Rpb24gKG51bUJpdHMgLyppbnQqLykgewoJICAgICAgICB0aGlzLm51bUJpdHMgPSBudW1CaXRzOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQHJldHVybiB0ZXh0IHJlcHJlc2VudGF0aW9uIG9mIHRoZSByZXN1bHQKCSAgICAgKi8KCSAgICBEZWNvZGVyUmVzdWx0LnByb3RvdHlwZS5nZXRUZXh0ID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy50ZXh0OwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQHJldHVybiBsaXN0IG9mIGJ5dGUgc2VnbWVudHMgaW4gdGhlIHJlc3VsdCwgb3Ige0Bjb2RlIG51bGx9IGlmIG5vdCBhcHBsaWNhYmxlCgkgICAgICovCgkgICAgRGVjb2RlclJlc3VsdC5wcm90b3R5cGUuZ2V0Qnl0ZVNlZ21lbnRzID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5ieXRlU2VnbWVudHM7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcmV0dXJuIG5hbWUgb2YgZXJyb3IgY29ycmVjdGlvbiBsZXZlbCB1c2VkLCBvciB7QGNvZGUgbnVsbH0gaWYgbm90IGFwcGxpY2FibGUKCSAgICAgKi8KCSAgICBEZWNvZGVyUmVzdWx0LnByb3RvdHlwZS5nZXRFQ0xldmVsID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5lY0xldmVsOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQHJldHVybiBudW1iZXIgb2YgZXJyb3JzIGNvcnJlY3RlZCwgb3Ige0Bjb2RlIG51bGx9IGlmIG5vdCBhcHBsaWNhYmxlCgkgICAgICovCgkgICAgRGVjb2RlclJlc3VsdC5wcm90b3R5cGUuZ2V0RXJyb3JzQ29ycmVjdGVkID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5lcnJvcnNDb3JyZWN0ZWQ7CgkgICAgfTsKCSAgICBEZWNvZGVyUmVzdWx0LnByb3RvdHlwZS5zZXRFcnJvcnNDb3JyZWN0ZWQgPSBmdW5jdGlvbiAoZXJyb3JzQ29ycmVjdGVkIC8qSW50ZWdlciovKSB7CgkgICAgICAgIHRoaXMuZXJyb3JzQ29ycmVjdGVkID0gZXJyb3JzQ29ycmVjdGVkOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQHJldHVybiBudW1iZXIgb2YgZXJhc3VyZXMgY29ycmVjdGVkLCBvciB7QGNvZGUgbnVsbH0gaWYgbm90IGFwcGxpY2FibGUKCSAgICAgKi8KCSAgICBEZWNvZGVyUmVzdWx0LnByb3RvdHlwZS5nZXRFcmFzdXJlcyA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMuZXJhc3VyZXM7CgkgICAgfTsKCSAgICBEZWNvZGVyUmVzdWx0LnByb3RvdHlwZS5zZXRFcmFzdXJlcyA9IGZ1bmN0aW9uIChlcmFzdXJlcyAvKkludGVnZXIqLykgewoJICAgICAgICB0aGlzLmVyYXN1cmVzID0gZXJhc3VyZXM7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcmV0dXJuIGFyYml0cmFyeSBhZGRpdGlvbmFsIG1ldGFkYXRhCgkgICAgICovCgkgICAgRGVjb2RlclJlc3VsdC5wcm90b3R5cGUuZ2V0T3RoZXIgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLm90aGVyOwoJICAgIH07CgkgICAgRGVjb2RlclJlc3VsdC5wcm90b3R5cGUuc2V0T3RoZXIgPSBmdW5jdGlvbiAob3RoZXIpIHsKCSAgICAgICAgdGhpcy5vdGhlciA9IG90aGVyOwoJICAgIH07CgkgICAgRGVjb2RlclJlc3VsdC5wcm90b3R5cGUuaGFzU3RydWN0dXJlZEFwcGVuZCA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMuc3RydWN0dXJlZEFwcGVuZFBhcml0eSA+PSAwICYmIHRoaXMuc3RydWN0dXJlZEFwcGVuZFNlcXVlbmNlTnVtYmVyID49IDA7CgkgICAgfTsKCSAgICBEZWNvZGVyUmVzdWx0LnByb3RvdHlwZS5nZXRTdHJ1Y3R1cmVkQXBwZW5kUGFyaXR5ID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5zdHJ1Y3R1cmVkQXBwZW5kUGFyaXR5OwoJICAgIH07CgkgICAgRGVjb2RlclJlc3VsdC5wcm90b3R5cGUuZ2V0U3RydWN0dXJlZEFwcGVuZFNlcXVlbmNlTnVtYmVyID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5zdHJ1Y3R1cmVkQXBwZW5kU2VxdWVuY2VOdW1iZXI7CgkgICAgfTsKCSAgICByZXR1cm4gRGVjb2RlclJlc3VsdDsKCX0oKSk7CglEZWNvZGVyUmVzdWx0JDEuZGVmYXVsdCA9IERlY29kZXJSZXN1bHQ7CgoJdmFyIE1vZGUgPSB7fTsKCgkoZnVuY3Rpb24gKGV4cG9ydHMpIHsKCS8qCgkgKiBDb3B5cmlnaHQgMjAwNyBaWGluZyBhdXRob3JzCgkgKgoJICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIik7CgkgKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCgkgKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKCSAqCgkgKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAoJICoKCSAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKCSAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCgkgKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4KCSAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKCSAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgoJICovCglPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJZXhwb3J0cy5Nb2RlVmFsdWVzID0gdm9pZCAwOwoJdmFyIElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbl8xID0gSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uJDE7Cgl2YXIgTW9kZVZhbHVlczsKCShmdW5jdGlvbiAoTW9kZVZhbHVlcykgewoJICAgIE1vZGVWYWx1ZXNbTW9kZVZhbHVlc1siVEVSTUlOQVRPUiJdID0gMF0gPSAiVEVSTUlOQVRPUiI7CgkgICAgTW9kZVZhbHVlc1tNb2RlVmFsdWVzWyJOVU1FUklDIl0gPSAxXSA9ICJOVU1FUklDIjsKCSAgICBNb2RlVmFsdWVzW01vZGVWYWx1ZXNbIkFMUEhBTlVNRVJJQyJdID0gMl0gPSAiQUxQSEFOVU1FUklDIjsKCSAgICBNb2RlVmFsdWVzW01vZGVWYWx1ZXNbIlNUUlVDVFVSRURfQVBQRU5EIl0gPSAzXSA9ICJTVFJVQ1RVUkVEX0FQUEVORCI7CgkgICAgTW9kZVZhbHVlc1tNb2RlVmFsdWVzWyJCWVRFIl0gPSA0XSA9ICJCWVRFIjsKCSAgICBNb2RlVmFsdWVzW01vZGVWYWx1ZXNbIkVDSSJdID0gNV0gPSAiRUNJIjsKCSAgICBNb2RlVmFsdWVzW01vZGVWYWx1ZXNbIktBTkpJIl0gPSA2XSA9ICJLQU5KSSI7CgkgICAgTW9kZVZhbHVlc1tNb2RlVmFsdWVzWyJGTkMxX0ZJUlNUX1BPU0lUSU9OIl0gPSA3XSA9ICJGTkMxX0ZJUlNUX1BPU0lUSU9OIjsKCSAgICBNb2RlVmFsdWVzW01vZGVWYWx1ZXNbIkZOQzFfU0VDT05EX1BPU0lUSU9OIl0gPSA4XSA9ICJGTkMxX1NFQ09ORF9QT1NJVElPTiI7CgkgICAgLyoqIFNlZSBHQlQgMTgyODQtMjAwMDsgIkhhbnppIiBpcyBhIHRyYW5zbGl0ZXJhdGlvbiBvZiB0aGlzIG1vZGUgbmFtZS4gKi8KCSAgICBNb2RlVmFsdWVzW01vZGVWYWx1ZXNbIkhBTlpJIl0gPSA5XSA9ICJIQU5aSSI7Cgl9KShNb2RlVmFsdWVzID0gZXhwb3J0cy5Nb2RlVmFsdWVzIHx8IChleHBvcnRzLk1vZGVWYWx1ZXMgPSB7fSkpOwoJLyoqCgkgKiA8cD5TZWUgSVNPIDE4MDA0OjIwMDYsIDYuNC4xLCBUYWJsZXMgMiBhbmQgMy4gVGhpcyBlbnVtIGVuY2Fwc3VsYXRlcyB0aGUgdmFyaW91cyBtb2RlcyBpbiB3aGljaAoJICogZGF0YSBjYW4gYmUgZW5jb2RlZCB0byBiaXRzIGluIHRoZSBRUiBjb2RlIHN0YW5kYXJkLjwvcD4KCSAqCgkgKiBAYXV0aG9yIFNlYW4gT3dlbgoJICovCgl2YXIgTW9kZSA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHsKCSAgICBmdW5jdGlvbiBNb2RlKHZhbHVlLCBzdHJpbmdWYWx1ZSwgY2hhcmFjdGVyQ291bnRCaXRzRm9yVmVyc2lvbnMsIGJpdHMgLyppbnQqLykgewoJICAgICAgICB0aGlzLnZhbHVlID0gdmFsdWU7CgkgICAgICAgIHRoaXMuc3RyaW5nVmFsdWUgPSBzdHJpbmdWYWx1ZTsKCSAgICAgICAgdGhpcy5jaGFyYWN0ZXJDb3VudEJpdHNGb3JWZXJzaW9ucyA9IGNoYXJhY3RlckNvdW50Qml0c0ZvclZlcnNpb25zOwoJICAgICAgICB0aGlzLmJpdHMgPSBiaXRzOwoJICAgICAgICBNb2RlLkZPUl9CSVRTLnNldChiaXRzLCB0aGlzKTsKCSAgICAgICAgTW9kZS5GT1JfVkFMVUUuc2V0KHZhbHVlLCB0aGlzKTsKCSAgICB9CgkgICAgLyoqCgkgICAgICogQHBhcmFtIGJpdHMgZm91ciBiaXRzIGVuY29kaW5nIGEgUVIgQ29kZSBkYXRhIG1vZGUKCSAgICAgKiBAcmV0dXJuIE1vZGUgZW5jb2RlZCBieSB0aGVzZSBiaXRzCgkgICAgICogQHRocm93cyBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb24gaWYgYml0cyBkbyBub3QgY29ycmVzcG9uZCB0byBhIGtub3duIG1vZGUKCSAgICAgKi8KCSAgICBNb2RlLmZvckJpdHMgPSBmdW5jdGlvbiAoYml0cyAvKmludCovKSB7CgkgICAgICAgIHZhciBtb2RlID0gTW9kZS5GT1JfQklUUy5nZXQoYml0cyk7CgkgICAgICAgIGlmICh1bmRlZmluZWQgPT09IG1vZGUpIHsKCSAgICAgICAgICAgIHRocm93IG5ldyBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb25fMS5kZWZhdWx0KCk7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIG1vZGU7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcGFyYW0gdmVyc2lvbiB2ZXJzaW9uIGluIHF1ZXN0aW9uCgkgICAgICogQHJldHVybiBudW1iZXIgb2YgYml0cyB1c2VkLCBpbiB0aGlzIFFSIENvZGUgc3ltYm9sIHtAbGluayBWZXJzaW9ufSwgdG8gZW5jb2RlIHRoZQoJICAgICAqICAgICAgICAgY291bnQgb2YgY2hhcmFjdGVycyB0aGF0IHdpbGwgZm9sbG93IGVuY29kZWQgaW4gdGhpcyBNb2RlCgkgICAgICovCgkgICAgTW9kZS5wcm90b3R5cGUuZ2V0Q2hhcmFjdGVyQ291bnRCaXRzID0gZnVuY3Rpb24gKHZlcnNpb24pIHsKCSAgICAgICAgdmFyIHZlcnNpb25OdW1iZXIgPSB2ZXJzaW9uLmdldFZlcnNpb25OdW1iZXIoKTsKCSAgICAgICAgdmFyIG9mZnNldDsKCSAgICAgICAgaWYgKHZlcnNpb25OdW1iZXIgPD0gOSkgewoJICAgICAgICAgICAgb2Zmc2V0ID0gMDsKCSAgICAgICAgfQoJICAgICAgICBlbHNlIGlmICh2ZXJzaW9uTnVtYmVyIDw9IDI2KSB7CgkgICAgICAgICAgICBvZmZzZXQgPSAxOwoJICAgICAgICB9CgkgICAgICAgIGVsc2UgewoJICAgICAgICAgICAgb2Zmc2V0ID0gMjsKCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gdGhpcy5jaGFyYWN0ZXJDb3VudEJpdHNGb3JWZXJzaW9uc1tvZmZzZXRdOwoJICAgIH07CgkgICAgTW9kZS5wcm90b3R5cGUuZ2V0VmFsdWUgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLnZhbHVlOwoJICAgIH07CgkgICAgTW9kZS5wcm90b3R5cGUuZ2V0Qml0cyA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMuYml0czsKCSAgICB9OwoJICAgIE1vZGUucHJvdG90eXBlLmVxdWFscyA9IGZ1bmN0aW9uIChvKSB7CgkgICAgICAgIGlmICghKG8gaW5zdGFuY2VvZiBNb2RlKSkgewoJICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwoJICAgICAgICB9CgkgICAgICAgIHZhciBvdGhlciA9IG87CgkgICAgICAgIHJldHVybiB0aGlzLnZhbHVlID09PSBvdGhlci52YWx1ZTsKCSAgICB9OwoJICAgIE1vZGUucHJvdG90eXBlLnRvU3RyaW5nID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5zdHJpbmdWYWx1ZTsKCSAgICB9OwoJICAgIE1vZGUuRk9SX0JJVFMgPSBuZXcgTWFwKCk7CgkgICAgTW9kZS5GT1JfVkFMVUUgPSBuZXcgTWFwKCk7CgkgICAgTW9kZS5URVJNSU5BVE9SID0gbmV3IE1vZGUoTW9kZVZhbHVlcy5URVJNSU5BVE9SLCAnVEVSTUlOQVRPUicsIEludDMyQXJyYXkuZnJvbShbMCwgMCwgMF0pLCAweDAwKTsgLy8gTm90IHJlYWxseSBhIG1vZGUuLi4KCSAgICBNb2RlLk5VTUVSSUMgPSBuZXcgTW9kZShNb2RlVmFsdWVzLk5VTUVSSUMsICdOVU1FUklDJywgSW50MzJBcnJheS5mcm9tKFsxMCwgMTIsIDE0XSksIDB4MDEpOwoJICAgIE1vZGUuQUxQSEFOVU1FUklDID0gbmV3IE1vZGUoTW9kZVZhbHVlcy5BTFBIQU5VTUVSSUMsICdBTFBIQU5VTUVSSUMnLCBJbnQzMkFycmF5LmZyb20oWzksIDExLCAxM10pLCAweDAyKTsKCSAgICBNb2RlLlNUUlVDVFVSRURfQVBQRU5EID0gbmV3IE1vZGUoTW9kZVZhbHVlcy5TVFJVQ1RVUkVEX0FQUEVORCwgJ1NUUlVDVFVSRURfQVBQRU5EJywgSW50MzJBcnJheS5mcm9tKFswLCAwLCAwXSksIDB4MDMpOyAvLyBOb3Qgc3VwcG9ydGVkCgkgICAgTW9kZS5CWVRFID0gbmV3IE1vZGUoTW9kZVZhbHVlcy5CWVRFLCAnQllURScsIEludDMyQXJyYXkuZnJvbShbOCwgMTYsIDE2XSksIDB4MDQpOwoJICAgIE1vZGUuRUNJID0gbmV3IE1vZGUoTW9kZVZhbHVlcy5FQ0ksICdFQ0knLCBJbnQzMkFycmF5LmZyb20oWzAsIDAsIDBdKSwgMHgwNyk7IC8vIGNoYXJhY3RlciBjb3VudHMgZG9uJ3QgYXBwbHkKCSAgICBNb2RlLktBTkpJID0gbmV3IE1vZGUoTW9kZVZhbHVlcy5LQU5KSSwgJ0tBTkpJJywgSW50MzJBcnJheS5mcm9tKFs4LCAxMCwgMTJdKSwgMHgwOCk7CgkgICAgTW9kZS5GTkMxX0ZJUlNUX1BPU0lUSU9OID0gbmV3IE1vZGUoTW9kZVZhbHVlcy5GTkMxX0ZJUlNUX1BPU0lUSU9OLCAnRk5DMV9GSVJTVF9QT1NJVElPTicsIEludDMyQXJyYXkuZnJvbShbMCwgMCwgMF0pLCAweDA1KTsKCSAgICBNb2RlLkZOQzFfU0VDT05EX1BPU0lUSU9OID0gbmV3IE1vZGUoTW9kZVZhbHVlcy5GTkMxX1NFQ09ORF9QT1NJVElPTiwgJ0ZOQzFfU0VDT05EX1BPU0lUSU9OJywgSW50MzJBcnJheS5mcm9tKFswLCAwLCAwXSksIDB4MDkpOwoJICAgIC8qKiBTZWUgR0JUIDE4Mjg0LTIwMDA7ICJIYW56aSIgaXMgYSB0cmFuc2xpdGVyYXRpb24gb2YgdGhpcyBtb2RlIG5hbWUuICovCgkgICAgTW9kZS5IQU5aSSA9IG5ldyBNb2RlKE1vZGVWYWx1ZXMuSEFOWkksICdIQU5aSScsIEludDMyQXJyYXkuZnJvbShbOCwgMTAsIDEyXSksIDB4MEQpOwoJICAgIHJldHVybiBNb2RlOwoJfSgpKTsKCWV4cG9ydHMuZGVmYXVsdCA9IE1vZGU7CgoJfShNb2RlKSk7CgoJLyoKCSAqIENvcHlyaWdodCAyMDA3IFpYaW5nIGF1dGhvcnMKCSAqCgkgKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKCSAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4KCSAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdAoJICoKCSAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wCgkgKgoJICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZQoJICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gIkFTIElTIiBCQVNJUywKCSAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLgoJICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZAoJICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuCgkgKi8KCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShEZWNvZGVkQml0U3RyZWFtUGFyc2VyJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCS8qbmFtZXNwYWNlIGNvbS5nb29nbGUuenhpbmcucXJjb2RlLmRlY29kZXIgeyovCgl2YXIgQml0U291cmNlXzEgPSBCaXRTb3VyY2UkMTsKCXZhciBDaGFyYWN0ZXJTZXRFQ0lfMSA9IENoYXJhY3RlclNldEVDSTsKCXZhciBEZWNvZGVyUmVzdWx0XzEgPSBEZWNvZGVyUmVzdWx0JDE7Cgl2YXIgU3RyaW5nVXRpbHNfMSA9IFN0cmluZ1V0aWxzJDE7Cgl2YXIgRm9ybWF0RXhjZXB0aW9uXzEgPSBGb3JtYXRFeGNlcHRpb24kMTsKCXZhciBTdHJpbmdCdWlsZGVyXzEgPSBTdHJpbmdCdWlsZGVyJDE7Cgl2YXIgU3RyaW5nRW5jb2RpbmdfMSA9IFN0cmluZ0VuY29kaW5nJDE7Cgl2YXIgTW9kZV8xID0gTW9kZTsKCS8qaW1wb3J0IGphdmEuaW8uVW5zdXBwb3J0ZWRFbmNvZGluZ0V4Y2VwdGlvbjsqLwoJLyppbXBvcnQgamF2YS51dGlsLkFycmF5TGlzdDsqLwoJLyppbXBvcnQgamF2YS51dGlsLkNvbGxlY3Rpb247Ki8KCS8qaW1wb3J0IGphdmEudXRpbC5MaXN0OyovCgkvKmltcG9ydCBqYXZhLnV0aWwuTWFwOyovCgkvKioKCSAqIDxwPlFSIENvZGVzIGNhbiBlbmNvZGUgdGV4dCBhcyBiaXRzIGluIG9uZSBvZiBzZXZlcmFsIG1vZGVzLCBhbmQgY2FuIHVzZSBtdWx0aXBsZSBtb2RlcwoJICogaW4gb25lIFFSIENvZGUuIFRoaXMgY2xhc3MgZGVjb2RlcyB0aGUgYml0cyBiYWNrIGludG8gdGV4dC48L3A+CgkgKgoJICogPHA+U2VlIElTTyAxODAwNDoyMDA2LCA2LjQuMyAtIDYuNC43PC9wPgoJICoKCSAqIEBhdXRob3IgU2VhbiBPd2VuCgkgKi8KCXZhciBEZWNvZGVkQml0U3RyZWFtUGFyc2VyID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkgewoJICAgIGZ1bmN0aW9uIERlY29kZWRCaXRTdHJlYW1QYXJzZXIoKSB7CgkgICAgfQoJICAgIERlY29kZWRCaXRTdHJlYW1QYXJzZXIuZGVjb2RlID0gZnVuY3Rpb24gKGJ5dGVzLCB2ZXJzaW9uLCBlY0xldmVsLCBoaW50cykgewoJICAgICAgICB2YXIgYml0cyA9IG5ldyBCaXRTb3VyY2VfMS5kZWZhdWx0KGJ5dGVzKTsKCSAgICAgICAgdmFyIHJlc3VsdCA9IG5ldyBTdHJpbmdCdWlsZGVyXzEuZGVmYXVsdCgpOwoJICAgICAgICB2YXIgYnl0ZVNlZ21lbnRzID0gbmV3IEFycmF5KCk7IC8vIDEKCSAgICAgICAgLy8gVFlQRVNDUklQVFBPUlQ6IEkgZG8gbm90IHVzZSBjb25zdHJ1Y3RvciB3aXRoIHNpemUgMSBhcyBpbiBvcmlnaW5hbCBKYXZhIG1lYW5zIGNhcGFjaXR5IGFuZCB0aGUgYXJyYXkgbGVuZ3RoIGlzIGNoZWNrZWQgYmVsb3cKCSAgICAgICAgdmFyIHN5bWJvbFNlcXVlbmNlID0gLTE7CgkgICAgICAgIHZhciBwYXJpdHlEYXRhID0gLTE7CgkgICAgICAgIHRyeSB7CgkgICAgICAgICAgICB2YXIgY3VycmVudENoYXJhY3RlclNldEVDSSA9IG51bGw7CgkgICAgICAgICAgICB2YXIgZmMxSW5FZmZlY3QgPSBmYWxzZTsKCSAgICAgICAgICAgIHZhciBtb2RlID0gdm9pZCAwOwoJICAgICAgICAgICAgZG8gewoJICAgICAgICAgICAgICAgIC8vIFdoaWxlIHN0aWxsIGFub3RoZXIgc2VnbWVudCB0byByZWFkLi4uCgkgICAgICAgICAgICAgICAgaWYgKGJpdHMuYXZhaWxhYmxlKCkgPCA0KSB7CgkgICAgICAgICAgICAgICAgICAgIC8vIE9LLCBhc3N1bWUgd2UncmUgZG9uZS4gUmVhbGx5LCBhIFRFUk1JTkFUT1IgbW9kZSBzaG91bGQgaGF2ZSBiZWVuIHJlY29yZGVkIGhlcmUKCSAgICAgICAgICAgICAgICAgICAgbW9kZSA9IE1vZGVfMS5kZWZhdWx0LlRFUk1JTkFUT1I7CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgIGVsc2UgewoJICAgICAgICAgICAgICAgICAgICB2YXIgbW9kZUJpdHMgPSBiaXRzLnJlYWRCaXRzKDQpOwoJICAgICAgICAgICAgICAgICAgICBtb2RlID0gTW9kZV8xLmRlZmF1bHQuZm9yQml0cyhtb2RlQml0cyk7IC8vIG1vZGUgaXMgZW5jb2RlZCBieSA0IGJpdHMKCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgc3dpdGNoIChtb2RlKSB7CgkgICAgICAgICAgICAgICAgICAgIGNhc2UgTW9kZV8xLmRlZmF1bHQuVEVSTUlOQVRPUjoKCSAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwoJICAgICAgICAgICAgICAgICAgICBjYXNlIE1vZGVfMS5kZWZhdWx0LkZOQzFfRklSU1RfUE9TSVRJT046CgkgICAgICAgICAgICAgICAgICAgIGNhc2UgTW9kZV8xLmRlZmF1bHQuRk5DMV9TRUNPTkRfUE9TSVRJT046CgkgICAgICAgICAgICAgICAgICAgICAgICAvLyBXZSBkbyBsaXR0bGUgd2l0aCBGTkMxIGV4Y2VwdCBhbHRlciB0aGUgcGFyc2VkIHJlc3VsdCBhIGJpdCBhY2NvcmRpbmcgdG8gdGhlIHNwZWMKCSAgICAgICAgICAgICAgICAgICAgICAgIGZjMUluRWZmZWN0ID0gdHJ1ZTsKCSAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwoJICAgICAgICAgICAgICAgICAgICBjYXNlIE1vZGVfMS5kZWZhdWx0LlNUUlVDVFVSRURfQVBQRU5EOgoJICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGJpdHMuYXZhaWxhYmxlKCkgPCAxNikgewoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBGb3JtYXRFeGNlcHRpb25fMS5kZWZhdWx0KCk7CgkgICAgICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgICAgICAvLyBzZXF1ZW5jZSBudW1iZXIgYW5kIHBhcml0eSBpcyBhZGRlZCBsYXRlciB0byB0aGUgcmVzdWx0IG1ldGFkYXRhCgkgICAgICAgICAgICAgICAgICAgICAgICAvLyBSZWFkIG5leHQgOCBiaXRzIChzeW1ib2wgc2VxdWVuY2UgIykgYW5kIDggYml0cyAoZGF0YTogcGFyaXR5KSwgdGhlbiBjb250aW51ZQoJICAgICAgICAgICAgICAgICAgICAgICAgc3ltYm9sU2VxdWVuY2UgPSBiaXRzLnJlYWRCaXRzKDgpOwoJICAgICAgICAgICAgICAgICAgICAgICAgcGFyaXR5RGF0YSA9IGJpdHMucmVhZEJpdHMoOCk7CgkgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKCSAgICAgICAgICAgICAgICAgICAgY2FzZSBNb2RlXzEuZGVmYXVsdC5FQ0k6CgkgICAgICAgICAgICAgICAgICAgICAgICAvLyBDb3VudCBkb2Vzbid0IGFwcGx5IHRvIEVDSQoJICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHZhbHVlID0gRGVjb2RlZEJpdFN0cmVhbVBhcnNlci5wYXJzZUVDSVZhbHVlKGJpdHMpOwoJICAgICAgICAgICAgICAgICAgICAgICAgY3VycmVudENoYXJhY3RlclNldEVDSSA9IENoYXJhY3RlclNldEVDSV8xLmRlZmF1bHQuZ2V0Q2hhcmFjdGVyU2V0RUNJQnlWYWx1ZSh2YWx1ZSk7CgkgICAgICAgICAgICAgICAgICAgICAgICBpZiAoY3VycmVudENoYXJhY3RlclNldEVDSSA9PT0gbnVsbCkgewoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBGb3JtYXRFeGNlcHRpb25fMS5kZWZhdWx0KCk7CgkgICAgICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKCSAgICAgICAgICAgICAgICAgICAgY2FzZSBNb2RlXzEuZGVmYXVsdC5IQU5aSToKCSAgICAgICAgICAgICAgICAgICAgICAgIC8vIEZpcnN0IGhhbmRsZSBIYW56aSBtb2RlIHdoaWNoIGRvZXMgbm90IHN0YXJ0IHdpdGggY2hhcmFjdGVyIGNvdW50CgkgICAgICAgICAgICAgICAgICAgICAgICAvLyBDaGluZXNlIG1vZGUgY29udGFpbnMgYSBzdWIgc2V0IGluZGljYXRvciByaWdodCBhZnRlciBtb2RlIGluZGljYXRvcgoJICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHN1YnNldCA9IGJpdHMucmVhZEJpdHMoNCk7CgkgICAgICAgICAgICAgICAgICAgICAgICB2YXIgY291bnRIYW56aSA9IGJpdHMucmVhZEJpdHMobW9kZS5nZXRDaGFyYWN0ZXJDb3VudEJpdHModmVyc2lvbikpOwoJICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHN1YnNldCA9PT0gRGVjb2RlZEJpdFN0cmVhbVBhcnNlci5HQjIzMTJfU1VCU0VUKSB7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgRGVjb2RlZEJpdFN0cmVhbVBhcnNlci5kZWNvZGVIYW56aVNlZ21lbnQoYml0cywgcmVzdWx0LCBjb3VudEhhbnppKTsKCSAgICAgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwoJICAgICAgICAgICAgICAgICAgICBkZWZhdWx0OgoJICAgICAgICAgICAgICAgICAgICAgICAgLy8gIk5vcm1hbCIgUVIgY29kZSBtb2RlczoKCSAgICAgICAgICAgICAgICAgICAgICAgIC8vIEhvdyBtYW55IGNoYXJhY3RlcnMgd2lsbCBmb2xsb3csIGVuY29kZWQgaW4gdGhpcyBtb2RlPwoJICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGNvdW50ID0gYml0cy5yZWFkQml0cyhtb2RlLmdldENoYXJhY3RlckNvdW50Qml0cyh2ZXJzaW9uKSk7CgkgICAgICAgICAgICAgICAgICAgICAgICBzd2l0Y2ggKG1vZGUpIHsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIE1vZGVfMS5kZWZhdWx0Lk5VTUVSSUM6CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIERlY29kZWRCaXRTdHJlYW1QYXJzZXIuZGVjb2RlTnVtZXJpY1NlZ21lbnQoYml0cywgcmVzdWx0LCBjb3VudCk7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgTW9kZV8xLmRlZmF1bHQuQUxQSEFOVU1FUklDOgoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBEZWNvZGVkQml0U3RyZWFtUGFyc2VyLmRlY29kZUFscGhhbnVtZXJpY1NlZ21lbnQoYml0cywgcmVzdWx0LCBjb3VudCwgZmMxSW5FZmZlY3QpOwoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIE1vZGVfMS5kZWZhdWx0LkJZVEU6CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIERlY29kZWRCaXRTdHJlYW1QYXJzZXIuZGVjb2RlQnl0ZVNlZ21lbnQoYml0cywgcmVzdWx0LCBjb3VudCwgY3VycmVudENoYXJhY3RlclNldEVDSSwgYnl0ZVNlZ21lbnRzLCBoaW50cyk7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgTW9kZV8xLmRlZmF1bHQuS0FOSkk6CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIERlY29kZWRCaXRTdHJlYW1QYXJzZXIuZGVjb2RlS2FuamlTZWdtZW50KGJpdHMsIHJlc3VsdCwgY291bnQpOwoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWZhdWx0OgoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRm9ybWF0RXhjZXB0aW9uXzEuZGVmYXVsdCgpOwoJICAgICAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgfSB3aGlsZSAobW9kZSAhPT0gTW9kZV8xLmRlZmF1bHQuVEVSTUlOQVRPUik7CgkgICAgICAgIH0KCSAgICAgICAgY2F0Y2ggKGlhZSAvKjogSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uKi8pIHsKCSAgICAgICAgICAgIC8vIGZyb20gcmVhZEJpdHMoKSBjYWxscwoJICAgICAgICAgICAgdGhyb3cgbmV3IEZvcm1hdEV4Y2VwdGlvbl8xLmRlZmF1bHQoKTsKCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gbmV3IERlY29kZXJSZXN1bHRfMS5kZWZhdWx0KGJ5dGVzLCByZXN1bHQudG9TdHJpbmcoKSwgYnl0ZVNlZ21lbnRzLmxlbmd0aCA9PT0gMCA/IG51bGwgOiBieXRlU2VnbWVudHMsIGVjTGV2ZWwgPT09IG51bGwgPyBudWxsIDogZWNMZXZlbC50b1N0cmluZygpLCBzeW1ib2xTZXF1ZW5jZSwgcGFyaXR5RGF0YSk7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBTZWUgc3BlY2lmaWNhdGlvbiBHQlQgMTgyODQtMjAwMAoJICAgICAqLwoJICAgIERlY29kZWRCaXRTdHJlYW1QYXJzZXIuZGVjb2RlSGFuemlTZWdtZW50ID0gZnVuY3Rpb24gKGJpdHMsIHJlc3VsdCwgY291bnQgLyppbnQqLykgewoJICAgICAgICAvLyBEb24ndCBjcmFzaCB0cnlpbmcgdG8gcmVhZCBtb3JlIGJpdHMgdGhhbiB3ZSBoYXZlIGF2YWlsYWJsZS4KCSAgICAgICAgaWYgKGNvdW50ICogMTMgPiBiaXRzLmF2YWlsYWJsZSgpKSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgRm9ybWF0RXhjZXB0aW9uXzEuZGVmYXVsdCgpOwoJICAgICAgICB9CgkgICAgICAgIC8vIEVhY2ggY2hhcmFjdGVyIHdpbGwgcmVxdWlyZSAyIGJ5dGVzLiBSZWFkIHRoZSBjaGFyYWN0ZXJzIGFzIDItYnl0ZSBwYWlycwoJICAgICAgICAvLyBhbmQgZGVjb2RlIGFzIEdCMjMxMiBhZnRlcndhcmRzCgkgICAgICAgIHZhciBidWZmZXIgPSBuZXcgVWludDhBcnJheSgyICogY291bnQpOwoJICAgICAgICB2YXIgb2Zmc2V0ID0gMDsKCSAgICAgICAgd2hpbGUgKGNvdW50ID4gMCkgewoJICAgICAgICAgICAgLy8gRWFjaCAxMyBiaXRzIGVuY29kZXMgYSAyLWJ5dGUgY2hhcmFjdGVyCgkgICAgICAgICAgICB2YXIgdHdvQnl0ZXMgPSBiaXRzLnJlYWRCaXRzKDEzKTsKCSAgICAgICAgICAgIHZhciBhc3NlbWJsZWRUd29CeXRlcyA9ICgoKHR3b0J5dGVzIC8gMHgwNjApIDw8IDgpICYgMHhGRkZGRkZGRikgfCAodHdvQnl0ZXMgJSAweDA2MCk7CgkgICAgICAgICAgICBpZiAoYXNzZW1ibGVkVHdvQnl0ZXMgPCAweDAwM0JGKSB7CgkgICAgICAgICAgICAgICAgLy8gSW4gdGhlIDB4QTFBMSB0byAweEFBRkUgcmFuZ2UKCSAgICAgICAgICAgICAgICBhc3NlbWJsZWRUd29CeXRlcyArPSAweDBBMUExOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgZWxzZSB7CgkgICAgICAgICAgICAgICAgLy8gSW4gdGhlIDB4QjBBMSB0byAweEZBRkUgcmFuZ2UKCSAgICAgICAgICAgICAgICBhc3NlbWJsZWRUd29CeXRlcyArPSAweDBBNkExOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgYnVmZmVyW29mZnNldF0gPSAvKihieXRlKSAqLyAoKGFzc2VtYmxlZFR3b0J5dGVzID4+IDgpICYgMHhGRik7CgkgICAgICAgICAgICBidWZmZXJbb2Zmc2V0ICsgMV0gPSAvKihieXRlKSAqLyAoYXNzZW1ibGVkVHdvQnl0ZXMgJiAweEZGKTsKCSAgICAgICAgICAgIG9mZnNldCArPSAyOwoJICAgICAgICAgICAgY291bnQtLTsKCSAgICAgICAgfQoJICAgICAgICB0cnkgewoJICAgICAgICAgICAgcmVzdWx0LmFwcGVuZChTdHJpbmdFbmNvZGluZ18xLmRlZmF1bHQuZGVjb2RlKGJ1ZmZlciwgU3RyaW5nVXRpbHNfMS5kZWZhdWx0LkdCMjMxMikpOwoJICAgICAgICAgICAgLy8gVFlQRVNDUklQVFBPUlQ6IFRPRE86IGltcGxlbWVudCBHQjIzMTIgZGVjb2RlLiBTdHJpbmdWaWV3IGZyb20gTUROIGNvdWxkIGJlIGEgc3RhcnRpbmcgcG9pbnQKCSAgICAgICAgfQoJICAgICAgICBjYXRjaCAoaWdub3JlZCAvKjogVW5zdXBwb3J0ZWRFbmNvZGluZ0V4Y2VwdGlvbiovKSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgRm9ybWF0RXhjZXB0aW9uXzEuZGVmYXVsdChpZ25vcmVkKTsKCSAgICAgICAgfQoJICAgIH07CgkgICAgRGVjb2RlZEJpdFN0cmVhbVBhcnNlci5kZWNvZGVLYW5qaVNlZ21lbnQgPSBmdW5jdGlvbiAoYml0cywgcmVzdWx0LCBjb3VudCAvKmludCovKSB7CgkgICAgICAgIC8vIERvbid0IGNyYXNoIHRyeWluZyB0byByZWFkIG1vcmUgYml0cyB0aGFuIHdlIGhhdmUgYXZhaWxhYmxlLgoJICAgICAgICBpZiAoY291bnQgKiAxMyA+IGJpdHMuYXZhaWxhYmxlKCkpIHsKCSAgICAgICAgICAgIHRocm93IG5ldyBGb3JtYXRFeGNlcHRpb25fMS5kZWZhdWx0KCk7CgkgICAgICAgIH0KCSAgICAgICAgLy8gRWFjaCBjaGFyYWN0ZXIgd2lsbCByZXF1aXJlIDIgYnl0ZXMuIFJlYWQgdGhlIGNoYXJhY3RlcnMgYXMgMi1ieXRlIHBhaXJzCgkgICAgICAgIC8vIGFuZCBkZWNvZGUgYXMgU2hpZnRfSklTIGFmdGVyd2FyZHMKCSAgICAgICAgdmFyIGJ1ZmZlciA9IG5ldyBVaW50OEFycmF5KDIgKiBjb3VudCk7CgkgICAgICAgIHZhciBvZmZzZXQgPSAwOwoJICAgICAgICB3aGlsZSAoY291bnQgPiAwKSB7CgkgICAgICAgICAgICAvLyBFYWNoIDEzIGJpdHMgZW5jb2RlcyBhIDItYnl0ZSBjaGFyYWN0ZXIKCSAgICAgICAgICAgIHZhciB0d29CeXRlcyA9IGJpdHMucmVhZEJpdHMoMTMpOwoJICAgICAgICAgICAgdmFyIGFzc2VtYmxlZFR3b0J5dGVzID0gKCgodHdvQnl0ZXMgLyAweDBDMCkgPDwgOCkgJiAweEZGRkZGRkZGKSB8ICh0d29CeXRlcyAlIDB4MEMwKTsKCSAgICAgICAgICAgIGlmIChhc3NlbWJsZWRUd29CeXRlcyA8IDB4MDFGMDApIHsKCSAgICAgICAgICAgICAgICAvLyBJbiB0aGUgMHg4MTQwIHRvIDB4OUZGQyByYW5nZQoJICAgICAgICAgICAgICAgIGFzc2VtYmxlZFR3b0J5dGVzICs9IDB4MDgxNDA7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBlbHNlIHsKCSAgICAgICAgICAgICAgICAvLyBJbiB0aGUgMHhFMDQwIHRvIDB4RUJCRiByYW5nZQoJICAgICAgICAgICAgICAgIGFzc2VtYmxlZFR3b0J5dGVzICs9IDB4MEMxNDA7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBidWZmZXJbb2Zmc2V0XSA9IC8qKGJ5dGUpICovIChhc3NlbWJsZWRUd29CeXRlcyA+PiA4KTsKCSAgICAgICAgICAgIGJ1ZmZlcltvZmZzZXQgKyAxXSA9IC8qKGJ5dGUpICovIGFzc2VtYmxlZFR3b0J5dGVzOwoJICAgICAgICAgICAgb2Zmc2V0ICs9IDI7CgkgICAgICAgICAgICBjb3VudC0tOwoJICAgICAgICB9CgkgICAgICAgIC8vIFNoaWZ0X0pJUyBtYXkgbm90IGJlIHN1cHBvcnRlZCBpbiBzb21lIGVudmlyb25tZW50czoKCSAgICAgICAgdHJ5IHsKCSAgICAgICAgICAgIHJlc3VsdC5hcHBlbmQoU3RyaW5nRW5jb2RpbmdfMS5kZWZhdWx0LmRlY29kZShidWZmZXIsIFN0cmluZ1V0aWxzXzEuZGVmYXVsdC5TSElGVF9KSVMpKTsKCSAgICAgICAgICAgIC8vIFRZUEVTQ1JJUFRQT1JUOiBUT0RPOiBpbXBsZW1lbnQgU0hJRlRfSklTIGRlY29kZS4gU3RyaW5nVmlldyBmcm9tIE1ETiBjb3VsZCBiZSBhIHN0YXJ0aW5nIHBvaW50CgkgICAgICAgIH0KCSAgICAgICAgY2F0Y2ggKGlnbm9yZWQgLyo6IFVuc3VwcG9ydGVkRW5jb2RpbmdFeGNlcHRpb24qLykgewoJICAgICAgICAgICAgdGhyb3cgbmV3IEZvcm1hdEV4Y2VwdGlvbl8xLmRlZmF1bHQoaWdub3JlZCk7CgkgICAgICAgIH0KCSAgICB9OwoJICAgIERlY29kZWRCaXRTdHJlYW1QYXJzZXIuZGVjb2RlQnl0ZVNlZ21lbnQgPSBmdW5jdGlvbiAoYml0cywgcmVzdWx0LCBjb3VudCAvKmludCovLCBjdXJyZW50Q2hhcmFjdGVyU2V0RUNJLCBieXRlU2VnbWVudHMsIGhpbnRzKSB7CgkgICAgICAgIC8vIERvbid0IGNyYXNoIHRyeWluZyB0byByZWFkIG1vcmUgYml0cyB0aGFuIHdlIGhhdmUgYXZhaWxhYmxlLgoJICAgICAgICBpZiAoOCAqIGNvdW50ID4gYml0cy5hdmFpbGFibGUoKSkgewoJICAgICAgICAgICAgdGhyb3cgbmV3IEZvcm1hdEV4Y2VwdGlvbl8xLmRlZmF1bHQoKTsKCSAgICAgICAgfQoJICAgICAgICB2YXIgcmVhZEJ5dGVzID0gbmV3IFVpbnQ4QXJyYXkoY291bnQpOwoJICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGNvdW50OyBpKyspIHsKCSAgICAgICAgICAgIHJlYWRCeXRlc1tpXSA9IC8qKGJ5dGUpICovIGJpdHMucmVhZEJpdHMoOCk7CgkgICAgICAgIH0KCSAgICAgICAgdmFyIGVuY29kaW5nOwoJICAgICAgICBpZiAoY3VycmVudENoYXJhY3RlclNldEVDSSA9PT0gbnVsbCkgewoJICAgICAgICAgICAgLy8gVGhlIHNwZWMgaXNuJ3QgY2xlYXIgb24gdGhpcyBtb2RlOyBzZWUKCSAgICAgICAgICAgIC8vIHNlY3Rpb24gNi40LjU6IHQgZG9lcyBub3Qgc2F5IHdoaWNoIGVuY29kaW5nIHRvIGFzc3VtaW5nCgkgICAgICAgICAgICAvLyB1cG9uIGRlY29kaW5nLiBJIGhhdmUgc2VlbiBJU08tODg1OS0xIHVzZWQgYXMgd2VsbCBhcwoJICAgICAgICAgICAgLy8gU2hpZnRfSklTIC0tIHdpdGhvdXQgYW55dGhpbmcgbGlrZSBhbiBFQ0kgZGVzaWduYXRvciB0bwoJICAgICAgICAgICAgLy8gZ2l2ZSBhIGhpbnQuCgkgICAgICAgICAgICBlbmNvZGluZyA9IFN0cmluZ1V0aWxzXzEuZGVmYXVsdC5ndWVzc0VuY29kaW5nKHJlYWRCeXRlcywgaGludHMpOwoJICAgICAgICB9CgkgICAgICAgIGVsc2UgewoJICAgICAgICAgICAgZW5jb2RpbmcgPSBjdXJyZW50Q2hhcmFjdGVyU2V0RUNJLmdldE5hbWUoKTsKCSAgICAgICAgfQoJICAgICAgICB0cnkgewoJICAgICAgICAgICAgcmVzdWx0LmFwcGVuZChTdHJpbmdFbmNvZGluZ18xLmRlZmF1bHQuZGVjb2RlKHJlYWRCeXRlcywgZW5jb2RpbmcpKTsKCSAgICAgICAgfQoJICAgICAgICBjYXRjaCAoaWdub3JlZCAvKjogVW5zdXBwb3J0ZWRFbmNvZGluZ0V4Y2VwdGlvbiovKSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgRm9ybWF0RXhjZXB0aW9uXzEuZGVmYXVsdChpZ25vcmVkKTsKCSAgICAgICAgfQoJICAgICAgICBieXRlU2VnbWVudHMucHVzaChyZWFkQnl0ZXMpOwoJICAgIH07CgkgICAgRGVjb2RlZEJpdFN0cmVhbVBhcnNlci50b0FscGhhTnVtZXJpY0NoYXIgPSBmdW5jdGlvbiAodmFsdWUgLyppbnQqLykgewoJICAgICAgICBpZiAodmFsdWUgPj0gRGVjb2RlZEJpdFN0cmVhbVBhcnNlci5BTFBIQU5VTUVSSUNfQ0hBUlMubGVuZ3RoKSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgRm9ybWF0RXhjZXB0aW9uXzEuZGVmYXVsdCgpOwoJICAgICAgICB9CgkgICAgICAgIHJldHVybiBEZWNvZGVkQml0U3RyZWFtUGFyc2VyLkFMUEhBTlVNRVJJQ19DSEFSU1t2YWx1ZV07CgkgICAgfTsKCSAgICBEZWNvZGVkQml0U3RyZWFtUGFyc2VyLmRlY29kZUFscGhhbnVtZXJpY1NlZ21lbnQgPSBmdW5jdGlvbiAoYml0cywgcmVzdWx0LCBjb3VudCAvKmludCovLCBmYzFJbkVmZmVjdCkgewoJICAgICAgICAvLyBSZWFkIHR3byBjaGFyYWN0ZXJzIGF0IGEgdGltZQoJICAgICAgICB2YXIgc3RhcnQgPSByZXN1bHQubGVuZ3RoKCk7CgkgICAgICAgIHdoaWxlIChjb3VudCA+IDEpIHsKCSAgICAgICAgICAgIGlmIChiaXRzLmF2YWlsYWJsZSgpIDwgMTEpIHsKCSAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRm9ybWF0RXhjZXB0aW9uXzEuZGVmYXVsdCgpOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgdmFyIG5leHRUd29DaGFyc0JpdHMgPSBiaXRzLnJlYWRCaXRzKDExKTsKCSAgICAgICAgICAgIHJlc3VsdC5hcHBlbmQoRGVjb2RlZEJpdFN0cmVhbVBhcnNlci50b0FscGhhTnVtZXJpY0NoYXIoTWF0aC5mbG9vcihuZXh0VHdvQ2hhcnNCaXRzIC8gNDUpKSk7CgkgICAgICAgICAgICByZXN1bHQuYXBwZW5kKERlY29kZWRCaXRTdHJlYW1QYXJzZXIudG9BbHBoYU51bWVyaWNDaGFyKG5leHRUd29DaGFyc0JpdHMgJSA0NSkpOwoJICAgICAgICAgICAgY291bnQgLT0gMjsKCSAgICAgICAgfQoJICAgICAgICBpZiAoY291bnQgPT09IDEpIHsKCSAgICAgICAgICAgIC8vIHNwZWNpYWwgY2FzZTogb25lIGNoYXJhY3RlciBsZWZ0CgkgICAgICAgICAgICBpZiAoYml0cy5hdmFpbGFibGUoKSA8IDYpIHsKCSAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRm9ybWF0RXhjZXB0aW9uXzEuZGVmYXVsdCgpOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgcmVzdWx0LmFwcGVuZChEZWNvZGVkQml0U3RyZWFtUGFyc2VyLnRvQWxwaGFOdW1lcmljQ2hhcihiaXRzLnJlYWRCaXRzKDYpKSk7CgkgICAgICAgIH0KCSAgICAgICAgLy8gU2VlIHNlY3Rpb24gNi40LjguMSwgNi40LjguMgoJICAgICAgICBpZiAoZmMxSW5FZmZlY3QpIHsKCSAgICAgICAgICAgIC8vIFdlIG5lZWQgdG8gbWFzc2FnZSB0aGUgcmVzdWx0IGEgYml0IGlmIGluIGFuIEZOQzEgbW9kZToKCSAgICAgICAgICAgIGZvciAodmFyIGkgPSBzdGFydDsgaSA8IHJlc3VsdC5sZW5ndGgoKTsgaSsrKSB7CgkgICAgICAgICAgICAgICAgaWYgKHJlc3VsdC5jaGFyQXQoaSkgPT09ICclJykgewoJICAgICAgICAgICAgICAgICAgICBpZiAoaSA8IHJlc3VsdC5sZW5ndGgoKSAtIDEgJiYgcmVzdWx0LmNoYXJBdChpICsgMSkgPT09ICclJykgewoJICAgICAgICAgICAgICAgICAgICAgICAgLy8gJSUgaXMgcmVuZGVyZWQgYXMgJQoJICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0LmRlbGV0ZUNoYXJBdChpICsgMSk7CgkgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICAgICAgZWxzZSB7CgkgICAgICAgICAgICAgICAgICAgICAgICAvLyBJbiBhbHBoYSBtb2RlLCAlIHNob3VsZCBiZSBjb252ZXJ0ZWQgdG8gRk5DMSBzZXBhcmF0b3IgMHgxRAoJICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0LnNldENoYXJBdChpLCBTdHJpbmcuZnJvbUNoYXJDb2RlKDB4MUQpKTsKCSAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgIH0KCSAgICAgICAgfQoJICAgIH07CgkgICAgRGVjb2RlZEJpdFN0cmVhbVBhcnNlci5kZWNvZGVOdW1lcmljU2VnbWVudCA9IGZ1bmN0aW9uIChiaXRzLCByZXN1bHQsIGNvdW50IC8qaW50Ki8pIHsKCSAgICAgICAgLy8gUmVhZCB0aHJlZSBkaWdpdHMgYXQgYSB0aW1lCgkgICAgICAgIHdoaWxlIChjb3VudCA+PSAzKSB7CgkgICAgICAgICAgICAvLyBFYWNoIDEwIGJpdHMgZW5jb2RlcyB0aHJlZSBkaWdpdHMKCSAgICAgICAgICAgIGlmIChiaXRzLmF2YWlsYWJsZSgpIDwgMTApIHsKCSAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRm9ybWF0RXhjZXB0aW9uXzEuZGVmYXVsdCgpOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgdmFyIHRocmVlRGlnaXRzQml0cyA9IGJpdHMucmVhZEJpdHMoMTApOwoJICAgICAgICAgICAgaWYgKHRocmVlRGlnaXRzQml0cyA+PSAxMDAwKSB7CgkgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEZvcm1hdEV4Y2VwdGlvbl8xLmRlZmF1bHQoKTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIHJlc3VsdC5hcHBlbmQoRGVjb2RlZEJpdFN0cmVhbVBhcnNlci50b0FscGhhTnVtZXJpY0NoYXIoTWF0aC5mbG9vcih0aHJlZURpZ2l0c0JpdHMgLyAxMDApKSk7CgkgICAgICAgICAgICByZXN1bHQuYXBwZW5kKERlY29kZWRCaXRTdHJlYW1QYXJzZXIudG9BbHBoYU51bWVyaWNDaGFyKE1hdGguZmxvb3IodGhyZWVEaWdpdHNCaXRzIC8gMTApICUgMTApKTsKCSAgICAgICAgICAgIHJlc3VsdC5hcHBlbmQoRGVjb2RlZEJpdFN0cmVhbVBhcnNlci50b0FscGhhTnVtZXJpY0NoYXIodGhyZWVEaWdpdHNCaXRzICUgMTApKTsKCSAgICAgICAgICAgIGNvdW50IC09IDM7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKGNvdW50ID09PSAyKSB7CgkgICAgICAgICAgICAvLyBUd28gZGlnaXRzIGxlZnQgb3ZlciB0byByZWFkLCBlbmNvZGVkIGluIDcgYml0cwoJICAgICAgICAgICAgaWYgKGJpdHMuYXZhaWxhYmxlKCkgPCA3KSB7CgkgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEZvcm1hdEV4Y2VwdGlvbl8xLmRlZmF1bHQoKTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIHZhciB0d29EaWdpdHNCaXRzID0gYml0cy5yZWFkQml0cyg3KTsKCSAgICAgICAgICAgIGlmICh0d29EaWdpdHNCaXRzID49IDEwMCkgewoJICAgICAgICAgICAgICAgIHRocm93IG5ldyBGb3JtYXRFeGNlcHRpb25fMS5kZWZhdWx0KCk7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICByZXN1bHQuYXBwZW5kKERlY29kZWRCaXRTdHJlYW1QYXJzZXIudG9BbHBoYU51bWVyaWNDaGFyKE1hdGguZmxvb3IodHdvRGlnaXRzQml0cyAvIDEwKSkpOwoJICAgICAgICAgICAgcmVzdWx0LmFwcGVuZChEZWNvZGVkQml0U3RyZWFtUGFyc2VyLnRvQWxwaGFOdW1lcmljQ2hhcih0d29EaWdpdHNCaXRzICUgMTApKTsKCSAgICAgICAgfQoJICAgICAgICBlbHNlIGlmIChjb3VudCA9PT0gMSkgewoJICAgICAgICAgICAgLy8gT25lIGRpZ2l0IGxlZnQgb3ZlciB0byByZWFkCgkgICAgICAgICAgICBpZiAoYml0cy5hdmFpbGFibGUoKSA8IDQpIHsKCSAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRm9ybWF0RXhjZXB0aW9uXzEuZGVmYXVsdCgpOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgdmFyIGRpZ2l0Qml0cyA9IGJpdHMucmVhZEJpdHMoNCk7CgkgICAgICAgICAgICBpZiAoZGlnaXRCaXRzID49IDEwKSB7CgkgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEZvcm1hdEV4Y2VwdGlvbl8xLmRlZmF1bHQoKTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIHJlc3VsdC5hcHBlbmQoRGVjb2RlZEJpdFN0cmVhbVBhcnNlci50b0FscGhhTnVtZXJpY0NoYXIoZGlnaXRCaXRzKSk7CgkgICAgICAgIH0KCSAgICB9OwoJICAgIERlY29kZWRCaXRTdHJlYW1QYXJzZXIucGFyc2VFQ0lWYWx1ZSA9IGZ1bmN0aW9uIChiaXRzKSB7CgkgICAgICAgIHZhciBmaXJzdEJ5dGUgPSBiaXRzLnJlYWRCaXRzKDgpOwoJICAgICAgICBpZiAoKGZpcnN0Qnl0ZSAmIDB4ODApID09PSAwKSB7CgkgICAgICAgICAgICAvLyBqdXN0IG9uZSBieXRlCgkgICAgICAgICAgICByZXR1cm4gZmlyc3RCeXRlICYgMHg3RjsKCSAgICAgICAgfQoJICAgICAgICBpZiAoKGZpcnN0Qnl0ZSAmIDB4QzApID09PSAweDgwKSB7CgkgICAgICAgICAgICAvLyB0d28gYnl0ZXMKCSAgICAgICAgICAgIHZhciBzZWNvbmRCeXRlID0gYml0cy5yZWFkQml0cyg4KTsKCSAgICAgICAgICAgIHJldHVybiAoKChmaXJzdEJ5dGUgJiAweDNGKSA8PCA4KSAmIDB4RkZGRkZGRkYpIHwgc2Vjb25kQnl0ZTsKCSAgICAgICAgfQoJICAgICAgICBpZiAoKGZpcnN0Qnl0ZSAmIDB4RTApID09PSAweEMwKSB7CgkgICAgICAgICAgICAvLyB0aHJlZSBieXRlcwoJICAgICAgICAgICAgdmFyIHNlY29uZFRoaXJkQnl0ZXMgPSBiaXRzLnJlYWRCaXRzKDE2KTsKCSAgICAgICAgICAgIHJldHVybiAoKChmaXJzdEJ5dGUgJiAweDFGKSA8PCAxNikgJiAweEZGRkZGRkZGKSB8IHNlY29uZFRoaXJkQnl0ZXM7CgkgICAgICAgIH0KCSAgICAgICAgdGhyb3cgbmV3IEZvcm1hdEV4Y2VwdGlvbl8xLmRlZmF1bHQoKTsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIFNlZSBJU08gMTgwMDQ6MjAwNiwgNi40LjQgVGFibGUgNQoJICAgICAqLwoJICAgIERlY29kZWRCaXRTdHJlYW1QYXJzZXIuQUxQSEFOVU1FUklDX0NIQVJTID0gJzAxMjM0NTY3ODlBQkNERUZHSElKS0xNTk9QUVJTVFVWV1hZWiAkJSorLS4vOic7CgkgICAgRGVjb2RlZEJpdFN0cmVhbVBhcnNlci5HQjIzMTJfU1VCU0VUID0gMTsKCSAgICByZXR1cm4gRGVjb2RlZEJpdFN0cmVhbVBhcnNlcjsKCX0oKSk7CglEZWNvZGVkQml0U3RyZWFtUGFyc2VyJDEuZGVmYXVsdCA9IERlY29kZWRCaXRTdHJlYW1QYXJzZXI7CgoJdmFyIFFSQ29kZURlY29kZXJNZXRhRGF0YSQxID0ge307CgoJLyoKCSAqIENvcHlyaWdodCAyMDEzIFpYaW5nIGF1dGhvcnMKCSAqCgkgKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKCSAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4KCSAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdAoJICoKCSAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wCgkgKgoJICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZQoJICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gIkFTIElTIiBCQVNJUywKCSAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLgoJICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZAoJICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuCgkgKi8KCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShRUkNvZGVEZWNvZGVyTWV0YURhdGEkMSwgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJLyoqCgkgKiBNZXRhLWRhdGEgY29udGFpbmVyIGZvciBRUiBDb2RlIGRlY29kaW5nLiBJbnN0YW5jZXMgb2YgdGhpcyBjbGFzcyBtYXkgYmUgdXNlZCB0byBjb252ZXkgaW5mb3JtYXRpb24gYmFjayB0byB0aGUKCSAqIGRlY29kaW5nIGNhbGxlci4gQ2FsbGVycyBhcmUgZXhwZWN0ZWQgdG8gcHJvY2VzcyB0aGlzLgoJICoKCSAqIEBzZWUgY29tLmdvb2dsZS56eGluZy5jb21tb24uRGVjb2RlclJlc3VsdCNnZXRPdGhlcigpCgkgKi8KCXZhciBRUkNvZGVEZWNvZGVyTWV0YURhdGEgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7CgkgICAgZnVuY3Rpb24gUVJDb2RlRGVjb2Rlck1ldGFEYXRhKG1pcnJvcmVkKSB7CgkgICAgICAgIHRoaXMubWlycm9yZWQgPSBtaXJyb3JlZDsKCSAgICB9CgkgICAgLyoqCgkgICAgICogQHJldHVybiB0cnVlIGlmIHRoZSBRUiBDb2RlIHdhcyBtaXJyb3JlZC4KCSAgICAgKi8KCSAgICBRUkNvZGVEZWNvZGVyTWV0YURhdGEucHJvdG90eXBlLmlzTWlycm9yZWQgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLm1pcnJvcmVkOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQXBwbHkgdGhlIHJlc3VsdCBwb2ludHMnIG9yZGVyIGNvcnJlY3Rpb24gZHVlIHRvIG1pcnJvcmluZy4KCSAgICAgKgoJICAgICAqIEBwYXJhbSBwb2ludHMgQXJyYXkgb2YgcG9pbnRzIHRvIGFwcGx5IG1pcnJvciBjb3JyZWN0aW9uIHRvLgoJICAgICAqLwoJICAgIFFSQ29kZURlY29kZXJNZXRhRGF0YS5wcm90b3R5cGUuYXBwbHlNaXJyb3JlZENvcnJlY3Rpb24gPSBmdW5jdGlvbiAocG9pbnRzKSB7CgkgICAgICAgIGlmICghdGhpcy5taXJyb3JlZCB8fCBwb2ludHMgPT09IG51bGwgfHwgcG9pbnRzLmxlbmd0aCA8IDMpIHsKCSAgICAgICAgICAgIHJldHVybjsKCSAgICAgICAgfQoJICAgICAgICB2YXIgYm90dG9tTGVmdCA9IHBvaW50c1swXTsKCSAgICAgICAgcG9pbnRzWzBdID0gcG9pbnRzWzJdOwoJICAgICAgICBwb2ludHNbMl0gPSBib3R0b21MZWZ0OwoJICAgICAgICAvLyBObyBuZWVkIHRvICdmaXgnIHRvcC1sZWZ0IGFuZCBhbGlnbm1lbnQgcGF0dGVybi4KCSAgICB9OwoJICAgIHJldHVybiBRUkNvZGVEZWNvZGVyTWV0YURhdGE7Cgl9KCkpOwoJUVJDb2RlRGVjb2Rlck1ldGFEYXRhJDEuZGVmYXVsdCA9IFFSQ29kZURlY29kZXJNZXRhRGF0YTsKCgkvKgoJICogQ29weXJpZ2h0IDIwMDcgWlhpbmcgYXV0aG9ycwoJICoKCSAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoJICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoJICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkgKgoJICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKCSAqCgkgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCgkgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoJICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCgkgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCSAqLwoJdmFyIF9fdmFsdWVzJDIgPSAoY29tbW9uanNHbG9iYWwgJiYgY29tbW9uanNHbG9iYWwuX192YWx1ZXMpIHx8IGZ1bmN0aW9uKG8pIHsKCSAgICB2YXIgcyA9IHR5cGVvZiBTeW1ib2wgPT09ICJmdW5jdGlvbiIgJiYgU3ltYm9sLml0ZXJhdG9yLCBtID0gcyAmJiBvW3NdLCBpID0gMDsKCSAgICBpZiAobSkgcmV0dXJuIG0uY2FsbChvKTsKCSAgICBpZiAobyAmJiB0eXBlb2Ygby5sZW5ndGggPT09ICJudW1iZXIiKSByZXR1cm4gewoJICAgICAgICBuZXh0OiBmdW5jdGlvbiAoKSB7CgkgICAgICAgICAgICBpZiAobyAmJiBpID49IG8ubGVuZ3RoKSBvID0gdm9pZCAwOwoJICAgICAgICAgICAgcmV0dXJuIHsgdmFsdWU6IG8gJiYgb1tpKytdLCBkb25lOiAhbyB9OwoJICAgICAgICB9CgkgICAgfTsKCSAgICB0aHJvdyBuZXcgVHlwZUVycm9yKHMgPyAiT2JqZWN0IGlzIG5vdCBpdGVyYWJsZS4iIDogIlN5bWJvbC5pdGVyYXRvciBpcyBub3QgZGVmaW5lZC4iKTsKCX07CglPYmplY3QuZGVmaW5lUHJvcGVydHkoRGVjb2RlciQxLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7CgkvKm5hbWVzcGFjZSBjb20uZ29vZ2xlLnp4aW5nLnFyY29kZS5kZWNvZGVyIHsqLwoJdmFyIENoZWNrc3VtRXhjZXB0aW9uXzEgPSBDaGVja3N1bUV4Y2VwdGlvbiQxOwoJdmFyIEJpdE1hdHJpeF8xJDIgPSBCaXRNYXRyaXgkMTsKCXZhciBHZW5lcmljR0ZfMSA9IEdlbmVyaWNHRiQxOwoJdmFyIFJlZWRTb2xvbW9uRGVjb2Rlcl8xID0gUmVlZFNvbG9tb25EZWNvZGVyJDE7Cgl2YXIgQml0TWF0cml4UGFyc2VyXzEgPSBCaXRNYXRyaXhQYXJzZXIkMTsKCXZhciBEYXRhQmxvY2tfMSA9IERhdGFCbG9jayQxOwoJdmFyIERlY29kZWRCaXRTdHJlYW1QYXJzZXJfMSA9IERlY29kZWRCaXRTdHJlYW1QYXJzZXIkMTsKCXZhciBRUkNvZGVEZWNvZGVyTWV0YURhdGFfMSQxID0gUVJDb2RlRGVjb2Rlck1ldGFEYXRhJDE7CgkvKmltcG9ydCBqYXZhLnV0aWwuTWFwOyovCgkvKioKCSAqIDxwPlRoZSBtYWluIGNsYXNzIHdoaWNoIGltcGxlbWVudHMgUVIgQ29kZSBkZWNvZGluZyAtLSBhcyBvcHBvc2VkIHRvIGxvY2F0aW5nIGFuZCBleHRyYWN0aW5nCgkgKiB0aGUgUVIgQ29kZSBmcm9tIGFuIGltYWdlLjwvcD4KCSAqCgkgKiBAYXV0aG9yIFNlYW4gT3dlbgoJICovCgl2YXIgRGVjb2RlciA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHsKCSAgICBmdW5jdGlvbiBEZWNvZGVyKCkgewoJICAgICAgICB0aGlzLnJzRGVjb2RlciA9IG5ldyBSZWVkU29sb21vbkRlY29kZXJfMS5kZWZhdWx0KEdlbmVyaWNHRl8xLmRlZmF1bHQuUVJfQ09ERV9GSUVMRF8yNTYpOwoJICAgIH0KCSAgICAvLyBwdWJsaWMgZGVjb2RlKGltYWdlOiBib29sZWFuW11bXSk6IERlY29kZXJSZXN1bHQgLyp0aHJvd3MgQ2hlY2tzdW1FeGNlcHRpb24sIEZvcm1hdEV4Y2VwdGlvbiovIHsKCSAgICAvLyAgIHJldHVybiBkZWNvZGUoaW1hZ2UsIG51bGwpCgkgICAgLy8gfQoJICAgIC8qKgoJICAgICAqIDxwPkNvbnZlbmllbmNlIG1ldGhvZCB0aGF0IGNhbiBkZWNvZGUgYSBRUiBDb2RlIHJlcHJlc2VudGVkIGFzIGEgMkQgYXJyYXkgb2YgYm9vbGVhbnMuCgkgICAgICogInRydWUiIGlzIHRha2VuIHRvIG1lYW4gYSBibGFjayBtb2R1bGUuPC9wPgoJICAgICAqCgkgICAgICogQHBhcmFtIGltYWdlIGJvb2xlYW5zIHJlcHJlc2VudGluZyB3aGl0ZS9ibGFjayBRUiBDb2RlIG1vZHVsZXMKCSAgICAgKiBAcGFyYW0gaGludHMgZGVjb2RpbmcgaGludHMgdGhhdCBzaG91bGQgYmUgdXNlZCB0byBpbmZsdWVuY2UgZGVjb2RpbmcKCSAgICAgKiBAcmV0dXJuIHRleHQgYW5kIGJ5dGVzIGVuY29kZWQgd2l0aGluIHRoZSBRUiBDb2RlCgkgICAgICogQHRocm93cyBGb3JtYXRFeGNlcHRpb24gaWYgdGhlIFFSIENvZGUgY2Fubm90IGJlIGRlY29kZWQKCSAgICAgKiBAdGhyb3dzIENoZWNrc3VtRXhjZXB0aW9uIGlmIGVycm9yIGNvcnJlY3Rpb24gZmFpbHMKCSAgICAgKi8KCSAgICBEZWNvZGVyLnByb3RvdHlwZS5kZWNvZGVCb29sZWFuQXJyYXkgPSBmdW5jdGlvbiAoaW1hZ2UsIGhpbnRzKSB7CgkgICAgICAgIHJldHVybiB0aGlzLmRlY29kZUJpdE1hdHJpeChCaXRNYXRyaXhfMSQyLmRlZmF1bHQucGFyc2VGcm9tQm9vbGVhbkFycmF5KGltYWdlKSwgaGludHMpOwoJICAgIH07CgkgICAgLy8gcHVibGljIGRlY29kZUJpdE1hdHJpeChiaXRzOiBCaXRNYXRyaXgpOiBEZWNvZGVyUmVzdWx0IC8qdGhyb3dzIENoZWNrc3VtRXhjZXB0aW9uLCBGb3JtYXRFeGNlcHRpb24qLyB7CgkgICAgLy8gICByZXR1cm4gZGVjb2RlKGJpdHMsIG51bGwpCgkgICAgLy8gfQoJICAgIC8qKgoJICAgICAqIDxwPkRlY29kZXMgYSBRUiBDb2RlIHJlcHJlc2VudGVkIGFzIGEge0BsaW5rIEJpdE1hdHJpeH0uIEEgMSBvciAidHJ1ZSIgaXMgdGFrZW4gdG8gbWVhbiBhIGJsYWNrIG1vZHVsZS48L3A+CgkgICAgICoKCSAgICAgKiBAcGFyYW0gYml0cyBib29sZWFucyByZXByZXNlbnRpbmcgd2hpdGUvYmxhY2sgUVIgQ29kZSBtb2R1bGVzCgkgICAgICogQHBhcmFtIGhpbnRzIGRlY29kaW5nIGhpbnRzIHRoYXQgc2hvdWxkIGJlIHVzZWQgdG8gaW5mbHVlbmNlIGRlY29kaW5nCgkgICAgICogQHJldHVybiB0ZXh0IGFuZCBieXRlcyBlbmNvZGVkIHdpdGhpbiB0aGUgUVIgQ29kZQoJICAgICAqIEB0aHJvd3MgRm9ybWF0RXhjZXB0aW9uIGlmIHRoZSBRUiBDb2RlIGNhbm5vdCBiZSBkZWNvZGVkCgkgICAgICogQHRocm93cyBDaGVja3N1bUV4Y2VwdGlvbiBpZiBlcnJvciBjb3JyZWN0aW9uIGZhaWxzCgkgICAgICovCgkgICAgRGVjb2Rlci5wcm90b3R5cGUuZGVjb2RlQml0TWF0cml4ID0gZnVuY3Rpb24gKGJpdHMsIGhpbnRzKSB7CgkgICAgICAgIC8vIENvbnN0cnVjdCBhIHBhcnNlciBhbmQgcmVhZCB2ZXJzaW9uLCBlcnJvci1jb3JyZWN0aW9uIGxldmVsCgkgICAgICAgIHZhciBwYXJzZXIgPSBuZXcgQml0TWF0cml4UGFyc2VyXzEuZGVmYXVsdChiaXRzKTsKCSAgICAgICAgdmFyIGV4ID0gbnVsbDsKCSAgICAgICAgdHJ5IHsKCSAgICAgICAgICAgIHJldHVybiB0aGlzLmRlY29kZUJpdE1hdHJpeFBhcnNlcihwYXJzZXIsIGhpbnRzKTsKCSAgICAgICAgfQoJICAgICAgICBjYXRjaCAoZSAvKjogRm9ybWF0RXhjZXB0aW9uLCBDaGVja3N1bUV4Y2VwdGlvbiovKSB7CgkgICAgICAgICAgICBleCA9IGU7CgkgICAgICAgIH0KCSAgICAgICAgdHJ5IHsKCSAgICAgICAgICAgIC8vIFJldmVydCB0aGUgYml0IG1hdHJpeAoJICAgICAgICAgICAgcGFyc2VyLnJlbWFzaygpOwoJICAgICAgICAgICAgLy8gV2lsbCBiZSBhdHRlbXB0aW5nIGEgbWlycm9yZWQgcmVhZGluZyBvZiB0aGUgdmVyc2lvbiBhbmQgZm9ybWF0IGluZm8uCgkgICAgICAgICAgICBwYXJzZXIuc2V0TWlycm9yKHRydWUpOwoJICAgICAgICAgICAgLy8gUHJlZW1wdGl2ZWx5IHJlYWQgdGhlIHZlcnNpb24uCgkgICAgICAgICAgICBwYXJzZXIucmVhZFZlcnNpb24oKTsKCSAgICAgICAgICAgIC8vIFByZWVtcHRpdmVseSByZWFkIHRoZSBmb3JtYXQgaW5mb3JtYXRpb24uCgkgICAgICAgICAgICBwYXJzZXIucmVhZEZvcm1hdEluZm9ybWF0aW9uKCk7CgkgICAgICAgICAgICAvKgoJICAgICAgICAgICAgICogU2luY2Ugd2UncmUgaGVyZSwgdGhpcyBtZWFucyB3ZSBoYXZlIHN1Y2Nlc3NmdWxseSBkZXRlY3RlZCBzb21lIGtpbmQKCSAgICAgICAgICAgICAqIG9mIHZlcnNpb24gYW5kIGZvcm1hdCBpbmZvcm1hdGlvbiB3aGVuIG1pcnJvcmVkLiBUaGlzIGlzIGEgZ29vZCBzaWduLAoJICAgICAgICAgICAgICogdGhhdCB0aGUgUVIgY29kZSBtYXkgYmUgbWlycm9yZWQsIGFuZCB3ZSBzaG91bGQgdHJ5IG9uY2UgbW9yZSB3aXRoIGEKCSAgICAgICAgICAgICAqIG1pcnJvcmVkIGNvbnRlbnQuCgkgICAgICAgICAgICAgKi8KCSAgICAgICAgICAgIC8vIFByZXBhcmUgZm9yIGEgbWlycm9yZWQgcmVhZGluZy4KCSAgICAgICAgICAgIHBhcnNlci5taXJyb3IoKTsKCSAgICAgICAgICAgIHZhciByZXN1bHQgPSB0aGlzLmRlY29kZUJpdE1hdHJpeFBhcnNlcihwYXJzZXIsIGhpbnRzKTsKCSAgICAgICAgICAgIC8vIFN1Y2Nlc3MhIE5vdGlmeSB0aGUgY2FsbGVyIHRoYXQgdGhlIGNvZGUgd2FzIG1pcnJvcmVkLgoJICAgICAgICAgICAgcmVzdWx0LnNldE90aGVyKG5ldyBRUkNvZGVEZWNvZGVyTWV0YURhdGFfMSQxLmRlZmF1bHQodHJ1ZSkpOwoJICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDsKCSAgICAgICAgfQoJICAgICAgICBjYXRjaCAoZSAvKkZvcm1hdEV4Y2VwdGlvbiB8IENoZWNrc3VtRXhjZXB0aW9uKi8pIHsKCSAgICAgICAgICAgIC8vIFRocm93IHRoZSBleGNlcHRpb24gZnJvbSB0aGUgb3JpZ2luYWwgcmVhZGluZwoJICAgICAgICAgICAgaWYgKGV4ICE9PSBudWxsKSB7CgkgICAgICAgICAgICAgICAgdGhyb3cgZXg7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICB0aHJvdyBlOwoJICAgICAgICB9CgkgICAgfTsKCSAgICBEZWNvZGVyLnByb3RvdHlwZS5kZWNvZGVCaXRNYXRyaXhQYXJzZXIgPSBmdW5jdGlvbiAocGFyc2VyLCBoaW50cykgewoJICAgICAgICB2YXIgZV8xLCBfYSwgZV8yLCBfYjsKCSAgICAgICAgdmFyIHZlcnNpb24gPSBwYXJzZXIucmVhZFZlcnNpb24oKTsKCSAgICAgICAgdmFyIGVjTGV2ZWwgPSBwYXJzZXIucmVhZEZvcm1hdEluZm9ybWF0aW9uKCkuZ2V0RXJyb3JDb3JyZWN0aW9uTGV2ZWwoKTsKCSAgICAgICAgLy8gUmVhZCBjb2Rld29yZHMKCSAgICAgICAgdmFyIGNvZGV3b3JkcyA9IHBhcnNlci5yZWFkQ29kZXdvcmRzKCk7CgkgICAgICAgIC8vIFNlcGFyYXRlIGludG8gZGF0YSBibG9ja3MKCSAgICAgICAgdmFyIGRhdGFCbG9ja3MgPSBEYXRhQmxvY2tfMS5kZWZhdWx0LmdldERhdGFCbG9ja3MoY29kZXdvcmRzLCB2ZXJzaW9uLCBlY0xldmVsKTsKCSAgICAgICAgLy8gQ291bnQgdG90YWwgbnVtYmVyIG9mIGRhdGEgYnl0ZXMKCSAgICAgICAgdmFyIHRvdGFsQnl0ZXMgPSAwOwoJICAgICAgICB0cnkgewoJICAgICAgICAgICAgZm9yICh2YXIgZGF0YUJsb2Nrc18xID0gX192YWx1ZXMkMihkYXRhQmxvY2tzKSwgZGF0YUJsb2Nrc18xXzEgPSBkYXRhQmxvY2tzXzEubmV4dCgpOyAhZGF0YUJsb2Nrc18xXzEuZG9uZTsgZGF0YUJsb2Nrc18xXzEgPSBkYXRhQmxvY2tzXzEubmV4dCgpKSB7CgkgICAgICAgICAgICAgICAgdmFyIGRhdGFCbG9jayA9IGRhdGFCbG9ja3NfMV8xLnZhbHVlOwoJICAgICAgICAgICAgICAgIHRvdGFsQnl0ZXMgKz0gZGF0YUJsb2NrLmdldE51bURhdGFDb2Rld29yZHMoKTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgfQoJICAgICAgICBjYXRjaCAoZV8xXzEpIHsgZV8xID0geyBlcnJvcjogZV8xXzEgfTsgfQoJICAgICAgICBmaW5hbGx5IHsKCSAgICAgICAgICAgIHRyeSB7CgkgICAgICAgICAgICAgICAgaWYgKGRhdGFCbG9ja3NfMV8xICYmICFkYXRhQmxvY2tzXzFfMS5kb25lICYmIChfYSA9IGRhdGFCbG9ja3NfMS5yZXR1cm4pKSBfYS5jYWxsKGRhdGFCbG9ja3NfMSk7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBmaW5hbGx5IHsgaWYgKGVfMSkgdGhyb3cgZV8xLmVycm9yOyB9CgkgICAgICAgIH0KCSAgICAgICAgdmFyIHJlc3VsdEJ5dGVzID0gbmV3IFVpbnQ4QXJyYXkodG90YWxCeXRlcyk7CgkgICAgICAgIHZhciByZXN1bHRPZmZzZXQgPSAwOwoJICAgICAgICB0cnkgewoJICAgICAgICAgICAgLy8gRXJyb3ItY29ycmVjdCBhbmQgY29weSBkYXRhIGJsb2NrcyB0b2dldGhlciBpbnRvIGEgc3RyZWFtIG9mIGJ5dGVzCgkgICAgICAgICAgICBmb3IgKHZhciBkYXRhQmxvY2tzXzIgPSBfX3ZhbHVlcyQyKGRhdGFCbG9ja3MpLCBkYXRhQmxvY2tzXzJfMSA9IGRhdGFCbG9ja3NfMi5uZXh0KCk7ICFkYXRhQmxvY2tzXzJfMS5kb25lOyBkYXRhQmxvY2tzXzJfMSA9IGRhdGFCbG9ja3NfMi5uZXh0KCkpIHsKCSAgICAgICAgICAgICAgICB2YXIgZGF0YUJsb2NrID0gZGF0YUJsb2Nrc18yXzEudmFsdWU7CgkgICAgICAgICAgICAgICAgdmFyIGNvZGV3b3JkQnl0ZXMgPSBkYXRhQmxvY2suZ2V0Q29kZXdvcmRzKCk7CgkgICAgICAgICAgICAgICAgdmFyIG51bURhdGFDb2Rld29yZHMgPSBkYXRhQmxvY2suZ2V0TnVtRGF0YUNvZGV3b3JkcygpOwoJICAgICAgICAgICAgICAgIHRoaXMuY29ycmVjdEVycm9ycyhjb2Rld29yZEJ5dGVzLCBudW1EYXRhQ29kZXdvcmRzKTsKCSAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IG51bURhdGFDb2Rld29yZHM7IGkrKykgewoJICAgICAgICAgICAgICAgICAgICByZXN1bHRCeXRlc1tyZXN1bHRPZmZzZXQrK10gPSBjb2Rld29yZEJ5dGVzW2ldOwoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgIH0KCSAgICAgICAgfQoJICAgICAgICBjYXRjaCAoZV8yXzEpIHsgZV8yID0geyBlcnJvcjogZV8yXzEgfTsgfQoJICAgICAgICBmaW5hbGx5IHsKCSAgICAgICAgICAgIHRyeSB7CgkgICAgICAgICAgICAgICAgaWYgKGRhdGFCbG9ja3NfMl8xICYmICFkYXRhQmxvY2tzXzJfMS5kb25lICYmIChfYiA9IGRhdGFCbG9ja3NfMi5yZXR1cm4pKSBfYi5jYWxsKGRhdGFCbG9ja3NfMik7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBmaW5hbGx5IHsgaWYgKGVfMikgdGhyb3cgZV8yLmVycm9yOyB9CgkgICAgICAgIH0KCSAgICAgICAgLy8gRGVjb2RlIHRoZSBjb250ZW50cyBvZiB0aGF0IHN0cmVhbSBvZiBieXRlcwoJICAgICAgICByZXR1cm4gRGVjb2RlZEJpdFN0cmVhbVBhcnNlcl8xLmRlZmF1bHQuZGVjb2RlKHJlc3VsdEJ5dGVzLCB2ZXJzaW9uLCBlY0xldmVsLCBoaW50cyk7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiA8cD5HaXZlbiBkYXRhIGFuZCBlcnJvci1jb3JyZWN0aW9uIGNvZGV3b3JkcyByZWNlaXZlZCwgcG9zc2libHkgY29ycnVwdGVkIGJ5IGVycm9ycywgYXR0ZW1wdHMgdG8KCSAgICAgKiBjb3JyZWN0IHRoZSBlcnJvcnMgaW4tcGxhY2UgdXNpbmcgUmVlZC1Tb2xvbW9uIGVycm9yIGNvcnJlY3Rpb24uPC9wPgoJICAgICAqCgkgICAgICogQHBhcmFtIGNvZGV3b3JkQnl0ZXMgZGF0YSBhbmQgZXJyb3IgY29ycmVjdGlvbiBjb2Rld29yZHMKCSAgICAgKiBAcGFyYW0gbnVtRGF0YUNvZGV3b3JkcyBudW1iZXIgb2YgY29kZXdvcmRzIHRoYXQgYXJlIGRhdGEgYnl0ZXMKCSAgICAgKiBAdGhyb3dzIENoZWNrc3VtRXhjZXB0aW9uIGlmIGVycm9yIGNvcnJlY3Rpb24gZmFpbHMKCSAgICAgKi8KCSAgICBEZWNvZGVyLnByb3RvdHlwZS5jb3JyZWN0RXJyb3JzID0gZnVuY3Rpb24gKGNvZGV3b3JkQnl0ZXMsIG51bURhdGFDb2Rld29yZHMgLyppbnQqLykgewoJICAgICAgICAvLyBjb25zdCBudW1Db2Rld29yZHMgPSBjb2Rld29yZEJ5dGVzLmxlbmd0aDsKCSAgICAgICAgLy8gRmlyc3QgcmVhZCBpbnRvIGFuIGFycmF5IG9mIGludHMKCSAgICAgICAgdmFyIGNvZGV3b3Jkc0ludHMgPSBuZXcgSW50MzJBcnJheShjb2Rld29yZEJ5dGVzKTsKCSAgICAgICAgLy8gVFlQRVNDUklQVFBPUlQ6IG5vdCByZWFseSBuZWNlc3NhcnkgdG8gdHJhbnNmb3JtIHRvIGludHM/IGNvdWxkIHJlZGVzaWduIGV2ZXJ5dGhpbmcgdG8gd29yayB3aXRoIHVuc2lnbmVkIGJ5dGVzPwoJICAgICAgICAvLyBjb25zdCBjb2Rld29yZHNJbnRzID0gbmV3IEludDMyQXJyYXkobnVtQ29kZXdvcmRzKQoJICAgICAgICAvLyBmb3IgKGxldCBpID0gMDsgaSA8IG51bUNvZGV3b3JkczsgaSsrKSB7CgkgICAgICAgIC8vICAgY29kZXdvcmRzSW50c1tpXSA9IGNvZGV3b3JkQnl0ZXNbaV0gJiAweEZGCgkgICAgICAgIC8vIH0KCSAgICAgICAgdHJ5IHsKCSAgICAgICAgICAgIHRoaXMucnNEZWNvZGVyLmRlY29kZShjb2Rld29yZHNJbnRzLCBjb2Rld29yZEJ5dGVzLmxlbmd0aCAtIG51bURhdGFDb2Rld29yZHMpOwoJICAgICAgICB9CgkgICAgICAgIGNhdGNoIChpZ25vcmVkIC8qOiBSZWVkU29sb21vbkV4Y2VwdGlvbiovKSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgQ2hlY2tzdW1FeGNlcHRpb25fMS5kZWZhdWx0KCk7CgkgICAgICAgIH0KCSAgICAgICAgLy8gQ29weSBiYWNrIGludG8gYXJyYXkgb2YgYnl0ZXMgLS0gb25seSBuZWVkIHRvIHdvcnJ5IGFib3V0IHRoZSBieXRlcyB0aGF0IHdlcmUgZGF0YQoJICAgICAgICAvLyBXZSBkb24ndCBjYXJlIGFib3V0IGVycm9ycyBpbiB0aGUgZXJyb3ItY29ycmVjdGlvbiBjb2Rld29yZHMKCSAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBudW1EYXRhQ29kZXdvcmRzOyBpKyspIHsKCSAgICAgICAgICAgIGNvZGV3b3JkQnl0ZXNbaV0gPSAvKihieXRlKSAqLyBjb2Rld29yZHNJbnRzW2ldOwoJICAgICAgICB9CgkgICAgfTsKCSAgICByZXR1cm4gRGVjb2RlcjsKCX0oKSk7CglEZWNvZGVyJDEuZGVmYXVsdCA9IERlY29kZXI7CgoJdmFyIERldGVjdG9yJDEgPSB7fTsKCgl2YXIgTWF0aFV0aWxzJDEgPSB7fTsKCgkvKgoJICogQ29weXJpZ2h0IDIwMTIgWlhpbmcgYXV0aG9ycwoJICoKCSAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoJICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoJICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkgKgoJICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKCSAqCgkgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCgkgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoJICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCgkgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCSAqLwoJT2JqZWN0LmRlZmluZVByb3BlcnR5KE1hdGhVdGlscyQxLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7CgkvKm5hbWVzcGFjZSBjb20uZ29vZ2xlLnp4aW5nLmNvbW1vbi5kZXRlY3RvciB7Ki8KCS8qKgoJICogR2VuZXJhbCBtYXRoLXJlbGF0ZWQgYW5kIG51bWVyaWMgdXRpbGl0eSBmdW5jdGlvbnMuCgkgKi8KCXZhciBNYXRoVXRpbHMgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7CgkgICAgZnVuY3Rpb24gTWF0aFV0aWxzKCkgewoJICAgIH0KCSAgICAvKioKCSAgICAgKiBFbmRzIHVwIGJlaW5nIGEgYml0IGZhc3RlciB0aGFuIHtAbGluayBNYXRoI3JvdW5kKGZsb2F0KX0uIFRoaXMgbWVyZWx5IHJvdW5kcyBpdHMKCSAgICAgKiBhcmd1bWVudCB0byB0aGUgbmVhcmVzdCBpbnQsIHdoZXJlIHguNSByb3VuZHMgdXAgdG8geCsxLiBTZW1hbnRpY3Mgb2YgdGhpcyBzaG9ydGN1dAoJICAgICAqIGRpZmZlciBzbGlnaHRseSBmcm9tIHtAbGluayBNYXRoI3JvdW5kKGZsb2F0KX0gaW4gdGhhdCBoYWxmIHJvdW5kcyBkb3duIGZvciBuZWdhdGl2ZQoJICAgICAqIHZhbHVlcy4gLTIuNSByb3VuZHMgdG8gLTMsIG5vdCAtMi4gRm9yIHB1cnBvc2VzIGhlcmUgaXQgbWFrZXMgbm8gZGlmZmVyZW5jZS4KCSAgICAgKgoJICAgICAqIEBwYXJhbSBkIHJlYWwgdmFsdWUgdG8gcm91bmQKCSAgICAgKiBAcmV0dXJuIG5lYXJlc3Qge0Bjb2RlIGludH0KCSAgICAgKi8KCSAgICBNYXRoVXRpbHMucm91bmQgPSBmdW5jdGlvbiAoZCAvKmZsb2F0Ki8pIHsKCSAgICAgICAgaWYgKE5hTiA9PT0gZCkKCSAgICAgICAgICAgIHJldHVybiAwOwoJICAgICAgICBpZiAoZCA8PSBOdW1iZXIuTUlOX1NBRkVfSU5URUdFUikKCSAgICAgICAgICAgIHJldHVybiBOdW1iZXIuTUlOX1NBRkVfSU5URUdFUjsKCSAgICAgICAgaWYgKGQgPj0gTnVtYmVyLk1BWF9TQUZFX0lOVEVHRVIpCgkgICAgICAgICAgICByZXR1cm4gTnVtYmVyLk1BWF9TQUZFX0lOVEVHRVI7CgkgICAgICAgIHJldHVybiAvKihpbnQpICovIChkICsgKGQgPCAwLjAgPyAtMC41IDogMC41KSkgfCAwOwoJICAgIH07CgkgICAgLy8gVFlQRVNDUklQVFBPUlQ6IG1heWJlIHJlbW92ZSByb3VuZCBtZXRob2QgYW5kIGNhbGwgZGlyZWN0bHkgTWF0aC5yb3VuZCwgaXQgbG9va3MgbGlrZSBpdCBkb2Vzbid0IG1ha2Ugc2Vuc2UgZm9yIGpzCgkgICAgLyoqCgkgICAgICogQHBhcmFtIGFYIHBvaW50IEEgeCBjb29yZGluYXRlCgkgICAgICogQHBhcmFtIGFZIHBvaW50IEEgeSBjb29yZGluYXRlCgkgICAgICogQHBhcmFtIGJYIHBvaW50IEIgeCBjb29yZGluYXRlCgkgICAgICogQHBhcmFtIGJZIHBvaW50IEIgeSBjb29yZGluYXRlCgkgICAgICogQHJldHVybiBFdWNsaWRlYW4gZGlzdGFuY2UgYmV0d2VlbiBwb2ludHMgQSBhbmQgQgoJICAgICAqLwoJICAgIE1hdGhVdGlscy5kaXN0YW5jZSA9IGZ1bmN0aW9uIChhWCAvKmZsb2F0fGludCovLCBhWSAvKmZsb2F0fGludCovLCBiWCAvKmZsb2F0fGludCovLCBiWSAvKmZsb2F0fGludCovKSB7CgkgICAgICAgIHZhciB4RGlmZiA9IGFYIC0gYlg7CgkgICAgICAgIHZhciB5RGlmZiA9IGFZIC0gYlk7CgkgICAgICAgIHJldHVybiAvKihmbG9hdCkgKi8gTWF0aC5zcXJ0KHhEaWZmICogeERpZmYgKyB5RGlmZiAqIHlEaWZmKTsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEBwYXJhbSBhWCBwb2ludCBBIHggY29vcmRpbmF0ZQoJICAgICAqIEBwYXJhbSBhWSBwb2ludCBBIHkgY29vcmRpbmF0ZQoJICAgICAqIEBwYXJhbSBiWCBwb2ludCBCIHggY29vcmRpbmF0ZQoJICAgICAqIEBwYXJhbSBiWSBwb2ludCBCIHkgY29vcmRpbmF0ZQoJICAgICAqIEByZXR1cm4gRXVjbGlkZWFuIGRpc3RhbmNlIGJldHdlZW4gcG9pbnRzIEEgYW5kIEIKCSAgICAgKi8KCSAgICAvLyBwdWJsaWMgc3RhdGljIGRpc3RhbmNlKGFYOiBudW1iZXIgLyppbnQqLywgYVk6IG51bWJlciAvKmludCovLCBiWDogbnVtYmVyIC8qaW50Ki8sIGJZOiBudW1iZXIgLyppbnQqLyk6IGZsb2F0IHsKCSAgICAvLyAgIGNvbnN0IHhEaWZmID0gYVggLSBiWAoJICAgIC8vICAgY29uc3QgeURpZmYgPSBhWSAtIGJZCgkgICAgLy8gICByZXR1cm4gKGZsb2F0KSBNYXRoLnNxcnQoeERpZmYgKiB4RGlmZiArIHlEaWZmICogeURpZmYpOwoJICAgIC8vIH0KCSAgICAvKioKCSAgICAgKiBAcGFyYW0gYXJyYXkgdmFsdWVzIHRvIHN1bQoJICAgICAqIEByZXR1cm4gc3VtIG9mIHZhbHVlcyBpbiBhcnJheQoJICAgICAqLwoJICAgIE1hdGhVdGlscy5zdW0gPSBmdW5jdGlvbiAoYXJyYXkpIHsKCSAgICAgICAgdmFyIGNvdW50ID0gMDsKCSAgICAgICAgZm9yICh2YXIgaSA9IDAsIGxlbmd0aF8xID0gYXJyYXkubGVuZ3RoOyBpICE9PSBsZW5ndGhfMTsgaSsrKSB7CgkgICAgICAgICAgICB2YXIgYSA9IGFycmF5W2ldOwoJICAgICAgICAgICAgY291bnQgKz0gYTsKCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gY291bnQ7CgkgICAgfTsKCSAgICByZXR1cm4gTWF0aFV0aWxzOwoJfSgpKTsKCU1hdGhVdGlscyQxLmRlZmF1bHQgPSBNYXRoVXRpbHM7CgoJdmFyIERldGVjdG9yUmVzdWx0JDEgPSB7fTsKCgkvKgoJICogQ29weXJpZ2h0IDIwMDcgWlhpbmcgYXV0aG9ycwoJICoKCSAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoJICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoJICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkgKgoJICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKCSAqCgkgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCgkgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoJICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCgkgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCSAqLwoJT2JqZWN0LmRlZmluZVByb3BlcnR5KERldGVjdG9yUmVzdWx0JDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCS8qKgoJICogPHA+RW5jYXBzdWxhdGVzIHRoZSByZXN1bHQgb2YgZGV0ZWN0aW5nIGEgYmFyY29kZSBpbiBhbiBpbWFnZS4gVGhpcyBpbmNsdWRlcyB0aGUgcmF3CgkgKiBtYXRyaXggb2YgYmxhY2svd2hpdGUgcGl4ZWxzIGNvcnJlc3BvbmRpbmcgdG8gdGhlIGJhcmNvZGUsIGFuZCBwb3NzaWJseSBwb2ludHMgb2YgaW50ZXJlc3QKCSAqIGluIHRoZSBpbWFnZSwgbGlrZSB0aGUgbG9jYXRpb24gb2YgZmluZGVyIHBhdHRlcm5zIG9yIGNvcm5lcnMgb2YgdGhlIGJhcmNvZGUgaW4gdGhlIGltYWdlLjwvcD4KCSAqCgkgKiBAYXV0aG9yIFNlYW4gT3dlbgoJICovCgl2YXIgRGV0ZWN0b3JSZXN1bHQgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7CgkgICAgZnVuY3Rpb24gRGV0ZWN0b3JSZXN1bHQoYml0cywgcG9pbnRzKSB7CgkgICAgICAgIHRoaXMuYml0cyA9IGJpdHM7CgkgICAgICAgIHRoaXMucG9pbnRzID0gcG9pbnRzOwoJICAgIH0KCSAgICBEZXRlY3RvclJlc3VsdC5wcm90b3R5cGUuZ2V0Qml0cyA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMuYml0czsKCSAgICB9OwoJICAgIERldGVjdG9yUmVzdWx0LnByb3RvdHlwZS5nZXRQb2ludHMgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLnBvaW50czsKCSAgICB9OwoJICAgIHJldHVybiBEZXRlY3RvclJlc3VsdDsKCX0oKSk7CglEZXRlY3RvclJlc3VsdCQxLmRlZmF1bHQgPSBEZXRlY3RvclJlc3VsdDsKCgl2YXIgR3JpZFNhbXBsZXJJbnN0YW5jZSQxID0ge307CgoJdmFyIERlZmF1bHRHcmlkU2FtcGxlciQxID0ge307CgoJdmFyIEdyaWRTYW1wbGVyJDEgPSB7fTsKCgkvKgoJICogQ29weXJpZ2h0IDIwMDcgWlhpbmcgYXV0aG9ycwoJICoKCSAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoJICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoJICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkgKgoJICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKCSAqCgkgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCgkgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoJICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCgkgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCSAqLwoJT2JqZWN0LmRlZmluZVByb3BlcnR5KEdyaWRTYW1wbGVyJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCXZhciBOb3RGb3VuZEV4Y2VwdGlvbl8xJDUgPSBOb3RGb3VuZEV4Y2VwdGlvbiQxOwoJLyoqCgkgKiBJbXBsZW1lbnRhdGlvbnMgb2YgdGhpcyBjbGFzcyBjYW4sIGdpdmVuIGxvY2F0aW9ucyBvZiBmaW5kZXIgcGF0dGVybnMgZm9yIGEgUVIgY29kZSBpbiBhbgoJICogaW1hZ2UsIHNhbXBsZSB0aGUgcmlnaHQgcG9pbnRzIGluIHRoZSBpbWFnZSB0byByZWNvbnN0cnVjdCB0aGUgUVIgY29kZSwgYWNjb3VudGluZyBmb3IKCSAqIHBlcnNwZWN0aXZlIGRpc3RvcnRpb24uIEl0IGlzIGFic3RyYWN0ZWQgc2luY2UgaXQgaXMgcmVsYXRpdmVseSBleHBlbnNpdmUgYW5kIHNob3VsZCBiZSBhbGxvd2VkCgkgKiB0byB0YWtlIGFkdmFudGFnZSBvZiBwbGF0Zm9ybS1zcGVjaWZpYyBvcHRpbWl6ZWQgaW1wbGVtZW50YXRpb25zLCBsaWtlIFN1bidzIEphdmEgQWR2YW5jZWQKCSAqIEltYWdpbmcgbGlicmFyeSwgYnV0IHdoaWNoIG1heSBub3QgYmUgYXZhaWxhYmxlIGluIG90aGVyIGVudmlyb25tZW50cyBzdWNoIGFzIEoyTUUsIGFuZCB2aWNlCgkgKiB2ZXJzYS4KCSAqCgkgKiBUaGUgaW1wbGVtZW50YXRpb24gdXNlZCBjYW4gYmUgY29udHJvbGxlZCBieSBjYWxsaW5nIHtAbGluayAjc2V0R3JpZFNhbXBsZXIoR3JpZFNhbXBsZXIpfQoJICogd2l0aCBhbiBpbnN0YW5jZSBvZiBhIGNsYXNzIHdoaWNoIGltcGxlbWVudHMgdGhpcyBpbnRlcmZhY2UuCgkgKgoJICogQGF1dGhvciBTZWFuIE93ZW4KCSAqLwoJdmFyIEdyaWRTYW1wbGVyID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkgewoJICAgIGZ1bmN0aW9uIEdyaWRTYW1wbGVyKCkgewoJICAgIH0KCSAgICAvKioKCSAgICAgKiA8cD5DaGVja3MgYSBzZXQgb2YgcG9pbnRzIHRoYXQgaGF2ZSBiZWVuIHRyYW5zZm9ybWVkIHRvIHNhbXBsZSBwb2ludHMgb24gYW4gaW1hZ2UgYWdhaW5zdAoJICAgICAqIHRoZSBpbWFnZSdzIGRpbWVuc2lvbnMgdG8gc2VlIGlmIHRoZSBwb2ludCBhcmUgZXZlbiB3aXRoaW4gdGhlIGltYWdlLjwvcD4KCSAgICAgKgoJICAgICAqIDxwPlRoaXMgbWV0aG9kIHdpbGwgYWN0dWFsbHkgIm51ZGdlIiB0aGUgZW5kcG9pbnRzIGJhY2sgb250byB0aGUgaW1hZ2UgaWYgdGhleSBhcmUgZm91bmQgdG8gYmUKCSAgICAgKiBiYXJlbHkgKGxlc3MgdGhhbiAxIHBpeGVsKSBvZmYgdGhlIGltYWdlLiBUaGlzIGFjY291bnRzIGZvciBpbXBlcmZlY3QgZGV0ZWN0aW9uIG9mIGZpbmRlcgoJICAgICAqIHBhdHRlcm5zIGluIGFuIGltYWdlIHdoZXJlIHRoZSBRUiBDb2RlIHJ1bnMgYWxsIHRoZSB3YXkgdG8gdGhlIGltYWdlIGJvcmRlci48L3A+CgkgICAgICoKCSAgICAgKiA8cD5Gb3IgZWZmaWNpZW5jeSwgdGhlIG1ldGhvZCB3aWxsIGNoZWNrIHBvaW50cyBmcm9tIGVpdGhlciBlbmQgb2YgdGhlIGxpbmUgdW50aWwgb25lIGlzIGZvdW5kCgkgICAgICogdG8gYmUgd2l0aGluIHRoZSBpbWFnZS4gQmVjYXVzZSB0aGUgc2V0IG9mIHBvaW50cyBhcmUgYXNzdW1lZCB0byBiZSBsaW5lYXIsIHRoaXMgaXMgdmFsaWQuPC9wPgoJICAgICAqCgkgICAgICogQHBhcmFtIGltYWdlIGltYWdlIGludG8gd2hpY2ggdGhlIHBvaW50cyBzaG91bGQgbWFwCgkgICAgICogQHBhcmFtIHBvaW50cyBhY3R1YWwgcG9pbnRzIGluIHgxLHkxLC4uLix4bix5biBmb3JtCgkgICAgICogQHRocm93cyBOb3RGb3VuZEV4Y2VwdGlvbiBpZiBhbiBlbmRwb2ludCBpcyBsaWVzIG91dHNpZGUgdGhlIGltYWdlIGJvdW5kYXJpZXMKCSAgICAgKi8KCSAgICBHcmlkU2FtcGxlci5jaGVja0FuZE51ZGdlUG9pbnRzID0gZnVuY3Rpb24gKGltYWdlLCBwb2ludHMpIHsKCSAgICAgICAgdmFyIHdpZHRoID0gaW1hZ2UuZ2V0V2lkdGgoKTsKCSAgICAgICAgdmFyIGhlaWdodCA9IGltYWdlLmdldEhlaWdodCgpOwoJICAgICAgICAvLyBDaGVjayBhbmQgbnVkZ2UgcG9pbnRzIGZyb20gc3RhcnQgdW50aWwgd2Ugc2VlIHNvbWUgdGhhdCBhcmUgT0s6CgkgICAgICAgIHZhciBudWRnZWQgPSB0cnVlOwoJICAgICAgICBmb3IgKHZhciBvZmZzZXQgPSAwOyBvZmZzZXQgPCBwb2ludHMubGVuZ3RoICYmIG51ZGdlZDsgb2Zmc2V0ICs9IDIpIHsKCSAgICAgICAgICAgIHZhciB4ID0gTWF0aC5mbG9vcihwb2ludHNbb2Zmc2V0XSk7CgkgICAgICAgICAgICB2YXIgeSA9IE1hdGguZmxvb3IocG9pbnRzW29mZnNldCArIDFdKTsKCSAgICAgICAgICAgIGlmICh4IDwgLTEgfHwgeCA+IHdpZHRoIHx8IHkgPCAtMSB8fCB5ID4gaGVpZ2h0KSB7CgkgICAgICAgICAgICAgICAgdGhyb3cgbmV3IE5vdEZvdW5kRXhjZXB0aW9uXzEkNS5kZWZhdWx0KCk7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBudWRnZWQgPSBmYWxzZTsKCSAgICAgICAgICAgIGlmICh4ID09PSAtMSkgewoJICAgICAgICAgICAgICAgIHBvaW50c1tvZmZzZXRdID0gMC4wOwoJICAgICAgICAgICAgICAgIG51ZGdlZCA9IHRydWU7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBlbHNlIGlmICh4ID09PSB3aWR0aCkgewoJICAgICAgICAgICAgICAgIHBvaW50c1tvZmZzZXRdID0gd2lkdGggLSAxOwoJICAgICAgICAgICAgICAgIG51ZGdlZCA9IHRydWU7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBpZiAoeSA9PT0gLTEpIHsKCSAgICAgICAgICAgICAgICBwb2ludHNbb2Zmc2V0ICsgMV0gPSAwLjA7CgkgICAgICAgICAgICAgICAgbnVkZ2VkID0gdHJ1ZTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIGVsc2UgaWYgKHkgPT09IGhlaWdodCkgewoJICAgICAgICAgICAgICAgIHBvaW50c1tvZmZzZXQgKyAxXSA9IGhlaWdodCAtIDE7CgkgICAgICAgICAgICAgICAgbnVkZ2VkID0gdHJ1ZTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgfQoJICAgICAgICAvLyBDaGVjayBhbmQgbnVkZ2UgcG9pbnRzIGZyb20gZW5kOgoJICAgICAgICBudWRnZWQgPSB0cnVlOwoJICAgICAgICBmb3IgKHZhciBvZmZzZXQgPSBwb2ludHMubGVuZ3RoIC0gMjsgb2Zmc2V0ID49IDAgJiYgbnVkZ2VkOyBvZmZzZXQgLT0gMikgewoJICAgICAgICAgICAgdmFyIHggPSBNYXRoLmZsb29yKHBvaW50c1tvZmZzZXRdKTsKCSAgICAgICAgICAgIHZhciB5ID0gTWF0aC5mbG9vcihwb2ludHNbb2Zmc2V0ICsgMV0pOwoJICAgICAgICAgICAgaWYgKHggPCAtMSB8fCB4ID4gd2lkdGggfHwgeSA8IC0xIHx8IHkgPiBoZWlnaHQpIHsKCSAgICAgICAgICAgICAgICB0aHJvdyBuZXcgTm90Rm91bmRFeGNlcHRpb25fMSQ1LmRlZmF1bHQoKTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIG51ZGdlZCA9IGZhbHNlOwoJICAgICAgICAgICAgaWYgKHggPT09IC0xKSB7CgkgICAgICAgICAgICAgICAgcG9pbnRzW29mZnNldF0gPSAwLjA7CgkgICAgICAgICAgICAgICAgbnVkZ2VkID0gdHJ1ZTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIGVsc2UgaWYgKHggPT09IHdpZHRoKSB7CgkgICAgICAgICAgICAgICAgcG9pbnRzW29mZnNldF0gPSB3aWR0aCAtIDE7CgkgICAgICAgICAgICAgICAgbnVkZ2VkID0gdHJ1ZTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIGlmICh5ID09PSAtMSkgewoJICAgICAgICAgICAgICAgIHBvaW50c1tvZmZzZXQgKyAxXSA9IDAuMDsKCSAgICAgICAgICAgICAgICBudWRnZWQgPSB0cnVlOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgZWxzZSBpZiAoeSA9PT0gaGVpZ2h0KSB7CgkgICAgICAgICAgICAgICAgcG9pbnRzW29mZnNldCArIDFdID0gaGVpZ2h0IC0gMTsKCSAgICAgICAgICAgICAgICBudWRnZWQgPSB0cnVlOwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgfTsKCSAgICByZXR1cm4gR3JpZFNhbXBsZXI7Cgl9KCkpOwoJR3JpZFNhbXBsZXIkMS5kZWZhdWx0ID0gR3JpZFNhbXBsZXI7CgoJdmFyIFBlcnNwZWN0aXZlVHJhbnNmb3JtJDEgPSB7fTsKCgkvKgoJICogQ29weXJpZ2h0IDIwMDcgWlhpbmcgYXV0aG9ycwoJICoKCSAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoJICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoJICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkgKgoJICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKCSAqCgkgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCgkgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoJICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCgkgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCSAqLwoJT2JqZWN0LmRlZmluZVByb3BlcnR5KFBlcnNwZWN0aXZlVHJhbnNmb3JtJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCS8qbmFtZXNwYWNlIGNvbS5nb29nbGUuenhpbmcuY29tbW9uIHsqLwoJLyoqCgkgKiA8cD5UaGlzIGNsYXNzIGltcGxlbWVudHMgYSBwZXJzcGVjdGl2ZSB0cmFuc2Zvcm0gaW4gdHdvIGRpbWVuc2lvbnMuIEdpdmVuIGZvdXIgc291cmNlIGFuZCBmb3VyCgkgKiBkZXN0aW5hdGlvbiBwb2ludHMsIGl0IHdpbGwgY29tcHV0ZSB0aGUgdHJhbnNmb3JtYXRpb24gaW1wbGllZCBiZXR3ZWVuIHRoZW0uIFRoZSBjb2RlIGlzIGJhc2VkCgkgKiBkaXJlY3RseSB1cG9uIHNlY3Rpb24gMy40LjIgb2YgR2VvcmdlIFdvbGJlcmcncyAiRGlnaXRhbCBJbWFnZSBXYXJwaW5nIjsgc2VlIHBhZ2VzIDU0LTU2LjwvcD4KCSAqCgkgKiBAYXV0aG9yIFNlYW4gT3dlbgoJICovCgl2YXIgUGVyc3BlY3RpdmVUcmFuc2Zvcm0gPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7CgkgICAgZnVuY3Rpb24gUGVyc3BlY3RpdmVUcmFuc2Zvcm0oYTExIC8qZmxvYXQqLywgYTIxIC8qZmxvYXQqLywgYTMxIC8qZmxvYXQqLywgYTEyIC8qZmxvYXQqLywgYTIyIC8qZmxvYXQqLywgYTMyIC8qZmxvYXQqLywgYTEzIC8qZmxvYXQqLywgYTIzIC8qZmxvYXQqLywgYTMzIC8qZmxvYXQqLykgewoJICAgICAgICB0aGlzLmExMSA9IGExMTsKCSAgICAgICAgdGhpcy5hMjEgPSBhMjE7CgkgICAgICAgIHRoaXMuYTMxID0gYTMxOwoJICAgICAgICB0aGlzLmExMiA9IGExMjsKCSAgICAgICAgdGhpcy5hMjIgPSBhMjI7CgkgICAgICAgIHRoaXMuYTMyID0gYTMyOwoJICAgICAgICB0aGlzLmExMyA9IGExMzsKCSAgICAgICAgdGhpcy5hMjMgPSBhMjM7CgkgICAgICAgIHRoaXMuYTMzID0gYTMzOwoJICAgIH0KCSAgICBQZXJzcGVjdGl2ZVRyYW5zZm9ybS5xdWFkcmlsYXRlcmFsVG9RdWFkcmlsYXRlcmFsID0gZnVuY3Rpb24gKHgwIC8qZmxvYXQqLywgeTAgLypmbG9hdCovLCB4MSAvKmZsb2F0Ki8sIHkxIC8qZmxvYXQqLywgeDIgLypmbG9hdCovLCB5MiAvKmZsb2F0Ki8sIHgzIC8qZmxvYXQqLywgeTMgLypmbG9hdCovLCB4MHAgLypmbG9hdCovLCB5MHAgLypmbG9hdCovLCB4MXAgLypmbG9hdCovLCB5MXAgLypmbG9hdCovLCB4MnAgLypmbG9hdCovLCB5MnAgLypmbG9hdCovLCB4M3AgLypmbG9hdCovLCB5M3AgLypmbG9hdCovKSB7CgkgICAgICAgIHZhciBxVG9TID0gUGVyc3BlY3RpdmVUcmFuc2Zvcm0ucXVhZHJpbGF0ZXJhbFRvU3F1YXJlKHgwLCB5MCwgeDEsIHkxLCB4MiwgeTIsIHgzLCB5Myk7CgkgICAgICAgIHZhciBzVG9RID0gUGVyc3BlY3RpdmVUcmFuc2Zvcm0uc3F1YXJlVG9RdWFkcmlsYXRlcmFsKHgwcCwgeTBwLCB4MXAsIHkxcCwgeDJwLCB5MnAsIHgzcCwgeTNwKTsKCSAgICAgICAgcmV0dXJuIHNUb1EudGltZXMocVRvUyk7CgkgICAgfTsKCSAgICBQZXJzcGVjdGl2ZVRyYW5zZm9ybS5wcm90b3R5cGUudHJhbnNmb3JtUG9pbnRzID0gZnVuY3Rpb24gKHBvaW50cykgewoJICAgICAgICB2YXIgbWF4ID0gcG9pbnRzLmxlbmd0aDsKCSAgICAgICAgdmFyIGExMSA9IHRoaXMuYTExOwoJICAgICAgICB2YXIgYTEyID0gdGhpcy5hMTI7CgkgICAgICAgIHZhciBhMTMgPSB0aGlzLmExMzsKCSAgICAgICAgdmFyIGEyMSA9IHRoaXMuYTIxOwoJICAgICAgICB2YXIgYTIyID0gdGhpcy5hMjI7CgkgICAgICAgIHZhciBhMjMgPSB0aGlzLmEyMzsKCSAgICAgICAgdmFyIGEzMSA9IHRoaXMuYTMxOwoJICAgICAgICB2YXIgYTMyID0gdGhpcy5hMzI7CgkgICAgICAgIHZhciBhMzMgPSB0aGlzLmEzMzsKCSAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBtYXg7IGkgKz0gMikgewoJICAgICAgICAgICAgdmFyIHggPSBwb2ludHNbaV07CgkgICAgICAgICAgICB2YXIgeSA9IHBvaW50c1tpICsgMV07CgkgICAgICAgICAgICB2YXIgZGVub21pbmF0b3IgPSBhMTMgKiB4ICsgYTIzICogeSArIGEzMzsKCSAgICAgICAgICAgIHBvaW50c1tpXSA9IChhMTEgKiB4ICsgYTIxICogeSArIGEzMSkgLyBkZW5vbWluYXRvcjsKCSAgICAgICAgICAgIHBvaW50c1tpICsgMV0gPSAoYTEyICogeCArIGEyMiAqIHkgKyBhMzIpIC8gZGVub21pbmF0b3I7CgkgICAgICAgIH0KCSAgICB9OwoJICAgIFBlcnNwZWN0aXZlVHJhbnNmb3JtLnByb3RvdHlwZS50cmFuc2Zvcm1Qb2ludHNXaXRoVmFsdWVzID0gZnVuY3Rpb24gKHhWYWx1ZXMsIHlWYWx1ZXMpIHsKCSAgICAgICAgdmFyIGExMSA9IHRoaXMuYTExOwoJICAgICAgICB2YXIgYTEyID0gdGhpcy5hMTI7CgkgICAgICAgIHZhciBhMTMgPSB0aGlzLmExMzsKCSAgICAgICAgdmFyIGEyMSA9IHRoaXMuYTIxOwoJICAgICAgICB2YXIgYTIyID0gdGhpcy5hMjI7CgkgICAgICAgIHZhciBhMjMgPSB0aGlzLmEyMzsKCSAgICAgICAgdmFyIGEzMSA9IHRoaXMuYTMxOwoJICAgICAgICB2YXIgYTMyID0gdGhpcy5hMzI7CgkgICAgICAgIHZhciBhMzMgPSB0aGlzLmEzMzsKCSAgICAgICAgdmFyIG4gPSB4VmFsdWVzLmxlbmd0aDsKCSAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBuOyBpKyspIHsKCSAgICAgICAgICAgIHZhciB4ID0geFZhbHVlc1tpXTsKCSAgICAgICAgICAgIHZhciB5ID0geVZhbHVlc1tpXTsKCSAgICAgICAgICAgIHZhciBkZW5vbWluYXRvciA9IGExMyAqIHggKyBhMjMgKiB5ICsgYTMzOwoJICAgICAgICAgICAgeFZhbHVlc1tpXSA9IChhMTEgKiB4ICsgYTIxICogeSArIGEzMSkgLyBkZW5vbWluYXRvcjsKCSAgICAgICAgICAgIHlWYWx1ZXNbaV0gPSAoYTEyICogeCArIGEyMiAqIHkgKyBhMzIpIC8gZGVub21pbmF0b3I7CgkgICAgICAgIH0KCSAgICB9OwoJICAgIFBlcnNwZWN0aXZlVHJhbnNmb3JtLnNxdWFyZVRvUXVhZHJpbGF0ZXJhbCA9IGZ1bmN0aW9uICh4MCAvKmZsb2F0Ki8sIHkwIC8qZmxvYXQqLywgeDEgLypmbG9hdCovLCB5MSAvKmZsb2F0Ki8sIHgyIC8qZmxvYXQqLywgeTIgLypmbG9hdCovLCB4MyAvKmZsb2F0Ki8sIHkzIC8qZmxvYXQqLykgewoJICAgICAgICB2YXIgZHgzID0geDAgLSB4MSArIHgyIC0geDM7CgkgICAgICAgIHZhciBkeTMgPSB5MCAtIHkxICsgeTIgLSB5MzsKCSAgICAgICAgaWYgKGR4MyA9PT0gMC4wICYmIGR5MyA9PT0gMC4wKSB7CgkgICAgICAgICAgICAvLyBBZmZpbmUKCSAgICAgICAgICAgIHJldHVybiBuZXcgUGVyc3BlY3RpdmVUcmFuc2Zvcm0oeDEgLSB4MCwgeDIgLSB4MSwgeDAsIHkxIC0geTAsIHkyIC0geTEsIHkwLCAwLjAsIDAuMCwgMS4wKTsKCSAgICAgICAgfQoJICAgICAgICBlbHNlIHsKCSAgICAgICAgICAgIHZhciBkeDEgPSB4MSAtIHgyOwoJICAgICAgICAgICAgdmFyIGR4MiA9IHgzIC0geDI7CgkgICAgICAgICAgICB2YXIgZHkxID0geTEgLSB5MjsKCSAgICAgICAgICAgIHZhciBkeTIgPSB5MyAtIHkyOwoJICAgICAgICAgICAgdmFyIGRlbm9taW5hdG9yID0gZHgxICogZHkyIC0gZHgyICogZHkxOwoJICAgICAgICAgICAgdmFyIGExMyA9IChkeDMgKiBkeTIgLSBkeDIgKiBkeTMpIC8gZGVub21pbmF0b3I7CgkgICAgICAgICAgICB2YXIgYTIzID0gKGR4MSAqIGR5MyAtIGR4MyAqIGR5MSkgLyBkZW5vbWluYXRvcjsKCSAgICAgICAgICAgIHJldHVybiBuZXcgUGVyc3BlY3RpdmVUcmFuc2Zvcm0oeDEgLSB4MCArIGExMyAqIHgxLCB4MyAtIHgwICsgYTIzICogeDMsIHgwLCB5MSAtIHkwICsgYTEzICogeTEsIHkzIC0geTAgKyBhMjMgKiB5MywgeTAsIGExMywgYTIzLCAxLjApOwoJICAgICAgICB9CgkgICAgfTsKCSAgICBQZXJzcGVjdGl2ZVRyYW5zZm9ybS5xdWFkcmlsYXRlcmFsVG9TcXVhcmUgPSBmdW5jdGlvbiAoeDAgLypmbG9hdCovLCB5MCAvKmZsb2F0Ki8sIHgxIC8qZmxvYXQqLywgeTEgLypmbG9hdCovLCB4MiAvKmZsb2F0Ki8sIHkyIC8qZmxvYXQqLywgeDMgLypmbG9hdCovLCB5MyAvKmZsb2F0Ki8pIHsKCSAgICAgICAgLy8gSGVyZSwgdGhlIGFkam9pbnQgc2VydmVzIGFzIHRoZSBpbnZlcnNlOgoJICAgICAgICByZXR1cm4gUGVyc3BlY3RpdmVUcmFuc2Zvcm0uc3F1YXJlVG9RdWFkcmlsYXRlcmFsKHgwLCB5MCwgeDEsIHkxLCB4MiwgeTIsIHgzLCB5MykuYnVpbGRBZGpvaW50KCk7CgkgICAgfTsKCSAgICBQZXJzcGVjdGl2ZVRyYW5zZm9ybS5wcm90b3R5cGUuYnVpbGRBZGpvaW50ID0gZnVuY3Rpb24gKCkgewoJICAgICAgICAvLyBBZGpvaW50IGlzIHRoZSB0cmFuc3Bvc2Ugb2YgdGhlIGNvZmFjdG9yIG1hdHJpeDoKCSAgICAgICAgcmV0dXJuIG5ldyBQZXJzcGVjdGl2ZVRyYW5zZm9ybSh0aGlzLmEyMiAqIHRoaXMuYTMzIC0gdGhpcy5hMjMgKiB0aGlzLmEzMiwgdGhpcy5hMjMgKiB0aGlzLmEzMSAtIHRoaXMuYTIxICogdGhpcy5hMzMsIHRoaXMuYTIxICogdGhpcy5hMzIgLSB0aGlzLmEyMiAqIHRoaXMuYTMxLCB0aGlzLmExMyAqIHRoaXMuYTMyIC0gdGhpcy5hMTIgKiB0aGlzLmEzMywgdGhpcy5hMTEgKiB0aGlzLmEzMyAtIHRoaXMuYTEzICogdGhpcy5hMzEsIHRoaXMuYTEyICogdGhpcy5hMzEgLSB0aGlzLmExMSAqIHRoaXMuYTMyLCB0aGlzLmExMiAqIHRoaXMuYTIzIC0gdGhpcy5hMTMgKiB0aGlzLmEyMiwgdGhpcy5hMTMgKiB0aGlzLmEyMSAtIHRoaXMuYTExICogdGhpcy5hMjMsIHRoaXMuYTExICogdGhpcy5hMjIgLSB0aGlzLmExMiAqIHRoaXMuYTIxKTsKCSAgICB9OwoJICAgIFBlcnNwZWN0aXZlVHJhbnNmb3JtLnByb3RvdHlwZS50aW1lcyA9IGZ1bmN0aW9uIChvdGhlcikgewoJICAgICAgICByZXR1cm4gbmV3IFBlcnNwZWN0aXZlVHJhbnNmb3JtKHRoaXMuYTExICogb3RoZXIuYTExICsgdGhpcy5hMjEgKiBvdGhlci5hMTIgKyB0aGlzLmEzMSAqIG90aGVyLmExMywgdGhpcy5hMTEgKiBvdGhlci5hMjEgKyB0aGlzLmEyMSAqIG90aGVyLmEyMiArIHRoaXMuYTMxICogb3RoZXIuYTIzLCB0aGlzLmExMSAqIG90aGVyLmEzMSArIHRoaXMuYTIxICogb3RoZXIuYTMyICsgdGhpcy5hMzEgKiBvdGhlci5hMzMsIHRoaXMuYTEyICogb3RoZXIuYTExICsgdGhpcy5hMjIgKiBvdGhlci5hMTIgKyB0aGlzLmEzMiAqIG90aGVyLmExMywgdGhpcy5hMTIgKiBvdGhlci5hMjEgKyB0aGlzLmEyMiAqIG90aGVyLmEyMiArIHRoaXMuYTMyICogb3RoZXIuYTIzLCB0aGlzLmExMiAqIG90aGVyLmEzMSArIHRoaXMuYTIyICogb3RoZXIuYTMyICsgdGhpcy5hMzIgKiBvdGhlci5hMzMsIHRoaXMuYTEzICogb3RoZXIuYTExICsgdGhpcy5hMjMgKiBvdGhlci5hMTIgKyB0aGlzLmEzMyAqIG90aGVyLmExMywgdGhpcy5hMTMgKiBvdGhlci5hMjEgKyB0aGlzLmEyMyAqIG90aGVyLmEyMiArIHRoaXMuYTMzICogb3RoZXIuYTIzLCB0aGlzLmExMyAqIG90aGVyLmEzMSArIHRoaXMuYTIzICogb3RoZXIuYTMyICsgdGhpcy5hMzMgKiBvdGhlci5hMzMpOwoJICAgIH07CgkgICAgcmV0dXJuIFBlcnNwZWN0aXZlVHJhbnNmb3JtOwoJfSgpKTsKCVBlcnNwZWN0aXZlVHJhbnNmb3JtJDEuZGVmYXVsdCA9IFBlcnNwZWN0aXZlVHJhbnNmb3JtOwoKCS8qCgkgKiBDb3B5cmlnaHQgMjAwNyBaWGluZyBhdXRob3JzCgkgKgoJICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIik7CgkgKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCgkgKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKCSAqCgkgKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAoJICoKCSAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKCSAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCgkgKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4KCSAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKCSAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgoJICovCgl2YXIgX19leHRlbmRzJDIgPSAoY29tbW9uanNHbG9iYWwgJiYgY29tbW9uanNHbG9iYWwuX19leHRlbmRzKSB8fCAoZnVuY3Rpb24gKCkgewoJICAgIHZhciBleHRlbmRTdGF0aWNzID0gZnVuY3Rpb24gKGQsIGIpIHsKCSAgICAgICAgZXh0ZW5kU3RhdGljcyA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fAoJICAgICAgICAgICAgKHsgX19wcm90b19fOiBbXSB9IGluc3RhbmNlb2YgQXJyYXkgJiYgZnVuY3Rpb24gKGQsIGIpIHsgZC5fX3Byb3RvX18gPSBiOyB9KSB8fAoJICAgICAgICAgICAgZnVuY3Rpb24gKGQsIGIpIHsgZm9yICh2YXIgcCBpbiBiKSBpZiAoYi5oYXNPd25Qcm9wZXJ0eShwKSkgZFtwXSA9IGJbcF07IH07CgkgICAgICAgIHJldHVybiBleHRlbmRTdGF0aWNzKGQsIGIpOwoJICAgIH07CgkgICAgcmV0dXJuIGZ1bmN0aW9uIChkLCBiKSB7CgkgICAgICAgIGV4dGVuZFN0YXRpY3MoZCwgYik7CgkgICAgICAgIGZ1bmN0aW9uIF9fKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gZDsgfQoJICAgICAgICBkLnByb3RvdHlwZSA9IGIgPT09IG51bGwgPyBPYmplY3QuY3JlYXRlKGIpIDogKF9fLnByb3RvdHlwZSA9IGIucHJvdG90eXBlLCBuZXcgX18oKSk7CgkgICAgfTsKCX0pKCk7CglPYmplY3QuZGVmaW5lUHJvcGVydHkoRGVmYXVsdEdyaWRTYW1wbGVyJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCS8qbmFtZXNwYWNlIGNvbS5nb29nbGUuenhpbmcuY29tbW9uIHsqLwoJdmFyIEdyaWRTYW1wbGVyXzEgPSBHcmlkU2FtcGxlciQxOwoJdmFyIEJpdE1hdHJpeF8xJDEgPSBCaXRNYXRyaXgkMTsKCXZhciBQZXJzcGVjdGl2ZVRyYW5zZm9ybV8xJDEgPSBQZXJzcGVjdGl2ZVRyYW5zZm9ybSQxOwoJdmFyIE5vdEZvdW5kRXhjZXB0aW9uXzEkNCA9IE5vdEZvdW5kRXhjZXB0aW9uJDE7CgkvKioKCSAqIEBhdXRob3IgU2VhbiBPd2VuCgkgKi8KCXZhciBEZWZhdWx0R3JpZFNhbXBsZXIgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7CgkgICAgX19leHRlbmRzJDIoRGVmYXVsdEdyaWRTYW1wbGVyLCBfc3VwZXIpOwoJICAgIGZ1bmN0aW9uIERlZmF1bHRHcmlkU2FtcGxlcigpIHsKCSAgICAgICAgcmV0dXJuIF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzOwoJICAgIH0KCSAgICAvKkBPdmVycmlkZSovCgkgICAgRGVmYXVsdEdyaWRTYW1wbGVyLnByb3RvdHlwZS5zYW1wbGVHcmlkID0gZnVuY3Rpb24gKGltYWdlLCBkaW1lbnNpb25YIC8qaW50Ki8sIGRpbWVuc2lvblkgLyppbnQqLywgcDFUb1ggLypmbG9hdCovLCBwMVRvWSAvKmZsb2F0Ki8sIHAyVG9YIC8qZmxvYXQqLywgcDJUb1kgLypmbG9hdCovLCBwM1RvWCAvKmZsb2F0Ki8sIHAzVG9ZIC8qZmxvYXQqLywgcDRUb1ggLypmbG9hdCovLCBwNFRvWSAvKmZsb2F0Ki8sIHAxRnJvbVggLypmbG9hdCovLCBwMUZyb21ZIC8qZmxvYXQqLywgcDJGcm9tWCAvKmZsb2F0Ki8sIHAyRnJvbVkgLypmbG9hdCovLCBwM0Zyb21YIC8qZmxvYXQqLywgcDNGcm9tWSAvKmZsb2F0Ki8sIHA0RnJvbVggLypmbG9hdCovLCBwNEZyb21ZIC8qZmxvYXQqLykgewoJICAgICAgICB2YXIgdHJhbnNmb3JtID0gUGVyc3BlY3RpdmVUcmFuc2Zvcm1fMSQxLmRlZmF1bHQucXVhZHJpbGF0ZXJhbFRvUXVhZHJpbGF0ZXJhbChwMVRvWCwgcDFUb1ksIHAyVG9YLCBwMlRvWSwgcDNUb1gsIHAzVG9ZLCBwNFRvWCwgcDRUb1ksIHAxRnJvbVgsIHAxRnJvbVksIHAyRnJvbVgsIHAyRnJvbVksIHAzRnJvbVgsIHAzRnJvbVksIHA0RnJvbVgsIHA0RnJvbVkpOwoJICAgICAgICByZXR1cm4gdGhpcy5zYW1wbGVHcmlkV2l0aFRyYW5zZm9ybShpbWFnZSwgZGltZW5zaW9uWCwgZGltZW5zaW9uWSwgdHJhbnNmb3JtKTsKCSAgICB9OwoJICAgIC8qQE92ZXJyaWRlKi8KCSAgICBEZWZhdWx0R3JpZFNhbXBsZXIucHJvdG90eXBlLnNhbXBsZUdyaWRXaXRoVHJhbnNmb3JtID0gZnVuY3Rpb24gKGltYWdlLCBkaW1lbnNpb25YIC8qaW50Ki8sIGRpbWVuc2lvblkgLyppbnQqLywgdHJhbnNmb3JtKSB7CgkgICAgICAgIGlmIChkaW1lbnNpb25YIDw9IDAgfHwgZGltZW5zaW9uWSA8PSAwKSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgTm90Rm91bmRFeGNlcHRpb25fMSQ0LmRlZmF1bHQoKTsKCSAgICAgICAgfQoJICAgICAgICB2YXIgYml0cyA9IG5ldyBCaXRNYXRyaXhfMSQxLmRlZmF1bHQoZGltZW5zaW9uWCwgZGltZW5zaW9uWSk7CgkgICAgICAgIHZhciBwb2ludHMgPSBuZXcgRmxvYXQzMkFycmF5KDIgKiBkaW1lbnNpb25YKTsKCSAgICAgICAgZm9yICh2YXIgeSA9IDA7IHkgPCBkaW1lbnNpb25ZOyB5KyspIHsKCSAgICAgICAgICAgIHZhciBtYXggPSBwb2ludHMubGVuZ3RoOwoJICAgICAgICAgICAgdmFyIGlWYWx1ZSA9IHkgKyAwLjU7CgkgICAgICAgICAgICBmb3IgKHZhciB4ID0gMDsgeCA8IG1heDsgeCArPSAyKSB7CgkgICAgICAgICAgICAgICAgcG9pbnRzW3hdID0gKHggLyAyKSArIDAuNTsKCSAgICAgICAgICAgICAgICBwb2ludHNbeCArIDFdID0gaVZhbHVlOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgdHJhbnNmb3JtLnRyYW5zZm9ybVBvaW50cyhwb2ludHMpOwoJICAgICAgICAgICAgLy8gUXVpY2sgY2hlY2sgdG8gc2VlIGlmIHBvaW50cyB0cmFuc2Zvcm1lZCB0byBzb21ldGhpbmcgaW5zaWRlIHRoZSBpbWFnZQoJICAgICAgICAgICAgLy8gc3VmZmljaWVudCB0byBjaGVjayB0aGUgZW5kcG9pbnRzCgkgICAgICAgICAgICBHcmlkU2FtcGxlcl8xLmRlZmF1bHQuY2hlY2tBbmROdWRnZVBvaW50cyhpbWFnZSwgcG9pbnRzKTsKCSAgICAgICAgICAgIHRyeSB7CgkgICAgICAgICAgICAgICAgZm9yICh2YXIgeCA9IDA7IHggPCBtYXg7IHggKz0gMikgewoJICAgICAgICAgICAgICAgICAgICBpZiAoaW1hZ2UuZ2V0KE1hdGguZmxvb3IocG9pbnRzW3hdKSwgTWF0aC5mbG9vcihwb2ludHNbeCArIDFdKSkpIHsKCSAgICAgICAgICAgICAgICAgICAgICAgIC8vIEJsYWNrKC1pc2gpIHBpeGVsCgkgICAgICAgICAgICAgICAgICAgICAgICBiaXRzLnNldCh4IC8gMiwgeSk7CgkgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBjYXRjaCAoYWlvb2JlIC8qOiBBcnJheUluZGV4T3V0T2ZCb3VuZHNFeGNlcHRpb24qLykgewoJICAgICAgICAgICAgICAgIC8vIFRoaXMgZmVlbHMgd3JvbmcsIGJ1dCwgc29tZXRpbWVzIGlmIHRoZSBmaW5kZXIgcGF0dGVybnMgYXJlIG1pc2lkZW50aWZpZWQsIHRoZSByZXN1bHRpbmcKCSAgICAgICAgICAgICAgICAvLyB0cmFuc2Zvcm0gZ2V0cyAidHdpc3RlZCIgc3VjaCB0aGF0IGl0IG1hcHMgYSBzdHJhaWdodCBsaW5lIG9mIHBvaW50cyB0byBhIHNldCBvZiBwb2ludHMKCSAgICAgICAgICAgICAgICAvLyB3aG9zZSBlbmRwb2ludHMgYXJlIGluIGJvdW5kcywgYnV0IG90aGVycyBhcmUgbm90LiBUaGVyZSBpcyBwcm9iYWJseSBzb21lIG1hdGhlbWF0aWNhbAoJICAgICAgICAgICAgICAgIC8vIHdheSB0byBkZXRlY3QgdGhpcyBhYm91dCB0aGUgdHJhbnNmb3JtYXRpb24gdGhhdCBJIGRvbid0IGtub3cgeWV0LgoJICAgICAgICAgICAgICAgIC8vIFRoaXMgcmVzdWx0cyBpbiBhbiB1Z2x5IHJ1bnRpbWUgZXhjZXB0aW9uIGRlc3BpdGUgb3VyIGNsZXZlciBjaGVja3MgYWJvdmUgLS0gY2FuJ3QgaGF2ZQoJICAgICAgICAgICAgICAgIC8vIHRoYXQuIFdlIGNvdWxkIGNoZWNrIGVhY2ggcG9pbnQncyBjb29yZGluYXRlcyBidXQgdGhhdCBmZWVscyBkdXBsaWNhdGl2ZS4gV2Ugc2V0dGxlIGZvcgoJICAgICAgICAgICAgICAgIC8vIGNhdGNoaW5nIGFuZCB3cmFwcGluZyBBcnJheUluZGV4T3V0T2ZCb3VuZHNFeGNlcHRpb24uCgkgICAgICAgICAgICAgICAgdGhyb3cgbmV3IE5vdEZvdW5kRXhjZXB0aW9uXzEkNC5kZWZhdWx0KCk7CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIGJpdHM7CgkgICAgfTsKCSAgICByZXR1cm4gRGVmYXVsdEdyaWRTYW1wbGVyOwoJfShHcmlkU2FtcGxlcl8xLmRlZmF1bHQpKTsKCURlZmF1bHRHcmlkU2FtcGxlciQxLmRlZmF1bHQgPSBEZWZhdWx0R3JpZFNhbXBsZXI7CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KEdyaWRTYW1wbGVySW5zdGFuY2UkMSwgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJdmFyIERlZmF1bHRHcmlkU2FtcGxlcl8xID0gRGVmYXVsdEdyaWRTYW1wbGVyJDE7Cgl2YXIgR3JpZFNhbXBsZXJJbnN0YW5jZSA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHsKCSAgICBmdW5jdGlvbiBHcmlkU2FtcGxlckluc3RhbmNlKCkgewoJICAgIH0KCSAgICAvKioKCSAgICAgKiBTZXRzIHRoZSBpbXBsZW1lbnRhdGlvbiBvZiBHcmlkU2FtcGxlciB1c2VkIGJ5IHRoZSBsaWJyYXJ5LiBPbmUgZ2xvYmFsCgkgICAgICogaW5zdGFuY2UgaXMgc3RvcmVkLCB3aGljaCBtYXkgc291bmQgcHJvYmxlbWF0aWMuIEJ1dCwgdGhlIGltcGxlbWVudGF0aW9uIHByb3ZpZGVkCgkgICAgICogb3VnaHQgdG8gYmUgYXBwcm9wcmlhdGUgZm9yIHRoZSBlbnRpcmUgcGxhdGZvcm0sIGFuZCBhbGwgdXNlcyBvZiB0aGlzIGxpYnJhcnkKCSAgICAgKiBpbiB0aGUgd2hvbGUgbGlmZXRpbWUgb2YgdGhlIEpWTS4gRm9yIGluc3RhbmNlLCBhbiBBbmRyb2lkIGFjdGl2aXR5IGNhbiBzd2FwIGluCgkgICAgICogYW4gaW1wbGVtZW50YXRpb24gdGhhdCB0YWtlcyBhZHZhbnRhZ2Ugb2YgbmF0aXZlIHBsYXRmb3JtIGxpYnJhcmllcy4KCSAgICAgKgoJICAgICAqIEBwYXJhbSBuZXdHcmlkU2FtcGxlciBUaGUgcGxhdGZvcm0tc3BlY2lmaWMgb2JqZWN0IHRvIGluc3RhbGwuCgkgICAgICovCgkgICAgR3JpZFNhbXBsZXJJbnN0YW5jZS5zZXRHcmlkU2FtcGxlciA9IGZ1bmN0aW9uIChuZXdHcmlkU2FtcGxlcikgewoJICAgICAgICBHcmlkU2FtcGxlckluc3RhbmNlLmdyaWRTYW1wbGVyID0gbmV3R3JpZFNhbXBsZXI7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcmV0dXJuIHRoZSBjdXJyZW50IGltcGxlbWVudGF0aW9uIG9mIEdyaWRTYW1wbGVyCgkgICAgICovCgkgICAgR3JpZFNhbXBsZXJJbnN0YW5jZS5nZXRJbnN0YW5jZSA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIEdyaWRTYW1wbGVySW5zdGFuY2UuZ3JpZFNhbXBsZXI7CgkgICAgfTsKCSAgICBHcmlkU2FtcGxlckluc3RhbmNlLmdyaWRTYW1wbGVyID0gbmV3IERlZmF1bHRHcmlkU2FtcGxlcl8xLmRlZmF1bHQoKTsKCSAgICByZXR1cm4gR3JpZFNhbXBsZXJJbnN0YW5jZTsKCX0oKSk7CglHcmlkU2FtcGxlckluc3RhbmNlJDEuZGVmYXVsdCA9IEdyaWRTYW1wbGVySW5zdGFuY2U7CgoJdmFyIFJlc3VsdFBvaW50JDEgPSB7fTsKCgl2YXIgRmxvYXQkMSA9IHt9OwoKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShGbG9hdCQxLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7CgkvKioKCSAqIFBvbnlmaWxsIGZvciBKYXZhJ3MgRmxvYXQgY2xhc3MuCgkgKi8KCXZhciBGbG9hdCA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHsKCSAgICBmdW5jdGlvbiBGbG9hdCgpIHsKCSAgICB9CgkgICAgLyoqCgkgICAgICogU2luY1RTIGhhcyBubyBkaWZmZXJlbmNlIGJldHdlZW4gaW50IGFuZCBmbG9hdCwgdGhlcmUncyBhbGwgbnVtYmVycywKCSAgICAgKiB0aGlzIGlzIHVzZWQgb25seSB0byBwb2x5ZmlsbCBKYXZhIGNvZGUuCgkgICAgICovCgkgICAgRmxvYXQuZmxvYXRUb0ludEJpdHMgPSBmdW5jdGlvbiAoZikgewoJICAgICAgICByZXR1cm4gZjsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIFRoZSBmbG9hdCBtYXggdmFsdWUgaW4gSlMgaXMgdGhlIG51bWJlciBtYXggdmFsdWUuCgkgICAgICovCgkgICAgRmxvYXQuTUFYX1ZBTFVFID0gTnVtYmVyLk1BWF9TQUZFX0lOVEVHRVI7CgkgICAgcmV0dXJuIEZsb2F0OwoJfSgpKTsKCUZsb2F0JDEuZGVmYXVsdCA9IEZsb2F0OwoKCS8qCgkgKiBDb3B5cmlnaHQgMjAwNyBaWGluZyBhdXRob3JzCgkgKgoJICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIik7CgkgKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCgkgKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKCSAqCgkgKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAoJICoKCSAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKCSAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCgkgKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4KCSAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKCSAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgoJICovCglPYmplY3QuZGVmaW5lUHJvcGVydHkoUmVzdWx0UG9pbnQkMSwgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJLypuYW1lc3BhY2UgY29tLmdvb2dsZS56eGluZyB7Ki8KCXZhciBNYXRoVXRpbHNfMSQxID0gTWF0aFV0aWxzJDE7Cgl2YXIgRmxvYXRfMSA9IEZsb2F0JDE7CgkvKioKCSAqIDxwPkVuY2Fwc3VsYXRlcyBhIHBvaW50IG9mIGludGVyZXN0IGluIGFuIGltYWdlIGNvbnRhaW5pbmcgYSBiYXJjb2RlLiBUeXBpY2FsbHksIHRoaXMKCSAqIHdvdWxkIGJlIHRoZSBsb2NhdGlvbiBvZiBhIGZpbmRlciBwYXR0ZXJuIG9yIHRoZSBjb3JuZXIgb2YgdGhlIGJhcmNvZGUsIGZvciBleGFtcGxlLjwvcD4KCSAqCgkgKiBAYXV0aG9yIFNlYW4gT3dlbgoJICovCgl2YXIgUmVzdWx0UG9pbnQgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7CgkgICAgZnVuY3Rpb24gUmVzdWx0UG9pbnQoeCwgeSkgewoJICAgICAgICB0aGlzLnggPSB4OwoJICAgICAgICB0aGlzLnkgPSB5OwoJICAgIH0KCSAgICBSZXN1bHRQb2ludC5wcm90b3R5cGUuZ2V0WCA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMueDsKCSAgICB9OwoJICAgIFJlc3VsdFBvaW50LnByb3RvdHlwZS5nZXRZID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy55OwoJICAgIH07CgkgICAgLypAT3ZlcnJpZGUqLwoJICAgIFJlc3VsdFBvaW50LnByb3RvdHlwZS5lcXVhbHMgPSBmdW5jdGlvbiAob3RoZXIpIHsKCSAgICAgICAgaWYgKG90aGVyIGluc3RhbmNlb2YgUmVzdWx0UG9pbnQpIHsKCSAgICAgICAgICAgIHZhciBvdGhlclBvaW50ID0gb3RoZXI7CgkgICAgICAgICAgICByZXR1cm4gdGhpcy54ID09PSBvdGhlclBvaW50LnggJiYgdGhpcy55ID09PSBvdGhlclBvaW50Lnk7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIGZhbHNlOwoJICAgIH07CgkgICAgLypAT3ZlcnJpZGUqLwoJICAgIFJlc3VsdFBvaW50LnByb3RvdHlwZS5oYXNoQ29kZSA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIDMxICogRmxvYXRfMS5kZWZhdWx0LmZsb2F0VG9JbnRCaXRzKHRoaXMueCkgKyBGbG9hdF8xLmRlZmF1bHQuZmxvYXRUb0ludEJpdHModGhpcy55KTsKCSAgICB9OwoJICAgIC8qQE92ZXJyaWRlKi8KCSAgICBSZXN1bHRQb2ludC5wcm90b3R5cGUudG9TdHJpbmcgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiAnKCcgKyB0aGlzLnggKyAnLCcgKyB0aGlzLnkgKyAnKSc7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBPcmRlcnMgYW4gYXJyYXkgb2YgdGhyZWUgUmVzdWx0UG9pbnRzIGluIGFuIG9yZGVyIFtBLEIsQ10gc3VjaCB0aGF0IEFCIGlzIGxlc3MgdGhhbiBBQwoJICAgICAqIGFuZCBCQyBpcyBsZXNzIHRoYW4gQUMsIGFuZCB0aGUgYW5nbGUgYmV0d2VlbiBCQyBhbmQgQkEgaXMgbGVzcyB0aGFuIDE4MCBkZWdyZWVzLgoJICAgICAqCgkgICAgICogQHBhcmFtIHBhdHRlcm5zIGFycmF5IG9mIHRocmVlIHtAY29kZSBSZXN1bHRQb2ludH0gdG8gb3JkZXIKCSAgICAgKi8KCSAgICBSZXN1bHRQb2ludC5vcmRlckJlc3RQYXR0ZXJucyA9IGZ1bmN0aW9uIChwYXR0ZXJucykgewoJICAgICAgICAvLyBGaW5kIGRpc3RhbmNlcyBiZXR3ZWVuIHBhdHRlcm4gY2VudGVycwoJICAgICAgICB2YXIgemVyb09uZURpc3RhbmNlID0gdGhpcy5kaXN0YW5jZShwYXR0ZXJuc1swXSwgcGF0dGVybnNbMV0pOwoJICAgICAgICB2YXIgb25lVHdvRGlzdGFuY2UgPSB0aGlzLmRpc3RhbmNlKHBhdHRlcm5zWzFdLCBwYXR0ZXJuc1syXSk7CgkgICAgICAgIHZhciB6ZXJvVHdvRGlzdGFuY2UgPSB0aGlzLmRpc3RhbmNlKHBhdHRlcm5zWzBdLCBwYXR0ZXJuc1syXSk7CgkgICAgICAgIHZhciBwb2ludEE7CgkgICAgICAgIHZhciBwb2ludEI7CgkgICAgICAgIHZhciBwb2ludEM7CgkgICAgICAgIC8vIEFzc3VtZSBvbmUgY2xvc2VzdCB0byBvdGhlciB0d28gaXMgQjsgQSBhbmQgQyB3aWxsIGp1c3QgYmUgZ3Vlc3NlcyBhdCBmaXJzdAoJICAgICAgICBpZiAob25lVHdvRGlzdGFuY2UgPj0gemVyb09uZURpc3RhbmNlICYmIG9uZVR3b0Rpc3RhbmNlID49IHplcm9Ud29EaXN0YW5jZSkgewoJICAgICAgICAgICAgcG9pbnRCID0gcGF0dGVybnNbMF07CgkgICAgICAgICAgICBwb2ludEEgPSBwYXR0ZXJuc1sxXTsKCSAgICAgICAgICAgIHBvaW50QyA9IHBhdHRlcm5zWzJdOwoJICAgICAgICB9CgkgICAgICAgIGVsc2UgaWYgKHplcm9Ud29EaXN0YW5jZSA+PSBvbmVUd29EaXN0YW5jZSAmJiB6ZXJvVHdvRGlzdGFuY2UgPj0gemVyb09uZURpc3RhbmNlKSB7CgkgICAgICAgICAgICBwb2ludEIgPSBwYXR0ZXJuc1sxXTsKCSAgICAgICAgICAgIHBvaW50QSA9IHBhdHRlcm5zWzBdOwoJICAgICAgICAgICAgcG9pbnRDID0gcGF0dGVybnNbMl07CgkgICAgICAgIH0KCSAgICAgICAgZWxzZSB7CgkgICAgICAgICAgICBwb2ludEIgPSBwYXR0ZXJuc1syXTsKCSAgICAgICAgICAgIHBvaW50QSA9IHBhdHRlcm5zWzBdOwoJICAgICAgICAgICAgcG9pbnRDID0gcGF0dGVybnNbMV07CgkgICAgICAgIH0KCSAgICAgICAgLy8gVXNlIGNyb3NzIHByb2R1Y3QgdG8gZmlndXJlIG91dCB3aGV0aGVyIEEgYW5kIEMgYXJlIGNvcnJlY3Qgb3IgZmxpcHBlZC4KCSAgICAgICAgLy8gVGhpcyBhc2tzIHdoZXRoZXIgQkMgeCBCQSBoYXMgYSBwb3NpdGl2ZSB6IGNvbXBvbmVudCwgd2hpY2ggaXMgdGhlIGFycmFuZ2VtZW50CgkgICAgICAgIC8vIHdlIHdhbnQgZm9yIEEsIEIsIEMuIElmIGl0J3MgbmVnYXRpdmUsIHRoZW4gd2UndmUgZ290IGl0IGZsaXBwZWQgYXJvdW5kIGFuZAoJICAgICAgICAvLyBzaG91bGQgc3dhcCBBIGFuZCBDLgoJICAgICAgICBpZiAodGhpcy5jcm9zc1Byb2R1Y3RaKHBvaW50QSwgcG9pbnRCLCBwb2ludEMpIDwgMC4wKSB7CgkgICAgICAgICAgICB2YXIgdGVtcCA9IHBvaW50QTsKCSAgICAgICAgICAgIHBvaW50QSA9IHBvaW50QzsKCSAgICAgICAgICAgIHBvaW50QyA9IHRlbXA7CgkgICAgICAgIH0KCSAgICAgICAgcGF0dGVybnNbMF0gPSBwb2ludEE7CgkgICAgICAgIHBhdHRlcm5zWzFdID0gcG9pbnRCOwoJICAgICAgICBwYXR0ZXJuc1syXSA9IHBvaW50QzsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEBwYXJhbSBwYXR0ZXJuMSBmaXJzdCBwYXR0ZXJuCgkgICAgICogQHBhcmFtIHBhdHRlcm4yIHNlY29uZCBwYXR0ZXJuCgkgICAgICogQHJldHVybiBkaXN0YW5jZSBiZXR3ZWVuIHR3byBwb2ludHMKCSAgICAgKi8KCSAgICBSZXN1bHRQb2ludC5kaXN0YW5jZSA9IGZ1bmN0aW9uIChwYXR0ZXJuMSwgcGF0dGVybjIpIHsKCSAgICAgICAgcmV0dXJuIE1hdGhVdGlsc18xJDEuZGVmYXVsdC5kaXN0YW5jZShwYXR0ZXJuMS54LCBwYXR0ZXJuMS55LCBwYXR0ZXJuMi54LCBwYXR0ZXJuMi55KTsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIFJldHVybnMgdGhlIHogY29tcG9uZW50IG9mIHRoZSBjcm9zcyBwcm9kdWN0IGJldHdlZW4gdmVjdG9ycyBCQyBhbmQgQkEuCgkgICAgICovCgkgICAgUmVzdWx0UG9pbnQuY3Jvc3NQcm9kdWN0WiA9IGZ1bmN0aW9uIChwb2ludEEsIHBvaW50QiwgcG9pbnRDKSB7CgkgICAgICAgIHZhciBiWCA9IHBvaW50Qi54OwoJICAgICAgICB2YXIgYlkgPSBwb2ludEIueTsKCSAgICAgICAgcmV0dXJuICgocG9pbnRDLnggLSBiWCkgKiAocG9pbnRBLnkgLSBiWSkpIC0gKChwb2ludEMueSAtIGJZKSAqIChwb2ludEEueCAtIGJYKSk7CgkgICAgfTsKCSAgICByZXR1cm4gUmVzdWx0UG9pbnQ7Cgl9KCkpOwoJUmVzdWx0UG9pbnQkMS5kZWZhdWx0ID0gUmVzdWx0UG9pbnQ7CgoJdmFyIEFsaWdubWVudFBhdHRlcm5GaW5kZXIkMSA9IHt9OwoKCXZhciBBbGlnbm1lbnRQYXR0ZXJuJDEgPSB7fTsKCgkvKgoJICogQ29weXJpZ2h0IDIwMDcgWlhpbmcgYXV0aG9ycwoJICoKCSAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoJICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoJICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkgKgoJICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKCSAqCgkgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCgkgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoJICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCgkgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCSAqLwoJdmFyIF9fZXh0ZW5kcyQxID0gKGNvbW1vbmpzR2xvYmFsICYmIGNvbW1vbmpzR2xvYmFsLl9fZXh0ZW5kcykgfHwgKGZ1bmN0aW9uICgpIHsKCSAgICB2YXIgZXh0ZW5kU3RhdGljcyA9IGZ1bmN0aW9uIChkLCBiKSB7CgkgICAgICAgIGV4dGVuZFN0YXRpY3MgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgfHwKCSAgICAgICAgICAgICh7IF9fcHJvdG9fXzogW10gfSBpbnN0YW5jZW9mIEFycmF5ICYmIGZ1bmN0aW9uIChkLCBiKSB7IGQuX19wcm90b19fID0gYjsgfSkgfHwKCSAgICAgICAgICAgIGZ1bmN0aW9uIChkLCBiKSB7IGZvciAodmFyIHAgaW4gYikgaWYgKGIuaGFzT3duUHJvcGVydHkocCkpIGRbcF0gPSBiW3BdOyB9OwoJICAgICAgICByZXR1cm4gZXh0ZW5kU3RhdGljcyhkLCBiKTsKCSAgICB9OwoJICAgIHJldHVybiBmdW5jdGlvbiAoZCwgYikgewoJICAgICAgICBleHRlbmRTdGF0aWNzKGQsIGIpOwoJICAgICAgICBmdW5jdGlvbiBfXygpIHsgdGhpcy5jb25zdHJ1Y3RvciA9IGQ7IH0KCSAgICAgICAgZC5wcm90b3R5cGUgPSBiID09PSBudWxsID8gT2JqZWN0LmNyZWF0ZShiKSA6IChfXy5wcm90b3R5cGUgPSBiLnByb3RvdHlwZSwgbmV3IF9fKCkpOwoJICAgIH07Cgl9KSgpOwoJT2JqZWN0LmRlZmluZVByb3BlcnR5KEFsaWdubWVudFBhdHRlcm4kMSwgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJLypuYW1lc3BhY2UgY29tLmdvb2dsZS56eGluZy5xcmNvZGUuZGV0ZWN0b3IgeyovCgl2YXIgUmVzdWx0UG9pbnRfMSQzID0gUmVzdWx0UG9pbnQkMTsKCS8qKgoJICogPHA+RW5jYXBzdWxhdGVzIGFuIGFsaWdubWVudCBwYXR0ZXJuLCB3aGljaCBhcmUgdGhlIHNtYWxsZXIgc3F1YXJlIHBhdHRlcm5zIGZvdW5kIGluCgkgKiBhbGwgYnV0IHRoZSBzaW1wbGVzdCBRUiBDb2Rlcy48L3A+CgkgKgoJICogQGF1dGhvciBTZWFuIE93ZW4KCSAqLwoJdmFyIEFsaWdubWVudFBhdHRlcm4gPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7CgkgICAgX19leHRlbmRzJDEoQWxpZ25tZW50UGF0dGVybiwgX3N1cGVyKTsKCSAgICBmdW5jdGlvbiBBbGlnbm1lbnRQYXR0ZXJuKHBvc1ggLypmbG9hdCovLCBwb3NZIC8qZmxvYXQqLywgZXN0aW1hdGVkTW9kdWxlU2l6ZSAvKmZsb2F0Ki8pIHsKCSAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcywgcG9zWCwgcG9zWSkgfHwgdGhpczsKCSAgICAgICAgX3RoaXMuZXN0aW1hdGVkTW9kdWxlU2l6ZSA9IGVzdGltYXRlZE1vZHVsZVNpemU7CgkgICAgICAgIHJldHVybiBfdGhpczsKCSAgICB9CgkgICAgLyoqCgkgICAgICogPHA+RGV0ZXJtaW5lcyBpZiB0aGlzIGFsaWdubWVudCBwYXR0ZXJuICJhYm91dCBlcXVhbHMiIGFuIGFsaWdubWVudCBwYXR0ZXJuIGF0IHRoZSBzdGF0ZWQKCSAgICAgKiBwb3NpdGlvbiBhbmQgc2l6ZSAtLSBtZWFuaW5nLCBpdCBpcyBhdCBuZWFybHkgdGhlIHNhbWUgY2VudGVyIHdpdGggbmVhcmx5IHRoZSBzYW1lIHNpemUuPC9wPgoJICAgICAqLwoJICAgIEFsaWdubWVudFBhdHRlcm4ucHJvdG90eXBlLmFib3V0RXF1YWxzID0gZnVuY3Rpb24gKG1vZHVsZVNpemUgLypmbG9hdCovLCBpIC8qZmxvYXQqLywgaiAvKmZsb2F0Ki8pIHsKCSAgICAgICAgaWYgKE1hdGguYWJzKGkgLSB0aGlzLmdldFkoKSkgPD0gbW9kdWxlU2l6ZSAmJiBNYXRoLmFicyhqIC0gdGhpcy5nZXRYKCkpIDw9IG1vZHVsZVNpemUpIHsKCSAgICAgICAgICAgIHZhciBtb2R1bGVTaXplRGlmZiA9IE1hdGguYWJzKG1vZHVsZVNpemUgLSB0aGlzLmVzdGltYXRlZE1vZHVsZVNpemUpOwoJICAgICAgICAgICAgcmV0dXJuIG1vZHVsZVNpemVEaWZmIDw9IDEuMCB8fCBtb2R1bGVTaXplRGlmZiA8PSB0aGlzLmVzdGltYXRlZE1vZHVsZVNpemU7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIGZhbHNlOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQ29tYmluZXMgdGhpcyBvYmplY3QncyBjdXJyZW50IGVzdGltYXRlIG9mIGEgZmluZGVyIHBhdHRlcm4gcG9zaXRpb24gYW5kIG1vZHVsZSBzaXplCgkgICAgICogd2l0aCBhIG5ldyBlc3RpbWF0ZS4gSXQgcmV0dXJucyBhIG5ldyB7QGNvZGUgRmluZGVyUGF0dGVybn0gY29udGFpbmluZyBhbiBhdmVyYWdlIG9mIHRoZSB0d28uCgkgICAgICovCgkgICAgQWxpZ25tZW50UGF0dGVybi5wcm90b3R5cGUuY29tYmluZUVzdGltYXRlID0gZnVuY3Rpb24gKGkgLypmbG9hdCovLCBqIC8qZmxvYXQqLywgbmV3TW9kdWxlU2l6ZSAvKmZsb2F0Ki8pIHsKCSAgICAgICAgdmFyIGNvbWJpbmVkWCA9ICh0aGlzLmdldFgoKSArIGopIC8gMi4wOwoJICAgICAgICB2YXIgY29tYmluZWRZID0gKHRoaXMuZ2V0WSgpICsgaSkgLyAyLjA7CgkgICAgICAgIHZhciBjb21iaW5lZE1vZHVsZVNpemUgPSAodGhpcy5lc3RpbWF0ZWRNb2R1bGVTaXplICsgbmV3TW9kdWxlU2l6ZSkgLyAyLjA7CgkgICAgICAgIHJldHVybiBuZXcgQWxpZ25tZW50UGF0dGVybihjb21iaW5lZFgsIGNvbWJpbmVkWSwgY29tYmluZWRNb2R1bGVTaXplKTsKCSAgICB9OwoJICAgIHJldHVybiBBbGlnbm1lbnRQYXR0ZXJuOwoJfShSZXN1bHRQb2ludF8xJDMuZGVmYXVsdCkpOwoJQWxpZ25tZW50UGF0dGVybiQxLmRlZmF1bHQgPSBBbGlnbm1lbnRQYXR0ZXJuOwoKCS8qCgkgKiBDb3B5cmlnaHQgMjAwNyBaWGluZyBhdXRob3JzCgkgKgoJICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIik7CgkgKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCgkgKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKCSAqCgkgKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAoJICoKCSAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKCSAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCgkgKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4KCSAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKCSAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgoJICovCgl2YXIgX192YWx1ZXMkMSA9IChjb21tb25qc0dsb2JhbCAmJiBjb21tb25qc0dsb2JhbC5fX3ZhbHVlcykgfHwgZnVuY3Rpb24obykgewoJICAgIHZhciBzID0gdHlwZW9mIFN5bWJvbCA9PT0gImZ1bmN0aW9uIiAmJiBTeW1ib2wuaXRlcmF0b3IsIG0gPSBzICYmIG9bc10sIGkgPSAwOwoJICAgIGlmIChtKSByZXR1cm4gbS5jYWxsKG8pOwoJICAgIGlmIChvICYmIHR5cGVvZiBvLmxlbmd0aCA9PT0gIm51bWJlciIpIHJldHVybiB7CgkgICAgICAgIG5leHQ6IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgICAgIGlmIChvICYmIGkgPj0gby5sZW5ndGgpIG8gPSB2b2lkIDA7CgkgICAgICAgICAgICByZXR1cm4geyB2YWx1ZTogbyAmJiBvW2krK10sIGRvbmU6ICFvIH07CgkgICAgICAgIH0KCSAgICB9OwoJICAgIHRocm93IG5ldyBUeXBlRXJyb3IocyA/ICJPYmplY3QgaXMgbm90IGl0ZXJhYmxlLiIgOiAiU3ltYm9sLml0ZXJhdG9yIGlzIG5vdCBkZWZpbmVkLiIpOwoJfTsKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShBbGlnbm1lbnRQYXR0ZXJuRmluZGVyJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCXZhciBBbGlnbm1lbnRQYXR0ZXJuXzEgPSBBbGlnbm1lbnRQYXR0ZXJuJDE7Cgl2YXIgTm90Rm91bmRFeGNlcHRpb25fMSQzID0gTm90Rm91bmRFeGNlcHRpb24kMTsKCS8qaW1wb3J0IGphdmEudXRpbC5BcnJheUxpc3Q7Ki8KCS8qaW1wb3J0IGphdmEudXRpbC5MaXN0OyovCgkvKioKCSAqIDxwPlRoaXMgY2xhc3MgYXR0ZW1wdHMgdG8gZmluZCBhbGlnbm1lbnQgcGF0dGVybnMgaW4gYSBRUiBDb2RlLiBBbGlnbm1lbnQgcGF0dGVybnMgbG9vayBsaWtlIGZpbmRlcgoJICogcGF0dGVybnMgYnV0IGFyZSBzbWFsbGVyIGFuZCBhcHBlYXIgYXQgcmVndWxhciBpbnRlcnZhbHMgdGhyb3VnaG91dCB0aGUgaW1hZ2UuPC9wPgoJICoKCSAqIDxwPkF0IHRoZSBtb21lbnQgdGhpcyBvbmx5IGxvb2tzIGZvciB0aGUgYm90dG9tLXJpZ2h0IGFsaWdubWVudCBwYXR0ZXJuLjwvcD4KCSAqCgkgKiA8cD5UaGlzIGlzIG1vc3RseSBhIHNpbXBsaWZpZWQgY29weSBvZiB7QGxpbmsgRmluZGVyUGF0dGVybkZpbmRlcn0uIEl0IGlzIGNvcGllZCwKCSAqIHBhc3RlZCBhbmQgc3RyaXBwZWQgZG93biBoZXJlIGZvciBtYXhpbXVtIHBlcmZvcm1hbmNlIGJ1dCBkb2VzIHVuZm9ydHVuYXRlbHkgZHVwbGljYXRlCgkgKiBzb21lIGNvZGUuPC9wPgoJICoKCSAqIDxwPlRoaXMgY2xhc3MgaXMgdGhyZWFkLXNhZmUgYnV0IG5vdCByZWVudHJhbnQuIEVhY2ggdGhyZWFkIG11c3QgYWxsb2NhdGUgaXRzIG93biBvYmplY3QuPC9wPgoJICoKCSAqIEBhdXRob3IgU2VhbiBPd2VuCgkgKi8KCXZhciBBbGlnbm1lbnRQYXR0ZXJuRmluZGVyID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkgewoJICAgIC8qKgoJICAgICAqIDxwPkNyZWF0ZXMgYSBmaW5kZXIgdGhhdCB3aWxsIGxvb2sgaW4gYSBwb3J0aW9uIG9mIHRoZSB3aG9sZSBpbWFnZS48L3A+CgkgICAgICoKCSAgICAgKiBAcGFyYW0gaW1hZ2UgaW1hZ2UgdG8gc2VhcmNoCgkgICAgICogQHBhcmFtIHN0YXJ0WCBsZWZ0IGNvbHVtbiBmcm9tIHdoaWNoIHRvIHN0YXJ0IHNlYXJjaGluZwoJICAgICAqIEBwYXJhbSBzdGFydFkgdG9wIHJvdyBmcm9tIHdoaWNoIHRvIHN0YXJ0IHNlYXJjaGluZwoJICAgICAqIEBwYXJhbSB3aWR0aCB3aWR0aCBvZiByZWdpb24gdG8gc2VhcmNoCgkgICAgICogQHBhcmFtIGhlaWdodCBoZWlnaHQgb2YgcmVnaW9uIHRvIHNlYXJjaAoJICAgICAqIEBwYXJhbSBtb2R1bGVTaXplIGVzdGltYXRlZCBtb2R1bGUgc2l6ZSBzbyBmYXIKCSAgICAgKi8KCSAgICBmdW5jdGlvbiBBbGlnbm1lbnRQYXR0ZXJuRmluZGVyKGltYWdlLCBzdGFydFggLyppbnQqLywgc3RhcnRZIC8qaW50Ki8sIHdpZHRoIC8qaW50Ki8sIGhlaWdodCAvKmludCovLCBtb2R1bGVTaXplIC8qZmxvYXQqLywgcmVzdWx0UG9pbnRDYWxsYmFjaykgewoJICAgICAgICB0aGlzLmltYWdlID0gaW1hZ2U7CgkgICAgICAgIHRoaXMuc3RhcnRYID0gc3RhcnRYOwoJICAgICAgICB0aGlzLnN0YXJ0WSA9IHN0YXJ0WTsKCSAgICAgICAgdGhpcy53aWR0aCA9IHdpZHRoOwoJICAgICAgICB0aGlzLmhlaWdodCA9IGhlaWdodDsKCSAgICAgICAgdGhpcy5tb2R1bGVTaXplID0gbW9kdWxlU2l6ZTsKCSAgICAgICAgdGhpcy5yZXN1bHRQb2ludENhbGxiYWNrID0gcmVzdWx0UG9pbnRDYWxsYmFjazsKCSAgICAgICAgdGhpcy5wb3NzaWJsZUNlbnRlcnMgPSBbXTsgLy8gbmV3IEFycmF5PGFueT4oNSkpCgkgICAgICAgIC8vIFRZUEVTQ1JJUFRQT1JUOiBhcnJheSBpbml0aWFsaXphdGlvbiB3aXRob3V0IHNpemUgYXMgdGhlIGxlbmd0aCBpcyBjaGVja2VkIGJlbG93CgkgICAgICAgIHRoaXMuY3Jvc3NDaGVja1N0YXRlQ291bnQgPSBuZXcgSW50MzJBcnJheSgzKTsKCSAgICB9CgkgICAgLyoqCgkgICAgICogPHA+VGhpcyBtZXRob2QgYXR0ZW1wdHMgdG8gZmluZCB0aGUgYm90dG9tLXJpZ2h0IGFsaWdubWVudCBwYXR0ZXJuIGluIHRoZSBpbWFnZS4gSXQgaXMgYSBiaXQgbWVzc3kgc2luY2UKCSAgICAgKiBpdCdzIHByZXR0eSBwZXJmb3JtYW5jZS1jcml0aWNhbCBhbmQgc28gaXMgd3JpdHRlbiB0byBiZSBmYXN0IGZvcmVtb3N0LjwvcD4KCSAgICAgKgoJICAgICAqIEByZXR1cm4ge0BsaW5rIEFsaWdubWVudFBhdHRlcm59IGlmIGZvdW5kCgkgICAgICogQHRocm93cyBOb3RGb3VuZEV4Y2VwdGlvbiBpZiBub3QgZm91bmQKCSAgICAgKi8KCSAgICBBbGlnbm1lbnRQYXR0ZXJuRmluZGVyLnByb3RvdHlwZS5maW5kID0gZnVuY3Rpb24gKCkgewoJICAgICAgICB2YXIgc3RhcnRYID0gdGhpcy5zdGFydFg7CgkgICAgICAgIHZhciBoZWlnaHQgPSB0aGlzLmhlaWdodDsKCSAgICAgICAgdmFyIHdpZHRoID0gdGhpcy53aWR0aDsKCSAgICAgICAgdmFyIG1heEogPSBzdGFydFggKyB3aWR0aDsKCSAgICAgICAgdmFyIG1pZGRsZUkgPSB0aGlzLnN0YXJ0WSArIChoZWlnaHQgLyAyKTsKCSAgICAgICAgLy8gV2UgYXJlIGxvb2tpbmcgZm9yIGJsYWNrL3doaXRlL2JsYWNrIG1vZHVsZXMgaW4gMToxOjEgcmF0aW8KCSAgICAgICAgLy8gdGhpcyB0cmFja3MgdGhlIG51bWJlciBvZiBibGFjay93aGl0ZS9ibGFjayBtb2R1bGVzIHNlZW4gc28gZmFyCgkgICAgICAgIHZhciBzdGF0ZUNvdW50ID0gbmV3IEludDMyQXJyYXkoMyk7CgkgICAgICAgIHZhciBpbWFnZSA9IHRoaXMuaW1hZ2U7CgkgICAgICAgIGZvciAodmFyIGlHZW4gPSAwOyBpR2VuIDwgaGVpZ2h0OyBpR2VuKyspIHsKCSAgICAgICAgICAgIC8vIFNlYXJjaCBmcm9tIG1pZGRsZSBvdXR3YXJkcwoJICAgICAgICAgICAgdmFyIGkgPSBtaWRkbGVJICsgKChpR2VuICYgMHgwMSkgPT09IDAgPyBNYXRoLmZsb29yKChpR2VuICsgMSkgLyAyKSA6IC1NYXRoLmZsb29yKChpR2VuICsgMSkgLyAyKSk7CgkgICAgICAgICAgICBzdGF0ZUNvdW50WzBdID0gMDsKCSAgICAgICAgICAgIHN0YXRlQ291bnRbMV0gPSAwOwoJICAgICAgICAgICAgc3RhdGVDb3VudFsyXSA9IDA7CgkgICAgICAgICAgICB2YXIgaiA9IHN0YXJ0WDsKCSAgICAgICAgICAgIC8vIEJ1cm4gb2ZmIGxlYWRpbmcgd2hpdGUgcGl4ZWxzIGJlZm9yZSBhbnl0aGluZyBlbHNlOyBpZiB3ZSBzdGFydCBpbiB0aGUgbWlkZGxlIG9mCgkgICAgICAgICAgICAvLyBhIHdoaXRlIHJ1biwgaXQgZG9lc24ndCBtYWtlIHNlbnNlIHRvIGNvdW50IGl0cyBsZW5ndGgsIHNpbmNlIHdlIGRvbid0IGtub3cgaWYgdGhlCgkgICAgICAgICAgICAvLyB3aGl0ZSBydW4gY29udGludWVkIHRvIHRoZSBsZWZ0IG9mIHRoZSBzdGFydCBwb2ludAoJICAgICAgICAgICAgd2hpbGUgKGogPCBtYXhKICYmICFpbWFnZS5nZXQoaiwgaSkpIHsKCSAgICAgICAgICAgICAgICBqKys7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICB2YXIgY3VycmVudFN0YXRlID0gMDsKCSAgICAgICAgICAgIHdoaWxlIChqIDwgbWF4SikgewoJICAgICAgICAgICAgICAgIGlmIChpbWFnZS5nZXQoaiwgaSkpIHsKCSAgICAgICAgICAgICAgICAgICAgLy8gQmxhY2sgcGl4ZWwKCSAgICAgICAgICAgICAgICAgICAgaWYgKGN1cnJlbnRTdGF0ZSA9PT0gMSkgeyAvLyBDb3VudGluZyBibGFjayBwaXhlbHMKCSAgICAgICAgICAgICAgICAgICAgICAgIHN0YXRlQ291bnRbMV0rKzsKCSAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICBlbHNlIHsgLy8gQ291bnRpbmcgd2hpdGUgcGl4ZWxzCgkgICAgICAgICAgICAgICAgICAgICAgICBpZiAoY3VycmVudFN0YXRlID09PSAyKSB7IC8vIEEgd2lubmVyPwoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmZvdW5kUGF0dGVybkNyb3NzKHN0YXRlQ291bnQpKSB7IC8vIFllcwoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgY29uZmlybWVkID0gdGhpcy5oYW5kbGVQb3NzaWJsZUNlbnRlcihzdGF0ZUNvdW50LCBpLCBqKTsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGNvbmZpcm1lZCAhPT0gbnVsbCkgewoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGNvbmZpcm1lZDsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGF0ZUNvdW50WzBdID0gc3RhdGVDb3VudFsyXTsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGF0ZUNvdW50WzFdID0gMTsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGF0ZUNvdW50WzJdID0gMDsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICBjdXJyZW50U3RhdGUgPSAxOwoJICAgICAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSB7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RhdGVDb3VudFsrK2N1cnJlbnRTdGF0ZV0rKzsKCSAgICAgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICBlbHNlIHsgLy8gV2hpdGUgcGl4ZWwKCSAgICAgICAgICAgICAgICAgICAgaWYgKGN1cnJlbnRTdGF0ZSA9PT0gMSkgeyAvLyBDb3VudGluZyBibGFjayBwaXhlbHMKCSAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJlbnRTdGF0ZSsrOwoJICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgIHN0YXRlQ291bnRbY3VycmVudFN0YXRlXSsrOwoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICBqKys7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBpZiAodGhpcy5mb3VuZFBhdHRlcm5Dcm9zcyhzdGF0ZUNvdW50KSkgewoJICAgICAgICAgICAgICAgIHZhciBjb25maXJtZWQgPSB0aGlzLmhhbmRsZVBvc3NpYmxlQ2VudGVyKHN0YXRlQ291bnQsIGksIG1heEopOwoJICAgICAgICAgICAgICAgIGlmIChjb25maXJtZWQgIT09IG51bGwpIHsKCSAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGNvbmZpcm1lZDsKCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICAgICAgLy8gSG1tLCBub3RoaW5nIHdlIHNhdyB3YXMgb2JzZXJ2ZWQgYW5kIGNvbmZpcm1lZCB0d2ljZS4gSWYgd2UgaGFkCgkgICAgICAgIC8vIGFueSBndWVzcyBhdCBhbGwsIHJldHVybiBpdC4KCSAgICAgICAgaWYgKHRoaXMucG9zc2libGVDZW50ZXJzLmxlbmd0aCAhPT0gMCkgewoJICAgICAgICAgICAgcmV0dXJuIHRoaXMucG9zc2libGVDZW50ZXJzWzBdOwoJICAgICAgICB9CgkgICAgICAgIHRocm93IG5ldyBOb3RGb3VuZEV4Y2VwdGlvbl8xJDMuZGVmYXVsdCgpOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogR2l2ZW4gYSBjb3VudCBvZiBibGFjay93aGl0ZS9ibGFjayBwaXhlbHMganVzdCBzZWVuIGFuZCBhbiBlbmQgcG9zaXRpb24sCgkgICAgICogZmlndXJlcyB0aGUgbG9jYXRpb24gb2YgdGhlIGNlbnRlciBvZiB0aGlzIGJsYWNrL3doaXRlL2JsYWNrIHJ1bi4KCSAgICAgKi8KCSAgICBBbGlnbm1lbnRQYXR0ZXJuRmluZGVyLmNlbnRlckZyb21FbmQgPSBmdW5jdGlvbiAoc3RhdGVDb3VudCwgZW5kIC8qaW50Ki8pIHsKCSAgICAgICAgcmV0dXJuIChlbmQgLSBzdGF0ZUNvdW50WzJdKSAtIHN0YXRlQ291bnRbMV0gLyAyLjA7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcGFyYW0gc3RhdGVDb3VudCBjb3VudCBvZiBibGFjay93aGl0ZS9ibGFjayBwaXhlbHMganVzdCByZWFkCgkgICAgICogQHJldHVybiB0cnVlIGlmZiB0aGUgcHJvcG9ydGlvbnMgb2YgdGhlIGNvdW50cyBpcyBjbG9zZSBlbm91Z2ggdG8gdGhlIDEvMS8xIHJhdGlvcwoJICAgICAqICAgICAgICAgdXNlZCBieSBhbGlnbm1lbnQgcGF0dGVybnMgdG8gYmUgY29uc2lkZXJlZCBhIG1hdGNoCgkgICAgICovCgkgICAgQWxpZ25tZW50UGF0dGVybkZpbmRlci5wcm90b3R5cGUuZm91bmRQYXR0ZXJuQ3Jvc3MgPSBmdW5jdGlvbiAoc3RhdGVDb3VudCkgewoJICAgICAgICB2YXIgbW9kdWxlU2l6ZSA9IHRoaXMubW9kdWxlU2l6ZTsKCSAgICAgICAgdmFyIG1heFZhcmlhbmNlID0gbW9kdWxlU2l6ZSAvIDIuMDsKCSAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCAzOyBpKyspIHsKCSAgICAgICAgICAgIGlmIChNYXRoLmFicyhtb2R1bGVTaXplIC0gc3RhdGVDb3VudFtpXSkgPj0gbWF4VmFyaWFuY2UpIHsKCSAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIHRydWU7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiA8cD5BZnRlciBhIGhvcml6b250YWwgc2NhbiBmaW5kcyBhIHBvdGVudGlhbCBhbGlnbm1lbnQgcGF0dGVybiwgdGhpcyBtZXRob2QKCSAgICAgKiAiY3Jvc3MtY2hlY2tzIiBieSBzY2FubmluZyBkb3duIHZlcnRpY2FsbHkgdGhyb3VnaCB0aGUgY2VudGVyIG9mIHRoZSBwb3NzaWJsZQoJICAgICAqIGFsaWdubWVudCBwYXR0ZXJuIHRvIHNlZSBpZiB0aGUgc2FtZSBwcm9wb3J0aW9uIGlzIGRldGVjdGVkLjwvcD4KCSAgICAgKgoJICAgICAqIEBwYXJhbSBzdGFydEkgcm93IHdoZXJlIGFuIGFsaWdubWVudCBwYXR0ZXJuIHdhcyBkZXRlY3RlZAoJICAgICAqIEBwYXJhbSBjZW50ZXJKIGNlbnRlciBvZiB0aGUgc2VjdGlvbiB0aGF0IGFwcGVhcnMgdG8gY3Jvc3MgYW4gYWxpZ25tZW50IHBhdHRlcm4KCSAgICAgKiBAcGFyYW0gbWF4Q291bnQgbWF4aW11bSByZWFzb25hYmxlIG51bWJlciBvZiBtb2R1bGVzIHRoYXQgc2hvdWxkIGJlCgkgICAgICogb2JzZXJ2ZWQgaW4gYW55IHJlYWRpbmcgc3RhdGUsIGJhc2VkIG9uIHRoZSByZXN1bHRzIG9mIHRoZSBob3Jpem9udGFsIHNjYW4KCSAgICAgKiBAcmV0dXJuIHZlcnRpY2FsIGNlbnRlciBvZiBhbGlnbm1lbnQgcGF0dGVybiwgb3Ige0BsaW5rIEZsb2F0I05hTn0gaWYgbm90IGZvdW5kCgkgICAgICovCgkgICAgQWxpZ25tZW50UGF0dGVybkZpbmRlci5wcm90b3R5cGUuY3Jvc3NDaGVja1ZlcnRpY2FsID0gZnVuY3Rpb24gKHN0YXJ0SSAvKmludCovLCBjZW50ZXJKIC8qaW50Ki8sIG1heENvdW50IC8qaW50Ki8sIG9yaWdpbmFsU3RhdGVDb3VudFRvdGFsIC8qaW50Ki8pIHsKCSAgICAgICAgdmFyIGltYWdlID0gdGhpcy5pbWFnZTsKCSAgICAgICAgdmFyIG1heEkgPSBpbWFnZS5nZXRIZWlnaHQoKTsKCSAgICAgICAgdmFyIHN0YXRlQ291bnQgPSB0aGlzLmNyb3NzQ2hlY2tTdGF0ZUNvdW50OwoJICAgICAgICBzdGF0ZUNvdW50WzBdID0gMDsKCSAgICAgICAgc3RhdGVDb3VudFsxXSA9IDA7CgkgICAgICAgIHN0YXRlQ291bnRbMl0gPSAwOwoJICAgICAgICAvLyBTdGFydCBjb3VudGluZyB1cCBmcm9tIGNlbnRlcgoJICAgICAgICB2YXIgaSA9IHN0YXJ0STsKCSAgICAgICAgd2hpbGUgKGkgPj0gMCAmJiBpbWFnZS5nZXQoY2VudGVySiwgaSkgJiYgc3RhdGVDb3VudFsxXSA8PSBtYXhDb3VudCkgewoJICAgICAgICAgICAgc3RhdGVDb3VudFsxXSsrOwoJICAgICAgICAgICAgaS0tOwoJICAgICAgICB9CgkgICAgICAgIC8vIElmIGFscmVhZHkgdG9vIG1hbnkgbW9kdWxlcyBpbiB0aGlzIHN0YXRlIG9yIHJhbiBvZmYgdGhlIGVkZ2U6CgkgICAgICAgIGlmIChpIDwgMCB8fCBzdGF0ZUNvdW50WzFdID4gbWF4Q291bnQpIHsKCSAgICAgICAgICAgIHJldHVybiBOYU47CgkgICAgICAgIH0KCSAgICAgICAgd2hpbGUgKGkgPj0gMCAmJiAhaW1hZ2UuZ2V0KGNlbnRlckosIGkpICYmIHN0YXRlQ291bnRbMF0gPD0gbWF4Q291bnQpIHsKCSAgICAgICAgICAgIHN0YXRlQ291bnRbMF0rKzsKCSAgICAgICAgICAgIGktLTsKCSAgICAgICAgfQoJICAgICAgICBpZiAoc3RhdGVDb3VudFswXSA+IG1heENvdW50KSB7CgkgICAgICAgICAgICByZXR1cm4gTmFOOwoJICAgICAgICB9CgkgICAgICAgIC8vIE5vdyBhbHNvIGNvdW50IGRvd24gZnJvbSBjZW50ZXIKCSAgICAgICAgaSA9IHN0YXJ0SSArIDE7CgkgICAgICAgIHdoaWxlIChpIDwgbWF4SSAmJiBpbWFnZS5nZXQoY2VudGVySiwgaSkgJiYgc3RhdGVDb3VudFsxXSA8PSBtYXhDb3VudCkgewoJICAgICAgICAgICAgc3RhdGVDb3VudFsxXSsrOwoJICAgICAgICAgICAgaSsrOwoJICAgICAgICB9CgkgICAgICAgIGlmIChpID09PSBtYXhJIHx8IHN0YXRlQ291bnRbMV0gPiBtYXhDb3VudCkgewoJICAgICAgICAgICAgcmV0dXJuIE5hTjsKCSAgICAgICAgfQoJICAgICAgICB3aGlsZSAoaSA8IG1heEkgJiYgIWltYWdlLmdldChjZW50ZXJKLCBpKSAmJiBzdGF0ZUNvdW50WzJdIDw9IG1heENvdW50KSB7CgkgICAgICAgICAgICBzdGF0ZUNvdW50WzJdKys7CgkgICAgICAgICAgICBpKys7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKHN0YXRlQ291bnRbMl0gPiBtYXhDb3VudCkgewoJICAgICAgICAgICAgcmV0dXJuIE5hTjsKCSAgICAgICAgfQoJICAgICAgICB2YXIgc3RhdGVDb3VudFRvdGFsID0gc3RhdGVDb3VudFswXSArIHN0YXRlQ291bnRbMV0gKyBzdGF0ZUNvdW50WzJdOwoJICAgICAgICBpZiAoNSAqIE1hdGguYWJzKHN0YXRlQ291bnRUb3RhbCAtIG9yaWdpbmFsU3RhdGVDb3VudFRvdGFsKSA+PSAyICogb3JpZ2luYWxTdGF0ZUNvdW50VG90YWwpIHsKCSAgICAgICAgICAgIHJldHVybiBOYU47CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIHRoaXMuZm91bmRQYXR0ZXJuQ3Jvc3Moc3RhdGVDb3VudCkgPyBBbGlnbm1lbnRQYXR0ZXJuRmluZGVyLmNlbnRlckZyb21FbmQoc3RhdGVDb3VudCwgaSkgOiBOYU47CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiA8cD5UaGlzIGlzIGNhbGxlZCB3aGVuIGEgaG9yaXpvbnRhbCBzY2FuIGZpbmRzIGEgcG9zc2libGUgYWxpZ25tZW50IHBhdHRlcm4uIEl0IHdpbGwKCSAgICAgKiBjcm9zcyBjaGVjayB3aXRoIGEgdmVydGljYWwgc2NhbiwgYW5kIGlmIHN1Y2Nlc3NmdWwsIHdpbGwgc2VlIGlmIHRoaXMgcGF0dGVybiBoYWQgYmVlbgoJICAgICAqIGZvdW5kIG9uIGEgcHJldmlvdXMgaG9yaXpvbnRhbCBzY2FuLiBJZiBzbywgd2UgY29uc2lkZXIgaXQgY29uZmlybWVkIGFuZCBjb25jbHVkZSB3ZSBoYXZlCgkgICAgICogZm91bmQgdGhlIGFsaWdubWVudCBwYXR0ZXJuLjwvcD4KCSAgICAgKgoJICAgICAqIEBwYXJhbSBzdGF0ZUNvdW50IHJlYWRpbmcgc3RhdGUgbW9kdWxlIGNvdW50cyBmcm9tIGhvcml6b250YWwgc2NhbgoJICAgICAqIEBwYXJhbSBpIHJvdyB3aGVyZSBhbGlnbm1lbnQgcGF0dGVybiBtYXkgYmUgZm91bmQKCSAgICAgKiBAcGFyYW0gaiBlbmQgb2YgcG9zc2libGUgYWxpZ25tZW50IHBhdHRlcm4gaW4gcm93CgkgICAgICogQHJldHVybiB7QGxpbmsgQWxpZ25tZW50UGF0dGVybn0gaWYgd2UgaGF2ZSBmb3VuZCB0aGUgc2FtZSBwYXR0ZXJuIHR3aWNlLCBvciBudWxsIGlmIG5vdAoJICAgICAqLwoJICAgIEFsaWdubWVudFBhdHRlcm5GaW5kZXIucHJvdG90eXBlLmhhbmRsZVBvc3NpYmxlQ2VudGVyID0gZnVuY3Rpb24gKHN0YXRlQ291bnQsIGkgLyppbnQqLywgaiAvKmludCovKSB7CgkgICAgICAgIHZhciBlXzEsIF9hOwoJICAgICAgICB2YXIgc3RhdGVDb3VudFRvdGFsID0gc3RhdGVDb3VudFswXSArIHN0YXRlQ291bnRbMV0gKyBzdGF0ZUNvdW50WzJdOwoJICAgICAgICB2YXIgY2VudGVySiA9IEFsaWdubWVudFBhdHRlcm5GaW5kZXIuY2VudGVyRnJvbUVuZChzdGF0ZUNvdW50LCBqKTsKCSAgICAgICAgdmFyIGNlbnRlckkgPSB0aGlzLmNyb3NzQ2hlY2tWZXJ0aWNhbChpLCAvKihpbnQpICovIGNlbnRlckosIDIgKiBzdGF0ZUNvdW50WzFdLCBzdGF0ZUNvdW50VG90YWwpOwoJICAgICAgICBpZiAoIWlzTmFOKGNlbnRlckkpKSB7CgkgICAgICAgICAgICB2YXIgZXN0aW1hdGVkTW9kdWxlU2l6ZSA9IChzdGF0ZUNvdW50WzBdICsgc3RhdGVDb3VudFsxXSArIHN0YXRlQ291bnRbMl0pIC8gMy4wOwoJICAgICAgICAgICAgdHJ5IHsKCSAgICAgICAgICAgICAgICBmb3IgKHZhciBfYiA9IF9fdmFsdWVzJDEodGhpcy5wb3NzaWJsZUNlbnRlcnMpLCBfYyA9IF9iLm5leHQoKTsgIV9jLmRvbmU7IF9jID0gX2IubmV4dCgpKSB7CgkgICAgICAgICAgICAgICAgICAgIHZhciBjZW50ZXIgPSBfYy52YWx1ZTsKCSAgICAgICAgICAgICAgICAgICAgLy8gTG9vayBmb3IgYWJvdXQgdGhlIHNhbWUgY2VudGVyIGFuZCBtb2R1bGUgc2l6ZToKCSAgICAgICAgICAgICAgICAgICAgaWYgKGNlbnRlci5hYm91dEVxdWFscyhlc3RpbWF0ZWRNb2R1bGVTaXplLCBjZW50ZXJJLCBjZW50ZXJKKSkgewoJICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGNlbnRlci5jb21iaW5lRXN0aW1hdGUoY2VudGVySSwgY2VudGVySiwgZXN0aW1hdGVkTW9kdWxlU2l6ZSk7CgkgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBjYXRjaCAoZV8xXzEpIHsgZV8xID0geyBlcnJvcjogZV8xXzEgfTsgfQoJICAgICAgICAgICAgZmluYWxseSB7CgkgICAgICAgICAgICAgICAgdHJ5IHsKCSAgICAgICAgICAgICAgICAgICAgaWYgKF9jICYmICFfYy5kb25lICYmIChfYSA9IF9iLnJldHVybikpIF9hLmNhbGwoX2IpOwoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICBmaW5hbGx5IHsgaWYgKGVfMSkgdGhyb3cgZV8xLmVycm9yOyB9CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICAvLyBIYWRuJ3QgZm91bmQgdGhpcyBiZWZvcmU7IHNhdmUgaXQKCSAgICAgICAgICAgIHZhciBwb2ludCA9IG5ldyBBbGlnbm1lbnRQYXR0ZXJuXzEuZGVmYXVsdChjZW50ZXJKLCBjZW50ZXJJLCBlc3RpbWF0ZWRNb2R1bGVTaXplKTsKCSAgICAgICAgICAgIHRoaXMucG9zc2libGVDZW50ZXJzLnB1c2gocG9pbnQpOwoJICAgICAgICAgICAgaWYgKHRoaXMucmVzdWx0UG9pbnRDYWxsYmFjayAhPT0gbnVsbCAmJiB0aGlzLnJlc3VsdFBvaW50Q2FsbGJhY2sgIT09IHVuZGVmaW5lZCkgewoJICAgICAgICAgICAgICAgIHRoaXMucmVzdWx0UG9pbnRDYWxsYmFjay5mb3VuZFBvc3NpYmxlUmVzdWx0UG9pbnQocG9pbnQpOwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIHJldHVybiBudWxsOwoJICAgIH07CgkgICAgcmV0dXJuIEFsaWdubWVudFBhdHRlcm5GaW5kZXI7Cgl9KCkpOwoJQWxpZ25tZW50UGF0dGVybkZpbmRlciQxLmRlZmF1bHQgPSBBbGlnbm1lbnRQYXR0ZXJuRmluZGVyOwoKCXZhciBGaW5kZXJQYXR0ZXJuRmluZGVyJDEgPSB7fTsKCgl2YXIgRmluZGVyUGF0dGVybiQxID0ge307CgoJLyoKCSAqIENvcHlyaWdodCAyMDA3IFpYaW5nIGF1dGhvcnMKCSAqCgkgKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKCSAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4KCSAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdAoJICoKCSAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wCgkgKgoJICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZQoJICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gIkFTIElTIiBCQVNJUywKCSAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLgoJICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZAoJICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuCgkgKi8KCXZhciBfX2V4dGVuZHMgPSAoY29tbW9uanNHbG9iYWwgJiYgY29tbW9uanNHbG9iYWwuX19leHRlbmRzKSB8fCAoZnVuY3Rpb24gKCkgewoJICAgIHZhciBleHRlbmRTdGF0aWNzID0gZnVuY3Rpb24gKGQsIGIpIHsKCSAgICAgICAgZXh0ZW5kU3RhdGljcyA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fAoJICAgICAgICAgICAgKHsgX19wcm90b19fOiBbXSB9IGluc3RhbmNlb2YgQXJyYXkgJiYgZnVuY3Rpb24gKGQsIGIpIHsgZC5fX3Byb3RvX18gPSBiOyB9KSB8fAoJICAgICAgICAgICAgZnVuY3Rpb24gKGQsIGIpIHsgZm9yICh2YXIgcCBpbiBiKSBpZiAoYi5oYXNPd25Qcm9wZXJ0eShwKSkgZFtwXSA9IGJbcF07IH07CgkgICAgICAgIHJldHVybiBleHRlbmRTdGF0aWNzKGQsIGIpOwoJICAgIH07CgkgICAgcmV0dXJuIGZ1bmN0aW9uIChkLCBiKSB7CgkgICAgICAgIGV4dGVuZFN0YXRpY3MoZCwgYik7CgkgICAgICAgIGZ1bmN0aW9uIF9fKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gZDsgfQoJICAgICAgICBkLnByb3RvdHlwZSA9IGIgPT09IG51bGwgPyBPYmplY3QuY3JlYXRlKGIpIDogKF9fLnByb3RvdHlwZSA9IGIucHJvdG90eXBlLCBuZXcgX18oKSk7CgkgICAgfTsKCX0pKCk7CglPYmplY3QuZGVmaW5lUHJvcGVydHkoRmluZGVyUGF0dGVybiQxLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7CgkvKm5hbWVzcGFjZSBjb20uZ29vZ2xlLnp4aW5nLnFyY29kZS5kZXRlY3RvciB7Ki8KCXZhciBSZXN1bHRQb2ludF8xJDIgPSBSZXN1bHRQb2ludCQxOwoJLyoqCgkgKiA8cD5FbmNhcHN1bGF0ZXMgYSBmaW5kZXIgcGF0dGVybiwgd2hpY2ggYXJlIHRoZSB0aHJlZSBzcXVhcmUgcGF0dGVybnMgZm91bmQgaW4KCSAqIHRoZSBjb3JuZXJzIG9mIFFSIENvZGVzLiBJdCBhbHNvIGVuY2Fwc3VsYXRlcyBhIGNvdW50IG9mIHNpbWlsYXIgZmluZGVyIHBhdHRlcm5zLAoJICogYXMgYSBjb252ZW5pZW5jZSB0byB0aGUgZmluZGVyJ3MgYm9va2tlZXBpbmcuPC9wPgoJICoKCSAqIEBhdXRob3IgU2VhbiBPd2VuCgkgKi8KCXZhciBGaW5kZXJQYXR0ZXJuID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikgewoJICAgIF9fZXh0ZW5kcyhGaW5kZXJQYXR0ZXJuLCBfc3VwZXIpOwoJICAgIC8vIEZpbmRlclBhdHRlcm4ocG9zWDogbnVtYmVyLypmbG9hdCovLCBwb3NZOiBudW1iZXIvKmZsb2F0Ki8sIGVzdGltYXRlZE1vZHVsZVNpemU6IG51bWJlci8qZmxvYXQqLykgewoJICAgIC8vICAgdGhpcyhwb3NYLCBwb3NZLCBlc3RpbWF0ZWRNb2R1bGVTaXplLCAxKQoJICAgIC8vIH0KCSAgICBmdW5jdGlvbiBGaW5kZXJQYXR0ZXJuKHBvc1ggLypmbG9hdCovLCBwb3NZIC8qZmxvYXQqLywgZXN0aW1hdGVkTW9kdWxlU2l6ZSAvKmZsb2F0Ki8sIGNvdW50IC8qaW50Ki8pIHsKCSAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcywgcG9zWCwgcG9zWSkgfHwgdGhpczsKCSAgICAgICAgX3RoaXMuZXN0aW1hdGVkTW9kdWxlU2l6ZSA9IGVzdGltYXRlZE1vZHVsZVNpemU7CgkgICAgICAgIF90aGlzLmNvdW50ID0gY291bnQ7CgkgICAgICAgIGlmICh1bmRlZmluZWQgPT09IGNvdW50KSB7CgkgICAgICAgICAgICBfdGhpcy5jb3VudCA9IDE7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIF90aGlzOwoJICAgIH0KCSAgICBGaW5kZXJQYXR0ZXJuLnByb3RvdHlwZS5nZXRFc3RpbWF0ZWRNb2R1bGVTaXplID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5lc3RpbWF0ZWRNb2R1bGVTaXplOwoJICAgIH07CgkgICAgRmluZGVyUGF0dGVybi5wcm90b3R5cGUuZ2V0Q291bnQgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLmNvdW50OwoJICAgIH07CgkgICAgLyoKCSAgICB2b2lkIGluY3JlbWVudENvdW50KCkgewoJICAgICAgdGhpcy5jb3VudCsrCgkgICAgfQoJICAgICAqLwoJICAgIC8qKgoJICAgICAqIDxwPkRldGVybWluZXMgaWYgdGhpcyBmaW5kZXIgcGF0dGVybiAiYWJvdXQgZXF1YWxzIiBhIGZpbmRlciBwYXR0ZXJuIGF0IHRoZSBzdGF0ZWQKCSAgICAgKiBwb3NpdGlvbiBhbmQgc2l6ZSAtLSBtZWFuaW5nLCBpdCBpcyBhdCBuZWFybHkgdGhlIHNhbWUgY2VudGVyIHdpdGggbmVhcmx5IHRoZSBzYW1lIHNpemUuPC9wPgoJICAgICAqLwoJICAgIEZpbmRlclBhdHRlcm4ucHJvdG90eXBlLmFib3V0RXF1YWxzID0gZnVuY3Rpb24gKG1vZHVsZVNpemUgLypmbG9hdCovLCBpIC8qZmxvYXQqLywgaiAvKmZsb2F0Ki8pIHsKCSAgICAgICAgaWYgKE1hdGguYWJzKGkgLSB0aGlzLmdldFkoKSkgPD0gbW9kdWxlU2l6ZSAmJiBNYXRoLmFicyhqIC0gdGhpcy5nZXRYKCkpIDw9IG1vZHVsZVNpemUpIHsKCSAgICAgICAgICAgIHZhciBtb2R1bGVTaXplRGlmZiA9IE1hdGguYWJzKG1vZHVsZVNpemUgLSB0aGlzLmVzdGltYXRlZE1vZHVsZVNpemUpOwoJICAgICAgICAgICAgcmV0dXJuIG1vZHVsZVNpemVEaWZmIDw9IDEuMCB8fCBtb2R1bGVTaXplRGlmZiA8PSB0aGlzLmVzdGltYXRlZE1vZHVsZVNpemU7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIGZhbHNlOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQ29tYmluZXMgdGhpcyBvYmplY3QncyBjdXJyZW50IGVzdGltYXRlIG9mIGEgZmluZGVyIHBhdHRlcm4gcG9zaXRpb24gYW5kIG1vZHVsZSBzaXplCgkgICAgICogd2l0aCBhIG5ldyBlc3RpbWF0ZS4gSXQgcmV0dXJucyBhIG5ldyB7QGNvZGUgRmluZGVyUGF0dGVybn0gY29udGFpbmluZyBhIHdlaWdodGVkIGF2ZXJhZ2UKCSAgICAgKiBiYXNlZCBvbiBjb3VudC4KCSAgICAgKi8KCSAgICBGaW5kZXJQYXR0ZXJuLnByb3RvdHlwZS5jb21iaW5lRXN0aW1hdGUgPSBmdW5jdGlvbiAoaSAvKmZsb2F0Ki8sIGogLypmbG9hdCovLCBuZXdNb2R1bGVTaXplIC8qZmxvYXQqLykgewoJICAgICAgICB2YXIgY29tYmluZWRDb3VudCA9IHRoaXMuY291bnQgKyAxOwoJICAgICAgICB2YXIgY29tYmluZWRYID0gKHRoaXMuY291bnQgKiB0aGlzLmdldFgoKSArIGopIC8gY29tYmluZWRDb3VudDsKCSAgICAgICAgdmFyIGNvbWJpbmVkWSA9ICh0aGlzLmNvdW50ICogdGhpcy5nZXRZKCkgKyBpKSAvIGNvbWJpbmVkQ291bnQ7CgkgICAgICAgIHZhciBjb21iaW5lZE1vZHVsZVNpemUgPSAodGhpcy5jb3VudCAqIHRoaXMuZXN0aW1hdGVkTW9kdWxlU2l6ZSArIG5ld01vZHVsZVNpemUpIC8gY29tYmluZWRDb3VudDsKCSAgICAgICAgcmV0dXJuIG5ldyBGaW5kZXJQYXR0ZXJuKGNvbWJpbmVkWCwgY29tYmluZWRZLCBjb21iaW5lZE1vZHVsZVNpemUsIGNvbWJpbmVkQ291bnQpOwoJICAgIH07CgkgICAgcmV0dXJuIEZpbmRlclBhdHRlcm47Cgl9KFJlc3VsdFBvaW50XzEkMi5kZWZhdWx0KSk7CglGaW5kZXJQYXR0ZXJuJDEuZGVmYXVsdCA9IEZpbmRlclBhdHRlcm47CgoJdmFyIEZpbmRlclBhdHRlcm5JbmZvJDEgPSB7fTsKCgkvKgoJICogQ29weXJpZ2h0IDIwMDcgWlhpbmcgYXV0aG9ycwoJICoKCSAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoJICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoJICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkgKgoJICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKCSAqCgkgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCgkgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoJICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCgkgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCSAqLwoJT2JqZWN0LmRlZmluZVByb3BlcnR5KEZpbmRlclBhdHRlcm5JbmZvJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCS8qKgoJICogPHA+RW5jYXBzdWxhdGVzIGluZm9ybWF0aW9uIGFib3V0IGZpbmRlciBwYXR0ZXJucyBpbiBhbiBpbWFnZSwgaW5jbHVkaW5nIHRoZSBsb2NhdGlvbiBvZgoJICogdGhlIHRocmVlIGZpbmRlciBwYXR0ZXJucywgYW5kIHRoZWlyIGVzdGltYXRlZCBtb2R1bGUgc2l6ZS48L3A+CgkgKgoJICogQGF1dGhvciBTZWFuIE93ZW4KCSAqLwoJdmFyIEZpbmRlclBhdHRlcm5JbmZvID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkgewoJICAgIGZ1bmN0aW9uIEZpbmRlclBhdHRlcm5JbmZvKHBhdHRlcm5DZW50ZXJzKSB7CgkgICAgICAgIHRoaXMuYm90dG9tTGVmdCA9IHBhdHRlcm5DZW50ZXJzWzBdOwoJICAgICAgICB0aGlzLnRvcExlZnQgPSBwYXR0ZXJuQ2VudGVyc1sxXTsKCSAgICAgICAgdGhpcy50b3BSaWdodCA9IHBhdHRlcm5DZW50ZXJzWzJdOwoJICAgIH0KCSAgICBGaW5kZXJQYXR0ZXJuSW5mby5wcm90b3R5cGUuZ2V0Qm90dG9tTGVmdCA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMuYm90dG9tTGVmdDsKCSAgICB9OwoJICAgIEZpbmRlclBhdHRlcm5JbmZvLnByb3RvdHlwZS5nZXRUb3BMZWZ0ID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy50b3BMZWZ0OwoJICAgIH07CgkgICAgRmluZGVyUGF0dGVybkluZm8ucHJvdG90eXBlLmdldFRvcFJpZ2h0ID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy50b3BSaWdodDsKCSAgICB9OwoJICAgIHJldHVybiBGaW5kZXJQYXR0ZXJuSW5mbzsKCX0oKSk7CglGaW5kZXJQYXR0ZXJuSW5mbyQxLmRlZmF1bHQgPSBGaW5kZXJQYXR0ZXJuSW5mbzsKCgkvKgoJICogQ29weXJpZ2h0IDIwMDcgWlhpbmcgYXV0aG9ycwoJICoKCSAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoJICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoJICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkgKgoJICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKCSAqCgkgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCgkgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoJICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCgkgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCSAqLwoJdmFyIF9fdmFsdWVzID0gKGNvbW1vbmpzR2xvYmFsICYmIGNvbW1vbmpzR2xvYmFsLl9fdmFsdWVzKSB8fCBmdW5jdGlvbihvKSB7CgkgICAgdmFyIHMgPSB0eXBlb2YgU3ltYm9sID09PSAiZnVuY3Rpb24iICYmIFN5bWJvbC5pdGVyYXRvciwgbSA9IHMgJiYgb1tzXSwgaSA9IDA7CgkgICAgaWYgKG0pIHJldHVybiBtLmNhbGwobyk7CgkgICAgaWYgKG8gJiYgdHlwZW9mIG8ubGVuZ3RoID09PSAibnVtYmVyIikgcmV0dXJuIHsKCSAgICAgICAgbmV4dDogZnVuY3Rpb24gKCkgewoJICAgICAgICAgICAgaWYgKG8gJiYgaSA+PSBvLmxlbmd0aCkgbyA9IHZvaWQgMDsKCSAgICAgICAgICAgIHJldHVybiB7IHZhbHVlOiBvICYmIG9baSsrXSwgZG9uZTogIW8gfTsKCSAgICAgICAgfQoJICAgIH07CgkgICAgdGhyb3cgbmV3IFR5cGVFcnJvcihzID8gIk9iamVjdCBpcyBub3QgaXRlcmFibGUuIiA6ICJTeW1ib2wuaXRlcmF0b3IgaXMgbm90IGRlZmluZWQuIik7Cgl9OwoJT2JqZWN0LmRlZmluZVByb3BlcnR5KEZpbmRlclBhdHRlcm5GaW5kZXIkMSwgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJLypuYW1lc3BhY2UgY29tLmdvb2dsZS56eGluZy5xcmNvZGUuZGV0ZWN0b3IgeyovCgl2YXIgRGVjb2RlSGludFR5cGVfMSQyID0gRGVjb2RlSGludFR5cGUkMTsKCXZhciBSZXN1bHRQb2ludF8xJDEgPSBSZXN1bHRQb2ludCQxOwoJdmFyIEZpbmRlclBhdHRlcm5fMSA9IEZpbmRlclBhdHRlcm4kMTsKCXZhciBGaW5kZXJQYXR0ZXJuSW5mb18xID0gRmluZGVyUGF0dGVybkluZm8kMTsKCXZhciBOb3RGb3VuZEV4Y2VwdGlvbl8xJDIgPSBOb3RGb3VuZEV4Y2VwdGlvbiQxOwoJLyppbXBvcnQgamF2YS5pby5TZXJpYWxpemFibGU7Ki8KCS8qaW1wb3J0IGphdmEudXRpbC5BcnJheUxpc3Q7Ki8KCS8qaW1wb3J0IGphdmEudXRpbC5Db2xsZWN0aW9uczsqLwoJLyppbXBvcnQgamF2YS51dGlsLkNvbXBhcmF0b3I7Ki8KCS8qaW1wb3J0IGphdmEudXRpbC5MaXN0OyovCgkvKmltcG9ydCBqYXZhLnV0aWwuTWFwOyovCgkvKioKCSAqIDxwPlRoaXMgY2xhc3MgYXR0ZW1wdHMgdG8gZmluZCBmaW5kZXIgcGF0dGVybnMgaW4gYSBRUiBDb2RlLiBGaW5kZXIgcGF0dGVybnMgYXJlIHRoZSBzcXVhcmUKCSAqIG1hcmtlcnMgYXQgdGhyZWUgY29ybmVycyBvZiBhIFFSIENvZGUuPC9wPgoJICoKCSAqIDxwPlRoaXMgY2xhc3MgaXMgdGhyZWFkLXNhZmUgYnV0IG5vdCByZWVudHJhbnQuIEVhY2ggdGhyZWFkIG11c3QgYWxsb2NhdGUgaXRzIG93biBvYmplY3QuCgkgKgoJICogQGF1dGhvciBTZWFuIE93ZW4KCSAqLwoJdmFyIEZpbmRlclBhdHRlcm5GaW5kZXIgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7CgkgICAgLyoqCgkgICAgICogPHA+Q3JlYXRlcyBhIGZpbmRlciB0aGF0IHdpbGwgc2VhcmNoIHRoZSBpbWFnZSBmb3IgdGhyZWUgZmluZGVyIHBhdHRlcm5zLjwvcD4KCSAgICAgKgoJICAgICAqIEBwYXJhbSBpbWFnZSBpbWFnZSB0byBzZWFyY2gKCSAgICAgKi8KCSAgICAvLyBwdWJsaWMgY29uc3RydWN0b3IoaW1hZ2U6IEJpdE1hdHJpeCkgewoJICAgIC8vICAgdGhpcyhpbWFnZSwgbnVsbCkKCSAgICAvLyB9CgkgICAgZnVuY3Rpb24gRmluZGVyUGF0dGVybkZpbmRlcihpbWFnZSwgcmVzdWx0UG9pbnRDYWxsYmFjaykgewoJICAgICAgICB0aGlzLmltYWdlID0gaW1hZ2U7CgkgICAgICAgIHRoaXMucmVzdWx0UG9pbnRDYWxsYmFjayA9IHJlc3VsdFBvaW50Q2FsbGJhY2s7CgkgICAgICAgIHRoaXMucG9zc2libGVDZW50ZXJzID0gW107CgkgICAgICAgIHRoaXMuY3Jvc3NDaGVja1N0YXRlQ291bnQgPSBuZXcgSW50MzJBcnJheSg1KTsKCSAgICAgICAgdGhpcy5yZXN1bHRQb2ludENhbGxiYWNrID0gcmVzdWx0UG9pbnRDYWxsYmFjazsKCSAgICB9CgkgICAgRmluZGVyUGF0dGVybkZpbmRlci5wcm90b3R5cGUuZ2V0SW1hZ2UgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLmltYWdlOwoJICAgIH07CgkgICAgRmluZGVyUGF0dGVybkZpbmRlci5wcm90b3R5cGUuZ2V0UG9zc2libGVDZW50ZXJzID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5wb3NzaWJsZUNlbnRlcnM7CgkgICAgfTsKCSAgICBGaW5kZXJQYXR0ZXJuRmluZGVyLnByb3RvdHlwZS5maW5kID0gZnVuY3Rpb24gKGhpbnRzKSB7CgkgICAgICAgIHZhciB0cnlIYXJkZXIgPSAoaGludHMgIT09IG51bGwgJiYgaGludHMgIT09IHVuZGVmaW5lZCkgJiYgdW5kZWZpbmVkICE9PSBoaW50cy5nZXQoRGVjb2RlSGludFR5cGVfMSQyLmRlZmF1bHQuVFJZX0hBUkRFUik7CgkgICAgICAgIHZhciBwdXJlQmFyY29kZSA9IChoaW50cyAhPT0gbnVsbCAmJiBoaW50cyAhPT0gdW5kZWZpbmVkKSAmJiB1bmRlZmluZWQgIT09IGhpbnRzLmdldChEZWNvZGVIaW50VHlwZV8xJDIuZGVmYXVsdC5QVVJFX0JBUkNPREUpOwoJICAgICAgICB2YXIgaW1hZ2UgPSB0aGlzLmltYWdlOwoJICAgICAgICB2YXIgbWF4SSA9IGltYWdlLmdldEhlaWdodCgpOwoJICAgICAgICB2YXIgbWF4SiA9IGltYWdlLmdldFdpZHRoKCk7CgkgICAgICAgIC8vIFdlIGFyZSBsb29raW5nIGZvciBibGFjay93aGl0ZS9ibGFjay93aGl0ZS9ibGFjayBtb2R1bGVzIGluCgkgICAgICAgIC8vIDE6MTozOjE6MSByYXRpbzsgdGhpcyB0cmFja3MgdGhlIG51bWJlciBvZiBzdWNoIG1vZHVsZXMgc2VlbiBzbyBmYXIKCSAgICAgICAgLy8gTGV0J3MgYXNzdW1lIHRoYXQgdGhlIG1heGltdW0gdmVyc2lvbiBRUiBDb2RlIHdlIHN1cHBvcnQgdGFrZXMgdXAgMS80IHRoZSBoZWlnaHQgb2YgdGhlCgkgICAgICAgIC8vIGltYWdlLCBhbmQgdGhlbiBhY2NvdW50IGZvciB0aGUgY2VudGVyIGJlaW5nIDMgbW9kdWxlcyBpbiBzaXplLiBUaGlzIGdpdmVzIHRoZSBzbWFsbGVzdAoJICAgICAgICAvLyBudW1iZXIgb2YgcGl4ZWxzIHRoZSBjZW50ZXIgY291bGQgYmUsIHNvIHNraXAgdGhpcyBvZnRlbi4gV2hlbiB0cnlpbmcgaGFyZGVyLCBsb29rIGZvciBhbGwKCSAgICAgICAgLy8gUVIgdmVyc2lvbnMgcmVnYXJkbGVzcyBvZiBob3cgZGVuc2UgdGhleSBhcmUuCgkgICAgICAgIHZhciBpU2tpcCA9IE1hdGguZmxvb3IoKDMgKiBtYXhJKSAvICg0ICogRmluZGVyUGF0dGVybkZpbmRlci5NQVhfTU9EVUxFUykpOwoJICAgICAgICBpZiAoaVNraXAgPCBGaW5kZXJQYXR0ZXJuRmluZGVyLk1JTl9TS0lQIHx8IHRyeUhhcmRlcikgewoJICAgICAgICAgICAgaVNraXAgPSBGaW5kZXJQYXR0ZXJuRmluZGVyLk1JTl9TS0lQOwoJICAgICAgICB9CgkgICAgICAgIHZhciBkb25lID0gZmFsc2U7CgkgICAgICAgIHZhciBzdGF0ZUNvdW50ID0gbmV3IEludDMyQXJyYXkoNSk7CgkgICAgICAgIGZvciAodmFyIGkgPSBpU2tpcCAtIDE7IGkgPCBtYXhJICYmICFkb25lOyBpICs9IGlTa2lwKSB7CgkgICAgICAgICAgICAvLyBHZXQgYSByb3cgb2YgYmxhY2svd2hpdGUgdmFsdWVzCgkgICAgICAgICAgICBzdGF0ZUNvdW50WzBdID0gMDsKCSAgICAgICAgICAgIHN0YXRlQ291bnRbMV0gPSAwOwoJICAgICAgICAgICAgc3RhdGVDb3VudFsyXSA9IDA7CgkgICAgICAgICAgICBzdGF0ZUNvdW50WzNdID0gMDsKCSAgICAgICAgICAgIHN0YXRlQ291bnRbNF0gPSAwOwoJICAgICAgICAgICAgdmFyIGN1cnJlbnRTdGF0ZSA9IDA7CgkgICAgICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IG1heEo7IGorKykgewoJICAgICAgICAgICAgICAgIGlmIChpbWFnZS5nZXQoaiwgaSkpIHsKCSAgICAgICAgICAgICAgICAgICAgLy8gQmxhY2sgcGl4ZWwKCSAgICAgICAgICAgICAgICAgICAgaWYgKChjdXJyZW50U3RhdGUgJiAxKSA9PT0gMSkgeyAvLyBDb3VudGluZyB3aGl0ZSBwaXhlbHMKCSAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJlbnRTdGF0ZSsrOwoJICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgIHN0YXRlQ291bnRbY3VycmVudFN0YXRlXSsrOwoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICBlbHNlIHsgLy8gV2hpdGUgcGl4ZWwKCSAgICAgICAgICAgICAgICAgICAgaWYgKChjdXJyZW50U3RhdGUgJiAxKSA9PT0gMCkgeyAvLyBDb3VudGluZyBibGFjayBwaXhlbHMKCSAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjdXJyZW50U3RhdGUgPT09IDQpIHsgLy8gQSB3aW5uZXI/CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKEZpbmRlclBhdHRlcm5GaW5kZXIuZm91bmRQYXR0ZXJuQ3Jvc3Moc3RhdGVDb3VudCkpIHsgLy8gWWVzCgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjb25maXJtZWQgPSB0aGlzLmhhbmRsZVBvc3NpYmxlQ2VudGVyKHN0YXRlQ291bnQsIGksIGosIHB1cmVCYXJjb2RlKTsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGNvbmZpcm1lZCA9PT0gdHJ1ZSkgewoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gU3RhcnQgZXhhbWluaW5nIGV2ZXJ5IG90aGVyIGxpbmUuIENoZWNraW5nIGVhY2ggbGluZSB0dXJuZWQgb3V0IHRvIGJlIHRvbwoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gZXhwZW5zaXZlIGFuZCBkaWRuJ3QgaW1wcm92ZSBwZXJmb3JtYW5jZS4KCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlTa2lwID0gMjsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmhhc1NraXBwZWQgPT09IHRydWUpIHsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkb25lID0gdGhpcy5oYXZlTXVsdGlwbHlDb25maXJtZWRDZW50ZXJzKCk7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgcm93U2tpcCA9IHRoaXMuZmluZFJvd1NraXAoKTsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAocm93U2tpcCA+IHN0YXRlQ291bnRbMl0pIHsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gU2tpcCByb3dzIGJldHdlZW4gcm93IG9mIGxvd2VyIGNvbmZpcm1lZCBjZW50ZXIKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gYW5kIHRvcCBvZiBwcmVzdW1lZCB0aGlyZCBjb25maXJtZWQgY2VudGVyCgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGJ1dCBiYWNrIHVwIGEgYml0IHRvIGdldCBhIGZ1bGwgY2hhbmNlIG9mIGRldGVjdGluZwoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBpdCwgZW50aXJlIHdpZHRoIG9mIGNlbnRlciBvZiBmaW5kZXIgcGF0dGVybgoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBTa2lwIGJ5IHJvd1NraXAsIGJ1dCBiYWNrIG9mZiBieSBzdGF0ZUNvdW50WzJdIChzaXplIG9mIGxhc3QgY2VudGVyCgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIG9mIHBhdHRlcm4gd2Ugc2F3KSB0byBiZSBjb25zZXJ2YXRpdmUsIGFuZCBhbHNvIGJhY2sgb2ZmIGJ5IGlTa2lwIHdoaWNoCgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGlzIGFib3V0IHRvIGJlIHJlLWFkZGVkCgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGkgKz0gcm93U2tpcCAtIHN0YXRlQ291bnRbMl0gLSBpU2tpcDsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaiA9IG1heEogLSAxOwoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0YXRlQ291bnRbMF0gPSBzdGF0ZUNvdW50WzJdOwoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RhdGVDb3VudFsxXSA9IHN0YXRlQ291bnRbM107CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGF0ZUNvdW50WzJdID0gc3RhdGVDb3VudFs0XTsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0YXRlQ291bnRbM10gPSAxOwoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RhdGVDb3VudFs0XSA9IDA7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjdXJyZW50U3RhdGUgPSAzOwoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGludWU7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gQ2xlYXIgc3RhdGUgdG8gc3RhcnQgbG9va2luZyBhZ2FpbgoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjdXJyZW50U3RhdGUgPSAwOwoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGF0ZUNvdW50WzBdID0gMDsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RhdGVDb3VudFsxXSA9IDA7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0YXRlQ291bnRbMl0gPSAwOwoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGF0ZUNvdW50WzNdID0gMDsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RhdGVDb3VudFs0XSA9IDA7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UgeyAvLyBObywgc2hpZnQgY291bnRzIGJhY2sgYnkgdHdvCgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0YXRlQ291bnRbMF0gPSBzdGF0ZUNvdW50WzJdOwoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGF0ZUNvdW50WzFdID0gc3RhdGVDb3VudFszXTsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RhdGVDb3VudFsyXSA9IHN0YXRlQ291bnRbNF07CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0YXRlQ291bnRbM10gPSAxOwoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGF0ZUNvdW50WzRdID0gMDsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY3VycmVudFN0YXRlID0gMzsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGF0ZUNvdW50WysrY3VycmVudFN0YXRlXSsrOwoJICAgICAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgIGVsc2UgeyAvLyBDb3VudGluZyB3aGl0ZSBwaXhlbHMKCSAgICAgICAgICAgICAgICAgICAgICAgIHN0YXRlQ291bnRbY3VycmVudFN0YXRlXSsrOwoJICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgaWYgKEZpbmRlclBhdHRlcm5GaW5kZXIuZm91bmRQYXR0ZXJuQ3Jvc3Moc3RhdGVDb3VudCkpIHsKCSAgICAgICAgICAgICAgICB2YXIgY29uZmlybWVkID0gdGhpcy5oYW5kbGVQb3NzaWJsZUNlbnRlcihzdGF0ZUNvdW50LCBpLCBtYXhKLCBwdXJlQmFyY29kZSk7CgkgICAgICAgICAgICAgICAgaWYgKGNvbmZpcm1lZCA9PT0gdHJ1ZSkgewoJICAgICAgICAgICAgICAgICAgICBpU2tpcCA9IHN0YXRlQ291bnRbMF07CgkgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmhhc1NraXBwZWQpIHsKCSAgICAgICAgICAgICAgICAgICAgICAgIC8vIEZvdW5kIGEgdGhpcmQgb25lCgkgICAgICAgICAgICAgICAgICAgICAgICBkb25lID0gdGhpcy5oYXZlTXVsdGlwbHlDb25maXJtZWRDZW50ZXJzKCk7CgkgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICAgICAgdmFyIHBhdHRlcm5JbmZvID0gdGhpcy5zZWxlY3RCZXN0UGF0dGVybnMoKTsKCSAgICAgICAgUmVzdWx0UG9pbnRfMSQxLmRlZmF1bHQub3JkZXJCZXN0UGF0dGVybnMocGF0dGVybkluZm8pOwoJICAgICAgICByZXR1cm4gbmV3IEZpbmRlclBhdHRlcm5JbmZvXzEuZGVmYXVsdChwYXR0ZXJuSW5mbyk7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBHaXZlbiBhIGNvdW50IG9mIGJsYWNrL3doaXRlL2JsYWNrL3doaXRlL2JsYWNrIHBpeGVscyBqdXN0IHNlZW4gYW5kIGFuIGVuZCBwb3NpdGlvbiwKCSAgICAgKiBmaWd1cmVzIHRoZSBsb2NhdGlvbiBvZiB0aGUgY2VudGVyIG9mIHRoaXMgcnVuLgoJICAgICAqLwoJICAgIEZpbmRlclBhdHRlcm5GaW5kZXIuY2VudGVyRnJvbUVuZCA9IGZ1bmN0aW9uIChzdGF0ZUNvdW50LCBlbmQgLyppbnQqLykgewoJICAgICAgICByZXR1cm4gKGVuZCAtIHN0YXRlQ291bnRbNF0gLSBzdGF0ZUNvdW50WzNdKSAtIHN0YXRlQ291bnRbMl0gLyAyLjA7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcGFyYW0gc3RhdGVDb3VudCBjb3VudCBvZiBibGFjay93aGl0ZS9ibGFjay93aGl0ZS9ibGFjayBwaXhlbHMganVzdCByZWFkCgkgICAgICogQHJldHVybiB0cnVlIGlmZiB0aGUgcHJvcG9ydGlvbnMgb2YgdGhlIGNvdW50cyBpcyBjbG9zZSBlbm91Z2ggdG8gdGhlIDEvMS8zLzEvMSByYXRpb3MKCSAgICAgKiAgICAgICAgIHVzZWQgYnkgZmluZGVyIHBhdHRlcm5zIHRvIGJlIGNvbnNpZGVyZWQgYSBtYXRjaAoJICAgICAqLwoJICAgIEZpbmRlclBhdHRlcm5GaW5kZXIuZm91bmRQYXR0ZXJuQ3Jvc3MgPSBmdW5jdGlvbiAoc3RhdGVDb3VudCkgewoJICAgICAgICB2YXIgdG90YWxNb2R1bGVTaXplID0gMDsKCSAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCA1OyBpKyspIHsKCSAgICAgICAgICAgIHZhciBjb3VudCA9IHN0YXRlQ291bnRbaV07CgkgICAgICAgICAgICBpZiAoY291bnQgPT09IDApIHsKCSAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICB0b3RhbE1vZHVsZVNpemUgKz0gY291bnQ7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKHRvdGFsTW9kdWxlU2l6ZSA8IDcpIHsKCSAgICAgICAgICAgIHJldHVybiBmYWxzZTsKCSAgICAgICAgfQoJICAgICAgICB2YXIgbW9kdWxlU2l6ZSA9IHRvdGFsTW9kdWxlU2l6ZSAvIDcuMDsKCSAgICAgICAgdmFyIG1heFZhcmlhbmNlID0gbW9kdWxlU2l6ZSAvIDIuMDsKCSAgICAgICAgLy8gQWxsb3cgbGVzcyB0aGFuIDUwJSB2YXJpYW5jZSBmcm9tIDEtMS0zLTEtMSBwcm9wb3J0aW9ucwoJICAgICAgICByZXR1cm4gTWF0aC5hYnMobW9kdWxlU2l6ZSAtIHN0YXRlQ291bnRbMF0pIDwgbWF4VmFyaWFuY2UgJiYKCSAgICAgICAgICAgIE1hdGguYWJzKG1vZHVsZVNpemUgLSBzdGF0ZUNvdW50WzFdKSA8IG1heFZhcmlhbmNlICYmCgkgICAgICAgICAgICBNYXRoLmFicygzLjAgKiBtb2R1bGVTaXplIC0gc3RhdGVDb3VudFsyXSkgPCAzICogbWF4VmFyaWFuY2UgJiYKCSAgICAgICAgICAgIE1hdGguYWJzKG1vZHVsZVNpemUgLSBzdGF0ZUNvdW50WzNdKSA8IG1heFZhcmlhbmNlICYmCgkgICAgICAgICAgICBNYXRoLmFicyhtb2R1bGVTaXplIC0gc3RhdGVDb3VudFs0XSkgPCBtYXhWYXJpYW5jZTsKCSAgICB9OwoJICAgIEZpbmRlclBhdHRlcm5GaW5kZXIucHJvdG90eXBlLmdldENyb3NzQ2hlY2tTdGF0ZUNvdW50ID0gZnVuY3Rpb24gKCkgewoJICAgICAgICB2YXIgY3Jvc3NDaGVja1N0YXRlQ291bnQgPSB0aGlzLmNyb3NzQ2hlY2tTdGF0ZUNvdW50OwoJICAgICAgICBjcm9zc0NoZWNrU3RhdGVDb3VudFswXSA9IDA7CgkgICAgICAgIGNyb3NzQ2hlY2tTdGF0ZUNvdW50WzFdID0gMDsKCSAgICAgICAgY3Jvc3NDaGVja1N0YXRlQ291bnRbMl0gPSAwOwoJICAgICAgICBjcm9zc0NoZWNrU3RhdGVDb3VudFszXSA9IDA7CgkgICAgICAgIGNyb3NzQ2hlY2tTdGF0ZUNvdW50WzRdID0gMDsKCSAgICAgICAgcmV0dXJuIGNyb3NzQ2hlY2tTdGF0ZUNvdW50OwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQWZ0ZXIgYSB2ZXJ0aWNhbCBhbmQgaG9yaXpvbnRhbCBzY2FuIGZpbmRzIGEgcG90ZW50aWFsIGZpbmRlciBwYXR0ZXJuLCB0aGlzIG1ldGhvZAoJICAgICAqICJjcm9zcy1jcm9zcy1jcm9zcy1jaGVja3MiIGJ5IHNjYW5uaW5nIGRvd24gZGlhZ29uYWxseSB0aHJvdWdoIHRoZSBjZW50ZXIgb2YgdGhlIHBvc3NpYmxlCgkgICAgICogZmluZGVyIHBhdHRlcm4gdG8gc2VlIGlmIHRoZSBzYW1lIHByb3BvcnRpb24gaXMgZGV0ZWN0ZWQuCgkgICAgICoKCSAgICAgKiBAcGFyYW0gc3RhcnRJIHJvdyB3aGVyZSBhIGZpbmRlciBwYXR0ZXJuIHdhcyBkZXRlY3RlZAoJICAgICAqIEBwYXJhbSBjZW50ZXJKIGNlbnRlciBvZiB0aGUgc2VjdGlvbiB0aGF0IGFwcGVhcnMgdG8gY3Jvc3MgYSBmaW5kZXIgcGF0dGVybgoJICAgICAqIEBwYXJhbSBtYXhDb3VudCBtYXhpbXVtIHJlYXNvbmFibGUgbnVtYmVyIG9mIG1vZHVsZXMgdGhhdCBzaG91bGQgYmUKCSAgICAgKiAgb2JzZXJ2ZWQgaW4gYW55IHJlYWRpbmcgc3RhdGUsIGJhc2VkIG9uIHRoZSByZXN1bHRzIG9mIHRoZSBob3Jpem9udGFsIHNjYW4KCSAgICAgKiBAcGFyYW0gb3JpZ2luYWxTdGF0ZUNvdW50VG90YWwgVGhlIG9yaWdpbmFsIHN0YXRlIGNvdW50IHRvdGFsLgoJICAgICAqIEByZXR1cm4gdHJ1ZSBpZiBwcm9wb3J0aW9ucyBhcmUgd2l0aGluZyBleHBlY3RlZCBsaW1pdHMKCSAgICAgKi8KCSAgICBGaW5kZXJQYXR0ZXJuRmluZGVyLnByb3RvdHlwZS5jcm9zc0NoZWNrRGlhZ29uYWwgPSBmdW5jdGlvbiAoc3RhcnRJIC8qaW50Ki8sIGNlbnRlckogLyppbnQqLywgbWF4Q291bnQgLyppbnQqLywgb3JpZ2luYWxTdGF0ZUNvdW50VG90YWwgLyppbnQqLykgewoJICAgICAgICB2YXIgc3RhdGVDb3VudCA9IHRoaXMuZ2V0Q3Jvc3NDaGVja1N0YXRlQ291bnQoKTsKCSAgICAgICAgLy8gU3RhcnQgY291bnRpbmcgdXAsIGxlZnQgZnJvbSBjZW50ZXIgZmluZGluZyBibGFjayBjZW50ZXIgbWFzcwoJICAgICAgICB2YXIgaSA9IDA7CgkgICAgICAgIHZhciBpbWFnZSA9IHRoaXMuaW1hZ2U7CgkgICAgICAgIHdoaWxlIChzdGFydEkgPj0gaSAmJiBjZW50ZXJKID49IGkgJiYgaW1hZ2UuZ2V0KGNlbnRlckogLSBpLCBzdGFydEkgLSBpKSkgewoJICAgICAgICAgICAgc3RhdGVDb3VudFsyXSsrOwoJICAgICAgICAgICAgaSsrOwoJICAgICAgICB9CgkgICAgICAgIGlmIChzdGFydEkgPCBpIHx8IGNlbnRlckogPCBpKSB7CgkgICAgICAgICAgICByZXR1cm4gZmFsc2U7CgkgICAgICAgIH0KCSAgICAgICAgLy8gQ29udGludWUgdXAsIGxlZnQgZmluZGluZyB3aGl0ZSBzcGFjZQoJICAgICAgICB3aGlsZSAoc3RhcnRJID49IGkgJiYgY2VudGVySiA+PSBpICYmICFpbWFnZS5nZXQoY2VudGVySiAtIGksIHN0YXJ0SSAtIGkpICYmCgkgICAgICAgICAgICBzdGF0ZUNvdW50WzFdIDw9IG1heENvdW50KSB7CgkgICAgICAgICAgICBzdGF0ZUNvdW50WzFdKys7CgkgICAgICAgICAgICBpKys7CgkgICAgICAgIH0KCSAgICAgICAgLy8gSWYgYWxyZWFkeSB0b28gbWFueSBtb2R1bGVzIGluIHRoaXMgc3RhdGUgb3IgcmFuIG9mZiB0aGUgZWRnZToKCSAgICAgICAgaWYgKHN0YXJ0SSA8IGkgfHwgY2VudGVySiA8IGkgfHwgc3RhdGVDb3VudFsxXSA+IG1heENvdW50KSB7CgkgICAgICAgICAgICByZXR1cm4gZmFsc2U7CgkgICAgICAgIH0KCSAgICAgICAgLy8gQ29udGludWUgdXAsIGxlZnQgZmluZGluZyBibGFjayBib3JkZXIKCSAgICAgICAgd2hpbGUgKHN0YXJ0SSA+PSBpICYmIGNlbnRlckogPj0gaSAmJiBpbWFnZS5nZXQoY2VudGVySiAtIGksIHN0YXJ0SSAtIGkpICYmCgkgICAgICAgICAgICBzdGF0ZUNvdW50WzBdIDw9IG1heENvdW50KSB7CgkgICAgICAgICAgICBzdGF0ZUNvdW50WzBdKys7CgkgICAgICAgICAgICBpKys7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKHN0YXRlQ291bnRbMF0gPiBtYXhDb3VudCkgewoJICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwoJICAgICAgICB9CgkgICAgICAgIHZhciBtYXhJID0gaW1hZ2UuZ2V0SGVpZ2h0KCk7CgkgICAgICAgIHZhciBtYXhKID0gaW1hZ2UuZ2V0V2lkdGgoKTsKCSAgICAgICAgLy8gTm93IGFsc28gY291bnQgZG93biwgcmlnaHQgZnJvbSBjZW50ZXIKCSAgICAgICAgaSA9IDE7CgkgICAgICAgIHdoaWxlIChzdGFydEkgKyBpIDwgbWF4SSAmJiBjZW50ZXJKICsgaSA8IG1heEogJiYgaW1hZ2UuZ2V0KGNlbnRlckogKyBpLCBzdGFydEkgKyBpKSkgewoJICAgICAgICAgICAgc3RhdGVDb3VudFsyXSsrOwoJICAgICAgICAgICAgaSsrOwoJICAgICAgICB9CgkgICAgICAgIC8vIFJhbiBvZmYgdGhlIGVkZ2U/CgkgICAgICAgIGlmIChzdGFydEkgKyBpID49IG1heEkgfHwgY2VudGVySiArIGkgPj0gbWF4SikgewoJICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwoJICAgICAgICB9CgkgICAgICAgIHdoaWxlIChzdGFydEkgKyBpIDwgbWF4SSAmJiBjZW50ZXJKICsgaSA8IG1heEogJiYgIWltYWdlLmdldChjZW50ZXJKICsgaSwgc3RhcnRJICsgaSkgJiYKCSAgICAgICAgICAgIHN0YXRlQ291bnRbM10gPCBtYXhDb3VudCkgewoJICAgICAgICAgICAgc3RhdGVDb3VudFszXSsrOwoJICAgICAgICAgICAgaSsrOwoJICAgICAgICB9CgkgICAgICAgIGlmIChzdGFydEkgKyBpID49IG1heEkgfHwgY2VudGVySiArIGkgPj0gbWF4SiB8fCBzdGF0ZUNvdW50WzNdID49IG1heENvdW50KSB7CgkgICAgICAgICAgICByZXR1cm4gZmFsc2U7CgkgICAgICAgIH0KCSAgICAgICAgd2hpbGUgKHN0YXJ0SSArIGkgPCBtYXhJICYmIGNlbnRlckogKyBpIDwgbWF4SiAmJiBpbWFnZS5nZXQoY2VudGVySiArIGksIHN0YXJ0SSArIGkpICYmCgkgICAgICAgICAgICBzdGF0ZUNvdW50WzRdIDwgbWF4Q291bnQpIHsKCSAgICAgICAgICAgIHN0YXRlQ291bnRbNF0rKzsKCSAgICAgICAgICAgIGkrKzsKCSAgICAgICAgfQoJICAgICAgICBpZiAoc3RhdGVDb3VudFs0XSA+PSBtYXhDb3VudCkgewoJICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwoJICAgICAgICB9CgkgICAgICAgIC8vIElmIHdlIGZvdW5kIGEgZmluZGVyLXBhdHRlcm4tbGlrZSBzZWN0aW9uLCBidXQgaXRzIHNpemUgaXMgbW9yZSB0aGFuIDEwMCUgZGlmZmVyZW50IHRoYW4KCSAgICAgICAgLy8gdGhlIG9yaWdpbmFsLCBhc3N1bWUgaXQncyBhIGZhbHNlIHBvc2l0aXZlCgkgICAgICAgIHZhciBzdGF0ZUNvdW50VG90YWwgPSBzdGF0ZUNvdW50WzBdICsgc3RhdGVDb3VudFsxXSArIHN0YXRlQ291bnRbMl0gKyBzdGF0ZUNvdW50WzNdICsgc3RhdGVDb3VudFs0XTsKCSAgICAgICAgcmV0dXJuIE1hdGguYWJzKHN0YXRlQ291bnRUb3RhbCAtIG9yaWdpbmFsU3RhdGVDb3VudFRvdGFsKSA8IDIgKiBvcmlnaW5hbFN0YXRlQ291bnRUb3RhbCAmJgoJICAgICAgICAgICAgRmluZGVyUGF0dGVybkZpbmRlci5mb3VuZFBhdHRlcm5Dcm9zcyhzdGF0ZUNvdW50KTsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIDxwPkFmdGVyIGEgaG9yaXpvbnRhbCBzY2FuIGZpbmRzIGEgcG90ZW50aWFsIGZpbmRlciBwYXR0ZXJuLCB0aGlzIG1ldGhvZAoJICAgICAqICJjcm9zcy1jaGVja3MiIGJ5IHNjYW5uaW5nIGRvd24gdmVydGljYWxseSB0aHJvdWdoIHRoZSBjZW50ZXIgb2YgdGhlIHBvc3NpYmxlCgkgICAgICogZmluZGVyIHBhdHRlcm4gdG8gc2VlIGlmIHRoZSBzYW1lIHByb3BvcnRpb24gaXMgZGV0ZWN0ZWQuPC9wPgoJICAgICAqCgkgICAgICogQHBhcmFtIHN0YXJ0SSByb3cgd2hlcmUgYSBmaW5kZXIgcGF0dGVybiB3YXMgZGV0ZWN0ZWQKCSAgICAgKiBAcGFyYW0gY2VudGVySiBjZW50ZXIgb2YgdGhlIHNlY3Rpb24gdGhhdCBhcHBlYXJzIHRvIGNyb3NzIGEgZmluZGVyIHBhdHRlcm4KCSAgICAgKiBAcGFyYW0gbWF4Q291bnQgbWF4aW11bSByZWFzb25hYmxlIG51bWJlciBvZiBtb2R1bGVzIHRoYXQgc2hvdWxkIGJlCgkgICAgICogb2JzZXJ2ZWQgaW4gYW55IHJlYWRpbmcgc3RhdGUsIGJhc2VkIG9uIHRoZSByZXN1bHRzIG9mIHRoZSBob3Jpem9udGFsIHNjYW4KCSAgICAgKiBAcmV0dXJuIHZlcnRpY2FsIGNlbnRlciBvZiBmaW5kZXIgcGF0dGVybiwgb3Ige0BsaW5rIEZsb2F0I05hTn0gaWYgbm90IGZvdW5kCgkgICAgICovCgkgICAgRmluZGVyUGF0dGVybkZpbmRlci5wcm90b3R5cGUuY3Jvc3NDaGVja1ZlcnRpY2FsID0gZnVuY3Rpb24gKHN0YXJ0SSAvKmludCovLCBjZW50ZXJKIC8qaW50Ki8sIG1heENvdW50IC8qaW50Ki8sIG9yaWdpbmFsU3RhdGVDb3VudFRvdGFsIC8qaW50Ki8pIHsKCSAgICAgICAgdmFyIGltYWdlID0gdGhpcy5pbWFnZTsKCSAgICAgICAgdmFyIG1heEkgPSBpbWFnZS5nZXRIZWlnaHQoKTsKCSAgICAgICAgdmFyIHN0YXRlQ291bnQgPSB0aGlzLmdldENyb3NzQ2hlY2tTdGF0ZUNvdW50KCk7CgkgICAgICAgIC8vIFN0YXJ0IGNvdW50aW5nIHVwIGZyb20gY2VudGVyCgkgICAgICAgIHZhciBpID0gc3RhcnRJOwoJICAgICAgICB3aGlsZSAoaSA+PSAwICYmIGltYWdlLmdldChjZW50ZXJKLCBpKSkgewoJICAgICAgICAgICAgc3RhdGVDb3VudFsyXSsrOwoJICAgICAgICAgICAgaS0tOwoJICAgICAgICB9CgkgICAgICAgIGlmIChpIDwgMCkgewoJICAgICAgICAgICAgcmV0dXJuIE5hTjsKCSAgICAgICAgfQoJICAgICAgICB3aGlsZSAoaSA+PSAwICYmICFpbWFnZS5nZXQoY2VudGVySiwgaSkgJiYgc3RhdGVDb3VudFsxXSA8PSBtYXhDb3VudCkgewoJICAgICAgICAgICAgc3RhdGVDb3VudFsxXSsrOwoJICAgICAgICAgICAgaS0tOwoJICAgICAgICB9CgkgICAgICAgIC8vIElmIGFscmVhZHkgdG9vIG1hbnkgbW9kdWxlcyBpbiB0aGlzIHN0YXRlIG9yIHJhbiBvZmYgdGhlIGVkZ2U6CgkgICAgICAgIGlmIChpIDwgMCB8fCBzdGF0ZUNvdW50WzFdID4gbWF4Q291bnQpIHsKCSAgICAgICAgICAgIHJldHVybiBOYU47CgkgICAgICAgIH0KCSAgICAgICAgd2hpbGUgKGkgPj0gMCAmJiBpbWFnZS5nZXQoY2VudGVySiwgaSkgJiYgc3RhdGVDb3VudFswXSA8PSBtYXhDb3VudCkgewoJICAgICAgICAgICAgc3RhdGVDb3VudFswXSsrOwoJICAgICAgICAgICAgaS0tOwoJICAgICAgICB9CgkgICAgICAgIGlmIChzdGF0ZUNvdW50WzBdID4gbWF4Q291bnQpIHsKCSAgICAgICAgICAgIHJldHVybiBOYU47CgkgICAgICAgIH0KCSAgICAgICAgLy8gTm93IGFsc28gY291bnQgZG93biBmcm9tIGNlbnRlcgoJICAgICAgICBpID0gc3RhcnRJICsgMTsKCSAgICAgICAgd2hpbGUgKGkgPCBtYXhJICYmIGltYWdlLmdldChjZW50ZXJKLCBpKSkgewoJICAgICAgICAgICAgc3RhdGVDb3VudFsyXSsrOwoJICAgICAgICAgICAgaSsrOwoJICAgICAgICB9CgkgICAgICAgIGlmIChpID09PSBtYXhJKSB7CgkgICAgICAgICAgICByZXR1cm4gTmFOOwoJICAgICAgICB9CgkgICAgICAgIHdoaWxlIChpIDwgbWF4SSAmJiAhaW1hZ2UuZ2V0KGNlbnRlckosIGkpICYmIHN0YXRlQ291bnRbM10gPCBtYXhDb3VudCkgewoJICAgICAgICAgICAgc3RhdGVDb3VudFszXSsrOwoJICAgICAgICAgICAgaSsrOwoJICAgICAgICB9CgkgICAgICAgIGlmIChpID09PSBtYXhJIHx8IHN0YXRlQ291bnRbM10gPj0gbWF4Q291bnQpIHsKCSAgICAgICAgICAgIHJldHVybiBOYU47CgkgICAgICAgIH0KCSAgICAgICAgd2hpbGUgKGkgPCBtYXhJICYmIGltYWdlLmdldChjZW50ZXJKLCBpKSAmJiBzdGF0ZUNvdW50WzRdIDwgbWF4Q291bnQpIHsKCSAgICAgICAgICAgIHN0YXRlQ291bnRbNF0rKzsKCSAgICAgICAgICAgIGkrKzsKCSAgICAgICAgfQoJICAgICAgICBpZiAoc3RhdGVDb3VudFs0XSA+PSBtYXhDb3VudCkgewoJICAgICAgICAgICAgcmV0dXJuIE5hTjsKCSAgICAgICAgfQoJICAgICAgICAvLyBJZiB3ZSBmb3VuZCBhIGZpbmRlci1wYXR0ZXJuLWxpa2Ugc2VjdGlvbiwgYnV0IGl0cyBzaXplIGlzIG1vcmUgdGhhbiA0MCUgZGlmZmVyZW50IHRoYW4KCSAgICAgICAgLy8gdGhlIG9yaWdpbmFsLCBhc3N1bWUgaXQncyBhIGZhbHNlIHBvc2l0aXZlCgkgICAgICAgIHZhciBzdGF0ZUNvdW50VG90YWwgPSBzdGF0ZUNvdW50WzBdICsgc3RhdGVDb3VudFsxXSArIHN0YXRlQ291bnRbMl0gKyBzdGF0ZUNvdW50WzNdICsKCSAgICAgICAgICAgIHN0YXRlQ291bnRbNF07CgkgICAgICAgIGlmICg1ICogTWF0aC5hYnMoc3RhdGVDb3VudFRvdGFsIC0gb3JpZ2luYWxTdGF0ZUNvdW50VG90YWwpID49IDIgKiBvcmlnaW5hbFN0YXRlQ291bnRUb3RhbCkgewoJICAgICAgICAgICAgcmV0dXJuIE5hTjsKCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gRmluZGVyUGF0dGVybkZpbmRlci5mb3VuZFBhdHRlcm5Dcm9zcyhzdGF0ZUNvdW50KSA/IEZpbmRlclBhdHRlcm5GaW5kZXIuY2VudGVyRnJvbUVuZChzdGF0ZUNvdW50LCBpKSA6IE5hTjsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIDxwPkxpa2Uge0BsaW5rICNjcm9zc0NoZWNrVmVydGljYWwoaW50LCBpbnQsIGludCwgaW50KX0sIGFuZCBpbiBmYWN0IGlzIGJhc2ljYWxseSBpZGVudGljYWwsCgkgICAgICogZXhjZXB0IGl0IHJlYWRzIGhvcml6b250YWxseSBpbnN0ZWFkIG9mIHZlcnRpY2FsbHkuIFRoaXMgaXMgdXNlZCB0byBjcm9zcy1jcm9zcwoJICAgICAqIGNoZWNrIGEgdmVydGljYWwgY3Jvc3MgY2hlY2sgYW5kIGxvY2F0ZSB0aGUgcmVhbCBjZW50ZXIgb2YgdGhlIGFsaWdubWVudCBwYXR0ZXJuLjwvcD4KCSAgICAgKi8KCSAgICBGaW5kZXJQYXR0ZXJuRmluZGVyLnByb3RvdHlwZS5jcm9zc0NoZWNrSG9yaXpvbnRhbCA9IGZ1bmN0aW9uIChzdGFydEogLyppbnQqLywgY2VudGVySSAvKmludCovLCBtYXhDb3VudCAvKmludCovLCBvcmlnaW5hbFN0YXRlQ291bnRUb3RhbCAvKmludCovKSB7CgkgICAgICAgIHZhciBpbWFnZSA9IHRoaXMuaW1hZ2U7CgkgICAgICAgIHZhciBtYXhKID0gaW1hZ2UuZ2V0V2lkdGgoKTsKCSAgICAgICAgdmFyIHN0YXRlQ291bnQgPSB0aGlzLmdldENyb3NzQ2hlY2tTdGF0ZUNvdW50KCk7CgkgICAgICAgIHZhciBqID0gc3RhcnRKOwoJICAgICAgICB3aGlsZSAoaiA+PSAwICYmIGltYWdlLmdldChqLCBjZW50ZXJJKSkgewoJICAgICAgICAgICAgc3RhdGVDb3VudFsyXSsrOwoJICAgICAgICAgICAgai0tOwoJICAgICAgICB9CgkgICAgICAgIGlmIChqIDwgMCkgewoJICAgICAgICAgICAgcmV0dXJuIE5hTjsKCSAgICAgICAgfQoJICAgICAgICB3aGlsZSAoaiA+PSAwICYmICFpbWFnZS5nZXQoaiwgY2VudGVySSkgJiYgc3RhdGVDb3VudFsxXSA8PSBtYXhDb3VudCkgewoJICAgICAgICAgICAgc3RhdGVDb3VudFsxXSsrOwoJICAgICAgICAgICAgai0tOwoJICAgICAgICB9CgkgICAgICAgIGlmIChqIDwgMCB8fCBzdGF0ZUNvdW50WzFdID4gbWF4Q291bnQpIHsKCSAgICAgICAgICAgIHJldHVybiBOYU47CgkgICAgICAgIH0KCSAgICAgICAgd2hpbGUgKGogPj0gMCAmJiBpbWFnZS5nZXQoaiwgY2VudGVySSkgJiYgc3RhdGVDb3VudFswXSA8PSBtYXhDb3VudCkgewoJICAgICAgICAgICAgc3RhdGVDb3VudFswXSsrOwoJICAgICAgICAgICAgai0tOwoJICAgICAgICB9CgkgICAgICAgIGlmIChzdGF0ZUNvdW50WzBdID4gbWF4Q291bnQpIHsKCSAgICAgICAgICAgIHJldHVybiBOYU47CgkgICAgICAgIH0KCSAgICAgICAgaiA9IHN0YXJ0SiArIDE7CgkgICAgICAgIHdoaWxlIChqIDwgbWF4SiAmJiBpbWFnZS5nZXQoaiwgY2VudGVySSkpIHsKCSAgICAgICAgICAgIHN0YXRlQ291bnRbMl0rKzsKCSAgICAgICAgICAgIGorKzsKCSAgICAgICAgfQoJICAgICAgICBpZiAoaiA9PT0gbWF4SikgewoJICAgICAgICAgICAgcmV0dXJuIE5hTjsKCSAgICAgICAgfQoJICAgICAgICB3aGlsZSAoaiA8IG1heEogJiYgIWltYWdlLmdldChqLCBjZW50ZXJJKSAmJiBzdGF0ZUNvdW50WzNdIDwgbWF4Q291bnQpIHsKCSAgICAgICAgICAgIHN0YXRlQ291bnRbM10rKzsKCSAgICAgICAgICAgIGorKzsKCSAgICAgICAgfQoJICAgICAgICBpZiAoaiA9PT0gbWF4SiB8fCBzdGF0ZUNvdW50WzNdID49IG1heENvdW50KSB7CgkgICAgICAgICAgICByZXR1cm4gTmFOOwoJICAgICAgICB9CgkgICAgICAgIHdoaWxlIChqIDwgbWF4SiAmJiBpbWFnZS5nZXQoaiwgY2VudGVySSkgJiYgc3RhdGVDb3VudFs0XSA8IG1heENvdW50KSB7CgkgICAgICAgICAgICBzdGF0ZUNvdW50WzRdKys7CgkgICAgICAgICAgICBqKys7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKHN0YXRlQ291bnRbNF0gPj0gbWF4Q291bnQpIHsKCSAgICAgICAgICAgIHJldHVybiBOYU47CgkgICAgICAgIH0KCSAgICAgICAgLy8gSWYgd2UgZm91bmQgYSBmaW5kZXItcGF0dGVybi1saWtlIHNlY3Rpb24sIGJ1dCBpdHMgc2l6ZSBpcyBzaWduaWZpY2FudGx5IGRpZmZlcmVudCB0aGFuCgkgICAgICAgIC8vIHRoZSBvcmlnaW5hbCwgYXNzdW1lIGl0J3MgYSBmYWxzZSBwb3NpdGl2ZQoJICAgICAgICB2YXIgc3RhdGVDb3VudFRvdGFsID0gc3RhdGVDb3VudFswXSArIHN0YXRlQ291bnRbMV0gKyBzdGF0ZUNvdW50WzJdICsgc3RhdGVDb3VudFszXSArCgkgICAgICAgICAgICBzdGF0ZUNvdW50WzRdOwoJICAgICAgICBpZiAoNSAqIE1hdGguYWJzKHN0YXRlQ291bnRUb3RhbCAtIG9yaWdpbmFsU3RhdGVDb3VudFRvdGFsKSA+PSBvcmlnaW5hbFN0YXRlQ291bnRUb3RhbCkgewoJICAgICAgICAgICAgcmV0dXJuIE5hTjsKCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gRmluZGVyUGF0dGVybkZpbmRlci5mb3VuZFBhdHRlcm5Dcm9zcyhzdGF0ZUNvdW50KSA/IEZpbmRlclBhdHRlcm5GaW5kZXIuY2VudGVyRnJvbUVuZChzdGF0ZUNvdW50LCBqKSA6IE5hTjsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIDxwPlRoaXMgaXMgY2FsbGVkIHdoZW4gYSBob3Jpem9udGFsIHNjYW4gZmluZHMgYSBwb3NzaWJsZSBhbGlnbm1lbnQgcGF0dGVybi4gSXQgd2lsbAoJICAgICAqIGNyb3NzIGNoZWNrIHdpdGggYSB2ZXJ0aWNhbCBzY2FuLCBhbmQgaWYgc3VjY2Vzc2Z1bCwgd2lsbCwgYWgsIGNyb3NzLWNyb3NzLWNoZWNrCgkgICAgICogd2l0aCBhbm90aGVyIGhvcml6b250YWwgc2Nhbi4gVGhpcyBpcyBuZWVkZWQgcHJpbWFyaWx5IHRvIGxvY2F0ZSB0aGUgcmVhbCBob3Jpem9udGFsCgkgICAgICogY2VudGVyIG9mIHRoZSBwYXR0ZXJuIGluIGNhc2VzIG9mIGV4dHJlbWUgc2tldy4KCSAgICAgKiBBbmQgdGhlbiB3ZSBjcm9zcy1jcm9zcy1jcm9zcyBjaGVjayB3aXRoIGFub3RoZXIgZGlhZ29uYWwgc2Nhbi48L3A+CgkgICAgICoKCSAgICAgKiA8cD5JZiB0aGF0IHN1Y2NlZWRzIHRoZSBmaW5kZXIgcGF0dGVybiBsb2NhdGlvbiBpcyBhZGRlZCB0byBhIGxpc3QgdGhhdCB0cmFja3MKCSAgICAgKiB0aGUgbnVtYmVyIG9mIHRpbWVzIGVhY2ggbG9jYXRpb24gaGFzIGJlZW4gbmVhcmx5LW1hdGNoZWQgYXMgYSBmaW5kZXIgcGF0dGVybi4KCSAgICAgKiBFYWNoIGFkZGl0aW9uYWwgZmluZCBpcyBtb3JlIGV2aWRlbmNlIHRoYXQgdGhlIGxvY2F0aW9uIGlzIGluIGZhY3QgYSBmaW5kZXIKCSAgICAgKiBwYXR0ZXJuIGNlbnRlcgoJICAgICAqCgkgICAgICogQHBhcmFtIHN0YXRlQ291bnQgcmVhZGluZyBzdGF0ZSBtb2R1bGUgY291bnRzIGZyb20gaG9yaXpvbnRhbCBzY2FuCgkgICAgICogQHBhcmFtIGkgcm93IHdoZXJlIGZpbmRlciBwYXR0ZXJuIG1heSBiZSBmb3VuZAoJICAgICAqIEBwYXJhbSBqIGVuZCBvZiBwb3NzaWJsZSBmaW5kZXIgcGF0dGVybiBpbiByb3cKCSAgICAgKiBAcGFyYW0gcHVyZUJhcmNvZGUgdHJ1ZSBpZiBpbiAicHVyZSBiYXJjb2RlIiBtb2RlCgkgICAgICogQHJldHVybiB0cnVlIGlmIGEgZmluZGVyIHBhdHRlcm4gY2FuZGlkYXRlIHdhcyBmb3VuZCB0aGlzIHRpbWUKCSAgICAgKi8KCSAgICBGaW5kZXJQYXR0ZXJuRmluZGVyLnByb3RvdHlwZS5oYW5kbGVQb3NzaWJsZUNlbnRlciA9IGZ1bmN0aW9uIChzdGF0ZUNvdW50LCBpIC8qaW50Ki8sIGogLyppbnQqLywgcHVyZUJhcmNvZGUpIHsKCSAgICAgICAgdmFyIHN0YXRlQ291bnRUb3RhbCA9IHN0YXRlQ291bnRbMF0gKyBzdGF0ZUNvdW50WzFdICsgc3RhdGVDb3VudFsyXSArIHN0YXRlQ291bnRbM10gKwoJICAgICAgICAgICAgc3RhdGVDb3VudFs0XTsKCSAgICAgICAgdmFyIGNlbnRlckogPSBGaW5kZXJQYXR0ZXJuRmluZGVyLmNlbnRlckZyb21FbmQoc3RhdGVDb3VudCwgaik7CgkgICAgICAgIHZhciBjZW50ZXJJID0gdGhpcy5jcm9zc0NoZWNrVmVydGljYWwoaSwgLyooaW50KSAqLyBNYXRoLmZsb29yKGNlbnRlckopLCBzdGF0ZUNvdW50WzJdLCBzdGF0ZUNvdW50VG90YWwpOwoJICAgICAgICBpZiAoIWlzTmFOKGNlbnRlckkpKSB7CgkgICAgICAgICAgICAvLyBSZS1jcm9zcyBjaGVjawoJICAgICAgICAgICAgY2VudGVySiA9IHRoaXMuY3Jvc3NDaGVja0hvcml6b250YWwoLyooaW50KSAqLyBNYXRoLmZsb29yKGNlbnRlckopLCAvKihpbnQpICovIE1hdGguZmxvb3IoY2VudGVySSksIHN0YXRlQ291bnRbMl0sIHN0YXRlQ291bnRUb3RhbCk7CgkgICAgICAgICAgICBpZiAoIWlzTmFOKGNlbnRlckopICYmCgkgICAgICAgICAgICAgICAgKCFwdXJlQmFyY29kZSB8fCB0aGlzLmNyb3NzQ2hlY2tEaWFnb25hbCgvKihpbnQpICovIE1hdGguZmxvb3IoY2VudGVySSksIC8qKGludCkgKi8gTWF0aC5mbG9vcihjZW50ZXJKKSwgc3RhdGVDb3VudFsyXSwgc3RhdGVDb3VudFRvdGFsKSkpIHsKCSAgICAgICAgICAgICAgICB2YXIgZXN0aW1hdGVkTW9kdWxlU2l6ZSA9IHN0YXRlQ291bnRUb3RhbCAvIDcuMDsKCSAgICAgICAgICAgICAgICB2YXIgZm91bmQgPSBmYWxzZTsKCSAgICAgICAgICAgICAgICB2YXIgcG9zc2libGVDZW50ZXJzID0gdGhpcy5wb3NzaWJsZUNlbnRlcnM7CgkgICAgICAgICAgICAgICAgZm9yICh2YXIgaW5kZXggPSAwLCBsZW5ndGhfMSA9IHBvc3NpYmxlQ2VudGVycy5sZW5ndGg7IGluZGV4IDwgbGVuZ3RoXzE7IGluZGV4KyspIHsKCSAgICAgICAgICAgICAgICAgICAgdmFyIGNlbnRlciA9IHBvc3NpYmxlQ2VudGVyc1tpbmRleF07CgkgICAgICAgICAgICAgICAgICAgIC8vIExvb2sgZm9yIGFib3V0IHRoZSBzYW1lIGNlbnRlciBhbmQgbW9kdWxlIHNpemU6CgkgICAgICAgICAgICAgICAgICAgIGlmIChjZW50ZXIuYWJvdXRFcXVhbHMoZXN0aW1hdGVkTW9kdWxlU2l6ZSwgY2VudGVySSwgY2VudGVySikpIHsKCSAgICAgICAgICAgICAgICAgICAgICAgIHBvc3NpYmxlQ2VudGVyc1tpbmRleF0gPSBjZW50ZXIuY29tYmluZUVzdGltYXRlKGNlbnRlckksIGNlbnRlckosIGVzdGltYXRlZE1vZHVsZVNpemUpOwoJICAgICAgICAgICAgICAgICAgICAgICAgZm91bmQgPSB0cnVlOwoJICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CgkgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgaWYgKCFmb3VuZCkgewoJICAgICAgICAgICAgICAgICAgICB2YXIgcG9pbnQgPSBuZXcgRmluZGVyUGF0dGVybl8xLmRlZmF1bHQoY2VudGVySiwgY2VudGVySSwgZXN0aW1hdGVkTW9kdWxlU2l6ZSk7CgkgICAgICAgICAgICAgICAgICAgIHBvc3NpYmxlQ2VudGVycy5wdXNoKHBvaW50KTsKCSAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMucmVzdWx0UG9pbnRDYWxsYmFjayAhPT0gbnVsbCAmJiB0aGlzLnJlc3VsdFBvaW50Q2FsbGJhY2sgIT09IHVuZGVmaW5lZCkgewoJICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5yZXN1bHRQb2ludENhbGxiYWNrLmZvdW5kUG9zc2libGVSZXN1bHRQb2ludChwb2ludCk7CgkgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIGZhbHNlOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQHJldHVybiBudW1iZXIgb2Ygcm93cyB3ZSBjb3VsZCBzYWZlbHkgc2tpcCBkdXJpbmcgc2Nhbm5pbmcsIGJhc2VkIG9uIHRoZSBmaXJzdAoJICAgICAqICAgICAgICAgdHdvIGZpbmRlciBwYXR0ZXJucyB0aGF0IGhhdmUgYmVlbiBsb2NhdGVkLiBJbiBzb21lIGNhc2VzIHRoZWlyIHBvc2l0aW9uIHdpbGwKCSAgICAgKiAgICAgICAgIGFsbG93IHVzIHRvIGluZmVyIHRoYXQgdGhlIHRoaXJkIHBhdHRlcm4gbXVzdCBsaWUgYmVsb3cgYSBjZXJ0YWluIHBvaW50IGZhcnRoZXIKCSAgICAgKiAgICAgICAgIGRvd24gaW4gdGhlIGltYWdlLgoJICAgICAqLwoJICAgIEZpbmRlclBhdHRlcm5GaW5kZXIucHJvdG90eXBlLmZpbmRSb3dTa2lwID0gZnVuY3Rpb24gKCkgewoJICAgICAgICB2YXIgZV8xLCBfYTsKCSAgICAgICAgdmFyIG1heCA9IHRoaXMucG9zc2libGVDZW50ZXJzLmxlbmd0aDsKCSAgICAgICAgaWYgKG1heCA8PSAxKSB7CgkgICAgICAgICAgICByZXR1cm4gMDsKCSAgICAgICAgfQoJICAgICAgICB2YXIgZmlyc3RDb25maXJtZWRDZW50ZXIgPSBudWxsOwoJICAgICAgICB0cnkgewoJICAgICAgICAgICAgZm9yICh2YXIgX2IgPSBfX3ZhbHVlcyh0aGlzLnBvc3NpYmxlQ2VudGVycyksIF9jID0gX2IubmV4dCgpOyAhX2MuZG9uZTsgX2MgPSBfYi5uZXh0KCkpIHsKCSAgICAgICAgICAgICAgICB2YXIgY2VudGVyID0gX2MudmFsdWU7CgkgICAgICAgICAgICAgICAgaWYgKGNlbnRlci5nZXRDb3VudCgpID49IEZpbmRlclBhdHRlcm5GaW5kZXIuQ0VOVEVSX1FVT1JVTSkgewoJICAgICAgICAgICAgICAgICAgICBpZiAoZmlyc3RDb25maXJtZWRDZW50ZXIgPT0gbnVsbCkgewoJICAgICAgICAgICAgICAgICAgICAgICAgZmlyc3RDb25maXJtZWRDZW50ZXIgPSBjZW50ZXI7CgkgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICAgICAgZWxzZSB7CgkgICAgICAgICAgICAgICAgICAgICAgICAvLyBXZSBoYXZlIHR3byBjb25maXJtZWQgY2VudGVycwoJICAgICAgICAgICAgICAgICAgICAgICAgLy8gSG93IGZhciBkb3duIGNhbiB3ZSBza2lwIGJlZm9yZSByZXN1bWluZyBsb29raW5nIGZvciB0aGUgbmV4dAoJICAgICAgICAgICAgICAgICAgICAgICAgLy8gcGF0dGVybj8gSW4gdGhlIHdvcnN0IGNhc2UsIG9ubHkgdGhlIGRpZmZlcmVuY2UgYmV0d2VlbiB0aGUKCSAgICAgICAgICAgICAgICAgICAgICAgIC8vIGRpZmZlcmVuY2UgaW4gdGhlIHggLyB5IGNvb3JkaW5hdGVzIG9mIHRoZSB0d28gY2VudGVycy4KCSAgICAgICAgICAgICAgICAgICAgICAgIC8vIFRoaXMgaXMgdGhlIGNhc2Ugd2hlcmUgeW91IGZpbmQgdG9wIGxlZnQgbGFzdC4KCSAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuaGFzU2tpcHBlZCA9IHRydWU7CgkgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gLyooaW50KSAqLyBNYXRoLmZsb29yKChNYXRoLmFicyhmaXJzdENvbmZpcm1lZENlbnRlci5nZXRYKCkgLSBjZW50ZXIuZ2V0WCgpKSAtCgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgTWF0aC5hYnMoZmlyc3RDb25maXJtZWRDZW50ZXIuZ2V0WSgpIC0gY2VudGVyLmdldFkoKSkpIC8gMik7CgkgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICAgICAgY2F0Y2ggKGVfMV8xKSB7IGVfMSA9IHsgZXJyb3I6IGVfMV8xIH07IH0KCSAgICAgICAgZmluYWxseSB7CgkgICAgICAgICAgICB0cnkgewoJICAgICAgICAgICAgICAgIGlmIChfYyAmJiAhX2MuZG9uZSAmJiAoX2EgPSBfYi5yZXR1cm4pKSBfYS5jYWxsKF9iKTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIGZpbmFsbHkgeyBpZiAoZV8xKSB0aHJvdyBlXzEuZXJyb3I7IH0KCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gMDsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEByZXR1cm4gdHJ1ZSBpZmYgd2UgaGF2ZSBmb3VuZCBhdCBsZWFzdCAzIGZpbmRlciBwYXR0ZXJucyB0aGF0IGhhdmUgYmVlbiBkZXRlY3RlZAoJICAgICAqICAgICAgICAgYXQgbGVhc3Qge0BsaW5rICNDRU5URVJfUVVPUlVNfSB0aW1lcyBlYWNoLCBhbmQsIHRoZSBlc3RpbWF0ZWQgbW9kdWxlIHNpemUgb2YgdGhlCgkgICAgICogICAgICAgICBjYW5kaWRhdGVzIGlzICJwcmV0dHkgc2ltaWxhciIKCSAgICAgKi8KCSAgICBGaW5kZXJQYXR0ZXJuRmluZGVyLnByb3RvdHlwZS5oYXZlTXVsdGlwbHlDb25maXJtZWRDZW50ZXJzID0gZnVuY3Rpb24gKCkgewoJICAgICAgICB2YXIgZV8yLCBfYSwgZV8zLCBfYjsKCSAgICAgICAgdmFyIGNvbmZpcm1lZENvdW50ID0gMDsKCSAgICAgICAgdmFyIHRvdGFsTW9kdWxlU2l6ZSA9IDAuMDsKCSAgICAgICAgdmFyIG1heCA9IHRoaXMucG9zc2libGVDZW50ZXJzLmxlbmd0aDsKCSAgICAgICAgdHJ5IHsKCSAgICAgICAgICAgIGZvciAodmFyIF9jID0gX192YWx1ZXModGhpcy5wb3NzaWJsZUNlbnRlcnMpLCBfZCA9IF9jLm5leHQoKTsgIV9kLmRvbmU7IF9kID0gX2MubmV4dCgpKSB7CgkgICAgICAgICAgICAgICAgdmFyIHBhdHRlcm4gPSBfZC52YWx1ZTsKCSAgICAgICAgICAgICAgICBpZiAocGF0dGVybi5nZXRDb3VudCgpID49IEZpbmRlclBhdHRlcm5GaW5kZXIuQ0VOVEVSX1FVT1JVTSkgewoJICAgICAgICAgICAgICAgICAgICBjb25maXJtZWRDb3VudCsrOwoJICAgICAgICAgICAgICAgICAgICB0b3RhbE1vZHVsZVNpemUgKz0gcGF0dGVybi5nZXRFc3RpbWF0ZWRNb2R1bGVTaXplKCk7CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIGNhdGNoIChlXzJfMSkgeyBlXzIgPSB7IGVycm9yOiBlXzJfMSB9OyB9CgkgICAgICAgIGZpbmFsbHkgewoJICAgICAgICAgICAgdHJ5IHsKCSAgICAgICAgICAgICAgICBpZiAoX2QgJiYgIV9kLmRvbmUgJiYgKF9hID0gX2MucmV0dXJuKSkgX2EuY2FsbChfYyk7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBmaW5hbGx5IHsgaWYgKGVfMikgdGhyb3cgZV8yLmVycm9yOyB9CgkgICAgICAgIH0KCSAgICAgICAgaWYgKGNvbmZpcm1lZENvdW50IDwgMykgewoJICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwoJICAgICAgICB9CgkgICAgICAgIC8vIE9LLCB3ZSBoYXZlIGF0IGxlYXN0IDMgY29uZmlybWVkIGNlbnRlcnMsIGJ1dCwgaXQncyBwb3NzaWJsZSB0aGF0IG9uZSBpcyBhICJmYWxzZSBwb3NpdGl2ZSIKCSAgICAgICAgLy8gYW5kIHRoYXQgd2UgbmVlZCB0byBrZWVwIGxvb2tpbmcuIFdlIGRldGVjdCB0aGlzIGJ5IGFza2luZyBpZiB0aGUgZXN0aW1hdGVkIG1vZHVsZSBzaXplcwoJICAgICAgICAvLyB2YXJ5IHRvbyBtdWNoLiBXZSBhcmJpdHJhcmlseSBzYXkgdGhhdCB3aGVuIHRoZSB0b3RhbCBkZXZpYXRpb24gZnJvbSBhdmVyYWdlIGV4Y2VlZHMKCSAgICAgICAgLy8gNSUgb2YgdGhlIHRvdGFsIG1vZHVsZSBzaXplIGVzdGltYXRlcywgaXQncyB0b28gbXVjaC4KCSAgICAgICAgdmFyIGF2ZXJhZ2UgPSB0b3RhbE1vZHVsZVNpemUgLyBtYXg7CgkgICAgICAgIHZhciB0b3RhbERldmlhdGlvbiA9IDAuMDsKCSAgICAgICAgdHJ5IHsKCSAgICAgICAgICAgIGZvciAodmFyIF9lID0gX192YWx1ZXModGhpcy5wb3NzaWJsZUNlbnRlcnMpLCBfZiA9IF9lLm5leHQoKTsgIV9mLmRvbmU7IF9mID0gX2UubmV4dCgpKSB7CgkgICAgICAgICAgICAgICAgdmFyIHBhdHRlcm4gPSBfZi52YWx1ZTsKCSAgICAgICAgICAgICAgICB0b3RhbERldmlhdGlvbiArPSBNYXRoLmFicyhwYXR0ZXJuLmdldEVzdGltYXRlZE1vZHVsZVNpemUoKSAtIGF2ZXJhZ2UpOwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIGNhdGNoIChlXzNfMSkgeyBlXzMgPSB7IGVycm9yOiBlXzNfMSB9OyB9CgkgICAgICAgIGZpbmFsbHkgewoJICAgICAgICAgICAgdHJ5IHsKCSAgICAgICAgICAgICAgICBpZiAoX2YgJiYgIV9mLmRvbmUgJiYgKF9iID0gX2UucmV0dXJuKSkgX2IuY2FsbChfZSk7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBmaW5hbGx5IHsgaWYgKGVfMykgdGhyb3cgZV8zLmVycm9yOyB9CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIHRvdGFsRGV2aWF0aW9uIDw9IDAuMDUgKiB0b3RhbE1vZHVsZVNpemU7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcmV0dXJuIHRoZSAzIGJlc3Qge0BsaW5rIEZpbmRlclBhdHRlcm59cyBmcm9tIG91ciBsaXN0IG9mIGNhbmRpZGF0ZXMuIFRoZSAiYmVzdCIgYXJlCgkgICAgICogICAgICAgICB0aG9zZSB0aGF0IGhhdmUgYmVlbiBkZXRlY3RlZCBhdCBsZWFzdCB7QGxpbmsgI0NFTlRFUl9RVU9SVU19IHRpbWVzLCBhbmQgd2hvc2UgbW9kdWxlCgkgICAgICogICAgICAgICBzaXplIGRpZmZlcnMgZnJvbSB0aGUgYXZlcmFnZSBhbW9uZyB0aG9zZSBwYXR0ZXJucyB0aGUgbGVhc3QKCSAgICAgKiBAdGhyb3dzIE5vdEZvdW5kRXhjZXB0aW9uIGlmIDMgc3VjaCBmaW5kZXIgcGF0dGVybnMgZG8gbm90IGV4aXN0CgkgICAgICovCgkgICAgRmluZGVyUGF0dGVybkZpbmRlci5wcm90b3R5cGUuc2VsZWN0QmVzdFBhdHRlcm5zID0gZnVuY3Rpb24gKCkgewoJICAgICAgICB2YXIgZV80LCBfYSwgZV81LCBfYjsKCSAgICAgICAgdmFyIHN0YXJ0U2l6ZSA9IHRoaXMucG9zc2libGVDZW50ZXJzLmxlbmd0aDsKCSAgICAgICAgaWYgKHN0YXJ0U2l6ZSA8IDMpIHsKCSAgICAgICAgICAgIC8vIENvdWxkbid0IGZpbmQgZW5vdWdoIGZpbmRlciBwYXR0ZXJucwoJICAgICAgICAgICAgdGhyb3cgbmV3IE5vdEZvdW5kRXhjZXB0aW9uXzEkMi5kZWZhdWx0KCk7CgkgICAgICAgIH0KCSAgICAgICAgdmFyIHBvc3NpYmxlQ2VudGVycyA9IHRoaXMucG9zc2libGVDZW50ZXJzOwoJICAgICAgICB2YXIgYXZlcmFnZTsKCSAgICAgICAgLy8gRmlsdGVyIG91dGxpZXIgcG9zc2liaWxpdGllcyB3aG9zZSBtb2R1bGUgc2l6ZSBpcyB0b28gZGlmZmVyZW50CgkgICAgICAgIGlmIChzdGFydFNpemUgPiAzKSB7CgkgICAgICAgICAgICAvLyBCdXQgd2UgY2FuIG9ubHkgYWZmb3JkIHRvIGRvIHNvIGlmIHdlIGhhdmUgYXQgbGVhc3QgNCBwb3NzaWJpbGl0aWVzIHRvIGNob29zZSBmcm9tCgkgICAgICAgICAgICB2YXIgdG90YWxNb2R1bGVTaXplID0gMC4wOwoJICAgICAgICAgICAgdmFyIHNxdWFyZSA9IDAuMDsKCSAgICAgICAgICAgIHRyeSB7CgkgICAgICAgICAgICAgICAgZm9yICh2YXIgX2MgPSBfX3ZhbHVlcyh0aGlzLnBvc3NpYmxlQ2VudGVycyksIF9kID0gX2MubmV4dCgpOyAhX2QuZG9uZTsgX2QgPSBfYy5uZXh0KCkpIHsKCSAgICAgICAgICAgICAgICAgICAgdmFyIGNlbnRlciA9IF9kLnZhbHVlOwoJICAgICAgICAgICAgICAgICAgICB2YXIgc2l6ZSA9IGNlbnRlci5nZXRFc3RpbWF0ZWRNb2R1bGVTaXplKCk7CgkgICAgICAgICAgICAgICAgICAgIHRvdGFsTW9kdWxlU2l6ZSArPSBzaXplOwoJICAgICAgICAgICAgICAgICAgICBzcXVhcmUgKz0gc2l6ZSAqIHNpemU7CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgY2F0Y2ggKGVfNF8xKSB7IGVfNCA9IHsgZXJyb3I6IGVfNF8xIH07IH0KCSAgICAgICAgICAgIGZpbmFsbHkgewoJICAgICAgICAgICAgICAgIHRyeSB7CgkgICAgICAgICAgICAgICAgICAgIGlmIChfZCAmJiAhX2QuZG9uZSAmJiAoX2EgPSBfYy5yZXR1cm4pKSBfYS5jYWxsKF9jKTsKCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgZmluYWxseSB7IGlmIChlXzQpIHRocm93IGVfNC5lcnJvcjsgfQoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgYXZlcmFnZSA9IHRvdGFsTW9kdWxlU2l6ZSAvIHN0YXJ0U2l6ZTsKCSAgICAgICAgICAgIHZhciBzdGREZXYgPSBNYXRoLnNxcnQoc3F1YXJlIC8gc3RhcnRTaXplIC0gYXZlcmFnZSAqIGF2ZXJhZ2UpOwoJICAgICAgICAgICAgcG9zc2libGVDZW50ZXJzLnNvcnQoCgkgICAgICAgICAgICAvKioKCSAgICAgICAgICAgICAqIDxwPk9yZGVycyBieSBmdXJ0aGVzdCBmcm9tIGF2ZXJhZ2U8L3A+CgkgICAgICAgICAgICAgKi8KCSAgICAgICAgICAgIC8vIEZ1cnRoZXN0RnJvbUF2ZXJhZ2VDb21wYXJhdG9yIGltcGxlbWVudHMgQ29tcGFyYXRvcjxGaW5kZXJQYXR0ZXJuPgoJICAgICAgICAgICAgZnVuY3Rpb24gKGNlbnRlcjEsIGNlbnRlcjIpIHsKCSAgICAgICAgICAgICAgICB2YXIgZEEgPSBNYXRoLmFicyhjZW50ZXIyLmdldEVzdGltYXRlZE1vZHVsZVNpemUoKSAtIGF2ZXJhZ2UpOwoJICAgICAgICAgICAgICAgIHZhciBkQiA9IE1hdGguYWJzKGNlbnRlcjEuZ2V0RXN0aW1hdGVkTW9kdWxlU2l6ZSgpIC0gYXZlcmFnZSk7CgkgICAgICAgICAgICAgICAgcmV0dXJuIGRBIDwgZEIgPyAtMSA6IGRBID4gZEIgPyAxIDogMDsKCSAgICAgICAgICAgIH0pOwoJICAgICAgICAgICAgdmFyIGxpbWl0ID0gTWF0aC5tYXgoMC4yICogYXZlcmFnZSwgc3RkRGV2KTsKCSAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgcG9zc2libGVDZW50ZXJzLmxlbmd0aCAmJiBwb3NzaWJsZUNlbnRlcnMubGVuZ3RoID4gMzsgaSsrKSB7CgkgICAgICAgICAgICAgICAgdmFyIHBhdHRlcm4gPSBwb3NzaWJsZUNlbnRlcnNbaV07CgkgICAgICAgICAgICAgICAgaWYgKE1hdGguYWJzKHBhdHRlcm4uZ2V0RXN0aW1hdGVkTW9kdWxlU2l6ZSgpIC0gYXZlcmFnZSkgPiBsaW1pdCkgewoJICAgICAgICAgICAgICAgICAgICBwb3NzaWJsZUNlbnRlcnMuc3BsaWNlKGksIDEpOwoJICAgICAgICAgICAgICAgICAgICBpLS07CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIGlmIChwb3NzaWJsZUNlbnRlcnMubGVuZ3RoID4gMykgewoJICAgICAgICAgICAgLy8gVGhyb3cgYXdheSBhbGwgYnV0IHRob3NlIGZpcnN0IHNpemUgY2FuZGlkYXRlIHBvaW50cyB3ZSBmb3VuZC4KCSAgICAgICAgICAgIHZhciB0b3RhbE1vZHVsZVNpemUgPSAwLjA7CgkgICAgICAgICAgICB0cnkgewoJICAgICAgICAgICAgICAgIGZvciAodmFyIHBvc3NpYmxlQ2VudGVyc18xID0gX192YWx1ZXMocG9zc2libGVDZW50ZXJzKSwgcG9zc2libGVDZW50ZXJzXzFfMSA9IHBvc3NpYmxlQ2VudGVyc18xLm5leHQoKTsgIXBvc3NpYmxlQ2VudGVyc18xXzEuZG9uZTsgcG9zc2libGVDZW50ZXJzXzFfMSA9IHBvc3NpYmxlQ2VudGVyc18xLm5leHQoKSkgewoJICAgICAgICAgICAgICAgICAgICB2YXIgcG9zc2libGVDZW50ZXIgPSBwb3NzaWJsZUNlbnRlcnNfMV8xLnZhbHVlOwoJICAgICAgICAgICAgICAgICAgICB0b3RhbE1vZHVsZVNpemUgKz0gcG9zc2libGVDZW50ZXIuZ2V0RXN0aW1hdGVkTW9kdWxlU2l6ZSgpOwoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIGNhdGNoIChlXzVfMSkgeyBlXzUgPSB7IGVycm9yOiBlXzVfMSB9OyB9CgkgICAgICAgICAgICBmaW5hbGx5IHsKCSAgICAgICAgICAgICAgICB0cnkgewoJICAgICAgICAgICAgICAgICAgICBpZiAocG9zc2libGVDZW50ZXJzXzFfMSAmJiAhcG9zc2libGVDZW50ZXJzXzFfMS5kb25lICYmIChfYiA9IHBvc3NpYmxlQ2VudGVyc18xLnJldHVybikpIF9iLmNhbGwocG9zc2libGVDZW50ZXJzXzEpOwoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICBmaW5hbGx5IHsgaWYgKGVfNSkgdGhyb3cgZV81LmVycm9yOyB9CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBhdmVyYWdlID0gdG90YWxNb2R1bGVTaXplIC8gcG9zc2libGVDZW50ZXJzLmxlbmd0aDsKCSAgICAgICAgICAgIHBvc3NpYmxlQ2VudGVycy5zb3J0KAoJICAgICAgICAgICAgLyoqCgkgICAgICAgICAgICAgKiA8cD5PcmRlcnMgYnkge0BsaW5rIEZpbmRlclBhdHRlcm4jZ2V0Q291bnQoKX0sIGRlc2NlbmRpbmcuPC9wPgoJICAgICAgICAgICAgICovCgkgICAgICAgICAgICAvLyBDZW50ZXJDb21wYXJhdG9yIGltcGxlbWVudHMgQ29tcGFyYXRvcjxGaW5kZXJQYXR0ZXJuPgoJICAgICAgICAgICAgZnVuY3Rpb24gKGNlbnRlcjEsIGNlbnRlcjIpIHsKCSAgICAgICAgICAgICAgICBpZiAoY2VudGVyMi5nZXRDb3VudCgpID09PSBjZW50ZXIxLmdldENvdW50KCkpIHsKCSAgICAgICAgICAgICAgICAgICAgdmFyIGRBID0gTWF0aC5hYnMoY2VudGVyMi5nZXRFc3RpbWF0ZWRNb2R1bGVTaXplKCkgLSBhdmVyYWdlKTsKCSAgICAgICAgICAgICAgICAgICAgdmFyIGRCID0gTWF0aC5hYnMoY2VudGVyMS5nZXRFc3RpbWF0ZWRNb2R1bGVTaXplKCkgLSBhdmVyYWdlKTsKCSAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGRBIDwgZEIgPyAxIDogZEEgPiBkQiA/IC0xIDogMDsKCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgZWxzZSB7CgkgICAgICAgICAgICAgICAgICAgIHJldHVybiBjZW50ZXIyLmdldENvdW50KCkgLSBjZW50ZXIxLmdldENvdW50KCk7CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgfSk7CgkgICAgICAgICAgICBwb3NzaWJsZUNlbnRlcnMuc3BsaWNlKDMpOyAvLyB0aGlzIGlzIG5vdCByZWFseSBuZWNlc3NhcnkgYXMgd2Ugb25seSByZXR1cm4gZmlyc3QgMyBhbnl3YXkKCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gWwoJICAgICAgICAgICAgcG9zc2libGVDZW50ZXJzWzBdLAoJICAgICAgICAgICAgcG9zc2libGVDZW50ZXJzWzFdLAoJICAgICAgICAgICAgcG9zc2libGVDZW50ZXJzWzJdCgkgICAgICAgIF07CgkgICAgfTsKCSAgICBGaW5kZXJQYXR0ZXJuRmluZGVyLkNFTlRFUl9RVU9SVU0gPSAyOwoJICAgIEZpbmRlclBhdHRlcm5GaW5kZXIuTUlOX1NLSVAgPSAzOyAvLyAxIHBpeGVsL21vZHVsZSB0aW1lcyAzIG1vZHVsZXMvY2VudGVyCgkgICAgRmluZGVyUGF0dGVybkZpbmRlci5NQVhfTU9EVUxFUyA9IDU3OyAvLyBzdXBwb3J0IHVwIHRvIHZlcnNpb24gMTAgZm9yIG1vYmlsZSBjbGllbnRzCgkgICAgcmV0dXJuIEZpbmRlclBhdHRlcm5GaW5kZXI7Cgl9KCkpOwoJRmluZGVyUGF0dGVybkZpbmRlciQxLmRlZmF1bHQgPSBGaW5kZXJQYXR0ZXJuRmluZGVyOwoKCS8qCgkgKiBDb3B5cmlnaHQgMjAwNyBaWGluZyBhdXRob3JzCgkgKgoJICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIik7CgkgKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCgkgKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKCSAqCgkgKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAoJICoKCSAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKCSAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCgkgKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4KCSAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKCSAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgoJICovCglPYmplY3QuZGVmaW5lUHJvcGVydHkoRGV0ZWN0b3IkMSwgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJdmFyIE1hdGhVdGlsc18xID0gTWF0aFV0aWxzJDE7Cgl2YXIgRGV0ZWN0b3JSZXN1bHRfMSA9IERldGVjdG9yUmVzdWx0JDE7CgkvLyBpbXBvcnQgR3JpZFNhbXBsZXIgZnJvbSAnLi4vLi4vY29tbW9uL0dyaWRTYW1wbGVyJzsKCXZhciBHcmlkU2FtcGxlckluc3RhbmNlXzEgPSBHcmlkU2FtcGxlckluc3RhbmNlJDE7Cgl2YXIgUGVyc3BlY3RpdmVUcmFuc2Zvcm1fMSA9IFBlcnNwZWN0aXZlVHJhbnNmb3JtJDE7Cgl2YXIgRGVjb2RlSGludFR5cGVfMSQxID0gRGVjb2RlSGludFR5cGUkMTsKCXZhciBOb3RGb3VuZEV4Y2VwdGlvbl8xJDEgPSBOb3RGb3VuZEV4Y2VwdGlvbiQxOwoJdmFyIFJlc3VsdFBvaW50XzEgPSBSZXN1bHRQb2ludCQxOwoJdmFyIFZlcnNpb25fMSA9IFZlcnNpb24kMTsKCXZhciBBbGlnbm1lbnRQYXR0ZXJuRmluZGVyXzEgPSBBbGlnbm1lbnRQYXR0ZXJuRmluZGVyJDE7Cgl2YXIgRmluZGVyUGF0dGVybkZpbmRlcl8xID0gRmluZGVyUGF0dGVybkZpbmRlciQxOwoJLyppbXBvcnQgamF2YS51dGlsLk1hcDsqLwoJLyoqCgkgKiA8cD5FbmNhcHN1bGF0ZXMgbG9naWMgdGhhdCBjYW4gZGV0ZWN0IGEgUVIgQ29kZSBpbiBhbiBpbWFnZSwgZXZlbiBpZiB0aGUgUVIgQ29kZQoJICogaXMgcm90YXRlZCBvciBza2V3ZWQsIG9yIHBhcnRpYWxseSBvYnNjdXJlZC48L3A+CgkgKgoJICogQGF1dGhvciBTZWFuIE93ZW4KCSAqLwoJdmFyIERldGVjdG9yID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkgewoJICAgIGZ1bmN0aW9uIERldGVjdG9yKGltYWdlKSB7CgkgICAgICAgIHRoaXMuaW1hZ2UgPSBpbWFnZTsKCSAgICB9CgkgICAgRGV0ZWN0b3IucHJvdG90eXBlLmdldEltYWdlID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5pbWFnZTsKCSAgICB9OwoJICAgIERldGVjdG9yLnByb3RvdHlwZS5nZXRSZXN1bHRQb2ludENhbGxiYWNrID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5yZXN1bHRQb2ludENhbGxiYWNrOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogPHA+RGV0ZWN0cyBhIFFSIENvZGUgaW4gYW4gaW1hZ2UuPC9wPgoJICAgICAqCgkgICAgICogQHJldHVybiB7QGxpbmsgRGV0ZWN0b3JSZXN1bHR9IGVuY2Fwc3VsYXRpbmcgcmVzdWx0cyBvZiBkZXRlY3RpbmcgYSBRUiBDb2RlCgkgICAgICogQHRocm93cyBOb3RGb3VuZEV4Y2VwdGlvbiBpZiBRUiBDb2RlIGNhbm5vdCBiZSBmb3VuZAoJICAgICAqIEB0aHJvd3MgRm9ybWF0RXhjZXB0aW9uIGlmIGEgUVIgQ29kZSBjYW5ub3QgYmUgZGVjb2RlZAoJICAgICAqLwoJICAgIC8vIHB1YmxpYyBkZXRlY3QoKTogRGV0ZWN0b3JSZXN1bHQgLyp0aHJvd3MgTm90Rm91bmRFeGNlcHRpb24sIEZvcm1hdEV4Y2VwdGlvbiovIHsKCSAgICAvLyAgIHJldHVybiBkZXRlY3QobnVsbCkKCSAgICAvLyB9CgkgICAgLyoqCgkgICAgICogPHA+RGV0ZWN0cyBhIFFSIENvZGUgaW4gYW4gaW1hZ2UuPC9wPgoJICAgICAqCgkgICAgICogQHBhcmFtIGhpbnRzIG9wdGlvbmFsIGhpbnRzIHRvIGRldGVjdG9yCgkgICAgICogQHJldHVybiB7QGxpbmsgRGV0ZWN0b3JSZXN1bHR9IGVuY2Fwc3VsYXRpbmcgcmVzdWx0cyBvZiBkZXRlY3RpbmcgYSBRUiBDb2RlCgkgICAgICogQHRocm93cyBOb3RGb3VuZEV4Y2VwdGlvbiBpZiBRUiBDb2RlIGNhbm5vdCBiZSBmb3VuZAoJICAgICAqIEB0aHJvd3MgRm9ybWF0RXhjZXB0aW9uIGlmIGEgUVIgQ29kZSBjYW5ub3QgYmUgZGVjb2RlZAoJICAgICAqLwoJICAgIERldGVjdG9yLnByb3RvdHlwZS5kZXRlY3QgPSBmdW5jdGlvbiAoaGludHMpIHsKCSAgICAgICAgdGhpcy5yZXN1bHRQb2ludENhbGxiYWNrID0gKGhpbnRzID09PSBudWxsIHx8IGhpbnRzID09PSB1bmRlZmluZWQpID8gbnVsbCA6CgkgICAgICAgICAgICAvKihSZXN1bHRQb2ludENhbGxiYWNrKSAqLyBoaW50cy5nZXQoRGVjb2RlSGludFR5cGVfMSQxLmRlZmF1bHQuTkVFRF9SRVNVTFRfUE9JTlRfQ0FMTEJBQ0spOwoJICAgICAgICB2YXIgZmluZGVyID0gbmV3IEZpbmRlclBhdHRlcm5GaW5kZXJfMS5kZWZhdWx0KHRoaXMuaW1hZ2UsIHRoaXMucmVzdWx0UG9pbnRDYWxsYmFjayk7CgkgICAgICAgIHZhciBpbmZvID0gZmluZGVyLmZpbmQoaGludHMpOwoJICAgICAgICByZXR1cm4gdGhpcy5wcm9jZXNzRmluZGVyUGF0dGVybkluZm8oaW5mbyk7CgkgICAgfTsKCSAgICBEZXRlY3Rvci5wcm90b3R5cGUucHJvY2Vzc0ZpbmRlclBhdHRlcm5JbmZvID0gZnVuY3Rpb24gKGluZm8pIHsKCSAgICAgICAgdmFyIHRvcExlZnQgPSBpbmZvLmdldFRvcExlZnQoKTsKCSAgICAgICAgdmFyIHRvcFJpZ2h0ID0gaW5mby5nZXRUb3BSaWdodCgpOwoJICAgICAgICB2YXIgYm90dG9tTGVmdCA9IGluZm8uZ2V0Qm90dG9tTGVmdCgpOwoJICAgICAgICB2YXIgbW9kdWxlU2l6ZSA9IHRoaXMuY2FsY3VsYXRlTW9kdWxlU2l6ZSh0b3BMZWZ0LCB0b3BSaWdodCwgYm90dG9tTGVmdCk7CgkgICAgICAgIGlmIChtb2R1bGVTaXplIDwgMS4wKSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgTm90Rm91bmRFeGNlcHRpb25fMSQxLmRlZmF1bHQoJ05vIHBhdHRlcm4gZm91bmQgaW4gcHJvY2Nlc3MgZmluZGVyLicpOwoJICAgICAgICB9CgkgICAgICAgIHZhciBkaW1lbnNpb24gPSBEZXRlY3Rvci5jb21wdXRlRGltZW5zaW9uKHRvcExlZnQsIHRvcFJpZ2h0LCBib3R0b21MZWZ0LCBtb2R1bGVTaXplKTsKCSAgICAgICAgdmFyIHByb3Zpc2lvbmFsVmVyc2lvbiA9IFZlcnNpb25fMS5kZWZhdWx0LmdldFByb3Zpc2lvbmFsVmVyc2lvbkZvckRpbWVuc2lvbihkaW1lbnNpb24pOwoJICAgICAgICB2YXIgbW9kdWxlc0JldHdlZW5GUENlbnRlcnMgPSBwcm92aXNpb25hbFZlcnNpb24uZ2V0RGltZW5zaW9uRm9yVmVyc2lvbigpIC0gNzsKCSAgICAgICAgdmFyIGFsaWdubWVudFBhdHRlcm4gPSBudWxsOwoJICAgICAgICAvLyBBbnl0aGluZyBhYm92ZSB2ZXJzaW9uIDEgaGFzIGFuIGFsaWdubWVudCBwYXR0ZXJuCgkgICAgICAgIGlmIChwcm92aXNpb25hbFZlcnNpb24uZ2V0QWxpZ25tZW50UGF0dGVybkNlbnRlcnMoKS5sZW5ndGggPiAwKSB7CgkgICAgICAgICAgICAvLyBHdWVzcyB3aGVyZSBhICJib3R0b20gcmlnaHQiIGZpbmRlciBwYXR0ZXJuIHdvdWxkIGhhdmUgYmVlbgoJICAgICAgICAgICAgdmFyIGJvdHRvbVJpZ2h0WCA9IHRvcFJpZ2h0LmdldFgoKSAtIHRvcExlZnQuZ2V0WCgpICsgYm90dG9tTGVmdC5nZXRYKCk7CgkgICAgICAgICAgICB2YXIgYm90dG9tUmlnaHRZID0gdG9wUmlnaHQuZ2V0WSgpIC0gdG9wTGVmdC5nZXRZKCkgKyBib3R0b21MZWZ0LmdldFkoKTsKCSAgICAgICAgICAgIC8vIEVzdGltYXRlIHRoYXQgYWxpZ25tZW50IHBhdHRlcm4gaXMgY2xvc2VyIGJ5IDMgbW9kdWxlcwoJICAgICAgICAgICAgLy8gZnJvbSAiYm90dG9tIHJpZ2h0IiB0byBrbm93biB0b3AgbGVmdCBsb2NhdGlvbgoJICAgICAgICAgICAgdmFyIGNvcnJlY3Rpb25Ub1RvcExlZnQgPSAxLjAgLSAzLjAgLyBtb2R1bGVzQmV0d2VlbkZQQ2VudGVyczsKCSAgICAgICAgICAgIHZhciBlc3RBbGlnbm1lbnRYID0gLyooaW50KSAqLyBNYXRoLmZsb29yKHRvcExlZnQuZ2V0WCgpICsgY29ycmVjdGlvblRvVG9wTGVmdCAqIChib3R0b21SaWdodFggLSB0b3BMZWZ0LmdldFgoKSkpOwoJICAgICAgICAgICAgdmFyIGVzdEFsaWdubWVudFkgPSAvKihpbnQpICovIE1hdGguZmxvb3IodG9wTGVmdC5nZXRZKCkgKyBjb3JyZWN0aW9uVG9Ub3BMZWZ0ICogKGJvdHRvbVJpZ2h0WSAtIHRvcExlZnQuZ2V0WSgpKSk7CgkgICAgICAgICAgICAvLyBLaW5kIG9mIGFyYml0cmFyeSAtLSBleHBhbmQgc2VhcmNoIHJhZGl1cyBiZWZvcmUgZ2l2aW5nIHVwCgkgICAgICAgICAgICBmb3IgKHZhciBpID0gNDsgaSA8PSAxNjsgaSA8PD0gMSkgewoJICAgICAgICAgICAgICAgIHRyeSB7CgkgICAgICAgICAgICAgICAgICAgIGFsaWdubWVudFBhdHRlcm4gPSB0aGlzLmZpbmRBbGlnbm1lbnRJblJlZ2lvbihtb2R1bGVTaXplLCBlc3RBbGlnbm1lbnRYLCBlc3RBbGlnbm1lbnRZLCBpKTsKCSAgICAgICAgICAgICAgICAgICAgYnJlYWs7CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgIGNhdGNoIChyZSAvKk5vdEZvdW5kRXhjZXB0aW9uKi8pIHsKCSAgICAgICAgICAgICAgICAgICAgaWYgKCEocmUgaW5zdGFuY2VvZiBOb3RGb3VuZEV4Y2VwdGlvbl8xJDEuZGVmYXVsdCkpIHsKCSAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IHJlOwoJICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgIC8vIHRyeSBuZXh0IHJvdW5kCgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgLy8gSWYgd2UgZGlkbid0IGZpbmQgYWxpZ25tZW50IHBhdHRlcm4uLi4gd2VsbCB0cnkgYW55d2F5IHdpdGhvdXQgaXQKCSAgICAgICAgfQoJICAgICAgICB2YXIgdHJhbnNmb3JtID0gRGV0ZWN0b3IuY3JlYXRlVHJhbnNmb3JtKHRvcExlZnQsIHRvcFJpZ2h0LCBib3R0b21MZWZ0LCBhbGlnbm1lbnRQYXR0ZXJuLCBkaW1lbnNpb24pOwoJICAgICAgICB2YXIgYml0cyA9IERldGVjdG9yLnNhbXBsZUdyaWQodGhpcy5pbWFnZSwgdHJhbnNmb3JtLCBkaW1lbnNpb24pOwoJICAgICAgICB2YXIgcG9pbnRzOwoJICAgICAgICBpZiAoYWxpZ25tZW50UGF0dGVybiA9PT0gbnVsbCkgewoJICAgICAgICAgICAgcG9pbnRzID0gW2JvdHRvbUxlZnQsIHRvcExlZnQsIHRvcFJpZ2h0XTsKCSAgICAgICAgfQoJICAgICAgICBlbHNlIHsKCSAgICAgICAgICAgIHBvaW50cyA9IFtib3R0b21MZWZ0LCB0b3BMZWZ0LCB0b3BSaWdodCwgYWxpZ25tZW50UGF0dGVybl07CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIG5ldyBEZXRlY3RvclJlc3VsdF8xLmRlZmF1bHQoYml0cywgcG9pbnRzKTsKCSAgICB9OwoJICAgIERldGVjdG9yLmNyZWF0ZVRyYW5zZm9ybSA9IGZ1bmN0aW9uICh0b3BMZWZ0LCB0b3BSaWdodCwgYm90dG9tTGVmdCwgYWxpZ25tZW50UGF0dGVybiwgZGltZW5zaW9uIC8qaW50Ki8pIHsKCSAgICAgICAgdmFyIGRpbU1pbnVzVGhyZWUgPSBkaW1lbnNpb24gLSAzLjU7CgkgICAgICAgIHZhciBib3R0b21SaWdodFg7IC8qZmxvYXQqLwoJICAgICAgICB2YXIgYm90dG9tUmlnaHRZOyAvKmZsb2F0Ki8KCSAgICAgICAgdmFyIHNvdXJjZUJvdHRvbVJpZ2h0WDsgLypmbG9hdCovCgkgICAgICAgIHZhciBzb3VyY2VCb3R0b21SaWdodFk7IC8qZmxvYXQqLwoJICAgICAgICBpZiAoYWxpZ25tZW50UGF0dGVybiAhPT0gbnVsbCkgewoJICAgICAgICAgICAgYm90dG9tUmlnaHRYID0gYWxpZ25tZW50UGF0dGVybi5nZXRYKCk7CgkgICAgICAgICAgICBib3R0b21SaWdodFkgPSBhbGlnbm1lbnRQYXR0ZXJuLmdldFkoKTsKCSAgICAgICAgICAgIHNvdXJjZUJvdHRvbVJpZ2h0WCA9IGRpbU1pbnVzVGhyZWUgLSAzLjA7CgkgICAgICAgICAgICBzb3VyY2VCb3R0b21SaWdodFkgPSBzb3VyY2VCb3R0b21SaWdodFg7CgkgICAgICAgIH0KCSAgICAgICAgZWxzZSB7CgkgICAgICAgICAgICAvLyBEb24ndCBoYXZlIGFuIGFsaWdubWVudCBwYXR0ZXJuLCBqdXN0IG1ha2UgdXAgdGhlIGJvdHRvbS1yaWdodCBwb2ludAoJICAgICAgICAgICAgYm90dG9tUmlnaHRYID0gKHRvcFJpZ2h0LmdldFgoKSAtIHRvcExlZnQuZ2V0WCgpKSArIGJvdHRvbUxlZnQuZ2V0WCgpOwoJICAgICAgICAgICAgYm90dG9tUmlnaHRZID0gKHRvcFJpZ2h0LmdldFkoKSAtIHRvcExlZnQuZ2V0WSgpKSArIGJvdHRvbUxlZnQuZ2V0WSgpOwoJICAgICAgICAgICAgc291cmNlQm90dG9tUmlnaHRYID0gZGltTWludXNUaHJlZTsKCSAgICAgICAgICAgIHNvdXJjZUJvdHRvbVJpZ2h0WSA9IGRpbU1pbnVzVGhyZWU7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIFBlcnNwZWN0aXZlVHJhbnNmb3JtXzEuZGVmYXVsdC5xdWFkcmlsYXRlcmFsVG9RdWFkcmlsYXRlcmFsKDMuNSwgMy41LCBkaW1NaW51c1RocmVlLCAzLjUsIHNvdXJjZUJvdHRvbVJpZ2h0WCwgc291cmNlQm90dG9tUmlnaHRZLCAzLjUsIGRpbU1pbnVzVGhyZWUsIHRvcExlZnQuZ2V0WCgpLCB0b3BMZWZ0LmdldFkoKSwgdG9wUmlnaHQuZ2V0WCgpLCB0b3BSaWdodC5nZXRZKCksIGJvdHRvbVJpZ2h0WCwgYm90dG9tUmlnaHRZLCBib3R0b21MZWZ0LmdldFgoKSwgYm90dG9tTGVmdC5nZXRZKCkpOwoJICAgIH07CgkgICAgRGV0ZWN0b3Iuc2FtcGxlR3JpZCA9IGZ1bmN0aW9uIChpbWFnZSwgdHJhbnNmb3JtLCBkaW1lbnNpb24gLyppbnQqLykgewoJICAgICAgICB2YXIgc2FtcGxlciA9IEdyaWRTYW1wbGVySW5zdGFuY2VfMS5kZWZhdWx0LmdldEluc3RhbmNlKCk7CgkgICAgICAgIHJldHVybiBzYW1wbGVyLnNhbXBsZUdyaWRXaXRoVHJhbnNmb3JtKGltYWdlLCBkaW1lbnNpb24sIGRpbWVuc2lvbiwgdHJhbnNmb3JtKTsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIDxwPkNvbXB1dGVzIHRoZSBkaW1lbnNpb24gKG51bWJlciBvZiBtb2R1bGVzIG9uIGEgc2l6ZSkgb2YgdGhlIFFSIENvZGUgYmFzZWQgb24gdGhlIHBvc2l0aW9uCgkgICAgICogb2YgdGhlIGZpbmRlciBwYXR0ZXJucyBhbmQgZXN0aW1hdGVkIG1vZHVsZSBzaXplLjwvcD4KCSAgICAgKi8KCSAgICBEZXRlY3Rvci5jb21wdXRlRGltZW5zaW9uID0gZnVuY3Rpb24gKHRvcExlZnQsIHRvcFJpZ2h0LCBib3R0b21MZWZ0LCBtb2R1bGVTaXplIC8qZmxvYXQqLykgewoJICAgICAgICB2YXIgdGx0ckNlbnRlcnNEaW1lbnNpb24gPSBNYXRoVXRpbHNfMS5kZWZhdWx0LnJvdW5kKFJlc3VsdFBvaW50XzEuZGVmYXVsdC5kaXN0YW5jZSh0b3BMZWZ0LCB0b3BSaWdodCkgLyBtb2R1bGVTaXplKTsKCSAgICAgICAgdmFyIHRsYmxDZW50ZXJzRGltZW5zaW9uID0gTWF0aFV0aWxzXzEuZGVmYXVsdC5yb3VuZChSZXN1bHRQb2ludF8xLmRlZmF1bHQuZGlzdGFuY2UodG9wTGVmdCwgYm90dG9tTGVmdCkgLyBtb2R1bGVTaXplKTsKCSAgICAgICAgdmFyIGRpbWVuc2lvbiA9IE1hdGguZmxvb3IoKHRsdHJDZW50ZXJzRGltZW5zaW9uICsgdGxibENlbnRlcnNEaW1lbnNpb24pIC8gMikgKyA3OwoJICAgICAgICBzd2l0Y2ggKGRpbWVuc2lvbiAmIDB4MDMpIHsgLy8gbW9kIDQKCSAgICAgICAgICAgIGNhc2UgMDoKCSAgICAgICAgICAgICAgICBkaW1lbnNpb24rKzsKCSAgICAgICAgICAgICAgICBicmVhazsKCSAgICAgICAgICAgIC8vIDE/IGRvIG5vdGhpbmcKCSAgICAgICAgICAgIGNhc2UgMjoKCSAgICAgICAgICAgICAgICBkaW1lbnNpb24tLTsKCSAgICAgICAgICAgICAgICBicmVhazsKCSAgICAgICAgICAgIGNhc2UgMzoKCSAgICAgICAgICAgICAgICB0aHJvdyBuZXcgTm90Rm91bmRFeGNlcHRpb25fMSQxLmRlZmF1bHQoJ0RpbWVuc2lvbnMgY291bGQgYmUgbm90IGZvdW5kLicpOwoJICAgICAgICB9CgkgICAgICAgIHJldHVybiBkaW1lbnNpb247CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiA8cD5Db21wdXRlcyBhbiBhdmVyYWdlIGVzdGltYXRlZCBtb2R1bGUgc2l6ZSBiYXNlZCBvbiBlc3RpbWF0ZWQgZGVyaXZlZCBmcm9tIHRoZSBwb3NpdGlvbnMKCSAgICAgKiBvZiB0aGUgdGhyZWUgZmluZGVyIHBhdHRlcm5zLjwvcD4KCSAgICAgKgoJICAgICAqIEBwYXJhbSB0b3BMZWZ0IGRldGVjdGVkIHRvcC1sZWZ0IGZpbmRlciBwYXR0ZXJuIGNlbnRlcgoJICAgICAqIEBwYXJhbSB0b3BSaWdodCBkZXRlY3RlZCB0b3AtcmlnaHQgZmluZGVyIHBhdHRlcm4gY2VudGVyCgkgICAgICogQHBhcmFtIGJvdHRvbUxlZnQgZGV0ZWN0ZWQgYm90dG9tLWxlZnQgZmluZGVyIHBhdHRlcm4gY2VudGVyCgkgICAgICogQHJldHVybiBlc3RpbWF0ZWQgbW9kdWxlIHNpemUKCSAgICAgKi8KCSAgICBEZXRlY3Rvci5wcm90b3R5cGUuY2FsY3VsYXRlTW9kdWxlU2l6ZSA9IGZ1bmN0aW9uICh0b3BMZWZ0LCB0b3BSaWdodCwgYm90dG9tTGVmdCkgewoJICAgICAgICAvLyBUYWtlIHRoZSBhdmVyYWdlCgkgICAgICAgIHJldHVybiAodGhpcy5jYWxjdWxhdGVNb2R1bGVTaXplT25lV2F5KHRvcExlZnQsIHRvcFJpZ2h0KSArCgkgICAgICAgICAgICB0aGlzLmNhbGN1bGF0ZU1vZHVsZVNpemVPbmVXYXkodG9wTGVmdCwgYm90dG9tTGVmdCkpIC8gMi4wOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogPHA+RXN0aW1hdGVzIG1vZHVsZSBzaXplIGJhc2VkIG9uIHR3byBmaW5kZXIgcGF0dGVybnMgLS0gaXQgdXNlcwoJICAgICAqIHtAbGluayAjc2l6ZU9mQmxhY2tXaGl0ZUJsYWNrUnVuQm90aFdheXMoaW50LCBpbnQsIGludCwgaW50KX0gdG8gZmlndXJlIHRoZQoJICAgICAqIHdpZHRoIG9mIGVhY2gsIG1lYXN1cmluZyBhbG9uZyB0aGUgYXhpcyBiZXR3ZWVuIHRoZWlyIGNlbnRlcnMuPC9wPgoJICAgICAqLwoJICAgIERldGVjdG9yLnByb3RvdHlwZS5jYWxjdWxhdGVNb2R1bGVTaXplT25lV2F5ID0gZnVuY3Rpb24gKHBhdHRlcm4sIG90aGVyUGF0dGVybikgewoJICAgICAgICB2YXIgbW9kdWxlU2l6ZUVzdDEgPSB0aGlzLnNpemVPZkJsYWNrV2hpdGVCbGFja1J1bkJvdGhXYXlzKC8qKGludCkgKi8gTWF0aC5mbG9vcihwYXR0ZXJuLmdldFgoKSksIAoJICAgICAgICAvKihpbnQpICovIE1hdGguZmxvb3IocGF0dGVybi5nZXRZKCkpLCAKCSAgICAgICAgLyooaW50KSAqLyBNYXRoLmZsb29yKG90aGVyUGF0dGVybi5nZXRYKCkpLCAKCSAgICAgICAgLyooaW50KSAqLyBNYXRoLmZsb29yKG90aGVyUGF0dGVybi5nZXRZKCkpKTsKCSAgICAgICAgdmFyIG1vZHVsZVNpemVFc3QyID0gdGhpcy5zaXplT2ZCbGFja1doaXRlQmxhY2tSdW5Cb3RoV2F5cygvKihpbnQpICovIE1hdGguZmxvb3Iob3RoZXJQYXR0ZXJuLmdldFgoKSksIAoJICAgICAgICAvKihpbnQpICovIE1hdGguZmxvb3Iob3RoZXJQYXR0ZXJuLmdldFkoKSksIAoJICAgICAgICAvKihpbnQpICovIE1hdGguZmxvb3IocGF0dGVybi5nZXRYKCkpLCAKCSAgICAgICAgLyooaW50KSAqLyBNYXRoLmZsb29yKHBhdHRlcm4uZ2V0WSgpKSk7CgkgICAgICAgIGlmIChpc05hTihtb2R1bGVTaXplRXN0MSkpIHsKCSAgICAgICAgICAgIHJldHVybiBtb2R1bGVTaXplRXN0MiAvIDcuMDsKCSAgICAgICAgfQoJICAgICAgICBpZiAoaXNOYU4obW9kdWxlU2l6ZUVzdDIpKSB7CgkgICAgICAgICAgICByZXR1cm4gbW9kdWxlU2l6ZUVzdDEgLyA3LjA7CgkgICAgICAgIH0KCSAgICAgICAgLy8gQXZlcmFnZSB0aGVtLCBhbmQgZGl2aWRlIGJ5IDcgc2luY2Ugd2UndmUgY291bnRlZCB0aGUgd2lkdGggb2YgMyBibGFjayBtb2R1bGVzLAoJICAgICAgICAvLyBhbmQgMSB3aGl0ZSBhbmQgMSBibGFjayBtb2R1bGUgb24gZWl0aGVyIHNpZGUuIEVyZ28sIGRpdmlkZSBzdW0gYnkgMTQuCgkgICAgICAgIHJldHVybiAobW9kdWxlU2l6ZUVzdDEgKyBtb2R1bGVTaXplRXN0MikgLyAxNC4wOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogU2VlIHtAbGluayAjc2l6ZU9mQmxhY2tXaGl0ZUJsYWNrUnVuKGludCwgaW50LCBpbnQsIGludCl9OyBjb21wdXRlcyB0aGUgdG90YWwgd2lkdGggb2YKCSAgICAgKiBhIGZpbmRlciBwYXR0ZXJuIGJ5IGxvb2tpbmcgZm9yIGEgYmxhY2std2hpdGUtYmxhY2sgcnVuIGZyb20gdGhlIGNlbnRlciBpbiB0aGUgZGlyZWN0aW9uCgkgICAgICogb2YgYW5vdGhlciBwb2ludCAoYW5vdGhlciBmaW5kZXIgcGF0dGVybiBjZW50ZXIpLCBhbmQgaW4gdGhlIG9wcG9zaXRlIGRpcmVjdGlvbiB0b28uCgkgICAgICovCgkgICAgRGV0ZWN0b3IucHJvdG90eXBlLnNpemVPZkJsYWNrV2hpdGVCbGFja1J1bkJvdGhXYXlzID0gZnVuY3Rpb24gKGZyb21YIC8qaW50Ki8sIGZyb21ZIC8qaW50Ki8sIHRvWCAvKmludCovLCB0b1kgLyppbnQqLykgewoJICAgICAgICB2YXIgcmVzdWx0ID0gdGhpcy5zaXplT2ZCbGFja1doaXRlQmxhY2tSdW4oZnJvbVgsIGZyb21ZLCB0b1gsIHRvWSk7CgkgICAgICAgIC8vIE5vdyBjb3VudCBvdGhlciB3YXkgLS0gZG9uJ3QgcnVuIG9mZiBpbWFnZSB0aG91Z2ggb2YgY291cnNlCgkgICAgICAgIHZhciBzY2FsZSA9IDEuMDsKCSAgICAgICAgdmFyIG90aGVyVG9YID0gZnJvbVggLSAodG9YIC0gZnJvbVgpOwoJICAgICAgICBpZiAob3RoZXJUb1ggPCAwKSB7CgkgICAgICAgICAgICBzY2FsZSA9IGZyb21YIC8gLyooZmxvYXQpICovIChmcm9tWCAtIG90aGVyVG9YKTsKCSAgICAgICAgICAgIG90aGVyVG9YID0gMDsKCSAgICAgICAgfQoJICAgICAgICBlbHNlIGlmIChvdGhlclRvWCA+PSB0aGlzLmltYWdlLmdldFdpZHRoKCkpIHsKCSAgICAgICAgICAgIHNjYWxlID0gKHRoaXMuaW1hZ2UuZ2V0V2lkdGgoKSAtIDEgLSBmcm9tWCkgLyAvKihmbG9hdCkgKi8gKG90aGVyVG9YIC0gZnJvbVgpOwoJICAgICAgICAgICAgb3RoZXJUb1ggPSB0aGlzLmltYWdlLmdldFdpZHRoKCkgLSAxOwoJICAgICAgICB9CgkgICAgICAgIHZhciBvdGhlclRvWSA9IC8qKGludCkgKi8gTWF0aC5mbG9vcihmcm9tWSAtICh0b1kgLSBmcm9tWSkgKiBzY2FsZSk7CgkgICAgICAgIHNjYWxlID0gMS4wOwoJICAgICAgICBpZiAob3RoZXJUb1kgPCAwKSB7CgkgICAgICAgICAgICBzY2FsZSA9IGZyb21ZIC8gLyooZmxvYXQpICovIChmcm9tWSAtIG90aGVyVG9ZKTsKCSAgICAgICAgICAgIG90aGVyVG9ZID0gMDsKCSAgICAgICAgfQoJICAgICAgICBlbHNlIGlmIChvdGhlclRvWSA+PSB0aGlzLmltYWdlLmdldEhlaWdodCgpKSB7CgkgICAgICAgICAgICBzY2FsZSA9ICh0aGlzLmltYWdlLmdldEhlaWdodCgpIC0gMSAtIGZyb21ZKSAvIC8qKGZsb2F0KSAqLyAob3RoZXJUb1kgLSBmcm9tWSk7CgkgICAgICAgICAgICBvdGhlclRvWSA9IHRoaXMuaW1hZ2UuZ2V0SGVpZ2h0KCkgLSAxOwoJICAgICAgICB9CgkgICAgICAgIG90aGVyVG9YID0gLyooaW50KSAqLyBNYXRoLmZsb29yKGZyb21YICsgKG90aGVyVG9YIC0gZnJvbVgpICogc2NhbGUpOwoJICAgICAgICByZXN1bHQgKz0gdGhpcy5zaXplT2ZCbGFja1doaXRlQmxhY2tSdW4oZnJvbVgsIGZyb21ZLCBvdGhlclRvWCwgb3RoZXJUb1kpOwoJICAgICAgICAvLyBNaWRkbGUgcGl4ZWwgaXMgZG91YmxlLWNvdW50ZWQgdGhpcyB3YXk7IHN1YnRyYWN0IDEKCSAgICAgICAgcmV0dXJuIHJlc3VsdCAtIDEuMDsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIDxwPlRoaXMgbWV0aG9kIHRyYWNlcyBhIGxpbmUgZnJvbSBhIHBvaW50IGluIHRoZSBpbWFnZSwgaW4gdGhlIGRpcmVjdGlvbiB0b3dhcmRzIGFub3RoZXIgcG9pbnQuCgkgICAgICogSXQgYmVnaW5zIGluIGEgYmxhY2sgcmVnaW9uLCBhbmQga2VlcHMgZ29pbmcgdW50aWwgaXQgZmluZHMgd2hpdGUsIHRoZW4gYmxhY2ssIHRoZW4gd2hpdGUgYWdhaW4uCgkgICAgICogSXQgcmVwb3J0cyB0aGUgZGlzdGFuY2UgZnJvbSB0aGUgc3RhcnQgdG8gdGhpcyBwb2ludC48L3A+CgkgICAgICoKCSAgICAgKiA8cD5UaGlzIGlzIHVzZWQgd2hlbiBmaWd1cmluZyBvdXQgaG93IHdpZGUgYSBmaW5kZXIgcGF0dGVybiBpcywgd2hlbiB0aGUgZmluZGVyIHBhdHRlcm4KCSAgICAgKiBtYXkgYmUgc2tld2VkIG9yIHJvdGF0ZWQuPC9wPgoJICAgICAqLwoJICAgIERldGVjdG9yLnByb3RvdHlwZS5zaXplT2ZCbGFja1doaXRlQmxhY2tSdW4gPSBmdW5jdGlvbiAoZnJvbVggLyppbnQqLywgZnJvbVkgLyppbnQqLywgdG9YIC8qaW50Ki8sIHRvWSAvKmludCovKSB7CgkgICAgICAgIC8vIE1pbGQgdmFyaWFudCBvZiBCcmVzZW5oYW0ncyBhbGdvcml0aG0KCSAgICAgICAgLy8gc2VlIGh0dHA6Ly9lbi53aWtpcGVkaWEub3JnL3dpa2kvQnJlc2VuaGFtJ3NfbGluZV9hbGdvcml0aG0KCSAgICAgICAgdmFyIHN0ZWVwID0gTWF0aC5hYnModG9ZIC0gZnJvbVkpID4gTWF0aC5hYnModG9YIC0gZnJvbVgpOwoJICAgICAgICBpZiAoc3RlZXApIHsKCSAgICAgICAgICAgIHZhciB0ZW1wID0gZnJvbVg7CgkgICAgICAgICAgICBmcm9tWCA9IGZyb21ZOwoJICAgICAgICAgICAgZnJvbVkgPSB0ZW1wOwoJICAgICAgICAgICAgdGVtcCA9IHRvWDsKCSAgICAgICAgICAgIHRvWCA9IHRvWTsKCSAgICAgICAgICAgIHRvWSA9IHRlbXA7CgkgICAgICAgIH0KCSAgICAgICAgdmFyIGR4ID0gTWF0aC5hYnModG9YIC0gZnJvbVgpOwoJICAgICAgICB2YXIgZHkgPSBNYXRoLmFicyh0b1kgLSBmcm9tWSk7CgkgICAgICAgIHZhciBlcnJvciA9IC1keCAvIDI7CgkgICAgICAgIHZhciB4c3RlcCA9IGZyb21YIDwgdG9YID8gMSA6IC0xOwoJICAgICAgICB2YXIgeXN0ZXAgPSBmcm9tWSA8IHRvWSA/IDEgOiAtMTsKCSAgICAgICAgLy8gSW4gYmxhY2sgcGl4ZWxzLCBsb29raW5nIGZvciB3aGl0ZSwgZmlyc3Qgb3Igc2Vjb25kIHRpbWUuCgkgICAgICAgIHZhciBzdGF0ZSA9IDA7CgkgICAgICAgIC8vIExvb3AgdXAgdW50aWwgeCA9PSB0b1gsIGJ1dCBub3QgYmV5b25kCgkgICAgICAgIHZhciB4TGltaXQgPSB0b1ggKyB4c3RlcDsKCSAgICAgICAgZm9yICh2YXIgeCA9IGZyb21YLCB5ID0gZnJvbVk7IHggIT09IHhMaW1pdDsgeCArPSB4c3RlcCkgewoJICAgICAgICAgICAgdmFyIHJlYWxYID0gc3RlZXAgPyB5IDogeDsKCSAgICAgICAgICAgIHZhciByZWFsWSA9IHN0ZWVwID8geCA6IHk7CgkgICAgICAgICAgICAvLyBEb2VzIGN1cnJlbnQgcGl4ZWwgbWVhbiB3ZSBoYXZlIG1vdmVkIHdoaXRlIHRvIGJsYWNrIG9yIHZpY2UgdmVyc2E/CgkgICAgICAgICAgICAvLyBTY2FubmluZyBibGFjayBpbiBzdGF0ZSAwLDIgYW5kIHdoaXRlIGluIHN0YXRlIDEsIHNvIGlmIHdlIGZpbmQgdGhlIHdyb25nCgkgICAgICAgICAgICAvLyBjb2xvciwgYWR2YW5jZSB0byBuZXh0IHN0YXRlIG9yIGVuZCBpZiB3ZSBhcmUgaW4gc3RhdGUgMiBhbHJlYWR5CgkgICAgICAgICAgICBpZiAoKHN0YXRlID09PSAxKSA9PT0gdGhpcy5pbWFnZS5nZXQocmVhbFgsIHJlYWxZKSkgewoJICAgICAgICAgICAgICAgIGlmIChzdGF0ZSA9PT0gMikgewoJICAgICAgICAgICAgICAgICAgICByZXR1cm4gTWF0aFV0aWxzXzEuZGVmYXVsdC5kaXN0YW5jZSh4LCB5LCBmcm9tWCwgZnJvbVkpOwoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICBzdGF0ZSsrOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgZXJyb3IgKz0gZHk7CgkgICAgICAgICAgICBpZiAoZXJyb3IgPiAwKSB7CgkgICAgICAgICAgICAgICAgaWYgKHkgPT09IHRvWSkgewoJICAgICAgICAgICAgICAgICAgICBicmVhazsKCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgeSArPSB5c3RlcDsKCSAgICAgICAgICAgICAgICBlcnJvciAtPSBkeDsKCSAgICAgICAgICAgIH0KCSAgICAgICAgfQoJICAgICAgICAvLyBGb3VuZCBibGFjay13aGl0ZS1ibGFjazsgZ2l2ZSB0aGUgYmVuZWZpdCBvZiB0aGUgZG91YnQgdGhhdCB0aGUgbmV4dCBwaXhlbCBvdXRzaWRlIHRoZSBpbWFnZQoJICAgICAgICAvLyBpcyAid2hpdGUiIHNvIHRoaXMgbGFzdCBwb2ludCBhdCAodG9YK3hTdGVwLHRvWSkgaXMgdGhlIHJpZ2h0IGVuZGluZy4gVGhpcyBpcyByZWFsbHkgYQoJICAgICAgICAvLyBzbWFsbCBhcHByb3hpbWF0aW9uOyAodG9YK3hTdGVwLHRvWSt5U3RlcCkgbWlnaHQgYmUgcmVhbGx5IGNvcnJlY3QuIElnbm9yZSB0aGlzLgoJICAgICAgICBpZiAoc3RhdGUgPT09IDIpIHsKCSAgICAgICAgICAgIHJldHVybiBNYXRoVXRpbHNfMS5kZWZhdWx0LmRpc3RhbmNlKHRvWCArIHhzdGVwLCB0b1ksIGZyb21YLCBmcm9tWSk7CgkgICAgICAgIH0KCSAgICAgICAgLy8gZWxzZSB3ZSBkaWRuJ3QgZmluZCBldmVuIGJsYWNrLXdoaXRlLWJsYWNrOyBubyBlc3RpbWF0ZSBpcyByZWFsbHkgcG9zc2libGUKCSAgICAgICAgcmV0dXJuIE5hTjsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIDxwPkF0dGVtcHRzIHRvIGxvY2F0ZSBhbiBhbGlnbm1lbnQgcGF0dGVybiBpbiBhIGxpbWl0ZWQgcmVnaW9uIG9mIHRoZSBpbWFnZSwgd2hpY2ggaXMKCSAgICAgKiBndWVzc2VkIHRvIGNvbnRhaW4gaXQuIFRoaXMgbWV0aG9kIHVzZXMge0BsaW5rIEFsaWdubWVudFBhdHRlcm59LjwvcD4KCSAgICAgKgoJICAgICAqIEBwYXJhbSBvdmVyYWxsRXN0TW9kdWxlU2l6ZSBlc3RpbWF0ZWQgbW9kdWxlIHNpemUgc28gZmFyCgkgICAgICogQHBhcmFtIGVzdEFsaWdubWVudFggeCBjb29yZGluYXRlIG9mIGNlbnRlciBvZiBhcmVhIHByb2JhYmx5IGNvbnRhaW5pbmcgYWxpZ25tZW50IHBhdHRlcm4KCSAgICAgKiBAcGFyYW0gZXN0QWxpZ25tZW50WSB5IGNvb3JkaW5hdGUgb2YgYWJvdmUKCSAgICAgKiBAcGFyYW0gYWxsb3dhbmNlRmFjdG9yIG51bWJlciBvZiBwaXhlbHMgaW4gYWxsIGRpcmVjdGlvbnMgdG8gc2VhcmNoIGZyb20gdGhlIGNlbnRlcgoJICAgICAqIEByZXR1cm4ge0BsaW5rIEFsaWdubWVudFBhdHRlcm59IGlmIGZvdW5kLCBvciBudWxsIG90aGVyd2lzZQoJICAgICAqIEB0aHJvd3MgTm90Rm91bmRFeGNlcHRpb24gaWYgYW4gdW5leHBlY3RlZCBlcnJvciBvY2N1cnMgZHVyaW5nIGRldGVjdGlvbgoJICAgICAqLwoJICAgIERldGVjdG9yLnByb3RvdHlwZS5maW5kQWxpZ25tZW50SW5SZWdpb24gPSBmdW5jdGlvbiAob3ZlcmFsbEVzdE1vZHVsZVNpemUgLypmbG9hdCovLCBlc3RBbGlnbm1lbnRYIC8qaW50Ki8sIGVzdEFsaWdubWVudFkgLyppbnQqLywgYWxsb3dhbmNlRmFjdG9yIC8qZmxvYXQqLykgewoJICAgICAgICAvLyBMb29rIGZvciBhbiBhbGlnbm1lbnQgcGF0dGVybiAoMyBtb2R1bGVzIGluIHNpemUpIGFyb3VuZCB3aGVyZSBpdAoJICAgICAgICAvLyBzaG91bGQgYmUKCSAgICAgICAgdmFyIGFsbG93YW5jZSA9IC8qKGludCkgKi8gTWF0aC5mbG9vcihhbGxvd2FuY2VGYWN0b3IgKiBvdmVyYWxsRXN0TW9kdWxlU2l6ZSk7CgkgICAgICAgIHZhciBhbGlnbm1lbnRBcmVhTGVmdFggPSBNYXRoLm1heCgwLCBlc3RBbGlnbm1lbnRYIC0gYWxsb3dhbmNlKTsKCSAgICAgICAgdmFyIGFsaWdubWVudEFyZWFSaWdodFggPSBNYXRoLm1pbih0aGlzLmltYWdlLmdldFdpZHRoKCkgLSAxLCBlc3RBbGlnbm1lbnRYICsgYWxsb3dhbmNlKTsKCSAgICAgICAgaWYgKGFsaWdubWVudEFyZWFSaWdodFggLSBhbGlnbm1lbnRBcmVhTGVmdFggPCBvdmVyYWxsRXN0TW9kdWxlU2l6ZSAqIDMpIHsKCSAgICAgICAgICAgIHRocm93IG5ldyBOb3RGb3VuZEV4Y2VwdGlvbl8xJDEuZGVmYXVsdCgnQWxpZ25tZW50IHRvcCBleGNlZWRzIGVzdGltYXRlZCBtb2R1bGUgc2l6ZS4nKTsKCSAgICAgICAgfQoJICAgICAgICB2YXIgYWxpZ25tZW50QXJlYVRvcFkgPSBNYXRoLm1heCgwLCBlc3RBbGlnbm1lbnRZIC0gYWxsb3dhbmNlKTsKCSAgICAgICAgdmFyIGFsaWdubWVudEFyZWFCb3R0b21ZID0gTWF0aC5taW4odGhpcy5pbWFnZS5nZXRIZWlnaHQoKSAtIDEsIGVzdEFsaWdubWVudFkgKyBhbGxvd2FuY2UpOwoJICAgICAgICBpZiAoYWxpZ25tZW50QXJlYUJvdHRvbVkgLSBhbGlnbm1lbnRBcmVhVG9wWSA8IG92ZXJhbGxFc3RNb2R1bGVTaXplICogMykgewoJICAgICAgICAgICAgdGhyb3cgbmV3IE5vdEZvdW5kRXhjZXB0aW9uXzEkMS5kZWZhdWx0KCdBbGlnbm1lbnQgYm90dG9tIGV4Y2VlZHMgZXN0aW1hdGVkIG1vZHVsZSBzaXplLicpOwoJICAgICAgICB9CgkgICAgICAgIHZhciBhbGlnbm1lbnRGaW5kZXIgPSBuZXcgQWxpZ25tZW50UGF0dGVybkZpbmRlcl8xLmRlZmF1bHQodGhpcy5pbWFnZSwgYWxpZ25tZW50QXJlYUxlZnRYLCBhbGlnbm1lbnRBcmVhVG9wWSwgYWxpZ25tZW50QXJlYVJpZ2h0WCAtIGFsaWdubWVudEFyZWFMZWZ0WCwgYWxpZ25tZW50QXJlYUJvdHRvbVkgLSBhbGlnbm1lbnRBcmVhVG9wWSwgb3ZlcmFsbEVzdE1vZHVsZVNpemUsIHRoaXMucmVzdWx0UG9pbnRDYWxsYmFjayk7CgkgICAgICAgIHJldHVybiBhbGlnbm1lbnRGaW5kZXIuZmluZCgpOwoJICAgIH07CgkgICAgcmV0dXJuIERldGVjdG9yOwoJfSgpKTsKCURldGVjdG9yJDEuZGVmYXVsdCA9IERldGVjdG9yOwoKCS8qCgkgKiBDb3B5cmlnaHQgMjAwNyBaWGluZyBhdXRob3JzCgkgKgoJICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIik7CgkgKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCgkgKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKCSAqCgkgKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAoJICoKCSAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKCSAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCgkgKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4KCSAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKCSAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgoJICovCglPYmplY3QuZGVmaW5lUHJvcGVydHkoUVJDb2RlUmVhZGVyJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCS8qbmFtZXNwYWNlIGNvbS5nb29nbGUuenhpbmcucXJjb2RlIHsqLwoJdmFyIEJhcmNvZGVGb3JtYXRfMSA9IEJhcmNvZGVGb3JtYXQkMTsKCXZhciBCaXRNYXRyaXhfMSA9IEJpdE1hdHJpeCQxOwoJdmFyIERlY29kZUhpbnRUeXBlXzEgPSBEZWNvZGVIaW50VHlwZSQxOwoJdmFyIE5vdEZvdW5kRXhjZXB0aW9uXzEgPSBOb3RGb3VuZEV4Y2VwdGlvbiQxOwoJdmFyIFJlc3VsdF8xID0gUmVzdWx0JDE7Cgl2YXIgUmVzdWx0TWV0YWRhdGFUeXBlXzEgPSBSZXN1bHRNZXRhZGF0YVR5cGUkMTsKCS8vIGltcG9ydCBEZXRlY3RvclJlc3VsdCBmcm9tICcuLi9jb21tb24vRGV0ZWN0b3JSZXN1bHQnOwoJdmFyIERlY29kZXJfMSA9IERlY29kZXIkMTsKCXZhciBRUkNvZGVEZWNvZGVyTWV0YURhdGFfMSA9IFFSQ29kZURlY29kZXJNZXRhRGF0YSQxOwoJdmFyIERldGVjdG9yXzEgPSBEZXRlY3RvciQxOwoJLyppbXBvcnQgamF2YS51dGlsLkxpc3Q7Ki8KCS8qaW1wb3J0IGphdmEudXRpbC5NYXA7Ki8KCS8qKgoJICogVGhpcyBpbXBsZW1lbnRhdGlvbiBjYW4gZGV0ZWN0IGFuZCBkZWNvZGUgUVIgQ29kZXMgaW4gYW4gaW1hZ2UuCgkgKgoJICogQGF1dGhvciBTZWFuIE93ZW4KCSAqLwoJdmFyIFFSQ29kZVJlYWRlciA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHsKCSAgICBmdW5jdGlvbiBRUkNvZGVSZWFkZXIoKSB7CgkgICAgICAgIHRoaXMuZGVjb2RlciA9IG5ldyBEZWNvZGVyXzEuZGVmYXVsdCgpOwoJICAgIH0KCSAgICBRUkNvZGVSZWFkZXIucHJvdG90eXBlLmdldERlY29kZXIgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLmRlY29kZXI7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBMb2NhdGVzIGFuZCBkZWNvZGVzIGEgUVIgY29kZSBpbiBhbiBpbWFnZS4KCSAgICAgKgoJICAgICAqIEByZXR1cm4gYSByZXByZXNlbnRpbmc6IHN0cmluZyB0aGUgY29udGVudCBlbmNvZGVkIGJ5IHRoZSBRUiBjb2RlCgkgICAgICogQHRocm93cyBOb3RGb3VuZEV4Y2VwdGlvbiBpZiBhIFFSIGNvZGUgY2Fubm90IGJlIGZvdW5kCgkgICAgICogQHRocm93cyBGb3JtYXRFeGNlcHRpb24gaWYgYSBRUiBjb2RlIGNhbm5vdCBiZSBkZWNvZGVkCgkgICAgICogQHRocm93cyBDaGVja3N1bUV4Y2VwdGlvbiBpZiBlcnJvciBjb3JyZWN0aW9uIGZhaWxzCgkgICAgICovCgkgICAgLypAT3ZlcnJpZGUqLwoJICAgIC8vIHB1YmxpYyBkZWNvZGUoaW1hZ2U6IEJpbmFyeUJpdG1hcCk6IFJlc3VsdCAvKnRocm93cyBOb3RGb3VuZEV4Y2VwdGlvbiwgQ2hlY2tzdW1FeGNlcHRpb24sIEZvcm1hdEV4Y2VwdGlvbiAqLyB7CgkgICAgLy8gICByZXR1cm4gdGhpcy5kZWNvZGUoaW1hZ2UsIG51bGwpCgkgICAgLy8gfQoJICAgIC8qQE92ZXJyaWRlKi8KCSAgICBRUkNvZGVSZWFkZXIucHJvdG90eXBlLmRlY29kZSA9IGZ1bmN0aW9uIChpbWFnZSwgaGludHMpIHsKCSAgICAgICAgdmFyIGRlY29kZXJSZXN1bHQ7CgkgICAgICAgIHZhciBwb2ludHM7CgkgICAgICAgIGlmIChoaW50cyAhPT0gdW5kZWZpbmVkICYmIGhpbnRzICE9PSBudWxsICYmIHVuZGVmaW5lZCAhPT0gaGludHMuZ2V0KERlY29kZUhpbnRUeXBlXzEuZGVmYXVsdC5QVVJFX0JBUkNPREUpKSB7CgkgICAgICAgICAgICB2YXIgYml0cyA9IFFSQ29kZVJlYWRlci5leHRyYWN0UHVyZUJpdHMoaW1hZ2UuZ2V0QmxhY2tNYXRyaXgoKSk7CgkgICAgICAgICAgICBkZWNvZGVyUmVzdWx0ID0gdGhpcy5kZWNvZGVyLmRlY29kZUJpdE1hdHJpeChiaXRzLCBoaW50cyk7CgkgICAgICAgICAgICBwb2ludHMgPSBRUkNvZGVSZWFkZXIuTk9fUE9JTlRTOwoJICAgICAgICB9CgkgICAgICAgIGVsc2UgewoJICAgICAgICAgICAgdmFyIGRldGVjdG9yUmVzdWx0ID0gbmV3IERldGVjdG9yXzEuZGVmYXVsdChpbWFnZS5nZXRCbGFja01hdHJpeCgpKS5kZXRlY3QoaGludHMpOwoJICAgICAgICAgICAgZGVjb2RlclJlc3VsdCA9IHRoaXMuZGVjb2Rlci5kZWNvZGVCaXRNYXRyaXgoZGV0ZWN0b3JSZXN1bHQuZ2V0Qml0cygpLCBoaW50cyk7CgkgICAgICAgICAgICBwb2ludHMgPSBkZXRlY3RvclJlc3VsdC5nZXRQb2ludHMoKTsKCSAgICAgICAgfQoJICAgICAgICAvLyBJZiB0aGUgY29kZSB3YXMgbWlycm9yZWQ6IHN3YXAgdGhlIGJvdHRvbS1sZWZ0IGFuZCB0aGUgdG9wLXJpZ2h0IHBvaW50cy4KCSAgICAgICAgaWYgKGRlY29kZXJSZXN1bHQuZ2V0T3RoZXIoKSBpbnN0YW5jZW9mIFFSQ29kZURlY29kZXJNZXRhRGF0YV8xLmRlZmF1bHQpIHsKCSAgICAgICAgICAgIGRlY29kZXJSZXN1bHQuZ2V0T3RoZXIoKS5hcHBseU1pcnJvcmVkQ29ycmVjdGlvbihwb2ludHMpOwoJICAgICAgICB9CgkgICAgICAgIHZhciByZXN1bHQgPSBuZXcgUmVzdWx0XzEuZGVmYXVsdChkZWNvZGVyUmVzdWx0LmdldFRleHQoKSwgZGVjb2RlclJlc3VsdC5nZXRSYXdCeXRlcygpLCB1bmRlZmluZWQsIHBvaW50cywgQmFyY29kZUZvcm1hdF8xLmRlZmF1bHQuUVJfQ09ERSwgdW5kZWZpbmVkKTsKCSAgICAgICAgdmFyIGJ5dGVTZWdtZW50cyA9IGRlY29kZXJSZXN1bHQuZ2V0Qnl0ZVNlZ21lbnRzKCk7CgkgICAgICAgIGlmIChieXRlU2VnbWVudHMgIT09IG51bGwpIHsKCSAgICAgICAgICAgIHJlc3VsdC5wdXRNZXRhZGF0YShSZXN1bHRNZXRhZGF0YVR5cGVfMS5kZWZhdWx0LkJZVEVfU0VHTUVOVFMsIGJ5dGVTZWdtZW50cyk7CgkgICAgICAgIH0KCSAgICAgICAgdmFyIGVjTGV2ZWwgPSBkZWNvZGVyUmVzdWx0LmdldEVDTGV2ZWwoKTsKCSAgICAgICAgaWYgKGVjTGV2ZWwgIT09IG51bGwpIHsKCSAgICAgICAgICAgIHJlc3VsdC5wdXRNZXRhZGF0YShSZXN1bHRNZXRhZGF0YVR5cGVfMS5kZWZhdWx0LkVSUk9SX0NPUlJFQ1RJT05fTEVWRUwsIGVjTGV2ZWwpOwoJICAgICAgICB9CgkgICAgICAgIGlmIChkZWNvZGVyUmVzdWx0Lmhhc1N0cnVjdHVyZWRBcHBlbmQoKSkgewoJICAgICAgICAgICAgcmVzdWx0LnB1dE1ldGFkYXRhKFJlc3VsdE1ldGFkYXRhVHlwZV8xLmRlZmF1bHQuU1RSVUNUVVJFRF9BUFBFTkRfU0VRVUVOQ0UsIGRlY29kZXJSZXN1bHQuZ2V0U3RydWN0dXJlZEFwcGVuZFNlcXVlbmNlTnVtYmVyKCkpOwoJICAgICAgICAgICAgcmVzdWx0LnB1dE1ldGFkYXRhKFJlc3VsdE1ldGFkYXRhVHlwZV8xLmRlZmF1bHQuU1RSVUNUVVJFRF9BUFBFTkRfUEFSSVRZLCBkZWNvZGVyUmVzdWx0LmdldFN0cnVjdHVyZWRBcHBlbmRQYXJpdHkoKSk7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIHJlc3VsdDsKCSAgICB9OwoJICAgIC8qQE92ZXJyaWRlKi8KCSAgICBRUkNvZGVSZWFkZXIucHJvdG90eXBlLnJlc2V0ID0gZnVuY3Rpb24gKCkgewoJICAgICAgICAvLyBkbyBub3RoaW5nCgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBUaGlzIG1ldGhvZCBkZXRlY3RzIGEgY29kZSBpbiBhICJwdXJlIiBpbWFnZSAtLSB0aGF0IGlzLCBwdXJlIG1vbm9jaHJvbWUgaW1hZ2UKCSAgICAgKiB3aGljaCBjb250YWlucyBvbmx5IGFuIHVucm90YXRlZCwgdW5za2V3ZWQsIGltYWdlIG9mIGEgY29kZSwgd2l0aCBzb21lIHdoaXRlIGJvcmRlcgoJICAgICAqIGFyb3VuZCBpdC4gVGhpcyBpcyBhIHNwZWNpYWxpemVkIG1ldGhvZCB0aGF0IHdvcmtzIGV4Y2VwdGlvbmFsbHkgZmFzdCBpbiB0aGlzIHNwZWNpYWwKCSAgICAgKiBjYXNlLgoJICAgICAqCgkgICAgICogQHNlZSBjb20uZ29vZ2xlLnp4aW5nLmRhdGFtYXRyaXguRGF0YU1hdHJpeFJlYWRlciNleHRyYWN0UHVyZUJpdHMoQml0TWF0cml4KQoJICAgICAqLwoJICAgIFFSQ29kZVJlYWRlci5leHRyYWN0UHVyZUJpdHMgPSBmdW5jdGlvbiAoaW1hZ2UpIHsKCSAgICAgICAgdmFyIGxlZnRUb3BCbGFjayA9IGltYWdlLmdldFRvcExlZnRPbkJpdCgpOwoJICAgICAgICB2YXIgcmlnaHRCb3R0b21CbGFjayA9IGltYWdlLmdldEJvdHRvbVJpZ2h0T25CaXQoKTsKCSAgICAgICAgaWYgKGxlZnRUb3BCbGFjayA9PT0gbnVsbCB8fCByaWdodEJvdHRvbUJsYWNrID09PSBudWxsKSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgTm90Rm91bmRFeGNlcHRpb25fMS5kZWZhdWx0KCk7CgkgICAgICAgIH0KCSAgICAgICAgdmFyIG1vZHVsZVNpemUgPSB0aGlzLm1vZHVsZVNpemUobGVmdFRvcEJsYWNrLCBpbWFnZSk7CgkgICAgICAgIHZhciB0b3AgPSBsZWZ0VG9wQmxhY2tbMV07CgkgICAgICAgIHZhciBib3R0b20gPSByaWdodEJvdHRvbUJsYWNrWzFdOwoJICAgICAgICB2YXIgbGVmdCA9IGxlZnRUb3BCbGFja1swXTsKCSAgICAgICAgdmFyIHJpZ2h0ID0gcmlnaHRCb3R0b21CbGFja1swXTsKCSAgICAgICAgLy8gU2FuaXR5IGNoZWNrIQoJICAgICAgICBpZiAobGVmdCA+PSByaWdodCB8fCB0b3AgPj0gYm90dG9tKSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgTm90Rm91bmRFeGNlcHRpb25fMS5kZWZhdWx0KCk7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKGJvdHRvbSAtIHRvcCAhPT0gcmlnaHQgLSBsZWZ0KSB7CgkgICAgICAgICAgICAvLyBTcGVjaWFsIGNhc2UsIHdoZXJlIGJvdHRvbS1yaWdodCBtb2R1bGUgd2Fzbid0IGJsYWNrIHNvIHdlIGZvdW5kIHNvbWV0aGluZyBlbHNlIGluIHRoZSBsYXN0IHJvdwoJICAgICAgICAgICAgLy8gQXNzdW1lIGl0J3MgYSBzcXVhcmUsIHNvIHVzZSBoZWlnaHQgYXMgdGhlIHdpZHRoCgkgICAgICAgICAgICByaWdodCA9IGxlZnQgKyAoYm90dG9tIC0gdG9wKTsKCSAgICAgICAgICAgIGlmIChyaWdodCA+PSBpbWFnZS5nZXRXaWR0aCgpKSB7CgkgICAgICAgICAgICAgICAgLy8gQWJvcnQgaWYgdGhhdCB3b3VsZCBub3QgbWFrZSBzZW5zZSAtLSBvZmYgaW1hZ2UKCSAgICAgICAgICAgICAgICB0aHJvdyBuZXcgTm90Rm91bmRFeGNlcHRpb25fMS5kZWZhdWx0KCk7CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICAgICAgdmFyIG1hdHJpeFdpZHRoID0gTWF0aC5yb3VuZCgocmlnaHQgLSBsZWZ0ICsgMSkgLyBtb2R1bGVTaXplKTsKCSAgICAgICAgdmFyIG1hdHJpeEhlaWdodCA9IE1hdGgucm91bmQoKGJvdHRvbSAtIHRvcCArIDEpIC8gbW9kdWxlU2l6ZSk7CgkgICAgICAgIGlmIChtYXRyaXhXaWR0aCA8PSAwIHx8IG1hdHJpeEhlaWdodCA8PSAwKSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgTm90Rm91bmRFeGNlcHRpb25fMS5kZWZhdWx0KCk7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKG1hdHJpeEhlaWdodCAhPT0gbWF0cml4V2lkdGgpIHsKCSAgICAgICAgICAgIC8vIE9ubHkgcG9zc2libHkgZGVjb2RlIHNxdWFyZSByZWdpb25zCgkgICAgICAgICAgICB0aHJvdyBuZXcgTm90Rm91bmRFeGNlcHRpb25fMS5kZWZhdWx0KCk7CgkgICAgICAgIH0KCSAgICAgICAgLy8gUHVzaCBpbiB0aGUgImJvcmRlciIgYnkgaGFsZiB0aGUgbW9kdWxlIHdpZHRoIHNvIHRoYXQgd2Ugc3RhcnQKCSAgICAgICAgLy8gc2FtcGxpbmcgaW4gdGhlIG1pZGRsZSBvZiB0aGUgbW9kdWxlLiBKdXN0IGluIGNhc2UgdGhlIGltYWdlIGlzIGEKCSAgICAgICAgLy8gbGl0dGxlIG9mZiwgdGhpcyB3aWxsIGhlbHAgcmVjb3Zlci4KCSAgICAgICAgdmFyIG51ZGdlID0gLyooaW50KSAqLyBNYXRoLmZsb29yKG1vZHVsZVNpemUgLyAyLjApOwoJICAgICAgICB0b3AgKz0gbnVkZ2U7CgkgICAgICAgIGxlZnQgKz0gbnVkZ2U7CgkgICAgICAgIC8vIEJ1dCBjYXJlZnVsIHRoYXQgdGhpcyBkb2VzIG5vdCBzYW1wbGUgb2ZmIHRoZSBlZGdlCgkgICAgICAgIC8vICJyaWdodCIgaXMgdGhlIGZhcnRoZXN0LXJpZ2h0IHZhbGlkIHBpeGVsIGxvY2F0aW9uIC0tIHJpZ2h0KzEgaXMgbm90IG5lY2Vzc2FyaWx5CgkgICAgICAgIC8vIFRoaXMgaXMgcG9zaXRpdmUgYnkgaG93IG11Y2ggdGhlIGlubmVyIHggbG9vcCBiZWxvdyB3b3VsZCBiZSB0b28gbGFyZ2UKCSAgICAgICAgdmFyIG51ZGdlZFRvb0ZhclJpZ2h0ID0gbGVmdCArIC8qKGludCkgKi8gTWF0aC5mbG9vcigobWF0cml4V2lkdGggLSAxKSAqIG1vZHVsZVNpemUpIC0gcmlnaHQ7CgkgICAgICAgIGlmIChudWRnZWRUb29GYXJSaWdodCA+IDApIHsKCSAgICAgICAgICAgIGlmIChudWRnZWRUb29GYXJSaWdodCA+IG51ZGdlKSB7CgkgICAgICAgICAgICAgICAgLy8gTmVpdGhlciB3YXkgZml0czsgYWJvcnQKCSAgICAgICAgICAgICAgICB0aHJvdyBuZXcgTm90Rm91bmRFeGNlcHRpb25fMS5kZWZhdWx0KCk7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBsZWZ0IC09IG51ZGdlZFRvb0ZhclJpZ2h0OwoJICAgICAgICB9CgkgICAgICAgIC8vIFNlZSBsb2dpYyBhYm92ZQoJICAgICAgICB2YXIgbnVkZ2VkVG9vRmFyRG93biA9IHRvcCArIC8qKGludCkgKi8gTWF0aC5mbG9vcigobWF0cml4SGVpZ2h0IC0gMSkgKiBtb2R1bGVTaXplKSAtIGJvdHRvbTsKCSAgICAgICAgaWYgKG51ZGdlZFRvb0ZhckRvd24gPiAwKSB7CgkgICAgICAgICAgICBpZiAobnVkZ2VkVG9vRmFyRG93biA+IG51ZGdlKSB7CgkgICAgICAgICAgICAgICAgLy8gTmVpdGhlciB3YXkgZml0czsgYWJvcnQKCSAgICAgICAgICAgICAgICB0aHJvdyBuZXcgTm90Rm91bmRFeGNlcHRpb25fMS5kZWZhdWx0KCk7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICB0b3AgLT0gbnVkZ2VkVG9vRmFyRG93bjsKCSAgICAgICAgfQoJICAgICAgICAvLyBOb3cganVzdCByZWFkIG9mZiB0aGUgYml0cwoJICAgICAgICB2YXIgYml0cyA9IG5ldyBCaXRNYXRyaXhfMS5kZWZhdWx0KG1hdHJpeFdpZHRoLCBtYXRyaXhIZWlnaHQpOwoJICAgICAgICBmb3IgKHZhciB5ID0gMDsgeSA8IG1hdHJpeEhlaWdodDsgeSsrKSB7CgkgICAgICAgICAgICB2YXIgaU9mZnNldCA9IHRvcCArIC8qKGludCkgKi8gTWF0aC5mbG9vcih5ICogbW9kdWxlU2l6ZSk7CgkgICAgICAgICAgICBmb3IgKHZhciB4ID0gMDsgeCA8IG1hdHJpeFdpZHRoOyB4KyspIHsKCSAgICAgICAgICAgICAgICBpZiAoaW1hZ2UuZ2V0KGxlZnQgKyAvKihpbnQpICovIE1hdGguZmxvb3IoeCAqIG1vZHVsZVNpemUpLCBpT2Zmc2V0KSkgewoJICAgICAgICAgICAgICAgICAgICBiaXRzLnNldCh4LCB5KTsKCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIGJpdHM7CgkgICAgfTsKCSAgICBRUkNvZGVSZWFkZXIubW9kdWxlU2l6ZSA9IGZ1bmN0aW9uIChsZWZ0VG9wQmxhY2ssIGltYWdlKSB7CgkgICAgICAgIHZhciBoZWlnaHQgPSBpbWFnZS5nZXRIZWlnaHQoKTsKCSAgICAgICAgdmFyIHdpZHRoID0gaW1hZ2UuZ2V0V2lkdGgoKTsKCSAgICAgICAgdmFyIHggPSBsZWZ0VG9wQmxhY2tbMF07CgkgICAgICAgIHZhciB5ID0gbGVmdFRvcEJsYWNrWzFdOwoJICAgICAgICB2YXIgaW5CbGFjayA9IHRydWU7CgkgICAgICAgIHZhciB0cmFuc2l0aW9ucyA9IDA7CgkgICAgICAgIHdoaWxlICh4IDwgd2lkdGggJiYgeSA8IGhlaWdodCkgewoJICAgICAgICAgICAgaWYgKGluQmxhY2sgIT09IGltYWdlLmdldCh4LCB5KSkgewoJICAgICAgICAgICAgICAgIGlmICgrK3RyYW5zaXRpb25zID09PSA1KSB7CgkgICAgICAgICAgICAgICAgICAgIGJyZWFrOwoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICBpbkJsYWNrID0gIWluQmxhY2s7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICB4Kys7CgkgICAgICAgICAgICB5Kys7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKHggPT09IHdpZHRoIHx8IHkgPT09IGhlaWdodCkgewoJICAgICAgICAgICAgdGhyb3cgbmV3IE5vdEZvdW5kRXhjZXB0aW9uXzEuZGVmYXVsdCgpOwoJICAgICAgICB9CgkgICAgICAgIHJldHVybiAoeCAtIGxlZnRUb3BCbGFja1swXSkgLyA3LjA7CgkgICAgfTsKCSAgICBRUkNvZGVSZWFkZXIuTk9fUE9JTlRTID0gbmV3IEFycmF5KCk7CgkgICAgcmV0dXJuIFFSQ29kZVJlYWRlcjsKCX0oKSk7Cgl2YXIgX2RlZmF1bHQgPSBRUkNvZGVSZWFkZXIkMS5kZWZhdWx0ID0gUVJDb2RlUmVhZGVyOwoKCXZhciB0b0dyYXlzY2FsZUJ1ZmZlciA9IGZ1bmN0aW9uIHRvR3JheXNjYWxlQnVmZmVyKGltYWdlQnVmZmVyLCB3aWR0aCwgaGVpZ2h0KSB7CgkgIHZhciBncmF5c2NhbGVCdWZmZXIgPSBuZXcgVWludDhDbGFtcGVkQXJyYXkod2lkdGggKiBoZWlnaHQpOwoKCSAgZm9yICh2YXIgaSA9IDAsIGogPSAwLCBsZW5ndGhfMSA9IGltYWdlQnVmZmVyLmxlbmd0aDsgaSA8IGxlbmd0aF8xOyBpICs9IDQsIGorKykgewoJICAgIHZhciBncmF5ID0gdm9pZCAwOwoJICAgIHZhciBhbHBoYSA9IGltYWdlQnVmZmVyW2kgKyAzXTsgLy8gVGhlIGNvbG9yIG9mIGZ1bGx5LXRyYW5zcGFyZW50IHBpeGVscyBpcyBpcnJlbGV2YW50LiBUaGV5IGFyZSBvZnRlbiwgdGVjaG5pY2FsbHksIGZ1bGx5LXRyYW5zcGFyZW50CgkgICAgLy8gYmxhY2sgKDAgYWxwaGEsIGFuZCB0aGVuIDAgUkdCKS4gVGhleSBhcmUgb2Z0ZW4gdXNlZCwgb2YgY291cnNlIGFzIHRoZSAid2hpdGUiIGFyZWEgaW4gYQoJICAgIC8vIGJhcmNvZGUgaW1hZ2UuIEZvcmNlIGFueSBzdWNoIHBpeGVsIHRvIGJlIHdoaXRlOgoKCSAgICBpZiAoYWxwaGEgPT09IDApIHsKCSAgICAgIGdyYXkgPSAweEZGOwoJICAgIH0gZWxzZSB7CgkgICAgICB2YXIgcGl4ZWxSID0gaW1hZ2VCdWZmZXJbaV07CgkgICAgICB2YXIgcGl4ZWxHID0gaW1hZ2VCdWZmZXJbaSArIDFdOwoJICAgICAgdmFyIHBpeGVsQiA9IGltYWdlQnVmZmVyW2kgKyAyXTsgLy8gLjI5OVIgKyAwLjU4N0cgKyAwLjExNEIgKFlVVi9ZSVEgZm9yIFBBTCBhbmQgTlRTQyksCgkgICAgICAvLyAoMzA2KlIpID4+IDEwIGlzIGFwcHJveGltYXRlbHkgZXF1YWwgdG8gUiowLjI5OSwgYW5kIHNvIG9uLgoJICAgICAgLy8gMHgyMDAgPj4gMTAgaXMgMC41LCBpdCBpbXBsZW1lbnRzIHJvdW5kaW5nLgoKCSAgICAgIGdyYXkgPSAzMDYgKiBwaXhlbFIgKyA2MDEgKiBwaXhlbEcgKyAxMTcgKiBwaXhlbEIgKyAweDIwMCA+PiAxMDsKCSAgICB9CgoJICAgIGdyYXlzY2FsZUJ1ZmZlcltqXSA9IGdyYXk7CgkgIH0KCgkgIHJldHVybiBncmF5c2NhbGVCdWZmZXI7Cgl9OwoKCXZhciByZWFkZXIgPSBuZXcgX2RlZmF1bHQoKTsKCXNlbGYuYWRkRXZlbnRMaXN0ZW5lcignbWVzc2FnZScsIGZ1bmN0aW9uIChlKSB7CgkgIC8vIGVzbGludC1kaXNhYmxlLWxpbmUgbm8tcmVzdHJpY3RlZC1nbG9iYWxzCgkgIHRyeSB7CgkgICAgdmFyIGx1bWluYW5jZXMgPSB0b0dyYXlzY2FsZUJ1ZmZlcihlLmRhdGEuZGF0YSwgZS5kYXRhLndpZHRoLCBlLmRhdGEuaGVpZ2h0KTsKCSAgICB2YXIgbHVtaW5hbmNlU291cmNlID0gbmV3IF9kZWZhdWx0JDEobHVtaW5hbmNlcywgZS5kYXRhLndpZHRoLCBlLmRhdGEuaGVpZ2h0KTsKCSAgICB2YXIgaHlicmlkQmluYXJpemVyID0gbmV3IF9kZWZhdWx0JDIobHVtaW5hbmNlU291cmNlKTsKCSAgICB2YXIgYmluYXJ5Qml0bWFwID0gbmV3IF9kZWZhdWx0JDMoaHlicmlkQmluYXJpemVyKTsKCSAgICB2YXIgZGVjb2RlZCA9IHJlYWRlci5kZWNvZGUoYmluYXJ5Qml0bWFwKTsKCSAgICBwb3N0TWVzc2FnZShkZWNvZGVkKTsKCSAgfSBjYXRjaCAoZXJyKSB7CgkgICAgcG9zdE1lc3NhZ2UobnVsbCk7CgkgIH0KCX0pOwoKfSkoKTsKCg==",null,!1),P=["constraints","onError","onLoad","onScan","resolution","qrArea"];function O(g,I){var e=Object.keys(g);if(Object.getOwnPropertySymbols){var C=Object.getOwnPropertySymbols(g);I&&(C=C.filter((function(I){return Object.getOwnPropertyDescriptor(g,I).enumerable}))),e.push.apply(e,C)}return e}function q(g){for(var I=1;I<arguments.length;I++){var e=null!=arguments[I]?arguments[I]:{};I%2?O(Object(e),!0).forEach((function(I){l(g,I,e[I])})):Object.getOwnPropertyDescriptors?Object.defineProperties(g,Object.getOwnPropertyDescriptors(e)):O(Object(e)).forEach((function(I){Object.defineProperty(g,I,Object.getOwnPropertyDescriptor(e,I))}))}return g}var _=function(){return new j},$=function(g){g&&(g.getVideoTracks&&g.getAudioTracks?(g.getVideoTracks().forEach((function(I){g.removeTrack(I),I.stop()})),g.getAudioTracks().forEach((function(I){g.removeTrack(I),I.stop()}))):g.stop())},gg=function(g){var I=g.constraints,l=g.onError,n=g.onLoad,t=g.onScan,a=g.resolution,o=g.qrArea,A=i(g,P),c=e.useRef(null),d=e.useRef(null),u=e.useRef(document.createElement("canvas")),s=e.useRef(null),m=e.useRef(),b=r(e.useState(null),2),Z=b[0],G=b[1],y=e.useRef(!1),h=e.useRef();e.useEffect((function(){h.current=_();var g=h.current;return g.onmessage=function(g){t&&t(g.data?q(q({},g.data),{},{canvas:u.current}):null),y.current=!1},function(){g.terminate()}}),[t]);var B=JSON.stringify(o),p=e.useCallback((function(){var g=JSON.parse(B),I=h.current,e=d.current&&d.current.readyState===d.current.HAVE_ENOUGH_DATA;if(!y.current&&e){y.current=!0;var C,l=d.current.videoWidth,n=d.current.videoHeight,t=l>n?l:n,o=Math.floor(a/t*100)/100;n=Math.floor(o*n),l=Math.floor(o*l),u.current.width=l,u.current.height=n,s.current=u.current.getContext("2d"),s.current.drawImage(d.current,0,0,l,n),C=g&&2===g.length&&g[0]>0&&g[1]>0?s.current.getImageData(Math.floor((l-g[0])/2),Math.floor((n-g[1])/2),g[0],g[1]):s.current.getImageData(0,0,l,n),I.postMessage(C)}m.current=requestAnimationFrame(p)}),[a,B]),W=JSON.stringify(I);return e.useEffect((function(){var g=JSON.parse(W),I=!0;return navigator.mediaDevices.getUserMedia(g).then((function(g){if(I){c.current=g;try{d.current&&(d.current.srcObject=g,d.current.setAttribute("playsinline",!0))}catch(e){G(window.URL.createObjectURL(g))}n&&n(),m.current=requestAnimationFrame(p)}else $(g)})).catch((function(g){return I?l(g):null})),function(){cancelAnimationFrame(m.current),I=!1,$(c.current),Z&&window.URL.revokeObjectURL(Z)}}),[p,W,l,n,Z]),e.createElement("video",C({autoPlay:!0,playsInline:!0,src:Z,ref:d},A))};return gg.propTypes={constraints:M.object,onError:M.func.isRequired,onLoad:M.func,onScan:M.func.isRequired,resolution:M.number,qrArea:M.array},gg.defaultProps={constraints:{audio:!1,video:!0},resolution:640,qrArea:[]},gg}(e(784))},533:function(g,I,e){"use strict";var C=e(784),l=Symbol.for("react.element"),n=Symbol.for("react.fragment"),t=Object.prototype.hasOwnProperty,a=C.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,o={key:!0,ref:!0,__self:!0,__source:!0};function A(g,I,e){var C,n={},A=null,r=null;for(C in void 0!==e&&(A=""+e),void 0!==I.key&&(A=""+I.key),void 0!==I.ref&&(r=I.ref),I)t.call(I,C)&&!o.hasOwnProperty(C)&&(n[C]=I[C]);if(g&&g.defaultProps)for(C in I=g.defaultProps)void 0===n[C]&&(n[C]=I[C]);return{$$typeof:l,type:g,key:A,ref:r,props:n,_owner:a.current}}I.Fragment=n,I.jsx=A,I.jsxs=A},474:function(g,I){"use strict";var e=Symbol.for("react.element"),C=Symbol.for("react.portal"),l=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),t=Symbol.for("react.profiler"),a=Symbol.for("react.provider"),o=Symbol.for("react.context"),A=Symbol.for("react.forward_ref"),r=Symbol.for("react.suspense"),c=Symbol.for("react.memo"),i=Symbol.for("react.lazy"),d=Symbol.iterator;var u={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},s=Object.assign,m={};function b(g,I,e){this.props=g,this.context=I,this.refs=m,this.updater=e||u}function Z(){}function G(g,I,e){this.props=g,this.context=I,this.refs=m,this.updater=e||u}b.prototype.isReactComponent={},b.prototype.setState=function(g,I){if("object"!==typeof g&&"function"!==typeof g&&null!=g)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,g,I,"setState")},b.prototype.forceUpdate=function(g){this.updater.enqueueForceUpdate(this,g,"forceUpdate")},Z.prototype=b.prototype;var y=G.prototype=new Z;y.constructor=G,s(y,b.prototype),y.isPureReactComponent=!0;var h=Array.isArray,B=Object.prototype.hasOwnProperty,p={current:null},W={key:!0,ref:!0,__self:!0,__source:!0};function V(g,I,C){var l,n={},t=null,a=null;if(null!=I)for(l in void 0!==I.ref&&(a=I.ref),void 0!==I.key&&(t=""+I.key),I)B.call(I,l)&&!W.hasOwnProperty(l)&&(n[l]=I[l]);var o=arguments.length-2;if(1===o)n.children=C;else if(1<o){for(var A=Array(o),r=0;r<o;r++)A[r]=arguments[r+2];n.children=A}if(g&&g.defaultProps)for(l in o=g.defaultProps)void 0===n[l]&&(n[l]=o[l]);return{$$typeof:e,type:g,key:t,ref:a,props:n,_owner:p.current}}function S(g){return"object"===typeof g&&null!==g&&g.$$typeof===e}var v=/\/+/g;function f(g,I){return"object"===typeof g&&null!==g&&null!=g.key?function(g){var I={"=":"=0",":":"=2"};return"$"+g.replace(/[=:]/g,(function(g){return I[g]}))}(""+g.key):I.toString(36)}function R(g,I,l,n,t){var a=typeof g;"undefined"!==a&&"boolean"!==a||(g=null);var o=!1;if(null===g)o=!0;else switch(a){case"string":case"number":o=!0;break;case"object":switch(g.$$typeof){case e:case C:o=!0}}if(o)return t=t(o=g),g=""===n?"."+f(o,0):n,h(t)?(l="",null!=g&&(l=g.replace(v,"$&/")+"/"),R(t,I,l,"",(function(g){return g}))):null!=t&&(S(t)&&(t=function(g,I){return{$$typeof:e,type:g.type,key:I,ref:g.ref,props:g.props,_owner:g._owner}}(t,l+(!t.key||o&&o.key===t.key?"":(""+t.key).replace(v,"$&/")+"/")+g)),I.push(t)),1;if(o=0,n=""===n?".":n+":",h(g))for(var A=0;A<g.length;A++){var r=n+f(a=g[A],A);o+=R(a,I,l,r,t)}else if(r=function(g){return null===g||"object"!==typeof g?null:"function"===typeof(g=d&&g[d]||g["@@iterator"])?g:null}(g),"function"===typeof r)for(g=r.call(g),A=0;!(a=g.next()).done;)o+=R(a=a.value,I,l,r=n+f(a,A++),t);else if("object"===a)throw I=String(g),Error("Objects are not valid as a React child (found: "+("[object Object]"===I?"object with keys {"+Object.keys(g).join(", ")+"}":I)+"). If you meant to render a collection of children, use an array instead.");return o}function X(g,I,e){if(null==g)return g;var C=[],l=0;return R(g,C,"","",(function(g){return I.call(e,g,l++)})),C}function J(g){if(-1===g._status){var I=g._result;(I=I()).then((function(I){0!==g._status&&-1!==g._status||(g._status=1,g._result=I)}),(function(I){0!==g._status&&-1!==g._status||(g._status=2,g._result=I)})),-1===g._status&&(g._status=0,g._result=I)}if(1===g._status)return g._result.default;throw g._result}var k={current:null},Y={transition:null},H={ReactCurrentDispatcher:k,ReactCurrentBatchConfig:Y,ReactCurrentOwner:p};I.Children={map:X,forEach:function(g,I,e){X(g,(function(){I.apply(this,arguments)}),e)},count:function(g){var I=0;return X(g,(function(){I++})),I},toArray:function(g){return X(g,(function(g){return g}))||[]},only:function(g){if(!S(g))throw Error("React.Children.only expected to receive a single React element child.");return g}},I.Component=b,I.Fragment=l,I.Profiler=t,I.PureComponent=G,I.StrictMode=n,I.Suspense=r,I.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=H,I.cloneElement=function(g,I,C){if(null===g||void 0===g)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+g+".");var l=s({},g.props),n=g.key,t=g.ref,a=g._owner;if(null!=I){if(void 0!==I.ref&&(t=I.ref,a=p.current),void 0!==I.key&&(n=""+I.key),g.type&&g.type.defaultProps)var o=g.type.defaultProps;for(A in I)B.call(I,A)&&!W.hasOwnProperty(A)&&(l[A]=void 0===I[A]&&void 0!==o?o[A]:I[A])}var A=arguments.length-2;if(1===A)l.children=C;else if(1<A){o=Array(A);for(var r=0;r<A;r++)o[r]=arguments[r+2];l.children=o}return{$$typeof:e,type:g.type,key:n,ref:t,props:l,_owner:a}},I.createContext=function(g){return(g={$$typeof:o,_currentValue:g,_currentValue2:g,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null}).Provider={$$typeof:a,_context:g},g.Consumer=g},I.createElement=V,I.createFactory=function(g){var I=V.bind(null,g);return I.type=g,I},I.createRef=function(){return{current:null}},I.forwardRef=function(g){return{$$typeof:A,render:g}},I.isValidElement=S,I.lazy=function(g){return{$$typeof:i,_payload:{_status:-1,_result:g},_init:J}},I.memo=function(g,I){return{$$typeof:c,type:g,compare:void 0===I?null:I}},I.startTransition=function(g){var I=Y.transition;Y.transition={};try{g()}finally{Y.transition=I}},I.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")},I.useCallback=function(g,I){return k.current.useCallback(g,I)},I.useContext=function(g){return k.current.useContext(g)},I.useDebugValue=function(){},I.useDeferredValue=function(g){return k.current.useDeferredValue(g)},I.useEffect=function(g,I){return k.current.useEffect(g,I)},I.useId=function(){return k.current.useId()},I.useImperativeHandle=function(g,I,e){return k.current.useImperativeHandle(g,I,e)},I.useInsertionEffect=function(g,I){return k.current.useInsertionEffect(g,I)},I.useLayoutEffect=function(g,I){return k.current.useLayoutEffect(g,I)},I.useMemo=function(g,I){return k.current.useMemo(g,I)},I.useReducer=function(g,I,e){return k.current.useReducer(g,I,e)},I.useRef=function(g){return k.current.useRef(g)},I.useState=function(g){return k.current.useState(g)},I.useSyncExternalStore=function(g,I,e){return k.current.useSyncExternalStore(g,I,e)},I.useTransition=function(){return k.current.useTransition()},I.version="18.2.0"},784:function(g,I,e){"use strict";g.exports=e(474)},72:function(g,I,e){"use strict";g.exports=e(533)},245:function(g,I){"use strict";function e(g,I){var e=g.length;g.push(I);g:for(;0<e;){var C=e-1>>>1,l=g[C];if(!(0<n(l,I)))break g;g[C]=I,g[e]=l,e=C}}function C(g){return 0===g.length?null:g[0]}function l(g){if(0===g.length)return null;var I=g[0],e=g.pop();if(e!==I){g[0]=e;g:for(var C=0,l=g.length,t=l>>>1;C<t;){var a=2*(C+1)-1,o=g[a],A=a+1,r=g[A];if(0>n(o,e))A<l&&0>n(r,o)?(g[C]=r,g[A]=e,C=A):(g[C]=o,g[a]=e,C=a);else{if(!(A<l&&0>n(r,e)))break g;g[C]=r,g[A]=e,C=A}}}return I}function n(g,I){var e=g.sortIndex-I.sortIndex;return 0!==e?e:g.id-I.id}if("object"===typeof performance&&"function"===typeof performance.now){var t=performance;I.unstable_now=function(){return t.now()}}else{var a=Date,o=a.now();I.unstable_now=function(){return a.now()-o}}var A=[],r=[],c=1,i=null,d=3,u=!1,s=!1,m=!1,b="function"===typeof setTimeout?setTimeout:null,Z="function"===typeof clearTimeout?clearTimeout:null,G="undefined"!==typeof setImmediate?setImmediate:null;function y(g){for(var I=C(r);null!==I;){if(null===I.callback)l(r);else{if(!(I.startTime<=g))break;l(r),I.sortIndex=I.expirationTime,e(A,I)}I=C(r)}}function h(g){if(m=!1,y(g),!s)if(null!==C(A))s=!0,Y(B);else{var I=C(r);null!==I&&H(h,I.startTime-g)}}function B(g,e){s=!1,m&&(m=!1,Z(S),S=-1),u=!0;var n=d;try{for(y(e),i=C(A);null!==i&&(!(i.expirationTime>e)||g&&!R());){var t=i.callback;if("function"===typeof t){i.callback=null,d=i.priorityLevel;var a=t(i.expirationTime<=e);e=I.unstable_now(),"function"===typeof a?i.callback=a:i===C(A)&&l(A),y(e)}else l(A);i=C(A)}if(null!==i)var o=!0;else{var c=C(r);null!==c&&H(h,c.startTime-e),o=!1}return o}finally{i=null,d=n,u=!1}}"undefined"!==typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var p,W=!1,V=null,S=-1,v=5,f=-1;function R(){return!(I.unstable_now()-f<v)}function X(){if(null!==V){var g=I.unstable_now();f=g;var e=!0;try{e=V(!0,g)}finally{e?p():(W=!1,V=null)}}else W=!1}if("function"===typeof G)p=function(){G(X)};else if("undefined"!==typeof MessageChannel){var J=new MessageChannel,k=J.port2;J.port1.onmessage=X,p=function(){k.postMessage(null)}}else p=function(){b(X,0)};function Y(g){V=g,W||(W=!0,p())}function H(g,e){S=b((function(){g(I.unstable_now())}),e)}I.unstable_IdlePriority=5,I.unstable_ImmediatePriority=1,I.unstable_LowPriority=4,I.unstable_NormalPriority=3,I.unstable_Profiling=null,I.unstable_UserBlockingPriority=2,I.unstable_cancelCallback=function(g){g.callback=null},I.unstable_continueExecution=function(){s||u||(s=!0,Y(B))},I.unstable_forceFrameRate=function(g){0>g||125<g?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):v=0<g?Math.floor(1e3/g):5},I.unstable_getCurrentPriorityLevel=function(){return d},I.unstable_getFirstCallbackNode=function(){return C(A)},I.unstable_next=function(g){switch(d){case 1:case 2:case 3:var I=3;break;default:I=d}var e=d;d=I;try{return g()}finally{d=e}},I.unstable_pauseExecution=function(){},I.unstable_requestPaint=function(){},I.unstable_runWithPriority=function(g,I){switch(g){case 1:case 2:case 3:case 4:case 5:break;default:g=3}var e=d;d=g;try{return I()}finally{d=e}},I.unstable_scheduleCallback=function(g,l,n){var t=I.unstable_now();switch("object"===typeof n&&null!==n?n="number"===typeof(n=n.delay)&&0<n?t+n:t:n=t,g){case 1:var a=-1;break;case 2:a=250;break;case 5:a=1073741823;break;case 4:a=1e4;break;default:a=5e3}return g={id:c++,callback:l,priorityLevel:g,startTime:n,expirationTime:a=n+a,sortIndex:-1},n>t?(g.sortIndex=n,e(r,g),null===C(A)&&g===C(r)&&(m?(Z(S),S=-1):m=!0,H(h,n-t))):(g.sortIndex=a,e(A,g),s||u||(s=!0,Y(B))),g},I.unstable_shouldYield=R,I.unstable_wrapCallback=function(g){var I=d;return function(){var e=d;d=I;try{return g.apply(this,arguments)}finally{d=e}}}},969:function(g,I,e){"use strict";g.exports=e(245)},834:function(g){var I=/[A-Z\xc0-\xd6\xd8-\xde]?[a-z\xdf-\xf6\xf8-\xff]+(?:['\u2019](?:d|ll|m|re|s|t|ve))?(?=[\xac\xb1\xd7\xf7\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\xbf\u2000-\u206f \t\x0b\f\xa0\ufeff\n\r\u2028\u2029\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000]|[A-Z\xc0-\xd6\xd8-\xde]|$)|(?:[A-Z\xc0-\xd6\xd8-\xde]|[^\ud800-\udfff\xac\xb1\xd7\xf7\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\xbf\u2000-\u206f \t\x0b\f\xa0\ufeff\n\r\u2028\u2029\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\d+\u2700-\u27bfa-z\xdf-\xf6\xf8-\xffA-Z\xc0-\xd6\xd8-\xde])+(?:['\u2019](?:D|LL|M|RE|S|T|VE))?(?=[\xac\xb1\xd7\xf7\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\xbf\u2000-\u206f \t\x0b\f\xa0\ufeff\n\r\u2028\u2029\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000]|[A-Z\xc0-\xd6\xd8-\xde](?:[a-z\xdf-\xf6\xf8-\xff]|[^\ud800-\udfff\xac\xb1\xd7\xf7\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\xbf\u2000-\u206f \t\x0b\f\xa0\ufeff\n\r\u2028\u2029\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\d+\u2700-\u27bfa-z\xdf-\xf6\xf8-\xffA-Z\xc0-\xd6\xd8-\xde])|$)|[A-Z\xc0-\xd6\xd8-\xde]?(?:[a-z\xdf-\xf6\xf8-\xff]|[^\ud800-\udfff\xac\xb1\xd7\xf7\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\xbf\u2000-\u206f \t\x0b\f\xa0\ufeff\n\r\u2028\u2029\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\d+\u2700-\u27bfa-z\xdf-\xf6\xf8-\xffA-Z\xc0-\xd6\xd8-\xde])+(?:['\u2019](?:d|ll|m|re|s|t|ve))?|[A-Z\xc0-\xd6\xd8-\xde]+(?:['\u2019](?:D|LL|M|RE|S|T|VE))?|\d*(?:1ST|2ND|3RD|(?![123])\dTH)(?=\b|[a-z_])|\d*(?:1st|2nd|3rd|(?![123])\dth)(?=\b|[A-Z_])|\d+|(?:[\u2700-\u27bf]|(?:\ud83c[\udde6-\uddff]){2}|[\ud800-\udbff][\udc00-\udfff])[\ufe0e\ufe0f]?(?:[\u0300-\u036f\ufe20-\ufe2f\u20d0-\u20ff]|\ud83c[\udffb-\udfff])?(?:\u200d(?:[^\ud800-\udfff]|(?:\ud83c[\udde6-\uddff]){2}|[\ud800-\udbff][\udc00-\udfff])[\ufe0e\ufe0f]?(?:[\u0300-\u036f\ufe20-\ufe2f\u20d0-\u20ff]|\ud83c[\udffb-\udfff])?)*/g,e=function(g){return g.match(I)||[]},C=function(g){return g[0].toUpperCase()+g.slice(1)},l=function(g,I){return e(g).join(I).toLowerCase()},n=function(g){return e(g).reduce((function(g,I){return"".concat(g).concat(g?I[0].toUpperCase()+I.slice(1).toLowerCase():I.toLowerCase())}),"")};g.exports={words:e,upperFirst:C,camelCase:n,pascalCase:function(g){return C(n(g))},snakeCase:function(g){return l(g,"_")},kebabCase:function(g){return l(g,"-")},sentenceCase:function(g){return C(l(g," "))},titleCase:function(g){return e(g).map(C).join(" ")}}},12:function(g){function I(g,I){var e=g.length,C=new Array(e),l={},n=e,t=function(g){for(var I=new Map,e=0,C=g.length;e<C;e++){var l=g[e];I.has(l[0])||I.set(l[0],new Set),I.has(l[1])||I.set(l[1],new Set),I.get(l[0]).add(l[1])}return I}(I),a=function(g){for(var I=new Map,e=0,C=g.length;e<C;e++)I.set(g[e],e);return I}(g);for(I.forEach((function(g){if(!a.has(g[0])||!a.has(g[1]))throw new Error("Unknown node. There is an unknown node in the supplied edges.")}));n--;)l[n]||o(g[n],n,new Set);return C;function o(g,I,n){if(n.has(g)){var A;try{A=", node was:"+JSON.stringify(g)}catch(i){A=""}throw new Error("Cyclic dependency"+A)}if(!a.has(g))throw new Error("Found unknown node. Make sure to provided all involved nodes. Unknown node: "+JSON.stringify(g));if(!l[I]){l[I]=!0;var r=t.get(g)||new Set;if(I=(r=Array.from(r)).length){n.add(g);do{var c=r[--I];o(c,a.get(c),n)}while(I);n.delete(g)}C[--e]=g}}}g.exports=function(g){return I(function(g){for(var I=new Set,e=0,C=g.length;e<C;e++){var l=g[e];I.add(l[0]),I.add(l[1])}return Array.from(I)}(g),g)},g.exports.array=I}},I={};function e(C){var l=I[C];if(void 0!==l)return l.exports;var n=I[C]={exports:{}};return g[C].call(n.exports,n,n.exports,e),n.exports}e.n=function(g){var I=g&&g.__esModule?function(){return g.default}:function(){return g};return e.d(I,{a:I}),I},function(){var g,I=Object.getPrototypeOf?function(g){return Object.getPrototypeOf(g)}:function(g){return g.__proto__};e.t=function(C,l){if(1&l&&(C=this(C)),8&l)return C;if("object"===typeof C&&C){if(4&l&&C.__esModule)return C;if(16&l&&"function"===typeof C.then)return C}var n=Object.create(null);e.r(n);var t={};g=g||[null,I({}),I([]),I(I)];for(var a=2&l&&C;"object"==typeof a&&!~g.indexOf(a);a=I(a))Object.getOwnPropertyNames(a).forEach((function(g){t[g]=function(){return C[g]}}));return t.default=function(){return C},e.d(n,t),n}}(),e.d=function(g,I){for(var C in I)e.o(I,C)&&!e.o(g,C)&&Object.defineProperty(g,C,{enumerable:!0,get:I[C]})},e.o=function(g,I){return Object.prototype.hasOwnProperty.call(g,I)},e.r=function(g){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(g,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(g,"__esModule",{value:!0})},e.nc=void 0,function(){"use strict";var g={};e.r(g),e.d(g,{hasBrowserEnv:function(){return bn},hasStandardBrowserEnv:function(){return Zn},hasStandardBrowserWebWorkerEnv:function(){return Gn},origin:function(){return yn}});var I=e(784),C=e.t(I,2),l=e(898);function n(g){if(Array.isArray(g))return g}function t(g,I){(null==I||I>g.length)&&(I=g.length);for(var e=0,C=new Array(I);e<I;e++)C[e]=g[e];return C}function a(g,I){if(g){if("string"===typeof g)return t(g,I);var e=Object.prototype.toString.call(g).slice(8,-1);return"Object"===e&&g.constructor&&(e=g.constructor.name),"Map"===e||"Set"===e?Array.from(g):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?t(g,I):void 0}}function o(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function A(g,I){return n(g)||function(g,I){var e=null==g?null:"undefined"!=typeof Symbol&&g[Symbol.iterator]||g["@@iterator"];if(null!=e){var C,l,n,t,a=[],o=!0,A=!1;try{if(n=(e=e.call(g)).next,0===I){if(Object(e)!==e)return;o=!1}else for(;!(o=(C=n.call(e)).done)&&(a.push(C.value),a.length!==I);o=!0);}catch(r){A=!0,l=r}finally{try{if(!o&&null!=e.return&&(t=e.return(),Object(t)!==t))return}finally{if(A)throw l}}return a}}(g,I)||a(g,I)||o()}var r,c=e(274),i=e.t(c,2);function d(g){if("undefined"!==typeof Symbol&&null!=g[Symbol.iterator]||null!=g["@@iterator"])return Array.from(g)}function u(g){return function(g){if(Array.isArray(g))return t(g)}(g)||d(g)||a(g)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function s(g,I){if(!(g instanceof I))throw new TypeError("Cannot call a class as a function")}function m(g){return m="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(g){return typeof g}:function(g){return g&&"function"==typeof Symbol&&g.constructor===Symbol&&g!==Symbol.prototype?"symbol":typeof g},m(g)}function b(g){var I=function(g,I){if("object"!==m(g)||null===g)return g;var e=g[Symbol.toPrimitive];if(void 0!==e){var C=e.call(g,I||"default");if("object"!==m(C))return C;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===I?String:Number)(g)}(g,"string");return"symbol"===m(I)?I:String(I)}function Z(g,I){for(var e=0;e<I.length;e++){var C=I[e];C.enumerable=C.enumerable||!1,C.configurable=!0,"value"in C&&(C.writable=!0),Object.defineProperty(g,b(C.key),C)}}function G(g,I,e){return I&&Z(g.prototype,I),e&&Z(g,e),Object.defineProperty(g,"prototype",{writable:!1}),g}function y(g,I){return y=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(g,I){return g.__proto__=I,g},y(g,I)}function h(g,I){if("function"!==typeof I&&null!==I)throw new TypeError("Super expression must either be null or a function");g.prototype=Object.create(I&&I.prototype,{constructor:{value:g,writable:!0,configurable:!0}}),Object.defineProperty(g,"prototype",{writable:!1}),I&&y(g,I)}function B(g){return B=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(g){return g.__proto__||Object.getPrototypeOf(g)},B(g)}function p(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(g){return!1}}function W(g){if(void 0===g)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return g}function V(g,I){if(I&&("object"===m(I)||"function"===typeof I))return I;if(void 0!==I)throw new TypeError("Derived constructors may only return object or undefined");return W(g)}function S(g){var I=p();return function(){var e,C=B(g);if(I){var l=B(this).constructor;e=Reflect.construct(C,arguments,l)}else e=C.apply(this,arguments);return V(this,e)}}function v(g,I,e){return v=p()?Reflect.construct.bind():function(g,I,e){var C=[null];C.push.apply(C,I);var l=new(Function.bind.apply(g,C));return e&&y(l,e.prototype),l},v.apply(null,arguments)}function f(g){var I="function"===typeof Map?new Map:void 0;return f=function(g){if(null===g||(e=g,-1===Function.toString.call(e).indexOf("[native code]")))return g;var e;if("function"!==typeof g)throw new TypeError("Super expression must either be null or a function");if("undefined"!==typeof I){if(I.has(g))return I.get(g);I.set(g,C)}function C(){return v(g,arguments,B(this).constructor)}return C.prototype=Object.create(g.prototype,{constructor:{value:C,enumerable:!1,writable:!0,configurable:!0}}),y(C,g)},f(g)}function R(g){return n(g)||d(g)||a(g)||o()}function X(g,I){var e="undefined"!==typeof Symbol&&g[Symbol.iterator]||g["@@iterator"];if(!e){if(Array.isArray(g)||(e=a(g))||I&&g&&"number"===typeof g.length){e&&(g=e);var C=0,l=function(){};return{s:l,n:function(){return C>=g.length?{done:!0}:{done:!1,value:g[C++]}},e:function(g){throw g},f:l}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var n,t=!0,o=!1;return{s:function(){e=e.call(g)},n:function(){var g=e.next();return t=g.done,g},e:function(g){o=!0,n=g},f:function(){try{t||null==e.return||e.return()}finally{if(o)throw n}}}}function J(){return J=Object.assign?Object.assign.bind():function(g){for(var I=1;I<arguments.length;I++){var e=arguments[I];for(var C in e)Object.prototype.hasOwnProperty.call(e,C)&&(g[C]=e[C])}return g},J.apply(this,arguments)}!function(g){g.Pop="POP",g.Push="PUSH",g.Replace="REPLACE"}(r||(r={}));var k,Y="popstate";function H(g,I){if(!1===g||null===g||"undefined"===typeof g)throw new Error(I)}function w(g,I){if(!g){"undefined"!==typeof console&&console.warn(I);try{throw new Error(I)}catch(e){}}}function N(g,I){return{usr:g.state,key:g.key,idx:I}}function F(g,I,e,C){return void 0===e&&(e=null),J({pathname:"string"===typeof g?g:g.pathname,search:"",hash:""},"string"===typeof I?x(I):I,{state:e,key:I&&I.key||C||Math.random().toString(36).substr(2,8)})}function K(g){var I=g.pathname,e=void 0===I?"/":I,C=g.search,l=void 0===C?"":C,n=g.hash,t=void 0===n?"":n;return l&&"?"!==l&&(e+="?"===l.charAt(0)?l:"?"+l),t&&"#"!==t&&(e+="#"===t.charAt(0)?t:"#"+t),e}function x(g){var I={};if(g){var e=g.indexOf("#");e>=0&&(I.hash=g.substr(e),g=g.substr(0,e));var C=g.indexOf("?");C>=0&&(I.search=g.substr(C),g=g.substr(0,C)),g&&(I.pathname=g)}return I}function z(g,I,e,C){void 0===C&&(C={});var l=C,n=l.window,t=void 0===n?document.defaultView:n,a=l.v5Compat,o=void 0!==a&&a,A=t.history,c=r.Pop,i=null,d=u();function u(){return(A.state||{idx:null}).idx}function s(){c=r.Pop;var g=u(),I=null==g?null:g-d;d=g,i&&i({action:c,location:b.location,delta:I})}function m(g){var I="null"!==t.location.origin?t.location.origin:t.location.href,e="string"===typeof g?g:K(g);return H(I,"No window.location.(origin|href) available to create URL for href: "+(e=e.replace(/ $/,"%20"))),new URL(e,I)}null==d&&(d=0,A.replaceState(J({},A.state,{idx:d}),""));var b={get action(){return c},get location(){return g(t,A)},listen:function(g){if(i)throw new Error("A history only accepts one active listener");return t.addEventListener(Y,s),i=g,function(){t.removeEventListener(Y,s),i=null}},createHref:function(g){return I(t,g)},createURL:m,encodeLocation:function(g){var I=m(g);return{pathname:I.pathname,search:I.search,hash:I.hash}},push:function(g,I){c=r.Push;var C=F(b.location,g,I);e&&e(C,g);var l=N(C,d=u()+1),n=b.createHref(C);try{A.pushState(l,"",n)}catch(a){if(a instanceof DOMException&&"DataCloneError"===a.name)throw a;t.location.assign(n)}o&&i&&i({action:c,location:b.location,delta:1})},replace:function(g,I){c=r.Replace;var C=F(b.location,g,I);e&&e(C,g);var l=N(C,d=u()),n=b.createHref(C);A.replaceState(l,"",n),o&&i&&i({action:c,location:b.location,delta:0})},go:function(g){return A.go(g)}};return b}!function(g){g.data="data",g.deferred="deferred",g.redirect="redirect",g.error="error"}(k||(k={}));new Set(["lazy","caseSensitive","path","id","index","children"]);function E(g,I,e){return void 0===e&&(e="/"),U(g,I,e,!1)}function U(g,I,e,C){var l=eg(("string"===typeof I?x(I):I).pathname||"/",e);if(null==l)return null;var n=Q(g);!function(g){g.sort((function(g,I){return g.score!==I.score?I.score-g.score:function(g,I){var e=g.length===I.length&&g.slice(0,-1).every((function(g,e){return g===I[e]}));return e?g[g.length-1]-I[I.length-1]:0}(g.routesMeta.map((function(g){return g.childrenIndex})),I.routesMeta.map((function(g){return g.childrenIndex})))}))}(n);for(var t=null,a=0;null==t&&a<n.length;++a){var o=Ig(l);t=$(n[a],o,C)}return t}function Q(g,I,e,C){void 0===I&&(I=[]),void 0===e&&(e=[]),void 0===C&&(C="");var l=function(g,l,n){var t={relativePath:void 0===n?g.path||"":n,caseSensitive:!0===g.caseSensitive,childrenIndex:l,route:g};t.relativePath.startsWith("/")&&(H(t.relativePath.startsWith(C),'Absolute route path "'+t.relativePath+'" nested under path "'+C+'" is not valid. An absolute child route path must start with the combined path of all its parent routes.'),t.relativePath=t.relativePath.slice(C.length));var a=ag([C,t.relativePath]),o=e.concat(t);g.children&&g.children.length>0&&(H(!0!==g.index,'Index routes must not have child routes. Please remove all child routes from route path "'+a+'".'),Q(g.children,I,o,a)),(null!=g.path||g.index)&&I.push({path:a,score:_(a,g.index),routesMeta:o})};return g.forEach((function(g,I){var e;if(""!==g.path&&null!=(e=g.path)&&e.includes("?")){var C,n=X(M(g.path));try{for(n.s();!(C=n.n()).done;){var t=C.value;l(g,I,t)}}catch(a){n.e(a)}finally{n.f()}}else l(g,I)})),I}function M(g){var I=g.split("/");if(0===I.length)return[];var e=R(I),C=e[0],l=e.slice(1),n=C.endsWith("?"),t=C.replace(/\?$/,"");if(0===l.length)return n?[t,""]:[t];var a=M(l.join("/")),o=[];return o.push.apply(o,u(a.map((function(g){return""===g?t:[t,g].join("/")})))),n&&o.push.apply(o,u(a)),o.map((function(I){return g.startsWith("/")&&""===I?"/":I}))}var L=/^:[\w-]+$/,D=3,T=2,j=1,P=10,O=-2,q=function(g){return"*"===g};function _(g,I){var e=g.split("/"),C=e.length;return e.some(q)&&(C+=O),I&&(C+=T),e.filter((function(g){return!q(g)})).reduce((function(g,I){return g+(L.test(I)?D:""===I?j:P)}),C)}function $(g,I,e){void 0===e&&(e=!1);for(var C=g.routesMeta,l={},n="/",t=[],a=0;a<C.length;++a){var o=C[a],A=a===C.length-1,r="/"===n?I:I.slice(n.length)||"/",c=gg({path:o.relativePath,caseSensitive:o.caseSensitive,end:A},r),i=o.route;if(!c&&A&&e&&!C[C.length-1].route.index&&(c=gg({path:o.relativePath,caseSensitive:o.caseSensitive,end:!1},r)),!c)return null;Object.assign(l,c.params),t.push({params:l,pathname:ag([n,c.pathname]),pathnameBase:og(ag([n,c.pathnameBase])),route:i}),"/"!==c.pathnameBase&&(n=ag([n,c.pathnameBase]))}return t}function gg(g,I){"string"===typeof g&&(g={path:g,caseSensitive:!1,end:!0});var e=function(g,I,e){void 0===I&&(I=!1);void 0===e&&(e=!0);w("*"===g||!g.endsWith("*")||g.endsWith("/*"),'Route path "'+g+'" will be treated as if it were "'+g.replace(/\*$/,"/*")+'" because the `*` character must always follow a `/` in the pattern. To get rid of this warning, please change the route path to "'+g.replace(/\*$/,"/*")+'".');var C=[],l="^"+g.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(function(g,I,e){return C.push({paramName:I,isOptional:null!=e}),e?"/?([^\\/]+)?":"/([^\\/]+)"}));g.endsWith("*")?(C.push({paramName:"*"}),l+="*"===g||"/*"===g?"(.*)$":"(?:\\/(.+)|\\/*)$"):e?l+="\\/*$":""!==g&&"/"!==g&&(l+="(?:(?=\\/|$))");var n=new RegExp(l,I?void 0:"i");return[n,C]}(g.path,g.caseSensitive,g.end),C=A(e,2),l=C[0],n=C[1],t=I.match(l);if(!t)return null;var a=t[0],o=a.replace(/(.)\/+$/,"$1"),r=t.slice(1),c=n.reduce((function(g,I,e){var C=I.paramName,l=I.isOptional;if("*"===C){var n=r[e]||"";o=a.slice(0,a.length-n.length).replace(/(.)\/+$/,"$1")}var t=r[e];return g[C]=l&&!t?void 0:(t||"").replace(/%2F/g,"/"),g}),{});return{params:c,pathname:a,pathnameBase:o,pattern:g}}function Ig(g){try{return g.split("/").map((function(g){return decodeURIComponent(g).replace(/\//g,"%2F")})).join("/")}catch(I){return w(!1,'The URL path "'+g+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent encoding ('+I+")."),g}}function eg(g,I){if("/"===I)return g;if(!g.toLowerCase().startsWith(I.toLowerCase()))return null;var e=I.endsWith("/")?I.length-1:I.length,C=g.charAt(e);return C&&"/"!==C?null:g.slice(e)||"/"}function Cg(g,I,e,C){return"Cannot include a '"+g+"' character in a manually specified `to."+I+"` field ["+JSON.stringify(C)+"].  Please separate it out to the `to."+e+'` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.'}function lg(g){return g.filter((function(g,I){return 0===I||g.route.path&&g.route.path.length>0}))}function ng(g,I){var e=lg(g);return I?e.map((function(g,I){return I===e.length-1?g.pathname:g.pathnameBase})):e.map((function(g){return g.pathnameBase}))}function tg(g,I,e,C){var l;void 0===C&&(C=!1),"string"===typeof g?l=x(g):(H(!(l=J({},g)).pathname||!l.pathname.includes("?"),Cg("?","pathname","search",l)),H(!l.pathname||!l.pathname.includes("#"),Cg("#","pathname","hash",l)),H(!l.search||!l.search.includes("#"),Cg("#","search","hash",l)));var n,t=""===g||""===l.pathname,a=t?"/":l.pathname;if(null==a)n=e;else{var o=I.length-1;if(!C&&a.startsWith("..")){for(var A=a.split("/");".."===A[0];)A.shift(),o-=1;l.pathname=A.join("/")}n=o>=0?I[o]:"/"}var r=function(g,I){void 0===I&&(I="/");var e="string"===typeof g?x(g):g,C=e.pathname,l=e.search,n=void 0===l?"":l,t=e.hash,a=void 0===t?"":t,o=C?C.startsWith("/")?C:function(g,I){var e=I.replace(/\/+$/,"").split("/");return g.split("/").forEach((function(g){".."===g?e.length>1&&e.pop():"."!==g&&e.push(g)})),e.length>1?e.join("/"):"/"}(C,I):I;return{pathname:o,search:Ag(n),hash:rg(a)}}(l,n),c=a&&"/"!==a&&a.endsWith("/"),i=(t||"."===a)&&e.endsWith("/");return r.pathname.endsWith("/")||!c&&!i||(r.pathname+="/"),r}var ag=function(g){return g.join("/").replace(/\/\/+/g,"/")},og=function(g){return g.replace(/\/+$/,"").replace(/^\/*/,"/")},Ag=function(g){return g&&"?"!==g?g.startsWith("?")?g:"?"+g:""},rg=function(g){return g&&"#"!==g?g.startsWith("#")?g:"#"+g:""};var cg=function(g){h(e,g);var I=S(e);function e(){return s(this,e),I.apply(this,arguments)}return G(e)}(f(Error));function ig(g){return null!=g&&"number"===typeof g.status&&"string"===typeof g.statusText&&"boolean"===typeof g.internal&&"data"in g}var dg=["post","put","patch","delete"],ug=(new Set(dg),["get"].concat(dg));new Set(ug),new Set([301,302,303,307,308]),new Set([307,308]);Symbol("deferred");function sg(){return sg=Object.assign?Object.assign.bind():function(g){for(var I=1;I<arguments.length;I++){var e=arguments[I];for(var C in e)Object.prototype.hasOwnProperty.call(e,C)&&(g[C]=e[C])}return g},sg.apply(this,arguments)}var mg=I.createContext(null);var bg=I.createContext(null);var Zg=I.createContext(null);var Gg=I.createContext(null);var yg=I.createContext(null);var hg=I.createContext({outlet:null,matches:[],isDataRoute:!1});var Bg=I.createContext(null);function pg(){return null!=I.useContext(yg)}function Wg(){return pg()||H(!1),I.useContext(yg).location}function Vg(g){I.useContext(Gg).static||I.useLayoutEffect(g)}function Sg(){return I.useContext(hg).isDataRoute?function(){var g=Ng(Hg.UseNavigateStable).router,e=Kg(wg.UseNavigateStable),C=I.useRef(!1);Vg((function(){C.current=!0}));var l=I.useCallback((function(I,l){void 0===l&&(l={}),C.current&&("number"===typeof I?g.navigate(I):g.navigate(I,sg({fromRouteId:e},l)))}),[g,e]);return l}():function(){pg()||H(!1);var g=I.useContext(mg),e=I.useContext(Gg),C=e.basename,l=e.future,n=e.navigator,t=I.useContext(hg).matches,a=Wg().pathname,o=JSON.stringify(ng(t,l.v7_relativeSplatPath)),A=I.useRef(!1);Vg((function(){A.current=!0}));var r=I.useCallback((function(I,e){if(void 0===e&&(e={}),A.current)if("number"!==typeof I){var l=tg(I,JSON.parse(o),a,"path"===e.relative);null==g&&"/"!==C&&(l.pathname="/"===l.pathname?C:ag([C,l.pathname])),(e.replace?n.replace:n.push)(l,e.state,e)}else n.go(I)}),[C,n,o,a,g]);return r}()}function vg(g,e){var C=(void 0===e?{}:e).relative,l=I.useContext(Gg).future,n=I.useContext(hg).matches,t=Wg().pathname,a=JSON.stringify(ng(n,l.v7_relativeSplatPath));return I.useMemo((function(){return tg(g,JSON.parse(a),t,"path"===C)}),[g,a,t,C])}function fg(g,e,C,l){pg()||H(!1);var n,t=I.useContext(Gg).navigator,a=I.useContext(hg).matches,o=a[a.length-1],A=o?o.params:{},c=(o&&o.pathname,o?o.pathnameBase:"/"),i=(o&&o.route,Wg());if(e){var d,u="string"===typeof e?x(e):e;"/"===c||(null==(d=u.pathname)?void 0:d.startsWith(c))||H(!1),n=u}else n=i;var s=n.pathname||"/",m=s;if("/"!==c){var b=c.replace(/^\//,"").split("/");m="/"+s.replace(/^\//,"").split("/").slice(b.length).join("/")}var Z=E(g,{pathname:m});var G=Yg(Z&&Z.map((function(g){return Object.assign({},g,{params:Object.assign({},A,g.params),pathname:ag([c,t.encodeLocation?t.encodeLocation(g.pathname).pathname:g.pathname]),pathnameBase:"/"===g.pathnameBase?c:ag([c,t.encodeLocation?t.encodeLocation(g.pathnameBase).pathname:g.pathnameBase])})})),a,C,l);return e&&G?I.createElement(yg.Provider,{value:{location:sg({pathname:"/",search:"",hash:"",state:null,key:"default"},n),navigationType:r.Pop}},G):G}function Rg(){var g=function(){var g,e=I.useContext(Bg),C=Fg(wg.UseRouteError),l=Kg(wg.UseRouteError);if(void 0!==e)return e;return null==(g=C.errors)?void 0:g[l]}(),e=ig(g)?g.status+" "+g.statusText:g instanceof Error?g.message:JSON.stringify(g),C=g instanceof Error?g.stack:null,l="rgba(200,200,200, 0.5)",n={padding:"0.5rem",backgroundColor:l};return I.createElement(I.Fragment,null,I.createElement("h2",null,"Unexpected Application Error!"),I.createElement("h3",{style:{fontStyle:"italic"}},e),C?I.createElement("pre",{style:n},C):null,null)}var Xg=I.createElement(Rg,null),Jg=function(g){h(C,g);var e=S(C);function C(g){var I;return s(this,C),(I=e.call(this,g)).state={location:g.location,revalidation:g.revalidation,error:g.error},I}return G(C,[{key:"componentDidCatch",value:function(g,I){console.error("React Router caught the following error during render",g,I)}},{key:"render",value:function(){return void 0!==this.state.error?I.createElement(hg.Provider,{value:this.props.routeContext},I.createElement(Bg.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}],[{key:"getDerivedStateFromError",value:function(g){return{error:g}}},{key:"getDerivedStateFromProps",value:function(g,I){return I.location!==g.location||"idle"!==I.revalidation&&"idle"===g.revalidation?{error:g.error,location:g.location,revalidation:g.revalidation}:{error:void 0!==g.error?g.error:I.error,location:I.location,revalidation:g.revalidation||I.revalidation}}}]),C}(I.Component);function kg(g){var e=g.routeContext,C=g.match,l=g.children,n=I.useContext(mg);return n&&n.static&&n.staticContext&&(C.route.errorElement||C.route.ErrorBoundary)&&(n.staticContext._deepestRenderedBoundaryId=C.route.id),I.createElement(hg.Provider,{value:e},l)}function Yg(g,e,C,l){var n;if(void 0===e&&(e=[]),void 0===C&&(C=null),void 0===l&&(l=null),null==g){var t;if(!C)return null;if(C.errors)g=C.matches;else{if(!(null!=(t=l)&&t.v7_partialHydration&&0===e.length&&!C.initialized&&C.matches.length>0))return null;g=C.matches}}var a=g,o=null==(n=C)?void 0:n.errors;if(null!=o){var A=a.findIndex((function(g){return g.route.id&&void 0!==(null==o?void 0:o[g.route.id])}));A>=0||H(!1),a=a.slice(0,Math.min(a.length,A+1))}var r=!1,c=-1;if(C&&l&&l.v7_partialHydration)for(var i=0;i<a.length;i++){var d=a[i];if((d.route.HydrateFallback||d.route.hydrateFallbackElement)&&(c=i),d.route.id){var u=C,s=u.loaderData,m=u.errors,b=d.route.loader&&void 0===s[d.route.id]&&(!m||void 0===m[d.route.id]);if(d.route.lazy||b){r=!0,a=c>=0?a.slice(0,c+1):[a[0]];break}}}return a.reduceRight((function(g,l,n){var t,A,i=!1,d=null,u=null;C&&(t=o&&l.route.id?o[l.route.id]:void 0,d=l.route.errorElement||Xg,r&&(c<0&&0===n?(A="route-fallback",!1||xg[A]||(xg[A]=!0),i=!0,u=null):c===n&&(i=!0,u=l.route.hydrateFallbackElement||null)));var s=e.concat(a.slice(0,n+1)),m=function(){var e;return e=t?d:i?u:l.route.Component?I.createElement(l.route.Component,null):l.route.element?l.route.element:g,I.createElement(kg,{match:l,routeContext:{outlet:g,matches:s,isDataRoute:null!=C},children:e})};return C&&(l.route.ErrorBoundary||l.route.errorElement||0===n)?I.createElement(Jg,{location:C.location,revalidation:C.revalidation,component:d,error:t,children:m(),routeContext:{outlet:null,matches:s,isDataRoute:!0}}):m()}),null)}var Hg=function(g){return g.UseBlocker="useBlocker",g.UseRevalidator="useRevalidator",g.UseNavigateStable="useNavigate",g}(Hg||{}),wg=function(g){return g.UseBlocker="useBlocker",g.UseLoaderData="useLoaderData",g.UseActionData="useActionData",g.UseRouteError="useRouteError",g.UseNavigation="useNavigation",g.UseRouteLoaderData="useRouteLoaderData",g.UseMatches="useMatches",g.UseRevalidator="useRevalidator",g.UseNavigateStable="useNavigate",g.UseRouteId="useRouteId",g}(wg||{});function Ng(g){var e=I.useContext(mg);return e||H(!1),e}function Fg(g){var e=I.useContext(bg);return e||H(!1),e}function Kg(g){var e=function(g){var e=I.useContext(hg);return e||H(!1),e}(),C=e.matches[e.matches.length-1];return C.route.id||H(!1),C.route.id}var xg={};C.startTransition;function zg(g){var e=g.to,C=g.replace,l=g.state,n=g.relative;pg()||H(!1);var t=I.useContext(Gg),a=t.future,o=(t.static,I.useContext(hg).matches),A=Wg().pathname,r=Sg(),c=tg(e,ng(o,a.v7_relativeSplatPath),A,"path"===n),i=JSON.stringify(c);return I.useEffect((function(){return r(JSON.parse(i),{replace:C,state:l,relative:n})}),[r,i,n,C,l]),null}function Eg(g){H(!1)}function Ug(g){var e=g.basename,C=void 0===e?"/":e,l=g.children,n=void 0===l?null:l,t=g.location,a=g.navigationType,o=void 0===a?r.Pop:a,A=g.navigator,c=g.static,i=void 0!==c&&c,d=g.future;pg()&&H(!1);var u=C.replace(/^\/*/,"/"),s=I.useMemo((function(){return{basename:u,navigator:A,static:i,future:sg({v7_relativeSplatPath:!1},d)}}),[u,d,A,i]);"string"===typeof t&&(t=x(t));var m=t,b=m.pathname,Z=void 0===b?"/":b,G=m.search,y=void 0===G?"":G,h=m.hash,B=void 0===h?"":h,p=m.state,W=void 0===p?null:p,V=m.key,S=void 0===V?"default":V,v=I.useMemo((function(){var g=eg(Z,u);return null==g?null:{location:{pathname:g,search:y,hash:B,state:W,key:S},navigationType:o}}),[u,Z,y,B,W,S,o]);return null==v?null:I.createElement(Gg.Provider,{value:s},I.createElement(yg.Provider,{children:n,value:v}))}function Qg(g){var I=g.children,e=g.location;return fg(Dg(I),e)}var Mg=function(g){return g[g.pending=0]="pending",g[g.success=1]="success",g[g.error=2]="error",g}(Mg||{}),Lg=new Promise((function(){}));I.Component;function Dg(g,e){void 0===e&&(e=[]);var C=[];return I.Children.forEach(g,(function(g,l){if(I.isValidElement(g)){var n=[].concat(u(e),[l]);if(g.type!==I.Fragment){g.type!==Eg&&H(!1),g.props.index&&g.props.children&&H(!1);var t={id:g.props.id||n.join("-"),caseSensitive:g.props.caseSensitive,element:g.props.element,Component:g.props.Component,index:g.props.index,path:g.props.path,loader:g.props.loader,action:g.props.action,errorElement:g.props.errorElement,ErrorBoundary:g.props.ErrorBoundary,hasErrorBoundary:null!=g.props.ErrorBoundary||null!=g.props.errorElement,shouldRevalidate:g.props.shouldRevalidate,handle:g.props.handle,lazy:g.props.lazy};g.props.children&&(t.children=Dg(g.props.children,n)),C.push(t)}else C.push.apply(C,Dg(g.props.children,n))}})),C}function Tg(){return Tg=Object.assign?Object.assign.bind():function(g){for(var I=1;I<arguments.length;I++){var e=arguments[I];for(var C in e)Object.prototype.hasOwnProperty.call(e,C)&&(g[C]=e[C])}return g},Tg.apply(this,arguments)}function jg(g,I){if(null==g)return{};var e,C,l={},n=Object.keys(g);for(C=0;C<n.length;C++)e=n[C],I.indexOf(e)>=0||(l[e]=g[e]);return l}new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);var Pg=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","unstable_viewTransition"];try{window.__reactRouterVersion="6"}catch($Z){}new Map;var Og=C.startTransition;i.flushSync,C.useId;function qg(g){var e=g.basename,C=g.children,l=g.future,n=g.window,t=I.useRef();null==t.current&&(t.current=function(g){return void 0===g&&(g={}),z((function(g,I){var e=g.location;return F("",{pathname:e.pathname,search:e.search,hash:e.hash},I.state&&I.state.usr||null,I.state&&I.state.key||"default")}),(function(g,I){return"string"===typeof I?I:K(I)}),null,g)}({window:n,v5Compat:!0}));var a=t.current,o=A(I.useState({action:a.action,location:a.location}),2),r=o[0],c=o[1],i=(l||{}).v7_startTransition,d=I.useCallback((function(g){i&&Og?Og((function(){return c(g)})):c(g)}),[c,i]);return I.useLayoutEffect((function(){return a.listen(d)}),[a,d]),I.createElement(Ug,{basename:e,children:C,location:r.location,navigationType:r.action,navigator:a,future:l})}var _g="undefined"!==typeof window&&"undefined"!==typeof window.document&&"undefined"!==typeof window.document.createElement,$g=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,gI=I.forwardRef((function(g,e){var C,l=g.onClick,n=g.relative,t=g.reloadDocument,a=g.replace,o=g.state,A=g.target,r=g.to,c=g.preventScrollReset,i=g.unstable_viewTransition,d=jg(g,Pg),u=I.useContext(Gg).basename,s=!1;if("string"===typeof r&&$g.test(r)&&(C=r,_g))try{var m=new URL(window.location.href),b=r.startsWith("//")?new URL(m.protocol+r):new URL(r),Z=eg(b.pathname,u);b.origin===m.origin&&null!=Z?r=Z+b.search+b.hash:s=!0}catch($Z){}var G=function(g,e){var C=(void 0===e?{}:e).relative;pg()||H(!1);var l=I.useContext(Gg),n=l.basename,t=l.navigator,a=vg(g,{relative:C}),o=a.hash,A=a.pathname,r=a.search,c=A;return"/"!==n&&(c="/"===A?n:ag([n,A])),t.createHref({pathname:c,search:r,hash:o})}(r,{relative:n}),y=function(g,e){var C=void 0===e?{}:e,l=C.target,n=C.replace,t=C.state,a=C.preventScrollReset,o=C.relative,A=C.unstable_viewTransition,r=Sg(),c=Wg(),i=vg(g,{relative:o});return I.useCallback((function(I){if(function(g,I){return 0===g.button&&(!I||"_self"===I)&&!function(g){return!!(g.metaKey||g.altKey||g.ctrlKey||g.shiftKey)}(g)}(I,l)){I.preventDefault();var e=void 0!==n?n:K(c)===K(i);r(g,{replace:e,state:t,preventScrollReset:a,relative:o,unstable_viewTransition:A})}}),[c,r,i,n,t,l,g,a,o,A])}(r,{replace:a,state:o,target:A,preventScrollReset:c,relative:n,unstable_viewTransition:i});return I.createElement("a",Tg({},d,{href:C||G,onClick:s||t?l:function(g){l&&l(g),g.defaultPrevented||y(g)},ref:e,target:A}))}));var II,eI;(function(g){g.UseScrollRestoration="useScrollRestoration",g.UseSubmit="useSubmit",g.UseSubmitFetcher="useSubmitFetcher",g.UseFetcher="useFetcher",g.useViewTransitionState="useViewTransitionState"})(II||(II={})),function(g){g.UseFetcher="useFetcher",g.UseFetchers="useFetchers",g.UseScrollRestoration="useScrollRestoration"}(eI||(eI={}));var CI=e(72),lI=function(){return(0,CI.jsx)("div",{children:"About"})};function nI(g,I,e){return(I=b(I))in g?Object.defineProperty(g,I,{value:e,enumerable:!0,configurable:!0,writable:!0}):g[I]=e,g}function tI(g,I){var e=Object.keys(g);if(Object.getOwnPropertySymbols){var C=Object.getOwnPropertySymbols(g);I&&(C=C.filter((function(I){return Object.getOwnPropertyDescriptor(g,I).enumerable}))),e.push.apply(e,C)}return e}function aI(g){for(var I=1;I<arguments.length;I++){var e=null!=arguments[I]?arguments[I]:{};I%2?tI(Object(e),!0).forEach((function(I){nI(g,I,e[I])})):Object.getOwnPropertyDescriptors?Object.defineProperties(g,Object.getOwnPropertyDescriptors(e)):tI(Object(e)).forEach((function(I){Object.defineProperty(g,I,Object.getOwnPropertyDescriptor(e,I))}))}return g}function oI(){oI=function(){return g};var g={},I=Object.prototype,e=I.hasOwnProperty,C=Object.defineProperty||function(g,I,e){g[I]=e.value},l="function"==typeof Symbol?Symbol:{},n=l.iterator||"@@iterator",t=l.asyncIterator||"@@asyncIterator",a=l.toStringTag||"@@toStringTag";function o(g,I,e){return Object.defineProperty(g,I,{value:e,enumerable:!0,configurable:!0,writable:!0}),g[I]}try{o({},"")}catch(R){o=function(g,I,e){return g[I]=e}}function A(g,I,e,l){var n=I&&I.prototype instanceof i?I:i,t=Object.create(n.prototype),a=new S(l||[]);return C(t,"_invoke",{value:B(g,e,a)}),t}function r(g,I,e){try{return{type:"normal",arg:g.call(I,e)}}catch(R){return{type:"throw",arg:R}}}g.wrap=A;var c={};function i(){}function d(){}function u(){}var s={};o(s,n,(function(){return this}));var b=Object.getPrototypeOf,Z=b&&b(b(v([])));Z&&Z!==I&&e.call(Z,n)&&(s=Z);var G=u.prototype=i.prototype=Object.create(s);function y(g){["next","throw","return"].forEach((function(I){o(g,I,(function(g){return this._invoke(I,g)}))}))}function h(g,I){function l(C,n,t,a){var o=r(g[C],g,n);if("throw"!==o.type){var A=o.arg,c=A.value;return c&&"object"==m(c)&&e.call(c,"__await")?I.resolve(c.__await).then((function(g){l("next",g,t,a)}),(function(g){l("throw",g,t,a)})):I.resolve(c).then((function(g){A.value=g,t(A)}),(function(g){return l("throw",g,t,a)}))}a(o.arg)}var n;C(this,"_invoke",{value:function(g,e){function C(){return new I((function(I,C){l(g,e,I,C)}))}return n=n?n.then(C,C):C()}})}function B(g,I,e){var C="suspendedStart";return function(l,n){if("executing"===C)throw new Error("Generator is already running");if("completed"===C){if("throw"===l)throw n;return f()}for(e.method=l,e.arg=n;;){var t=e.delegate;if(t){var a=p(t,e);if(a){if(a===c)continue;return a}}if("next"===e.method)e.sent=e._sent=e.arg;else if("throw"===e.method){if("suspendedStart"===C)throw C="completed",e.arg;e.dispatchException(e.arg)}else"return"===e.method&&e.abrupt("return",e.arg);C="executing";var o=r(g,I,e);if("normal"===o.type){if(C=e.done?"completed":"suspendedYield",o.arg===c)continue;return{value:o.arg,done:e.done}}"throw"===o.type&&(C="completed",e.method="throw",e.arg=o.arg)}}}function p(g,I){var e=I.method,C=g.iterator[e];if(void 0===C)return I.delegate=null,"throw"===e&&g.iterator.return&&(I.method="return",I.arg=void 0,p(g,I),"throw"===I.method)||"return"!==e&&(I.method="throw",I.arg=new TypeError("The iterator does not provide a '"+e+"' method")),c;var l=r(C,g.iterator,I.arg);if("throw"===l.type)return I.method="throw",I.arg=l.arg,I.delegate=null,c;var n=l.arg;return n?n.done?(I[g.resultName]=n.value,I.next=g.nextLoc,"return"!==I.method&&(I.method="next",I.arg=void 0),I.delegate=null,c):n:(I.method="throw",I.arg=new TypeError("iterator result is not an object"),I.delegate=null,c)}function W(g){var I={tryLoc:g[0]};1 in g&&(I.catchLoc=g[1]),2 in g&&(I.finallyLoc=g[2],I.afterLoc=g[3]),this.tryEntries.push(I)}function V(g){var I=g.completion||{};I.type="normal",delete I.arg,g.completion=I}function S(g){this.tryEntries=[{tryLoc:"root"}],g.forEach(W,this),this.reset(!0)}function v(g){if(g){var I=g[n];if(I)return I.call(g);if("function"==typeof g.next)return g;if(!isNaN(g.length)){var C=-1,l=function I(){for(;++C<g.length;)if(e.call(g,C))return I.value=g[C],I.done=!1,I;return I.value=void 0,I.done=!0,I};return l.next=l}}return{next:f}}function f(){return{value:void 0,done:!0}}return d.prototype=u,C(G,"constructor",{value:u,configurable:!0}),C(u,"constructor",{value:d,configurable:!0}),d.displayName=o(u,a,"GeneratorFunction"),g.isGeneratorFunction=function(g){var I="function"==typeof g&&g.constructor;return!!I&&(I===d||"GeneratorFunction"===(I.displayName||I.name))},g.mark=function(g){return Object.setPrototypeOf?Object.setPrototypeOf(g,u):(g.__proto__=u,o(g,a,"GeneratorFunction")),g.prototype=Object.create(G),g},g.awrap=function(g){return{__await:g}},y(h.prototype),o(h.prototype,t,(function(){return this})),g.AsyncIterator=h,g.async=function(I,e,C,l,n){void 0===n&&(n=Promise);var t=new h(A(I,e,C,l),n);return g.isGeneratorFunction(e)?t:t.next().then((function(g){return g.done?g.value:t.next()}))},y(G),o(G,a,"Generator"),o(G,n,(function(){return this})),o(G,"toString",(function(){return"[object Generator]"})),g.keys=function(g){var I=Object(g),e=[];for(var C in I)e.push(C);return e.reverse(),function g(){for(;e.length;){var C=e.pop();if(C in I)return g.value=C,g.done=!1,g}return g.done=!0,g}},g.values=v,S.prototype={constructor:S,reset:function(g){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(V),!g)for(var I in this)"t"===I.charAt(0)&&e.call(this,I)&&!isNaN(+I.slice(1))&&(this[I]=void 0)},stop:function(){this.done=!0;var g=this.tryEntries[0].completion;if("throw"===g.type)throw g.arg;return this.rval},dispatchException:function(g){if(this.done)throw g;var I=this;function C(e,C){return t.type="throw",t.arg=g,I.next=e,C&&(I.method="next",I.arg=void 0),!!C}for(var l=this.tryEntries.length-1;l>=0;--l){var n=this.tryEntries[l],t=n.completion;if("root"===n.tryLoc)return C("end");if(n.tryLoc<=this.prev){var a=e.call(n,"catchLoc"),o=e.call(n,"finallyLoc");if(a&&o){if(this.prev<n.catchLoc)return C(n.catchLoc,!0);if(this.prev<n.finallyLoc)return C(n.finallyLoc)}else if(a){if(this.prev<n.catchLoc)return C(n.catchLoc,!0)}else{if(!o)throw new Error("try statement without catch or finally");if(this.prev<n.finallyLoc)return C(n.finallyLoc)}}}},abrupt:function(g,I){for(var C=this.tryEntries.length-1;C>=0;--C){var l=this.tryEntries[C];if(l.tryLoc<=this.prev&&e.call(l,"finallyLoc")&&this.prev<l.finallyLoc){var n=l;break}}n&&("break"===g||"continue"===g)&&n.tryLoc<=I&&I<=n.finallyLoc&&(n=null);var t=n?n.completion:{};return t.type=g,t.arg=I,n?(this.method="next",this.next=n.finallyLoc,c):this.complete(t)},complete:function(g,I){if("throw"===g.type)throw g.arg;return"break"===g.type||"continue"===g.type?this.next=g.arg:"return"===g.type?(this.rval=this.arg=g.arg,this.method="return",this.next="end"):"normal"===g.type&&I&&(this.next=I),c},finish:function(g){for(var I=this.tryEntries.length-1;I>=0;--I){var e=this.tryEntries[I];if(e.finallyLoc===g)return this.complete(e.completion,e.afterLoc),V(e),c}},catch:function(g){for(var I=this.tryEntries.length-1;I>=0;--I){var e=this.tryEntries[I];if(e.tryLoc===g){var C=e.completion;if("throw"===C.type){var l=C.arg;V(e)}return l}}throw new Error("illegal catch attempt")},delegateYield:function(g,I,e){return this.delegate={iterator:v(g),resultName:I,nextLoc:e},"next"===this.method&&(this.arg=void 0),c}},g}function AI(g,I,e,C,l,n,t){try{var a=g[n](t),o=a.value}catch(A){return void e(A)}a.done?I(o):Promise.resolve(o).then(C,l)}function rI(g){return function(){var I=this,e=arguments;return new Promise((function(C,l){var n=g.apply(I,e);function t(g){AI(n,C,l,t,a,"next",g)}function a(g){AI(n,C,l,t,a,"throw",g)}t(void 0)}))}}function cI(g,I){if(null==g)return{};var e,C,l=function(g,I){if(null==g)return{};var e,C,l={},n=Object.keys(g);for(C=0;C<n.length;C++)e=n[C],I.indexOf(e)>=0||(l[e]=g[e]);return l}(g,I);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(g);for(C=0;C<n.length;C++)e=n[C],I.indexOf(e)>=0||Object.prototype.propertyIsEnumerable.call(g,e)&&(l[e]=g[e])}return l}var iI=["name"],dI=["_f"],uI=["_f"],sI=["ref","message","type"],mI=function(g){return"checkbox"===g.type},bI=function(g){return g instanceof Date},ZI=function(g){return null==g},GI=function(g){return"object"===typeof g},yI=function(g){return!ZI(g)&&!Array.isArray(g)&&GI(g)&&!bI(g)},hI=function(g){return yI(g)&&g.target?mI(g.target)?g.target.checked:g.target.value:g},BI=function(g,I){return g.has(function(g){return g.substring(0,g.search(/\.\d+(\.|$)/))||g}(I))},pI=function(g){var I=g.constructor&&g.constructor.prototype;return yI(I)&&I.hasOwnProperty("isPrototypeOf")},WI="undefined"!==typeof window&&"undefined"!==typeof window.HTMLElement&&"undefined"!==typeof document;function VI(g){var I,e=Array.isArray(g);if(g instanceof Date)I=new Date(g);else if(g instanceof Set)I=new Set(g);else{if(WI&&(g instanceof Blob||g instanceof FileList)||!e&&!yI(g))return g;if(I=e?[]:{},e||pI(g))for(var C in g)g.hasOwnProperty(C)&&(I[C]=VI(g[C]));else I=g}return I}var SI=function(g){return Array.isArray(g)?g.filter(Boolean):[]},vI=function(g){return void 0===g},fI=function(g,I,e){if(!I||!yI(g))return e;var C=SI(I.split(/[,[\].]+?/)).reduce((function(g,I){return ZI(g)?g:g[I]}),g);return vI(C)||C===g?vI(g[I])?e:g[I]:C},RI=function(g){return"boolean"===typeof g},XI=function(g){return/^\w*$/.test(g)},JI=function(g){return SI(g.replace(/["|']|\]/g,"").split(/\.|\[/))},kI=function(g,I,e){for(var C=-1,l=XI(I)?[I]:JI(I),n=l.length,t=n-1;++C<n;){var a=l[C],o=e;if(C!==t){var A=g[a];o=yI(A)||Array.isArray(A)?A:isNaN(+l[C+1])?{}:[]}if("__proto__"===a)return;g[a]=o,g=g[a]}return g},YI={BLUR:"blur",FOCUS_OUT:"focusout",CHANGE:"change"},HI={onBlur:"onBlur",onChange:"onChange",onSubmit:"onSubmit",onTouched:"onTouched",all:"all"},wI="max",NI="min",FI="maxLength",KI="minLength",xI="pattern",zI="required",EI="validate",UI=(I.createContext(null),function(g,I,e){var C=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],l={defaultValues:I._defaultValues},n=function(n){Object.defineProperty(l,n,{get:function(){var l=n;return I._proxyFormState[l]!==HI.all&&(I._proxyFormState[l]=!C||HI.all),e&&(e[l]=!0),g[l]}})};for(var t in g)n(t);return l}),QI=function(g){return yI(g)&&!Object.keys(g).length},MI=function(g,I,e,C){e(g);g.name;var l=cI(g,iI);return QI(l)||Object.keys(l).length>=Object.keys(I).length||Object.keys(l).find((function(g){return I[g]===(!C||HI.all)}))},LI=function(g){return Array.isArray(g)?g:[g]};function DI(g){var e=I.useRef(g);e.current=g,I.useEffect((function(){var I=!g.disabled&&e.current.subject&&e.current.subject.subscribe({next:e.current.next});return function(){I&&I.unsubscribe()}}),[g.disabled])}var TI=function(g){return"string"===typeof g},jI=function(g,I,e,C,l){return TI(g)?(C&&I.watch.add(g),fI(e,g,l)):Array.isArray(g)?g.map((function(g){return C&&I.watch.add(g),fI(e,g)})):(C&&(I.watchAll=!0),e)};var PI=function(g,I,e,C,l){return I?aI(aI({},e[g]),{},{types:aI(aI({},e[g]&&e[g].types?e[g].types:{}),{},nI({},C,l||!0))}):{}},OI=function(g){return{isOnSubmit:!g||g===HI.onSubmit,isOnBlur:g===HI.onBlur,isOnChange:g===HI.onChange,isOnAll:g===HI.all,isOnTouch:g===HI.onTouched}},qI=function(g,I,e){return!e&&(I.watchAll||I.watch.has(g)||u(I.watch).some((function(I){return g.startsWith(I)&&/^\.\w+/.test(g.slice(I.length))})))},_I=function g(I,e,C,l){var n,t=X(C||Object.keys(I));try{for(t.s();!(n=t.n()).done;){var a=n.value,o=fI(I,a);if(o){var A=o._f,r=cI(o,dI);if(A){if(A.refs&&A.refs[0]&&e(A.refs[0],a)&&!l)break;if(A.ref&&e(A.ref,A.name)&&!l)break;g(r,e)}else yI(r)&&g(r,e)}}}catch(c){t.e(c)}finally{t.f()}},$I=function(g,I,e){var C=LI(fI(g,e));return kI(C,"root",I[e]),kI(g,e,C),g},ge=function(g){return"file"===g.type},Ie=function(g){return"function"===typeof g},ee=function(g){if(!WI)return!1;var I=g?g.ownerDocument:0;return g instanceof(I&&I.defaultView?I.defaultView.HTMLElement:HTMLElement)},Ce=function(g){return TI(g)},le=function(g){return"radio"===g.type},ne=function(g){return g instanceof RegExp},te={value:!1,isValid:!1},ae={value:!0,isValid:!0},oe=function(g){if(Array.isArray(g)){if(g.length>1){var I=g.filter((function(g){return g&&g.checked&&!g.disabled})).map((function(g){return g.value}));return{value:I,isValid:!!I.length}}return g[0].checked&&!g[0].disabled?g[0].attributes&&!vI(g[0].attributes.value)?vI(g[0].value)||""===g[0].value?ae:{value:g[0].value,isValid:!0}:ae:te}return te},Ae={isValid:!1,value:null},re=function(g){return Array.isArray(g)?g.reduce((function(g,I){return I&&I.checked&&!I.disabled?{isValid:!0,value:I.value}:g}),Ae):Ae};function ce(g,I){var e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"validate";if(Ce(g)||Array.isArray(g)&&g.every(Ce)||RI(g)&&!g)return{type:e,message:Ce(g)?g:"",ref:I}}var ie=function(g){return yI(g)&&!ne(g)?g:{value:g,message:""}},de=function(){var g=rI(oI().mark((function g(I,e,C,l,n){var t,a,o,A,r,c,i,d,u,s,m,b,Z,G,y,h,B,p,W,V,S,v,f,R,X,J,k,Y,H,w,N,F,K,x,z,E,U,Q,M,L,D,T,j,P,O,q,_,$;return oI().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:if(t=I._f,a=t.ref,o=t.refs,A=t.required,r=t.maxLength,c=t.minLength,i=t.min,d=t.max,u=t.pattern,s=t.validate,m=t.name,b=t.valueAsNumber,Z=t.mount,G=t.disabled,y=fI(e,m),Z&&!G){g.next=4;break}return g.abrupt("return",{});case 4:if(h=o?o[0]:a,B=function(g){l&&h.reportValidity&&(h.setCustomValidity(RI(g)?"":g||""),h.reportValidity())},p={},W=le(a),V=mI(a),S=W||V,v=(b||ge(a))&&vI(a.value)&&vI(y)||ee(a)&&""===a.value||""===y||Array.isArray(y)&&!y.length,f=PI.bind(null,m,C,p),R=function(g,I,e){var C=arguments.length>3&&void 0!==arguments[3]?arguments[3]:FI,l=arguments.length>4&&void 0!==arguments[4]?arguments[4]:KI,n=g?I:e;p[m]=aI({type:g?C:l,message:n,ref:a},f(g?C:l,n))},!(n?!Array.isArray(y)||!y.length:A&&(!S&&(v||ZI(y))||RI(y)&&!y||V&&!oe(o).isValid||W&&!re(o).isValid))){g.next=20;break}if(X=Ce(A)?{value:!!A,message:A}:ie(A),J=X.value,k=X.message,!J){g.next=20;break}if(p[m]=aI({type:zI,message:k,ref:h},f(zI,k)),C){g.next=20;break}return B(k),g.abrupt("return",p);case 20:if(v||ZI(i)&&ZI(d)){g.next=29;break}if(w=ie(d),N=ie(i),ZI(y)||isNaN(y)?(K=a.valueAsDate||new Date(y),x=function(g){return new Date((new Date).toDateString()+" "+g)},z="time"==a.type,E="week"==a.type,TI(w.value)&&y&&(Y=z?x(y)>x(w.value):E?y>w.value:K>new Date(w.value)),TI(N.value)&&y&&(H=z?x(y)<x(N.value):E?y<N.value:K<new Date(N.value))):(F=a.valueAsNumber||(y?+y:y),ZI(w.value)||(Y=F>w.value),ZI(N.value)||(H=F<N.value)),!Y&&!H){g.next=29;break}if(R(!!Y,w.message,N.message,wI,NI),C){g.next=29;break}return B(p[m].message),g.abrupt("return",p);case 29:if(!r&&!c||v||!(TI(y)||n&&Array.isArray(y))){g.next=39;break}if(U=ie(r),Q=ie(c),M=!ZI(U.value)&&y.length>+U.value,L=!ZI(Q.value)&&y.length<+Q.value,!M&&!L){g.next=39;break}if(R(M,U.message,Q.message),C){g.next=39;break}return B(p[m].message),g.abrupt("return",p);case 39:if(!u||v||!TI(y)){g.next=46;break}if(D=ie(u),T=D.value,j=D.message,!ne(T)||y.match(T)){g.next=46;break}if(p[m]=aI({type:xI,message:j,ref:a},f(xI,j)),C){g.next=46;break}return B(j),g.abrupt("return",p);case 46:if(!s){g.next=80;break}if(!Ie(s)){g.next=59;break}return g.next=50,s(y,e);case 50:if(P=g.sent,!(O=ce(P,h))){g.next=57;break}if(p[m]=aI(aI({},O),f(EI,O.message)),C){g.next=57;break}return B(O.message),g.abrupt("return",p);case 57:g.next=80;break;case 59:if(!yI(s)){g.next=80;break}q={},g.t0=oI().keys(s);case 62:if((g.t1=g.t0()).done){g.next=76;break}if(_=g.t1.value,QI(q)||C){g.next=66;break}return g.abrupt("break",76);case 66:return g.t2=ce,g.next=69,s[_](y,e);case 69:g.t3=g.sent,g.t4=h,g.t5=_,($=(0,g.t2)(g.t3,g.t4,g.t5))&&(q=aI(aI({},$),f(_,$.message)),B($.message),C&&(p[m]=q)),g.next=62;break;case 76:if(QI(q)){g.next=80;break}if(p[m]=aI({ref:h},q),C){g.next=80;break}return g.abrupt("return",p);case 80:return B(!0),g.abrupt("return",p);case 82:case"end":return g.stop()}}),g)})));return function(I,e,C,l,n){return g.apply(this,arguments)}}();function ue(g,I){var e=Array.isArray(I)?I:XI(I)?[I]:JI(I),C=1===e.length?g:function(g,I){for(var e=I.slice(0,-1).length,C=0;C<e;)g=vI(g)?C++:g[I[C++]];return g}(g,e),l=e.length-1,n=e[l];return C&&delete C[n],0!==l&&(yI(C)&&QI(C)||Array.isArray(C)&&function(g){for(var I in g)if(g.hasOwnProperty(I)&&!vI(g[I]))return!1;return!0}(C))&&ue(g,e.slice(0,-1)),g}var se=function(){var g=[];return{get observers(){return g},next:function(I){var e,C=X(g);try{for(C.s();!(e=C.n()).done;){var l=e.value;l.next&&l.next(I)}}catch(n){C.e(n)}finally{C.f()}},subscribe:function(I){return g.push(I),{unsubscribe:function(){g=g.filter((function(g){return g!==I}))}}},unsubscribe:function(){g=[]}}},me=function(g){return ZI(g)||!GI(g)};function be(g,I){if(me(g)||me(I))return g===I;if(bI(g)&&bI(I))return g.getTime()===I.getTime();var e=Object.keys(g),C=Object.keys(I);if(e.length!==C.length)return!1;for(var l=0,n=e;l<n.length;l++){var t=n[l],a=g[t];if(!C.includes(t))return!1;if("ref"!==t){var o=I[t];if(bI(a)&&bI(o)||yI(a)&&yI(o)||Array.isArray(a)&&Array.isArray(o)?!be(a,o):a!==o)return!1}}return!0}var Ze=function(g){return"select-multiple"===g.type},Ge=function(g){return le(g)||mI(g)},ye=function(g){return ee(g)&&g.isConnected},he=function(g){for(var I in g)if(Ie(g[I]))return!0;return!1};function Be(g){var I=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},e=Array.isArray(g);if(yI(g)||e)for(var C in g)Array.isArray(g[C])||yI(g[C])&&!he(g[C])?(I[C]=Array.isArray(g[C])?[]:{},Be(g[C],I[C])):ZI(g[C])||(I[C]=!0);return I}function pe(g,I,e){var C=Array.isArray(g);if(yI(g)||C)for(var l in g)Array.isArray(g[l])||yI(g[l])&&!he(g[l])?vI(I)||me(e[l])?e[l]=Array.isArray(g[l])?Be(g[l],[]):aI({},Be(g[l])):pe(g[l],ZI(I)?{}:I[l],e[l]):e[l]=!be(g[l],I[l]);return e}var We=function(g,I){return pe(g,I,Be(I))},Ve=function(g,I){var e=I.valueAsNumber,C=I.valueAsDate,l=I.setValueAs;return vI(g)?g:e?""===g?NaN:g?+g:g:C&&TI(g)?new Date(g):l?l(g):g};function Se(g){var I=g.ref;if(!(g.refs?g.refs.every((function(g){return g.disabled})):I.disabled))return ge(I)?I.files:le(I)?re(g.refs).value:Ze(I)?u(I.selectedOptions).map((function(g){return g.value})):mI(I)?oe(g.refs).value:Ve(vI(I.value)?g.ref.value:I.value,g)}var ve=function(g,I,e,C){var l,n={},t=X(g);try{for(t.s();!(l=t.n()).done;){var a=l.value,o=fI(I,a);o&&kI(n,a,o._f)}}catch(A){t.e(A)}finally{t.f()}return{criteriaMode:e,names:u(g),fields:n,shouldUseNativeValidation:C}},fe=function(g){return vI(g)?g:ne(g)?g.source:yI(g)?ne(g.value)?g.value.source:g.value:g},Re=function(g){return g.mount&&(g.required||g.min||g.max||g.maxLength||g.minLength||g.pattern||g.validate)};function Xe(g,I,e){var C=fI(g,e);if(C||XI(e))return{error:C,name:e};for(var l=e.split(".");l.length;){var n=l.join("."),t=fI(I,n),a=fI(g,n);if(t&&!Array.isArray(t)&&e!==n)return{name:e};if(a&&a.type)return{name:n,error:a};l.pop()}return{name:e}}var Je=function(g,I,e,C,l){return!l.isOnAll&&(!e&&l.isOnTouch?!(I||g):(e?C.isOnBlur:l.isOnBlur)?!g:!(e?C.isOnChange:l.isOnChange)||g)},ke=function(g,I){return!SI(fI(g,I)).length&&ue(g,I)},Ye={mode:HI.onSubmit,reValidateMode:HI.onChange,shouldFocusError:!0};function He(){var g,I=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=aI(aI({},Ye),I),C={submitCount:0,isDirty:!1,isLoading:Ie(e.defaultValues),isValidating:!1,isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,touchedFields:{},dirtyFields:{},validatingFields:{},errors:e.errors||{},disabled:e.disabled||!1},l={},n=(yI(e.defaultValues)||yI(e.values))&&VI(e.defaultValues||e.values)||{},t=e.shouldUnregister?{}:VI(n),a={action:!1,mount:!1,watch:!1},o={mount:new Set,unMount:new Set,array:new Set,watch:new Set},A=0,r={isDirty:!1,dirtyFields:!1,validatingFields:!1,touchedFields:!1,isValidating:!1,isValid:!1,errors:!1},c={values:se(),array:se(),state:se()},i=OI(e.mode),d=OI(e.reValidateMode),s=e.criteriaMode===HI.all,m=function(){var g=rI(oI().mark((function g(I){var n;return oI().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:if(!r.isValid&&!I){g.next=14;break}if(!e.resolver){g.next=9;break}return g.t1=QI,g.next=5,h();case 5:g.t2=g.sent.errors,g.t0=(0,g.t1)(g.t2),g.next=12;break;case 9:return g.next=11,p(l,!0);case 11:g.t0=g.sent;case 12:(n=g.t0)!==C.isValid&&c.state.next({isValid:n});case 14:case"end":return g.stop()}}),g)})));return function(I){return g.apply(this,arguments)}}(),b=function(g,I){(r.isValidating||r.validatingFields)&&((g||Array.from(o.mount)).forEach((function(g){g&&(I?kI(C.validatingFields,g,I):ue(C.validatingFields,g))})),c.state.next({validatingFields:C.validatingFields,isValidating:!QI(C.validatingFields)}))},Z=function(g,I,e,C){var o=fI(l,g);if(o){var A=fI(t,g,vI(e)?fI(n,g):e);vI(A)||C&&C.defaultChecked||I?kI(t,g,I?A:Se(o._f)):S(g,A),a.mount&&m()}},G=function(g,I,e,t,a){var o=!1,A=!1,i={name:g},d=!!(fI(l,g)&&fI(l,g)._f&&fI(l,g)._f.disabled);if(!e||t){r.isDirty&&(A=C.isDirty,C.isDirty=i.isDirty=W(),o=A!==i.isDirty);var u=d||be(fI(n,g),I);A=!(d||!fI(C.dirtyFields,g)),u||d?ue(C.dirtyFields,g):kI(C.dirtyFields,g,!0),i.dirtyFields=C.dirtyFields,o=o||r.dirtyFields&&A!==!u}if(e){var s=fI(C.touchedFields,g);s||(kI(C.touchedFields,g,e),i.touchedFields=C.touchedFields,o=o||r.touchedFields&&s!==e)}return o&&a&&c.state.next(i),o?i:{}},y=function(e,l,n,t){var a,o=fI(C.errors,e),i=r.isValid&&RI(l)&&C.isValid!==l;if(I.delayError&&n?(a=function(){return function(g,I){kI(C.errors,g,I),c.state.next({errors:C.errors})}(e,n)},(g=function(g){clearTimeout(A),A=setTimeout(a,g)})(I.delayError)):(clearTimeout(A),g=null,n?kI(C.errors,e,n):ue(C.errors,e)),(n?!be(o,n):o)||!QI(t)||i){var d=aI(aI(aI({},t),i&&RI(l)?{isValid:l}:{}),{},{errors:C.errors,name:e});C=aI(aI({},C),d),c.state.next(d)}},h=function(){var g=rI(oI().mark((function g(I){var C;return oI().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:return b(I,!0),g.next=3,e.resolver(t,e.context,ve(I||o.mount,l,e.criteriaMode,e.shouldUseNativeValidation));case 3:return C=g.sent,b(I),g.abrupt("return",C);case 6:case"end":return g.stop()}}),g)})));return function(I){return g.apply(this,arguments)}}(),B=function(){var g=rI(oI().mark((function g(I){var e,l,n,t,a,o;return oI().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:return g.next=2,h(I);case 2:if(e=g.sent,l=e.errors,I){n=X(I);try{for(n.s();!(t=n.n()).done;)a=t.value,(o=fI(l,a))?kI(C.errors,a,o):ue(C.errors,a)}catch(A){n.e(A)}finally{n.f()}}else C.errors=l;return g.abrupt("return",l);case 6:case"end":return g.stop()}}),g)})));return function(I){return g.apply(this,arguments)}}(),p=function(){var g=rI(oI().mark((function g(I,l){var n,a,A,r,c,i,d,u=arguments;return oI().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:n=u.length>2&&void 0!==u[2]?u[2]:{valid:!0},g.t0=oI().keys(I);case 2:if((g.t1=g.t0()).done){g.next=25;break}if(a=g.t1.value,!(A=I[a])){g.next=23;break}if(r=A._f,c=cI(A,uI),!r){g.next=19;break}return i=o.array.has(r.name),b([a],!0),g.next=12,de(A,t,s,e.shouldUseNativeValidation&&!l,i);case 12:if(d=g.sent,b([a]),!d[r.name]){g.next=18;break}if(n.valid=!1,!l){g.next=18;break}return g.abrupt("break",25);case 18:!l&&(fI(d,r.name)?i?$I(C.errors,d,r.name):kI(C.errors,r.name,d[r.name]):ue(C.errors,r.name));case 19:if(g.t2=!QI(c),!g.t2){g.next=23;break}return g.next=23,p(c,l,n);case 23:g.next=2;break;case 25:return g.abrupt("return",n.valid);case 26:case"end":return g.stop()}}),g)})));return function(I,e){return g.apply(this,arguments)}}(),W=function(g,I){return g&&I&&kI(t,g,I),!be(Y(),n)},V=function(g,I,e){return jI(g,o,aI({},a.mount?t:vI(I)?n:TI(g)?nI({},g,I):I),e,I)},S=function(g,I){var e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},C=fI(l,g),n=I;if(C){var a=C._f;a&&(!a.disabled&&kI(t,g,Ve(I,a)),n=ee(a.ref)&&ZI(I)?"":I,Ze(a.ref)?u(a.ref.options).forEach((function(g){return g.selected=n.includes(g.value)})):a.refs?mI(a.ref)?a.refs.length>1?a.refs.forEach((function(g){return(!g.defaultChecked||!g.disabled)&&(g.checked=Array.isArray(n)?!!n.find((function(I){return I===g.value})):n===g.value)})):a.refs[0]&&(a.refs[0].checked=!!n):a.refs.forEach((function(g){return g.checked=g.value===n})):ge(a.ref)?a.ref.value="":(a.ref.value=n,a.ref.type||c.values.next({name:g,values:aI({},t)})))}(e.shouldDirty||e.shouldTouch)&&G(g,n,e.shouldTouch,e.shouldDirty,!0),e.shouldValidate&&k(g)},v=function g(I,e,C){for(var n in e){var t=e[n],a="".concat(I,".").concat(n),A=fI(l,a);!o.array.has(I)&&me(t)&&(!A||A._f)||bI(t)?S(a,t,C):g(a,t,C)}},f=function(g,I){var e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},A=fI(l,g),i=o.array.has(g),d=VI(I);kI(t,g,d),i?(c.array.next({name:g,values:aI({},t)}),(r.isDirty||r.dirtyFields)&&e.shouldDirty&&c.state.next({name:g,dirtyFields:We(n,t),isDirty:W(g,d)})):!A||A._f||ZI(d)?S(g,d,e):v(g,d,e),qI(g,o)&&c.state.next(aI({},C)),c.values.next({name:a.mount?g:void 0,values:aI({},t)})},R=function(){var I=rI(oI().mark((function I(n){var A,u,Z,B,W,V,S,v,f,R,X,J,Y,H,w,N,F,K;return oI().wrap((function(I){for(;;)switch(I.prev=I.next){case 0:if(a.mount=!0,A=n.target,u=A.name,Z=!0,B=fI(l,u),W=function(){return A.type?Se(B._f):hI(n)},V=function(g){Z=Number.isNaN(g)||g===fI(t,u,g)},!B){I.next=47;break}if(f=W(),R=n.type===YI.BLUR||n.type===YI.FOCUS_OUT,X=!Re(B._f)&&!e.resolver&&!fI(C.errors,u)&&!B._f.deps||Je(R,fI(C.touchedFields,u),C.isSubmitted,d,i),J=qI(u,o,R),kI(t,u,f),R?(B._f.onBlur&&B._f.onBlur(n),g&&g(0)):B._f.onChange&&B._f.onChange(n),Y=G(u,f,R,!1),H=!QI(Y)||J,!R&&c.values.next({name:u,type:n.type,values:aI({},t)}),!X){I.next=20;break}return r.isValid&&m(),I.abrupt("return",H&&c.state.next(aI({name:u},J?{}:Y)));case 20:if(!R&&J&&c.state.next(aI({},C)),!e.resolver){I.next=30;break}return I.next=24,h([u]);case 24:w=I.sent,N=w.errors,V(f),Z&&(F=Xe(C.errors,l,u),K=Xe(N,l,F.name||u),S=K.error,u=K.name,v=QI(N)),I.next=46;break;case 30:return b([u],!0),I.next=33,de(B,t,s,e.shouldUseNativeValidation);case 33:if(I.t0=u,S=I.sent[I.t0],b([u]),V(f),!Z){I.next=46;break}if(!S){I.next=42;break}v=!1,I.next=46;break;case 42:if(!r.isValid){I.next=46;break}return I.next=45,p(l,!0);case 45:v=I.sent;case 46:Z&&(B._f.deps&&k(B._f.deps),y(u,v,S,Y));case 47:case"end":return I.stop()}}),I)})));return function(g){return I.apply(this,arguments)}}(),J=function(g,I){if(fI(C.errors,I)&&g.focus)return g.focus(),1},k=function(){var g=rI(oI().mark((function g(I){var n,t,a,A,i,d=arguments;return oI().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:if(n=d.length>1&&void 0!==d[1]?d[1]:{},A=LI(I),!e.resolver){g.next=10;break}return g.next=5,B(vI(I)?I:A);case 5:i=g.sent,t=QI(i),a=I?!A.some((function(g){return fI(i,g)})):t,g.next=20;break;case 10:if(!I){g.next=17;break}return g.next=13,Promise.all(A.map(function(){var g=rI(oI().mark((function g(I){var e;return oI().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:return e=fI(l,I),g.next=3,p(e&&e._f?nI({},I,e):e);case 3:return g.abrupt("return",g.sent);case 4:case"end":return g.stop()}}),g)})));return function(I){return g.apply(this,arguments)}}()));case 13:((a=g.sent.every(Boolean))||C.isValid)&&m(),g.next=20;break;case 17:return g.next=19,p(l);case 19:a=t=g.sent;case 20:return c.state.next(aI(aI(aI({},!TI(I)||r.isValid&&t!==C.isValid?{}:{name:I}),e.resolver||!I?{isValid:t}:{}),{},{errors:C.errors})),n.shouldFocus&&!a&&_I(l,J,I?A:o.mount),g.abrupt("return",a);case 23:case"end":return g.stop()}}),g)})));return function(I){return g.apply(this,arguments)}}(),Y=function(g){var I=aI({},a.mount?t:n);return vI(g)?I:TI(g)?fI(I,g):g.map((function(g){return fI(I,g)}))},H=function(g,I){return{invalid:!!fI((I||C).errors,g),isDirty:!!fI((I||C).dirtyFields,g),error:fI((I||C).errors,g),isValidating:!!fI(C.validatingFields,g),isTouched:!!fI((I||C).touchedFields,g)}},w=function(g,I,e){var n=(fI(l,g,{_f:{}})._f||{}).ref,t=fI(C.errors,g)||{},a=(t.ref,t.message,t.type,cI(t,sI));kI(C.errors,g,aI(aI(aI({},a),I),{},{ref:n})),c.state.next({name:g,errors:C.errors,isValid:!1}),e&&e.shouldFocus&&n&&n.focus&&n.focus()},N=function(g){var I,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},A=X(g?LI(g):o.mount);try{for(A.s();!(I=A.n()).done;){var r=I.value;o.mount.delete(r),o.array.delete(r),a.keepValue||(ue(l,r),ue(t,r)),!a.keepError&&ue(C.errors,r),!a.keepDirty&&ue(C.dirtyFields,r),!a.keepTouched&&ue(C.touchedFields,r),!a.keepIsValidating&&ue(C.validatingFields,r),!e.shouldUnregister&&!a.keepDefaultValue&&ue(n,r)}}catch(i){A.e(i)}finally{A.f()}c.values.next({values:aI({},t)}),c.state.next(aI(aI({},C),a.keepDirty?{isDirty:W()}:{})),!a.keepIsValid&&m()},F=function(g){var I=g.disabled,e=g.name,C=g.field,l=g.fields,n=g.value;if(RI(I)&&a.mount||I){var o=I?void 0:vI(n)?Se(C?C._f:fI(l,e)._f):n;kI(t,e,o),G(e,o,!1,!1,!0)}},K=function g(I){var C=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},t=fI(l,I),A=RI(C.disabled);return kI(l,I,aI(aI({},t||{}),{},{_f:aI(aI({},t&&t._f?t._f:{ref:{name:I}}),{},{name:I,mount:!0},C)})),o.mount.add(I),t?F({field:t,disabled:C.disabled,name:I,value:C.value}):Z(I,!0,C.value),aI(aI(aI({},A?{disabled:C.disabled}:{}),e.progressive?{required:!!C.required,min:fe(C.min),max:fe(C.max),minLength:fe(C.minLength),maxLength:fe(C.maxLength),pattern:fe(C.pattern)}:{}),{},{name:I,onChange:R,onBlur:R,ref:function(g){function I(I){return g.apply(this,arguments)}return I.toString=function(){return g.toString()},I}((function(A){if(A){g(I,C),t=fI(l,I);var r=vI(A.value)&&A.querySelectorAll&&A.querySelectorAll("input,select,textarea")[0]||A,c=Ge(r),i=t._f.refs||[];if(c?i.find((function(g){return g===r})):r===t._f.ref)return;kI(l,I,{_f:aI(aI({},t._f),c?{refs:[].concat(u(i.filter(ye)),[r],u(Array.isArray(fI(n,I))?[{}]:[])),ref:{type:r.type,name:I}}:{ref:r})}),Z(I,!1,void 0,r)}else(t=fI(l,I,{}))._f&&(t._f.mount=!1),(e.shouldUnregister||C.shouldUnregister)&&(!BI(o.array,I)||!a.action)&&o.unMount.add(I)}))})},x=function(){return e.shouldFocusError&&_I(l,J,o.mount)},z=function(g,I){return function(){var n=rI(oI().mark((function n(a){var o,A,r,i,d;return oI().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(o=void 0,a&&(a.preventDefault&&a.preventDefault(),a.persist&&a.persist()),A=VI(t),c.state.next({isSubmitting:!0}),!e.resolver){n.next=14;break}return n.next=7,h();case 7:r=n.sent,i=r.errors,d=r.values,C.errors=i,A=d,n.next=16;break;case 14:return n.next=16,p(l);case 16:if(ue(C.errors,"root"),!QI(C.errors)){n.next=29;break}return c.state.next({errors:{}}),n.prev=19,n.next=22,g(A,a);case 22:n.next=27;break;case 24:n.prev=24,n.t0=n.catch(19),o=n.t0;case 27:n.next=34;break;case 29:if(!I){n.next=32;break}return n.next=32,I(aI({},C.errors),a);case 32:x(),setTimeout(x);case 34:if(c.state.next({isSubmitted:!0,isSubmitting:!1,isSubmitSuccessful:QI(C.errors)&&!o,submitCount:C.submitCount+1,errors:C.errors}),!o){n.next=37;break}throw o;case 37:case"end":return n.stop()}}),n,null,[[19,24]])})));return function(g){return n.apply(this,arguments)}}()},E=function(g){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},A=g?VI(g):n,i=VI(A),d=QI(g),u=d?n:i;if(e.keepDefaultValues||(n=A),!e.keepValues){if(e.keepDirtyValues){var s,m=X(o.mount);try{for(m.s();!(s=m.n()).done;){var b=s.value;fI(C.dirtyFields,b)?kI(u,b,fI(t,b)):f(b,fI(u,b))}}catch(W){m.e(W)}finally{m.f()}}else{if(WI&&vI(g)){var Z,G=X(o.mount);try{for(G.s();!(Z=G.n()).done;){var y=Z.value,h=fI(l,y);if(h&&h._f){var B=Array.isArray(h._f.refs)?h._f.refs[0]:h._f.ref;if(ee(B)){var p=B.closest("form");if(p){p.reset();break}}}}}catch(W){G.e(W)}finally{G.f()}}l={}}t=I.shouldUnregister?e.keepDefaultValues?VI(n):{}:VI(u),c.array.next({values:aI({},u)}),c.values.next({values:aI({},u)})}o={mount:e.keepDirtyValues?o.mount:new Set,unMount:new Set,array:new Set,watch:new Set,watchAll:!1,focus:""},a.mount=!r.isValid||!!e.keepIsValid||!!e.keepDirtyValues,a.watch=!!I.shouldUnregister,c.state.next({submitCount:e.keepSubmitCount?C.submitCount:0,isDirty:!d&&(e.keepDirty?C.isDirty:!(!e.keepDefaultValues||be(g,n))),isSubmitted:!!e.keepIsSubmitted&&C.isSubmitted,dirtyFields:d?{}:e.keepDirtyValues?e.keepDefaultValues&&t?We(n,t):C.dirtyFields:e.keepDefaultValues&&g?We(n,g):e.keepDirty?C.dirtyFields:{},touchedFields:e.keepTouched?C.touchedFields:{},errors:e.keepErrors?C.errors:{},isSubmitSuccessful:!!e.keepIsSubmitSuccessful&&C.isSubmitSuccessful,isSubmitting:!1})},U=function(g,I){return E(Ie(g)?g(t):g,I)};return{control:{register:K,unregister:N,getFieldState:H,handleSubmit:z,setError:w,_executeSchema:h,_getWatch:V,_getDirty:W,_updateValid:m,_removeUnmounted:function(){var g,I=X(o.unMount);try{for(I.s();!(g=I.n()).done;){var e=g.value,C=fI(l,e);C&&(C._f.refs?C._f.refs.every((function(g){return!ye(g)})):!ye(C._f.ref))&&N(e)}}catch(n){I.e(n)}finally{I.f()}o.unMount=new Set},_updateFieldArray:function(g){var I=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],e=arguments.length>2?arguments[2]:void 0,o=arguments.length>3?arguments[3]:void 0,A=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],i=!(arguments.length>5&&void 0!==arguments[5])||arguments[5];if(o&&e){if(a.action=!0,i&&Array.isArray(fI(l,g))){var d=e(fI(l,g),o.argA,o.argB);A&&kI(l,g,d)}if(i&&Array.isArray(fI(C.errors,g))){var u=e(fI(C.errors,g),o.argA,o.argB);A&&kI(C.errors,g,u),ke(C.errors,g)}if(r.touchedFields&&i&&Array.isArray(fI(C.touchedFields,g))){var s=e(fI(C.touchedFields,g),o.argA,o.argB);A&&kI(C.touchedFields,g,s)}r.dirtyFields&&(C.dirtyFields=We(n,t)),c.state.next({name:g,isDirty:W(g,I),dirtyFields:C.dirtyFields,errors:C.errors,isValid:C.isValid})}else kI(t,g,I)},_updateDisabledField:F,_getFieldArray:function(g){return SI(fI(a.mount?t:n,g,I.shouldUnregister?fI(n,g,[]):[]))},_reset:E,_resetDefaultValues:function(){return Ie(e.defaultValues)&&e.defaultValues().then((function(g){U(g,e.resetOptions),c.state.next({isLoading:!1})}))},_updateFormState:function(g){C=aI(aI({},C),g)},_disableForm:function(g){RI(g)&&(c.state.next({disabled:g}),_I(l,(function(I,e){var C=fI(l,e);C&&(I.disabled=C._f.disabled||g,Array.isArray(C._f.refs)&&C._f.refs.forEach((function(I){I.disabled=C._f.disabled||g})))}),0,!1))},_subjects:c,_proxyFormState:r,_setErrors:function(g){C.errors=g,c.state.next({errors:C.errors,isValid:!1})},get _fields(){return l},get _formValues(){return t},get _state(){return a},set _state(g){a=g},get _defaultValues(){return n},get _names(){return o},set _names(g){o=g},get _formState(){return C},set _formState(g){C=g},get _options(){return e},set _options(g){e=aI(aI({},e),g)}},trigger:k,register:K,handleSubmit:z,watch:function(g,I){return Ie(g)?c.values.subscribe({next:function(e){return g(V(void 0,I),e)}}):V(g,I,!0)},setValue:f,getValues:Y,reset:U,resetField:function(g){var I=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};fI(l,g)&&(vI(I.defaultValue)?f(g,VI(fI(n,g))):(f(g,I.defaultValue),kI(n,g,VI(I.defaultValue))),I.keepTouched||ue(C.touchedFields,g),I.keepDirty||(ue(C.dirtyFields,g),C.isDirty=I.defaultValue?W(g,VI(fI(n,g))):W()),I.keepError||(ue(C.errors,g),r.isValid&&m()),c.state.next(aI({},C)))},clearErrors:function(g){g&&LI(g).forEach((function(g){return ue(C.errors,g)})),c.state.next({errors:g?C.errors:{}})},unregister:N,setError:w,setFocus:function(g){var I=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},e=fI(l,g),C=e&&e._f;if(C){var n=C.refs?C.refs[0]:C.ref;n.focus&&(n.focus(),I.shouldSelect&&n.select())}},getFieldState:H}}function we(){var g=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=I.useRef(),C=I.useRef(),l=A(I.useState({isDirty:!1,isValidating:!1,isLoading:Ie(g.defaultValues),isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,submitCount:0,dirtyFields:{},touchedFields:{},validatingFields:{},errors:g.errors||{},disabled:g.disabled||!1,defaultValues:Ie(g.defaultValues)?void 0:g.defaultValues}),2),n=l[0],t=l[1];e.current||(e.current=aI(aI({},He(g)),{},{formState:n}));var a=e.current.control;return a._options=g,DI({subject:a._subjects.state,next:function(g){MI(g,a._proxyFormState,a._updateFormState,!0)&&t(aI({},a._formState))}}),I.useEffect((function(){return a._disableForm(g.disabled)}),[a,g.disabled]),I.useEffect((function(){if(a._proxyFormState.isDirty){var g=a._getDirty();g!==n.isDirty&&a._subjects.state.next({isDirty:g})}}),[a,n.isDirty]),I.useEffect((function(){g.values&&!be(g.values,C.current)?(a._reset(g.values,a._options.resetOptions),C.current=g.values,t((function(g){return aI({},g)}))):a._resetDefaultValues()}),[g.values,a]),I.useEffect((function(){g.errors&&a._setErrors(g.errors)}),[g.errors,a]),I.useEffect((function(){a._state.mount||(a._updateValid(),a._state.mount=!0),a._state.watch&&(a._state.watch=!1,a._subjects.state.next(aI({},a._formState))),a._removeUnmounted()})),I.useEffect((function(){g.shouldUnregister&&a._subjects.values.next({values:a._getWatch()})}),[g.shouldUnregister,a]),e.current.formState=UI(n,a),e.current}var Ne=function(g,I,e){if(g&&"reportValidity"in g){var C=fI(e,I);g.setCustomValidity(C&&C.message||""),g.reportValidity()}},Fe=function(g,I){var e=function(e){var C=I.fields[e];C&&C.ref&&"reportValidity"in C.ref?Ne(C.ref,e,g):C.refs&&C.refs.forEach((function(I){return Ne(I,e,g)}))};for(var C in I.fields)e(C)},Ke=function(g,I){I.shouldUseNativeValidation&&Fe(g,I);var e={};for(var C in g){var l=fI(I.fields,C),n=Object.assign(g[C]||{},{ref:l&&l.ref});if(xe(I.names||Object.keys(g),C)){var t=Object.assign({},fI(e,C));kI(t,"root",n),kI(e,C,t)}else kI(e,C,n)}return e},xe=function(g,I){return g.some((function(g){return g.startsWith(I+".")}))};function ze(g,I,e){return void 0===I&&(I={}),void 0===e&&(e={}),function(C,l,n){try{return Promise.resolve(function(t,a){try{var o=(I.context,Promise.resolve(g["sync"===e.mode?"validateSync":"validate"](C,Object.assign({abortEarly:!1},I,{context:l}))).then((function(g){return n.shouldUseNativeValidation&&Fe({},n),{values:e.raw?C:g,errors:{}}})))}catch($Z){return a($Z)}return o&&o.then?o.then(void 0,a):o}(0,(function(g){if(!g.inner)throw g;return{values:{},errors:Ke((I=g,e=!n.shouldUseNativeValidation&&"all"===n.criteriaMode,(I.inner||[]).reduce((function(g,I){if(g[I.path]||(g[I.path]={message:I.message,type:I.type}),e){var C=g[I.path].types,l=C&&C[I.type];g[I.path]=PI(I.path,e,g,I.type,l?[].concat(l,I.message):I.message)}return g}),{})),n)};var I,e})))}catch($Z){return Promise.reject($Z)}}}function Ee(){return Ee="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(g,I,e){var C=function(g,I){for(;!Object.prototype.hasOwnProperty.call(g,I)&&null!==(g=B(g)););return g}(g,I);if(C){var l=Object.getOwnPropertyDescriptor(C,I);return l.get?l.get.call(arguments.length<3?g:e):l.value}},Ee.apply(this,arguments)}var Ue,Qe,Me,Le=e(25),De=e(834),Te=e(12),je=e.n(Te),Pe=Object.prototype.toString,Oe=Error.prototype.toString,qe=RegExp.prototype.toString,_e="undefined"!==typeof Symbol?Symbol.prototype.toString:function(){return""},$e=/^Symbol\((.*)\)(.*)$/;function gC(g){var I=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(null==g||!0===g||!1===g)return""+g;var e=typeof g;if("number"===e)return function(g){return g!=+g?"NaN":0===g&&1/g<0?"-0":""+g}(g);if("string"===e)return I?'"'.concat(g,'"'):g;if("function"===e)return"[Function "+(g.name||"anonymous")+"]";if("symbol"===e)return _e.call(g).replace($e,"Symbol($1)");var C=Pe.call(g).slice(8,-1);return"Date"===C?isNaN(g.getTime())?""+g:g.toISOString(g):"Error"===C||g instanceof Error?"["+Oe.call(g)+"]":"RegExp"===C?qe.call(g):null}function IC(g,I){var e=gC(g,I);return null!==e?e:JSON.stringify(g,(function(g,e){var C=gC(this[g],I);return null!==C?C:e}),2)}function eC(g){return null==g?[]:[].concat(g)}var CC=/\$\{\s*(\w+)\s*\}/g;Ue=Symbol.toStringTag;var lC=G((function g(I,e,C,l){var n=this;s(this,g),this.name=void 0,this.message=void 0,this.value=void 0,this.path=void 0,this.type=void 0,this.params=void 0,this.errors=void 0,this.inner=void 0,this[Ue]="Error",this.name="ValidationError",this.value=e,this.path=C,this.type=l,this.errors=[],this.inner=[],eC(I).forEach((function(g){if(nC.isError(g)){var I,e;(I=n.errors).push.apply(I,u(g.errors));var C=g.inner.length?g.inner:[g];(e=n.inner).push.apply(e,u(C))}else n.errors.push(g)})),this.message=this.errors.length>1?"".concat(this.errors.length," errors occurred"):this.errors[0]}));Qe=Symbol.hasInstance,Me=Symbol.toStringTag;var nC=function(g,I){h(C,g);var e=S(C);function C(g,I,l,n,t){var a;s(this,C);var o=new lC(g,I,l,n);return t?V(a,o):((a=e.call(this)).value=void 0,a.path=void 0,a.type=void 0,a.params=void 0,a.errors=[],a.inner=[],a[Me]="Error",a.name=o.name,a.message=o.message,a.type=o.type,a.value=o.value,a.path=o.path,a.errors=o.errors,a.inner=o.inner,Error.captureStackTrace&&Error.captureStackTrace(W(a),C),a)}return G(C,null,[{key:"formatError",value:function(g,I){var e=I.label||I.path||"this";return e!==I.path&&(I=Object.assign({},I,{path:e})),"string"===typeof g?g.replace(CC,(function(g,e){return IC(I[e])})):"function"===typeof g?g(I):g}},{key:"isError",value:function(g){return g&&"ValidationError"===g.name}},{key:I,value:function(g){return lC[Symbol.hasInstance](g)||Ee(B(C),Symbol.hasInstance,this).call(this,g)}}]),C}(f(Error),Qe),tC={default:"${path} is invalid",required:"${path} is a required field",defined:"${path} must be defined",notNull:"${path} cannot be null",oneOf:"${path} must be one of the following values: ${values}",notOneOf:"${path} must not be one of the following values: ${values}",notType:function(g){var I=g.path,e=g.type,C=g.value,l=g.originalValue,n=null!=l&&l!==C?" (cast from the value `".concat(IC(l,!0),"`)."):".";return"mixed"!==e?"".concat(I," must be a `").concat(e,"` type, ")+"but the final value was: `".concat(IC(C,!0),"`")+n:"".concat(I," must match the configured type. ")+"The validated value was: `".concat(IC(C,!0),"`")+n}},aC={length:"${path} must be exactly ${length} characters",min:"${path} must be at least ${min} characters",max:"${path} must be at most ${max} characters",matches:'${path} must match the following: "${regex}"',email:"${path} must be a valid email",url:"${path} must be a valid URL",uuid:"${path} must be a valid UUID",datetime:"${path} must be a valid ISO date-time",datetime_precision:"${path} must be a valid ISO date-time with a sub-second precision of exactly ${precision} digits",datetime_offset:'${path} must be a valid ISO date-time with UTC "Z" timezone',trim:"${path} must be a trimmed string",lowercase:"${path} must be a lowercase string",uppercase:"${path} must be a upper case string"},oC={min:"${path} must be greater than or equal to ${min}",max:"${path} must be less than or equal to ${max}",lessThan:"${path} must be less than ${less}",moreThan:"${path} must be greater than ${more}",positive:"${path} must be a positive number",negative:"${path} must be a negative number",integer:"${path} must be an integer"},AC={min:"${path} field must be later than ${min}",max:"${path} field must be at earlier than ${max}"},rC={isValue:"${path} field must be ${value}"},cC={noUnknown:"${path} field has unspecified keys: ${unknown}"},iC={min:"${path} field must have at least ${min} items",max:"${path} field must have less than or equal to ${max} items",length:"${path} must have ${length} items"},dC={notType:function(g){var I=g.path,e=g.value,C=g.spec.types.length;if(Array.isArray(e)){if(e.length<C)return"".concat(I," tuple value has too few items, expected a length of ").concat(C," but got ").concat(e.length," for value: `").concat(IC(e,!0),"`");if(e.length>C)return"".concat(I," tuple value has too many items, expected a length of ").concat(C," but got ").concat(e.length," for value: `").concat(IC(e,!0),"`")}return nC.formatError(tC.notType,g)}},uC=(Object.assign(Object.create(null),{mixed:tC,string:aC,number:oC,date:AC,object:cC,array:iC,boolean:rC,tuple:dC}),function(g){return g&&g.__isYupSchema__}),sC=function(){function g(I,e){s(this,g),this.fn=void 0,this.refs=I,this.refs=I,this.fn=e}return G(g,[{key:"resolve",value:function(g,I){var e=this.refs.map((function(g){return g.getValue(null==I?void 0:I.value,null==I?void 0:I.parent,null==I?void 0:I.context)})),C=this.fn(e,g,I);if(void 0===C||C===g)return g;if(!uC(C))throw new TypeError("conditions must return a schema object");return C.resolve(I)}}],[{key:"fromOptions",value:function(I,e){if(!e.then&&!e.otherwise)throw new TypeError("either `then:` or `otherwise:` is required for `when()` conditions");var C=e.is,l=e.then,n=e.otherwise,t="function"===typeof C?C:function(){for(var g=arguments.length,I=new Array(g),e=0;e<g;e++)I[e]=arguments[e];return I.every((function(g){return g===C}))};return new g(I,(function(g,I){var e,C=t.apply(void 0,u(g))?l:n;return null!=(e=null==C?void 0:C(I))?e:I}))}}]),g}(),mC="$",bC=".";var ZC=function(){function g(I){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(s(this,g),this.key=void 0,this.isContext=void 0,this.isValue=void 0,this.isSibling=void 0,this.path=void 0,this.getter=void 0,this.map=void 0,"string"!==typeof I)throw new TypeError("ref must be a string, got: "+I);if(this.key=I.trim(),""===I)throw new TypeError("ref must be a non-empty string");this.isContext=this.key[0]===mC,this.isValue=this.key[0]===bC,this.isSibling=!this.isContext&&!this.isValue;var C=this.isContext?mC:this.isValue?bC:"";this.path=this.key.slice(C.length),this.getter=this.path&&(0,Le.getter)(this.path,!0),this.map=e.map}return G(g,[{key:"getValue",value:function(g,I,e){var C=this.isContext?e:this.isValue?g:I;return this.getter&&(C=this.getter(C||{})),this.map&&(C=this.map(C)),C}},{key:"cast",value:function(g,I){return this.getValue(g,null==I?void 0:I.parent,null==I?void 0:I.context)}},{key:"resolve",value:function(){return this}},{key:"describe",value:function(){return{type:"ref",key:this.key}}},{key:"toString",value:function(){return"Ref(".concat(this.key,")")}}],[{key:"isRef",value:function(g){return g&&g.__isYupRef}}]),g}();ZC.prototype.__isYupRef=!0;var GC=function(g){return null==g};function yC(g){function I(I,e,C){var l=I.value,n=I.path,t=void 0===n?"":n,a=I.options,o=I.originalValue,A=I.schema,r=g.name,c=g.test,i=g.params,d=g.message,u=g.skipAbsent,s=a.parent,m=a.context,b=a.abortEarly,Z=void 0===b?A.spec.abortEarly:b,G=a.disableStackTrace,y=void 0===G?A.spec.disableStackTrace:G;function h(g){return ZC.isRef(g)?g.getValue(l,s,m):g}function B(){for(var g=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},I=Object.assign({value:l,originalValue:o,label:A.spec.label,path:g.path||t,spec:A.spec,disableStackTrace:g.disableStackTrace||y},i,g.params),e=0,C=Object.keys(I);e<C.length;e++){var n=C[e];I[n]=h(I[n])}var a=new nC(nC.formatError(g.message||d,I),l,I.path,g.type||r,I.disableStackTrace);return a.params=I,a}var p,W=Z?e:C,V={path:t,parent:s,type:r,from:a.from,createError:B,resolve:h,options:a,originalValue:o,schema:A},S=function(g){nC.isError(g)?W(g):g?C(null):W(B())},v=function(g){nC.isError(g)?W(g):e(g)};if(u&&GC(l))return S(!0);try{var f;if("function"===typeof(null==(f=p=c.call(V,l,V))?void 0:f.then)){if(a.sync)throw new Error('Validation test of type: "'.concat(V.type,'" returned a Promise during a synchronous validate. ')+"This test will finish after the validate call has returned");return Promise.resolve(p).then(S,v)}}catch(R){return void v(R)}S(p)}return I.OPTIONS=g,I}function hC(g,I,e){var C,l,n,t=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e;return I?((0,Le.forEach)(I,(function(a,o,A){var r=o?a.slice(1,a.length-1):a,c="tuple"===(g=g.resolve({context:t,parent:C,value:e})).type,i=A?parseInt(r,10):0;if(g.innerType||c){if(c&&!A)throw new Error('Yup.reach cannot implicitly index into a tuple type. the path part "'.concat(n,'" must contain an index to the tuple element, e.g. "').concat(n,'[0]"'));if(e&&i>=e.length)throw new Error("Yup.reach cannot resolve an array item at index: ".concat(a,", in the path: ").concat(I,". ")+"because there is no value at that index. ");C=e,e=e&&e[i],g=c?g.spec.types[i]:g.innerType}if(!A){if(!g.fields||!g.fields[r])throw new Error("The schema does not contain the path: ".concat(I,". ")+"(failed at: ".concat(n,' which is a type: "').concat(g.type,'")'));C=e,e=e&&e[r],g=g.fields[r]}l=r,n=o?"["+a+"]":"."+a})),{schema:g,parent:C,parentPath:l}):{parent:C,parentPath:I,schema:g}}var BC=function(g){h(e,g);var I=S(e);function e(){return s(this,e),I.apply(this,arguments)}return G(e,[{key:"describe",value:function(){var g,I=[],e=X(this.values());try{for(e.s();!(g=e.n()).done;){var C=g.value;I.push(ZC.isRef(C)?C.describe():C)}}catch(l){e.e(l)}finally{e.f()}return I}},{key:"resolveAll",value:function(g){var I,e=[],C=X(this.values());try{for(C.s();!(I=C.n()).done;){var l=I.value;e.push(g(l))}}catch(n){C.e(n)}finally{C.f()}return e}},{key:"clone",value:function(){return new e(this.values())}},{key:"merge",value:function(g,I){var e=this.clone();return g.forEach((function(g){return e.add(g)})),I.forEach((function(g){return e.delete(g)})),e}}]),e}(f(Set));function pC(g){var I,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Map;if(uC(g)||!g||"object"!==typeof g)return g;if(e.has(g))return e.get(g);if(g instanceof Date)I=new Date(g.getTime()),e.set(g,I);else if(g instanceof RegExp)I=new RegExp(g),e.set(g,I);else if(Array.isArray(g)){I=new Array(g.length),e.set(g,I);for(var C=0;C<g.length;C++)I[C]=pC(g[C],e)}else if(g instanceof Map){I=new Map,e.set(g,I);var l,n=X(g.entries());try{for(n.s();!(l=n.n()).done;){var t=A(l.value,2),a=t[0],o=t[1];I.set(a,pC(o,e))}}catch(Z){n.e(Z)}finally{n.f()}}else if(g instanceof Set){I=new Set,e.set(g,I);var r,c=X(g);try{for(c.s();!(r=c.n()).done;){var i=r.value;I.add(pC(i,e))}}catch(Z){c.e(Z)}finally{c.f()}}else{if(!(g instanceof Object))throw Error("Unable to clone ".concat(g));I={},e.set(g,I);for(var d=0,u=Object.entries(g);d<u.length;d++){var s=A(u[d],2),m=s[0],b=s[1];I[m]=pC(b,e)}}return I}var WC=function(){function g(I){var e=this;s(this,g),this.type=void 0,this.deps=[],this.tests=void 0,this.transforms=void 0,this.conditions=[],this._mutate=void 0,this.internalTests={},this._whitelist=new BC,this._blacklist=new BC,this.exclusiveTests=Object.create(null),this._typeCheck=void 0,this.spec=void 0,this.tests=[],this.transforms=[],this.withMutation((function(){e.typeError(tC.notType)})),this.type=I.type,this._typeCheck=I.check,this.spec=Object.assign({strip:!1,strict:!1,abortEarly:!0,recursive:!0,disableStackTrace:!1,nullable:!1,optional:!0,coerce:!0},null==I?void 0:I.spec),this.withMutation((function(g){g.nonNullable()}))}return G(g,[{key:"_type",get:function(){return this.type}},{key:"clone",value:function(g){if(this._mutate)return g&&Object.assign(this.spec,g),this;var I=Object.create(Object.getPrototypeOf(this));return I.type=this.type,I._typeCheck=this._typeCheck,I._whitelist=this._whitelist.clone(),I._blacklist=this._blacklist.clone(),I.internalTests=Object.assign({},this.internalTests),I.exclusiveTests=Object.assign({},this.exclusiveTests),I.deps=u(this.deps),I.conditions=u(this.conditions),I.tests=u(this.tests),I.transforms=u(this.transforms),I.spec=pC(Object.assign({},this.spec,g)),I}},{key:"label",value:function(g){var I=this.clone();return I.spec.label=g,I}},{key:"meta",value:function(){if(0===arguments.length)return this.spec.meta;var g=this.clone();return g.spec.meta=Object.assign(g.spec.meta||{},arguments.length<=0?void 0:arguments[0]),g}},{key:"withMutation",value:function(g){var I=this._mutate;this._mutate=!0;var e=g(this);return this._mutate=I,e}},{key:"concat",value:function(g){if(!g||g===this)return this;if(g.type!==this.type&&"mixed"!==this.type)throw new TypeError("You cannot `concat()` schema's of different types: ".concat(this.type," and ").concat(g.type));var I=this,e=g.clone(),C=Object.assign({},I.spec,e.spec);return e.spec=C,e.internalTests=Object.assign({},I.internalTests,e.internalTests),e._whitelist=I._whitelist.merge(g._whitelist,g._blacklist),e._blacklist=I._blacklist.merge(g._blacklist,g._whitelist),e.tests=I.tests,e.exclusiveTests=I.exclusiveTests,e.withMutation((function(I){g.tests.forEach((function(g){I.test(g.OPTIONS)}))})),e.transforms=[].concat(u(I.transforms),u(e.transforms)),e}},{key:"isType",value:function(g){return null==g?!(!this.spec.nullable||null!==g)||!(!this.spec.optional||void 0!==g):this._typeCheck(g)}},{key:"resolve",value:function(g){var I=this;if(I.conditions.length){var e=I.conditions;(I=I.clone()).conditions=[],I=(I=e.reduce((function(I,e){return e.resolve(I,g)}),I)).resolve(g)}return I}},{key:"resolveOptions",value:function(g){var I,e,C,l;return Object.assign({},g,{from:g.from||[],strict:null!=(I=g.strict)?I:this.spec.strict,abortEarly:null!=(e=g.abortEarly)?e:this.spec.abortEarly,recursive:null!=(C=g.recursive)?C:this.spec.recursive,disableStackTrace:null!=(l=g.disableStackTrace)?l:this.spec.disableStackTrace})}},{key:"cast",value:function(g){var I=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},e=this.resolve(Object.assign({value:g},I)),C="ignore-optionality"===I.assert,l=e._cast(g,I);if(!1!==I.assert&&!e.isType(l)){if(C&&GC(l))return l;var n=IC(g),t=IC(l);throw new TypeError("The value of ".concat(I.path||"field"," could not be cast to a value ")+'that satisfies the schema type: "'.concat(e.type,'". \n\n')+"attempted value: ".concat(n," \n")+(t!==n?"result of cast: ".concat(t):""))}return l}},{key:"_cast",value:function(g,I){var e=this,C=void 0===g?g:this.transforms.reduce((function(I,C){return C.call(e,I,g,e)}),g);return void 0===C&&(C=this.getDefault(I)),C}},{key:"_validate",value:function(g){var I=this,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},C=arguments.length>2?arguments[2]:void 0,l=arguments.length>3?arguments[3]:void 0,n=e.path,t=e.originalValue,a=void 0===t?g:t,o=e.strict,A=void 0===o?this.spec.strict:o,r=g;A||(r=this._cast(r,Object.assign({assert:!1},e)));for(var c=[],i=0,d=Object.values(this.internalTests);i<d.length;i++){var u=d[i];u&&c.push(u)}this.runTests({path:n,value:r,originalValue:a,options:e,tests:c},C,(function(g){if(g.length)return l(g,r);I.runTests({path:n,value:r,originalValue:a,options:e,tests:I.tests},C,l)}))}},{key:"runTests",value:function(g,I,e){var C=!1,l=g.tests,n=g.value,t=g.originalValue,a=g.path,o=g.options,A=function(g){C||(C=!0,I(g,n))},r=function(g){C||(C=!0,e(g,n))},c=l.length,i=[];if(!c)return r([]);for(var d={value:n,originalValue:t,path:a,options:o,schema:this},s=0;s<l.length;s++){(0,l[s])(d,A,(function(g){g&&(Array.isArray(g)?i.push.apply(i,u(g)):i.push(g)),--c<=0&&r(i)}))}}},{key:"asNestedTest",value:function(g){var I,e=this,C=g.key,l=g.index,n=g.parent,t=g.parentPath,a=g.originalParent,o=g.options,A=null!=C?C:l;if(null==A)throw TypeError("Must include `key` or `index` for nested validations");var r="number"===typeof A,c=n[A],i=Object.assign({},o,(nI(I={strict:!0,parent:n,value:c,originalValue:a[A],key:void 0},r?"index":"key",A),nI(I,"path",r||A.includes(".")?"".concat(t||"","[").concat(r?A:'"'.concat(A,'"'),"]"):(t?"".concat(t,"."):"")+C),I));return function(g,I,C){return e.resolve(i)._validate(c,i,I,C)}}},{key:"validate",value:function(g,I){var e,C=this.resolve(Object.assign({},I,{value:g})),l=null!=(e=null==I?void 0:I.disableStackTrace)?e:C.spec.disableStackTrace;return new Promise((function(e,n){return C._validate(g,I,(function(g,I){nC.isError(g)&&(g.value=I),n(g)}),(function(g,I){g.length?n(new nC(g,I,void 0,void 0,l)):e(I)}))}))}},{key:"validateSync",value:function(g,I){var e,C,l=this.resolve(Object.assign({},I,{value:g})),n=null!=(e=null==I?void 0:I.disableStackTrace)?e:l.spec.disableStackTrace;return l._validate(g,Object.assign({},I,{sync:!0}),(function(g,I){throw nC.isError(g)&&(g.value=I),g}),(function(I,e){if(I.length)throw new nC(I,g,void 0,void 0,n);C=e})),C}},{key:"isValid",value:function(g,I){return this.validate(g,I).then((function(){return!0}),(function(g){if(nC.isError(g))return!1;throw g}))}},{key:"isValidSync",value:function(g,I){try{return this.validateSync(g,I),!0}catch(e){if(nC.isError(e))return!1;throw e}}},{key:"_getDefault",value:function(g){var I=this.spec.default;return null==I?I:"function"===typeof I?I.call(this,g):pC(I)}},{key:"getDefault",value:function(g){return this.resolve(g||{})._getDefault(g)}},{key:"default",value:function(g){return 0===arguments.length?this._getDefault():this.clone({default:g})}},{key:"strict",value:function(){var g=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return this.clone({strict:g})}},{key:"nullability",value:function(g,I){var e=this.clone({nullable:g});return e.internalTests.nullable=yC({message:I,name:"nullable",test:function(g){return null!==g||this.schema.spec.nullable}}),e}},{key:"optionality",value:function(g,I){var e=this.clone({optional:g});return e.internalTests.optionality=yC({message:I,name:"optionality",test:function(g){return void 0!==g||this.schema.spec.optional}}),e}},{key:"optional",value:function(){return this.optionality(!0)}},{key:"defined",value:function(){var g=arguments.length>0&&void 0!==arguments[0]?arguments[0]:tC.defined;return this.optionality(!1,g)}},{key:"nullable",value:function(){return this.nullability(!0)}},{key:"nonNullable",value:function(){var g=arguments.length>0&&void 0!==arguments[0]?arguments[0]:tC.notNull;return this.nullability(!1,g)}},{key:"required",value:function(){var g=arguments.length>0&&void 0!==arguments[0]?arguments[0]:tC.required;return this.clone().withMutation((function(I){return I.nonNullable(g).defined(g)}))}},{key:"notRequired",value:function(){return this.clone().withMutation((function(g){return g.nullable().optional()}))}},{key:"transform",value:function(g){var I=this.clone();return I.transforms.push(g),I}},{key:"test",value:function(){var g;if(void 0===(g=1===arguments.length?"function"===typeof(arguments.length<=0?void 0:arguments[0])?{test:arguments.length<=0?void 0:arguments[0]}:arguments.length<=0?void 0:arguments[0]:2===arguments.length?{name:arguments.length<=0?void 0:arguments[0],test:arguments.length<=1?void 0:arguments[1]}:{name:arguments.length<=0?void 0:arguments[0],message:arguments.length<=1?void 0:arguments[1],test:arguments.length<=2?void 0:arguments[2]}).message&&(g.message=tC.default),"function"!==typeof g.test)throw new TypeError("`test` is a required parameters");var I=this.clone(),e=yC(g),C=g.exclusive||g.name&&!0===I.exclusiveTests[g.name];if(g.exclusive&&!g.name)throw new TypeError("Exclusive tests must provide a unique `name` identifying the test");return g.name&&(I.exclusiveTests[g.name]=!!g.exclusive),I.tests=I.tests.filter((function(I){if(I.OPTIONS.name===g.name){if(C)return!1;if(I.OPTIONS.test===e.OPTIONS.test)return!1}return!0})),I.tests.push(e),I}},{key:"when",value:function(g,I){Array.isArray(g)||"string"===typeof g||(I=g,g=".");var e=this.clone(),C=eC(g).map((function(g){return new ZC(g)}));return C.forEach((function(g){g.isSibling&&e.deps.push(g.key)})),e.conditions.push("function"===typeof I?new sC(C,I):sC.fromOptions(C,I)),e}},{key:"typeError",value:function(g){var I=this.clone();return I.internalTests.typeError=yC({message:g,name:"typeError",skipAbsent:!0,test:function(g){return!!this.schema._typeCheck(g)||this.createError({params:{type:this.schema.type}})}}),I}},{key:"oneOf",value:function(g){var I=arguments.length>1&&void 0!==arguments[1]?arguments[1]:tC.oneOf,e=this.clone();return g.forEach((function(g){e._whitelist.add(g),e._blacklist.delete(g)})),e.internalTests.whiteList=yC({message:I,name:"oneOf",skipAbsent:!0,test:function(g){var I=this.schema._whitelist,e=I.resolveAll(this.resolve);return!!e.includes(g)||this.createError({params:{values:Array.from(I).join(", "),resolved:e}})}}),e}},{key:"notOneOf",value:function(g){var I=arguments.length>1&&void 0!==arguments[1]?arguments[1]:tC.notOneOf,e=this.clone();return g.forEach((function(g){e._blacklist.add(g),e._whitelist.delete(g)})),e.internalTests.blacklist=yC({message:I,name:"notOneOf",test:function(g){var I=this.schema._blacklist,e=I.resolveAll(this.resolve);return!e.includes(g)||this.createError({params:{values:Array.from(I).join(", "),resolved:e}})}}),e}},{key:"strip",value:function(){var g=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],I=this.clone();return I.spec.strip=g,I}},{key:"describe",value:function(g){var I=(g?this.resolve(g):this).clone(),e=I.spec,C=e.label;return{meta:e.meta,label:C,optional:e.optional,nullable:e.nullable,default:I.getDefault(g),type:I.type,oneOf:I._whitelist.describe(),notOneOf:I._blacklist.describe(),tests:I.tests.map((function(g){return{name:g.OPTIONS.name,params:g.OPTIONS.params}})).filter((function(g,I,e){return e.findIndex((function(I){return I.name===g.name}))===I}))}}}]),g}();WC.prototype.__isYupSchema__=!0;for(var VC=function(){var g=vC[SC];WC.prototype["".concat(g,"At")]=function(I,e){var C=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},l=hC(this,I,e,C.context),n=l.parent,t=l.parentPath;return l.schema[g](n&&n[t],Object.assign({},C,{parent:n,path:I}))}},SC=0,vC=["validate","validateSync"];SC<vC.length;SC++)VC();for(var fC=0,RC=["equals","is"];fC<RC.length;fC++){var XC=RC[fC];WC.prototype[XC]=WC.prototype.oneOf}for(var JC=0,kC=["not","nope"];JC<kC.length;JC++){var YC=kC[JC];WC.prototype[YC]=WC.prototype.notOneOf}var HC=function(){return!0};var wC=function(g){h(e,g);var I=S(e);function e(g){return s(this,e),I.call(this,"function"===typeof g?{type:"mixed",check:g}:Object.assign({type:"mixed",check:HC},g))}return G(e)}(WC);wC.prototype;var NC=function(g){h(e,g);var I=S(e);function e(){var g;return s(this,e),(g=I.call(this,{type:"boolean",check:function(g){return g instanceof Boolean&&(g=g.valueOf()),"boolean"===typeof g}})).withMutation((function(){g.transform((function(g,I,e){if(e.spec.coerce&&!e.isType(g)){if(/^(true|1)$/i.test(String(g)))return!0;if(/^(false|0)$/i.test(String(g)))return!1}return g}))})),g}return G(e,[{key:"isTrue",value:function(){var g=arguments.length>0&&void 0!==arguments[0]?arguments[0]:rC.isValue;return this.test({message:g,name:"is-value",exclusive:!0,params:{value:"true"},test:function(g){return GC(g)||!0===g}})}},{key:"isFalse",value:function(){var g=arguments.length>0&&void 0!==arguments[0]?arguments[0]:rC.isValue;return this.test({message:g,name:"is-value",exclusive:!0,params:{value:"false"},test:function(g){return GC(g)||!1===g}})}},{key:"default",value:function(g){return Ee(B(e.prototype),"default",this).call(this,g)}},{key:"defined",value:function(g){return Ee(B(e.prototype),"defined",this).call(this,g)}},{key:"optional",value:function(){return Ee(B(e.prototype),"optional",this).call(this)}},{key:"required",value:function(g){return Ee(B(e.prototype),"required",this).call(this,g)}},{key:"notRequired",value:function(){return Ee(B(e.prototype),"notRequired",this).call(this)}},{key:"nullable",value:function(){return Ee(B(e.prototype),"nullable",this).call(this)}},{key:"nonNullable",value:function(g){return Ee(B(e.prototype),"nonNullable",this).call(this,g)}},{key:"strip",value:function(g){return Ee(B(e.prototype),"strip",this).call(this,g)}}]),e}(WC);NC.prototype;var FC=/^(\d{4}|[+-]\d{6})(?:-?(\d{2})(?:-?(\d{2}))?)?(?:[ T]?(\d{2}):?(\d{2})(?::?(\d{2})(?:[,.](\d{1,}))?)?(?:(Z)|([+-])(\d{2})(?::?(\d{2}))?)?)?$/;function KC(g){var I,e,C=FC.exec(g);return C?{year:xC(C[1]),month:xC(C[2],1)-1,day:xC(C[3],1),hour:xC(C[4]),minute:xC(C[5]),second:xC(C[6]),millisecond:C[7]?xC(C[7].substring(0,3)):0,precision:null!=(I=null==(e=C[7])?void 0:e.length)?I:void 0,z:C[8]||void 0,plusMinus:C[9]||void 0,hourOffset:xC(C[10]),minuteOffset:xC(C[11])}:null}function xC(g){var I=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return Number(g)||I}var zC=/^[a-zA-Z0-9.!#$%&'*+\/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/,EC=/^((https?|ftp):)?\/\/(((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:)*@)?(((\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5]))|((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?)(:\d*)?)(\/((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)+(\/(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)*)*)?)?(\?((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|[\uE000-\uF8FF]|\/|\?)*)?(\#((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|\/|\?)*)?$/i,UC=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i,QC=new RegExp("".concat("^\\d{4}-\\d{2}-\\d{2}","T").concat("\\d{2}:\\d{2}:\\d{2}","(\\.\\d+)?").concat("(([+-]\\d{2}(:?\\d{2})?)|Z)","$")),MC=function(g){return GC(g)||g===g.trim()},LC={}.toString();function DC(){return new TC}var TC=function(g){h(e,g);var I=S(e);function e(){var g;return s(this,e),(g=I.call(this,{type:"string",check:function(g){return g instanceof String&&(g=g.valueOf()),"string"===typeof g}})).withMutation((function(){g.transform((function(g,I,e){if(!e.spec.coerce||e.isType(g))return g;if(Array.isArray(g))return g;var C=null!=g&&g.toString?g.toString():g;return C===LC?g:C}))})),g}return G(e,[{key:"required",value:function(g){return Ee(B(e.prototype),"required",this).call(this,g).withMutation((function(I){return I.test({message:g||tC.required,name:"required",skipAbsent:!0,test:function(g){return!!g.length}})}))}},{key:"notRequired",value:function(){return Ee(B(e.prototype),"notRequired",this).call(this).withMutation((function(g){return g.tests=g.tests.filter((function(g){return"required"!==g.OPTIONS.name})),g}))}},{key:"length",value:function(g){var I=arguments.length>1&&void 0!==arguments[1]?arguments[1]:aC.length;return this.test({message:I,name:"length",exclusive:!0,params:{length:g},skipAbsent:!0,test:function(I){return I.length===this.resolve(g)}})}},{key:"min",value:function(g){var I=arguments.length>1&&void 0!==arguments[1]?arguments[1]:aC.min;return this.test({message:I,name:"min",exclusive:!0,params:{min:g},skipAbsent:!0,test:function(I){return I.length>=this.resolve(g)}})}},{key:"max",value:function(g){var I=arguments.length>1&&void 0!==arguments[1]?arguments[1]:aC.max;return this.test({name:"max",exclusive:!0,message:I,params:{max:g},skipAbsent:!0,test:function(I){return I.length<=this.resolve(g)}})}},{key:"matches",value:function(g,I){var e,C,l=!1;if(I)if("object"===typeof I){var n=I.excludeEmptyString;l=void 0!==n&&n,e=I.message,C=I.name}else e=I;return this.test({name:C||"matches",message:e||aC.matches,params:{regex:g},skipAbsent:!0,test:function(I){return""===I&&l||-1!==I.search(g)}})}},{key:"email",value:function(){var g=arguments.length>0&&void 0!==arguments[0]?arguments[0]:aC.email;return this.matches(zC,{name:"email",message:g,excludeEmptyString:!0})}},{key:"url",value:function(){var g=arguments.length>0&&void 0!==arguments[0]?arguments[0]:aC.url;return this.matches(EC,{name:"url",message:g,excludeEmptyString:!0})}},{key:"uuid",value:function(){var g=arguments.length>0&&void 0!==arguments[0]?arguments[0]:aC.uuid;return this.matches(UC,{name:"uuid",message:g,excludeEmptyString:!1})}},{key:"datetime",value:function(g){var I,e,C="";if(g)if("object"===typeof g){var l=g.message;C=void 0===l?"":l;var n=g.allowOffset;I=void 0!==n&&n;var t=g.precision;e=void 0===t?void 0:t}else C=g;return this.matches(QC,{name:"datetime",message:C||aC.datetime,excludeEmptyString:!0}).test({name:"datetime_offset",message:C||aC.datetime_offset,params:{allowOffset:I},skipAbsent:!0,test:function(g){if(!g||I)return!0;var e=KC(g);return!!e&&!!e.z}}).test({name:"datetime_precision",message:C||aC.datetime_precision,params:{precision:e},skipAbsent:!0,test:function(g){if(!g||void 0==e)return!0;var I=KC(g);return!!I&&I.precision===e}})}},{key:"ensure",value:function(){return this.default("").transform((function(g){return null===g?"":g}))}},{key:"trim",value:function(){var g=arguments.length>0&&void 0!==arguments[0]?arguments[0]:aC.trim;return this.transform((function(g){return null!=g?g.trim():g})).test({message:g,name:"trim",test:MC})}},{key:"lowercase",value:function(){var g=arguments.length>0&&void 0!==arguments[0]?arguments[0]:aC.lowercase;return this.transform((function(g){return GC(g)?g:g.toLowerCase()})).test({message:g,name:"string_case",exclusive:!0,skipAbsent:!0,test:function(g){return GC(g)||g===g.toLowerCase()}})}},{key:"uppercase",value:function(){var g=arguments.length>0&&void 0!==arguments[0]?arguments[0]:aC.uppercase;return this.transform((function(g){return GC(g)?g:g.toUpperCase()})).test({message:g,name:"string_case",exclusive:!0,skipAbsent:!0,test:function(g){return GC(g)||g===g.toUpperCase()}})}}]),e}(WC);DC.prototype=TC.prototype;var jC=function(g){h(e,g);var I=S(e);function e(){var g;return s(this,e),(g=I.call(this,{type:"number",check:function(g){return g instanceof Number&&(g=g.valueOf()),"number"===typeof g&&!function(g){return g!=+g}(g)}})).withMutation((function(){g.transform((function(g,I,e){if(!e.spec.coerce)return g;var C=g;if("string"===typeof C){if(""===(C=C.replace(/\s/g,"")))return NaN;C=+C}return e.isType(C)||null===C?C:parseFloat(C)}))})),g}return G(e,[{key:"min",value:function(g){var I=arguments.length>1&&void 0!==arguments[1]?arguments[1]:oC.min;return this.test({message:I,name:"min",exclusive:!0,params:{min:g},skipAbsent:!0,test:function(I){return I>=this.resolve(g)}})}},{key:"max",value:function(g){var I=arguments.length>1&&void 0!==arguments[1]?arguments[1]:oC.max;return this.test({message:I,name:"max",exclusive:!0,params:{max:g},skipAbsent:!0,test:function(I){return I<=this.resolve(g)}})}},{key:"lessThan",value:function(g){var I=arguments.length>1&&void 0!==arguments[1]?arguments[1]:oC.lessThan;return this.test({message:I,name:"max",exclusive:!0,params:{less:g},skipAbsent:!0,test:function(I){return I<this.resolve(g)}})}},{key:"moreThan",value:function(g){var I=arguments.length>1&&void 0!==arguments[1]?arguments[1]:oC.moreThan;return this.test({message:I,name:"min",exclusive:!0,params:{more:g},skipAbsent:!0,test:function(I){return I>this.resolve(g)}})}},{key:"positive",value:function(){var g=arguments.length>0&&void 0!==arguments[0]?arguments[0]:oC.positive;return this.moreThan(0,g)}},{key:"negative",value:function(){var g=arguments.length>0&&void 0!==arguments[0]?arguments[0]:oC.negative;return this.lessThan(0,g)}},{key:"integer",value:function(){var g=arguments.length>0&&void 0!==arguments[0]?arguments[0]:oC.integer;return this.test({name:"integer",message:g,skipAbsent:!0,test:function(g){return Number.isInteger(g)}})}},{key:"truncate",value:function(){return this.transform((function(g){return GC(g)?g:0|g}))}},{key:"round",value:function(g){var I,e=["ceil","floor","round","trunc"];if("trunc"===(g=(null==(I=g)?void 0:I.toLowerCase())||"round"))return this.truncate();if(-1===e.indexOf(g.toLowerCase()))throw new TypeError("Only valid options for round() are: "+e.join(", "));return this.transform((function(I){return GC(I)?I:Math[g](I)}))}}]),e}(WC);jC.prototype;var PC=new Date("");function OC(){return new qC}var qC=function(g){h(e,g);var I=S(e);function e(){var g;return s(this,e),(g=I.call(this,{type:"date",check:function(g){return I=g,"[object Date]"===Object.prototype.toString.call(I)&&!isNaN(g.getTime());var I}})).withMutation((function(){g.transform((function(g,I,C){return!C.spec.coerce||C.isType(g)||null===g?g:(g=function(g){var I=KC(g);if(!I)return Date.parse?Date.parse(g):Number.NaN;if(void 0===I.z&&void 0===I.plusMinus)return new Date(I.year,I.month,I.day,I.hour,I.minute,I.second,I.millisecond).valueOf();var e=0;return"Z"!==I.z&&void 0!==I.plusMinus&&(e=60*I.hourOffset+I.minuteOffset,"+"===I.plusMinus&&(e=0-e)),Date.UTC(I.year,I.month,I.day,I.hour,I.minute+e,I.second,I.millisecond)}(g),isNaN(g)?e.INVALID_DATE:new Date(g))}))})),g}return G(e,[{key:"prepareParam",value:function(g,I){var e;if(ZC.isRef(g))e=g;else{var C=this.cast(g);if(!this._typeCheck(C))throw new TypeError("`".concat(I,"` must be a Date or a value that can be `cast()` to a Date"));e=C}return e}},{key:"min",value:function(g){var I=arguments.length>1&&void 0!==arguments[1]?arguments[1]:AC.min,e=this.prepareParam(g,"min");return this.test({message:I,name:"min",exclusive:!0,params:{min:g},skipAbsent:!0,test:function(g){return g>=this.resolve(e)}})}},{key:"max",value:function(g){var I=arguments.length>1&&void 0!==arguments[1]?arguments[1]:AC.max,e=this.prepareParam(g,"max");return this.test({message:I,name:"max",exclusive:!0,params:{max:g},skipAbsent:!0,test:function(g){return g<=this.resolve(e)}})}}]),e}(WC);function _C(g,I){var e=1/0;return g.some((function(g,C){var l;if(null!=(l=I.path)&&l.includes(g))return e=C,!0})),e}function $C(g){return function(I,e){return _C(g,I)-_C(g,e)}}qC.INVALID_DATE=PC,OC.prototype=qC.prototype,OC.INVALID_DATE=PC;var gl=function(g,I,e){if("string"!==typeof g)return g;var C=g;try{C=JSON.parse(g)}catch(l){}return e.isType(C)?C:g};function Il(g){if("fields"in g){for(var I={},e=0,C=Object.entries(g.fields);e<C.length;e++){var l=A(C[e],2),n=l[0],t=l[1];I[n]=Il(t)}return g.setFields(I)}if("array"===g.type){var a=g.optional();return a.innerType&&(a.innerType=Il(a.innerType)),a}return"tuple"===g.type?g.optional().clone({types:g.spec.types.map(Il)}):"optional"in g?g.optional():g}var el=function(g){return"[object Object]"===Object.prototype.toString.call(g)};var Cl=$C([]);function ll(g){return new nl(g)}var nl=function(g){h(e,g);var I=S(e);function e(g){var C;return s(this,e),(C=I.call(this,{type:"object",check:function(g){return el(g)||"function"===typeof g}})).fields=Object.create(null),C._sortErrors=Cl,C._nodes=[],C._excludedEdges=[],C.withMutation((function(){g&&C.shape(g)})),C}return G(e,[{key:"_cast",value:function(g){var I,C=this,l=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=Ee(B(e.prototype),"_cast",this).call(this,g,l);if(void 0===n)return this.getDefault(l);if(!this._typeCheck(n))return n;var t,a=this.fields,o=null!=(I=l.stripUnknown)?I:this.spec.noUnknown,A=[].concat(this._nodes,Object.keys(n).filter((function(g){return!C._nodes.includes(g)}))),r={},c=Object.assign({},l,{parent:r,__validating:l.__validating||!1}),i=!1,d=X(A);try{for(d.s();!(t=d.n()).done;){var u=t.value,s=a[u],m=u in n;if(s){var b,Z=n[u];c.path=(l.path?"".concat(l.path,"."):"")+u;var G=(s=s.resolve({value:Z,context:l.context,parent:r}))instanceof WC?s.spec:void 0,y=null==G?void 0:G.strict;if(null!=G&&G.strip){i=i||u in n;continue}void 0!==(b=l.__validating&&y?n[u]:s.cast(n[u],c))&&(r[u]=b)}else m&&!o&&(r[u]=n[u]);m===u in r&&r[u]===n[u]||(i=!0)}}catch(h){d.e(h)}finally{d.f()}return i?r:n}},{key:"_validate",value:function(g){var I=this,C=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},l=arguments.length>2?arguments[2]:void 0,n=arguments.length>3?arguments[3]:void 0,t=C.from,a=void 0===t?[]:t,o=C.originalValue,A=void 0===o?g:o,r=C.recursive,c=void 0===r?this.spec.recursive:r;C.from=[{schema:this,value:A}].concat(u(a)),C.__validating=!0,C.originalValue=A,Ee(B(e.prototype),"_validate",this).call(this,g,C,l,(function(g,e){if(c&&el(e)){A=A||e;var t,a=[],o=X(I._nodes);try{for(o.s();!(t=o.n()).done;){var r=t.value,i=I.fields[r];i&&!ZC.isRef(i)&&a.push(i.asNestedTest({options:C,key:r,parent:e,parentPath:C.path,originalParent:A}))}}catch(d){o.e(d)}finally{o.f()}I.runTests({tests:a,value:e,originalValue:A,options:C},l,(function(C){n(C.sort(I._sortErrors).concat(g),e)}))}else n(g,e)}))}},{key:"clone",value:function(g){var I=Ee(B(e.prototype),"clone",this).call(this,g);return I.fields=Object.assign({},this.fields),I._nodes=this._nodes,I._excludedEdges=this._excludedEdges,I._sortErrors=this._sortErrors,I}},{key:"concat",value:function(g){for(var I=this,C=Ee(B(e.prototype),"concat",this).call(this,g),l=C.fields,n=0,t=Object.entries(this.fields);n<t.length;n++){var a=A(t[n],2),o=a[0],r=a[1],c=l[o];l[o]=void 0===c?r:c}return C.withMutation((function(e){return e.setFields(l,[].concat(u(I._excludedEdges),u(g._excludedEdges)))}))}},{key:"_getDefault",value:function(g){var I=this;if("default"in this.spec)return Ee(B(e.prototype),"_getDefault",this).call(this,g);if(this._nodes.length){var C={};return this._nodes.forEach((function(e){var l,n=I.fields[e],t=g;null!=(l=t)&&l.value&&(t=Object.assign({},t,{parent:t.value,value:t.value[e]})),C[e]=n&&"getDefault"in n?n.getDefault(t):void 0})),C}}},{key:"setFields",value:function(g,I){var e=this.clone();return e.fields=g,e._nodes=function(g){var I=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],e=[],C=new Set,l=new Set(I.map((function(g){var I=A(g,2),e=I[0],C=I[1];return"".concat(e,"-").concat(C)})));function n(g,I){var n=(0,Le.split)(g)[0];C.add(n),l.has("".concat(I,"-").concat(n))||e.push([I,n])}for(var t=function(){var I=o[a],e=g[I];C.add(I),ZC.isRef(e)&&e.isSibling?n(e.path,I):uC(e)&&"deps"in e&&e.deps.forEach((function(g){return n(g,I)}))},a=0,o=Object.keys(g);a<o.length;a++)t();return je().array(Array.from(C),e).reverse()}(g,I),e._sortErrors=$C(Object.keys(g)),I&&(e._excludedEdges=I),e}},{key:"shape",value:function(g){var I=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return this.clone().withMutation((function(e){var C=e._excludedEdges;return I.length&&(Array.isArray(I[0])||(I=[I]),C=[].concat(u(e._excludedEdges),u(I))),e.setFields(Object.assign(e.fields,g),C)}))}},{key:"partial",value:function(){for(var g={},I=0,e=Object.entries(this.fields);I<e.length;I++){var C=A(e[I],2),l=C[0],n=C[1];g[l]="optional"in n&&n.optional instanceof Function?n.optional():n}return this.setFields(g)}},{key:"deepPartial",value:function(){return Il(this)}},{key:"pick",value:function(g){var I,e={},C=X(g);try{for(C.s();!(I=C.n()).done;){var l=I.value;this.fields[l]&&(e[l]=this.fields[l])}}catch(n){C.e(n)}finally{C.f()}return this.setFields(e,this._excludedEdges.filter((function(I){var e=A(I,2),C=e[0],l=e[1];return g.includes(C)&&g.includes(l)})))}},{key:"omit",value:function(g){for(var I=[],e=0,C=Object.keys(this.fields);e<C.length;e++){var l=C[e];g.includes(l)||I.push(l)}return this.pick(I)}},{key:"from",value:function(g,I,e){var C=(0,Le.getter)(g,!0);return this.transform((function(l){if(!l)return l;var n=l;return function(g,I){var e=u((0,Le.normalizePath)(I));if(1===e.length)return e[0]in g;var C=e.pop(),l=(0,Le.getter)((0,Le.join)(e),!0)(g);return!(!l||!(C in l))}(l,g)&&(n=Object.assign({},l),e||delete n[g],n[I]=C(l)),n}))}},{key:"json",value:function(){return this.transform(gl)}},{key:"noUnknown",value:function(){var g=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],I=arguments.length>1&&void 0!==arguments[1]?arguments[1]:cC.noUnknown;"boolean"!==typeof g&&(I=g,g=!0);var e=this.test({name:"noUnknown",exclusive:!0,message:I,test:function(I){if(null==I)return!0;var e=function(g,I){var e=Object.keys(g.fields);return Object.keys(I).filter((function(g){return-1===e.indexOf(g)}))}(this.schema,I);return!g||0===e.length||this.createError({params:{unknown:e.join(", ")}})}});return e.spec.noUnknown=g,e}},{key:"unknown",value:function(){var g=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],I=arguments.length>1&&void 0!==arguments[1]?arguments[1]:cC.noUnknown;return this.noUnknown(!g,I)}},{key:"transformKeys",value:function(g){return this.transform((function(I){if(!I)return I;for(var e={},C=0,l=Object.keys(I);C<l.length;C++){var n=l[C];e[g(n)]=I[n]}return e}))}},{key:"camelCase",value:function(){return this.transformKeys(De.camelCase)}},{key:"snakeCase",value:function(){return this.transformKeys(De.snakeCase)}},{key:"constantCase",value:function(){return this.transformKeys((function(g){return(0,De.snakeCase)(g).toUpperCase()}))}},{key:"describe",value:function(g){var I=(g?this.resolve(g):this).clone(),C=Ee(B(e.prototype),"describe",this).call(this,g);C.fields={};for(var l=0,n=Object.entries(I.fields);l<n.length;l++){var t,a=A(n[l],2),o=a[0],r=a[1],c=g;null!=(t=c)&&t.value&&(c=Object.assign({},c,{parent:c.value,value:c.value[o]})),C.fields[o]=r.describe(c)}return C}}]),e}(WC);ll.prototype=nl.prototype;var tl=function(g){h(e,g);var I=S(e);function e(g){var C;return s(this,e),(C=I.call(this,{type:"array",spec:{types:g},check:function(g){return Array.isArray(g)}})).innerType=void 0,C.innerType=g,C}return G(e,[{key:"_cast",value:function(g,I){var C=this,l=Ee(B(e.prototype),"_cast",this).call(this,g,I);if(!this._typeCheck(l)||!this.innerType)return l;var n=!1,t=l.map((function(g,e){var l=C.innerType.cast(g,Object.assign({},I,{path:"".concat(I.path||"","[").concat(e,"]")}));return l!==g&&(n=!0),l}));return n?t:l}},{key:"_validate",value:function(g){var I,C=this,l=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0,t=arguments.length>3?arguments[3]:void 0,a=this.innerType,o=null!=(I=l.recursive)?I:this.spec.recursive;null!=l.originalValue&&l.originalValue,Ee(B(e.prototype),"_validate",this).call(this,g,l,n,(function(I,e){var A;if(o&&a&&C._typeCheck(e)){for(var r=new Array(e.length),c=0;c<e.length;c++){var i;r[c]=a.asNestedTest({options:l,index:c,parent:e,parentPath:l.path,originalParent:null!=(i=l.originalValue)?i:g})}C.runTests({value:e,tests:r,originalValue:null!=(A=l.originalValue)?A:g,options:l},n,(function(g){return t(g.concat(I),e)}))}else t(I,e)}))}},{key:"clone",value:function(g){var I=Ee(B(e.prototype),"clone",this).call(this,g);return I.innerType=this.innerType,I}},{key:"json",value:function(){return this.transform(gl)}},{key:"concat",value:function(g){var I=Ee(B(e.prototype),"concat",this).call(this,g);return I.innerType=this.innerType,g.innerType&&(I.innerType=I.innerType?I.innerType.concat(g.innerType):g.innerType),I}},{key:"of",value:function(g){var I=this.clone();if(!uC(g))throw new TypeError("`array.of()` sub-schema must be a valid yup schema not: "+IC(g));return I.innerType=g,I.spec=Object.assign({},I.spec,{types:g}),I}},{key:"length",value:function(g){var I=arguments.length>1&&void 0!==arguments[1]?arguments[1]:iC.length;return this.test({message:I,name:"length",exclusive:!0,params:{length:g},skipAbsent:!0,test:function(I){return I.length===this.resolve(g)}})}},{key:"min",value:function(g,I){return I=I||iC.min,this.test({message:I,name:"min",exclusive:!0,params:{min:g},skipAbsent:!0,test:function(I){return I.length>=this.resolve(g)}})}},{key:"max",value:function(g,I){return I=I||iC.max,this.test({message:I,name:"max",exclusive:!0,params:{max:g},skipAbsent:!0,test:function(I){return I.length<=this.resolve(g)}})}},{key:"ensure",value:function(){var g=this;return this.default((function(){return[]})).transform((function(I,e){return g._typeCheck(I)?I:null==e?[]:[].concat(e)}))}},{key:"compact",value:function(g){var I=g?function(I,e,C){return!g(I,e,C)}:function(g){return!!g};return this.transform((function(g){return null!=g?g.filter(I):g}))}},{key:"describe",value:function(g){var I=(g?this.resolve(g):this).clone(),C=Ee(B(e.prototype),"describe",this).call(this,g);if(I.innerType){var l,n=g;null!=(l=n)&&l.value&&(n=Object.assign({},n,{parent:n.value,value:n.value[0]})),C.innerType=I.innerType.describe(n)}return C}}]),e}(WC);tl.prototype;var al=function(g){h(e,g);var I=S(e);function e(g){var C;return s(this,e),(C=I.call(this,{type:"tuple",spec:{types:g},check:function(g){var I=this.spec.types;return Array.isArray(g)&&g.length===I.length}})).withMutation((function(){C.typeError(dC.notType)})),C}return G(e,[{key:"_cast",value:function(g,I){var C=this.spec.types,l=Ee(B(e.prototype),"_cast",this).call(this,g,I);if(!this._typeCheck(l))return l;var n=!1,t=C.map((function(g,e){var C=g.cast(l[e],Object.assign({},I,{path:"".concat(I.path||"","[").concat(e,"]")}));return C!==l[e]&&(n=!0),C}));return n?t:l}},{key:"_validate",value:function(g){var I=this,C=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},l=arguments.length>2?arguments[2]:void 0,n=arguments.length>3?arguments[3]:void 0,t=this.spec.types;Ee(B(e.prototype),"_validate",this).call(this,g,C,l,(function(e,a){var o;if(I._typeCheck(a)){var r,c=[],i=X(t.entries());try{for(i.s();!(r=i.n()).done;){var d,u=A(r.value,2),s=u[0],m=u[1];c[s]=m.asNestedTest({options:C,index:s,parent:a,parentPath:C.path,originalParent:null!=(d=C.originalValue)?d:g})}}catch(b){i.e(b)}finally{i.f()}I.runTests({value:a,tests:c,originalValue:null!=(o=C.originalValue)?o:g,options:C},l,(function(g){return n(g.concat(e),a)}))}else n(e,a)}))}},{key:"describe",value:function(g){var I=(g?this.resolve(g):this).clone(),C=Ee(B(e.prototype),"describe",this).call(this,g);return C.innerType=I.spec.types.map((function(I,e){var C,l=g;return null!=(C=l)&&C.value&&(l=Object.assign({},l,{parent:l.value,value:l.value[e]})),I.describe(l)})),C}}]),e}(WC);al.prototype;function ol(g,I){return function(){return g.apply(I,arguments)}}var Al,rl=Object.prototype.toString,cl=Object.getPrototypeOf,il=(Al=Object.create(null),function(g){var I=rl.call(g);return Al[I]||(Al[I]=I.slice(8,-1).toLowerCase())}),dl=function(g){return g=g.toLowerCase(),function(I){return il(I)===g}},ul=function(g){return function(I){return typeof I===g}},sl=Array.isArray,ml=ul("undefined");var bl=dl("ArrayBuffer");var Zl=ul("string"),Gl=ul("function"),yl=ul("number"),hl=function(g){return null!==g&&"object"===typeof g},Bl=function(g){if("object"!==il(g))return!1;var I=cl(g);return(null===I||I===Object.prototype||null===Object.getPrototypeOf(I))&&!(Symbol.toStringTag in g)&&!(Symbol.iterator in g)},pl=dl("Date"),Wl=dl("File"),Vl=dl("Blob"),Sl=dl("FileList"),vl=dl("URLSearchParams"),fl=A(["ReadableStream","Request","Response","Headers"].map(dl),4),Rl=fl[0],Xl=fl[1],Jl=fl[2],kl=fl[3];function Yl(g,I){var e,C,l=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:{}).allOwnKeys,n=void 0!==l&&l;if(null!==g&&"undefined"!==typeof g)if("object"!==typeof g&&(g=[g]),sl(g))for(e=0,C=g.length;e<C;e++)I.call(null,g[e],e,g);else{var t,a=n?Object.getOwnPropertyNames(g):Object.keys(g),o=a.length;for(e=0;e<o;e++)t=a[e],I.call(null,g[t],t,g)}}function Hl(g,I){I=I.toLowerCase();for(var e,C=Object.keys(g),l=C.length;l-- >0;)if(I===(e=C[l]).toLowerCase())return e;return null}var wl="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof self?self:"undefined"!==typeof window?window:global,Nl=function(g){return!ml(g)&&g!==wl};var Fl,Kl=(Fl="undefined"!==typeof Uint8Array&&cl(Uint8Array),function(g){return Fl&&g instanceof Fl}),xl=dl("HTMLFormElement"),zl=function(g){var I=Object.prototype.hasOwnProperty;return function(g,e){return I.call(g,e)}}(),El=dl("RegExp"),Ul=function(g,I){var e=Object.getOwnPropertyDescriptors(g),C={};Yl(e,(function(e,l){var n;!1!==(n=I(e,l,g))&&(C[l]=n||e)})),Object.defineProperties(g,C)},Ql="abcdefghijklmnopqrstuvwxyz",Ml="0123456789",Ll={DIGIT:Ml,ALPHA:Ql,ALPHA_DIGIT:Ql+Ql.toUpperCase()+Ml};var Dl=dl("AsyncFunction"),Tl=function(g,I){return g?setImmediate:I?(e="axios@".concat(Math.random()),C=[],wl.addEventListener("message",(function(g){var I=g.source,l=g.data;I===wl&&l===e&&C.length&&C.shift()()}),!1),function(g){C.push(g),wl.postMessage(e,"*")}):function(g){return setTimeout(g)};var e,C}("function"===typeof setImmediate,Gl(wl.postMessage)),jl="undefined"!==typeof queueMicrotask?queueMicrotask.bind(wl):"undefined"!==typeof process&&process.nextTick||Tl,Pl={isArray:sl,isArrayBuffer:bl,isBuffer:function(g){return null!==g&&!ml(g)&&null!==g.constructor&&!ml(g.constructor)&&Gl(g.constructor.isBuffer)&&g.constructor.isBuffer(g)},isFormData:function(g){var I;return g&&("function"===typeof FormData&&g instanceof FormData||Gl(g.append)&&("formdata"===(I=il(g))||"object"===I&&Gl(g.toString)&&"[object FormData]"===g.toString()))},isArrayBufferView:function(g){return"undefined"!==typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(g):g&&g.buffer&&bl(g.buffer)},isString:Zl,isNumber:yl,isBoolean:function(g){return!0===g||!1===g},isObject:hl,isPlainObject:Bl,isReadableStream:Rl,isRequest:Xl,isResponse:Jl,isHeaders:kl,isUndefined:ml,isDate:pl,isFile:Wl,isBlob:Vl,isRegExp:El,isFunction:Gl,isStream:function(g){return hl(g)&&Gl(g.pipe)},isURLSearchParams:vl,isTypedArray:Kl,isFileList:Sl,forEach:Yl,merge:function g(){for(var I=(Nl(this)&&this||{}).caseless,e={},C=function(C,l){var n=I&&Hl(e,l)||l;Bl(e[n])&&Bl(C)?e[n]=g(e[n],C):Bl(C)?e[n]=g({},C):sl(C)?e[n]=C.slice():e[n]=C},l=0,n=arguments.length;l<n;l++)arguments[l]&&Yl(arguments[l],C);return e},extend:function(g,I,e){return Yl(I,(function(I,C){e&&Gl(I)?g[C]=ol(I,e):g[C]=I}),{allOwnKeys:(arguments.length>3&&void 0!==arguments[3]?arguments[3]:{}).allOwnKeys}),g},trim:function(g){return g.trim?g.trim():g.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")},stripBOM:function(g){return 65279===g.charCodeAt(0)&&(g=g.slice(1)),g},inherits:function(g,I,e,C){g.prototype=Object.create(I.prototype,C),g.prototype.constructor=g,Object.defineProperty(g,"super",{value:I.prototype}),e&&Object.assign(g.prototype,e)},toFlatObject:function(g,I,e,C){var l,n,t,a={};if(I=I||{},null==g)return I;do{for(n=(l=Object.getOwnPropertyNames(g)).length;n-- >0;)t=l[n],C&&!C(t,g,I)||a[t]||(I[t]=g[t],a[t]=!0);g=!1!==e&&cl(g)}while(g&&(!e||e(g,I))&&g!==Object.prototype);return I},kindOf:il,kindOfTest:dl,endsWith:function(g,I,e){g=String(g),(void 0===e||e>g.length)&&(e=g.length),e-=I.length;var C=g.indexOf(I,e);return-1!==C&&C===e},toArray:function(g){if(!g)return null;if(sl(g))return g;var I=g.length;if(!yl(I))return null;for(var e=new Array(I);I-- >0;)e[I]=g[I];return e},forEachEntry:function(g,I){for(var e,C=(g&&g[Symbol.iterator]).call(g);(e=C.next())&&!e.done;){var l=e.value;I.call(g,l[0],l[1])}},matchAll:function(g,I){for(var e,C=[];null!==(e=g.exec(I));)C.push(e);return C},isHTMLForm:xl,hasOwnProperty:zl,hasOwnProp:zl,reduceDescriptors:Ul,freezeMethods:function(g){Ul(g,(function(I,e){if(Gl(g)&&-1!==["arguments","caller","callee"].indexOf(e))return!1;var C=g[e];Gl(C)&&(I.enumerable=!1,"writable"in I?I.writable=!1:I.set||(I.set=function(){throw Error("Can not rewrite read-only method '"+e+"'")}))}))},toObjectSet:function(g,I){var e={},C=function(g){g.forEach((function(g){e[g]=!0}))};return sl(g)?C(g):C(String(g).split(I)),e},toCamelCase:function(g){return g.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,(function(g,I,e){return I.toUpperCase()+e}))},noop:function(){},toFiniteNumber:function(g,I){return null!=g&&Number.isFinite(g=+g)?g:I},findKey:Hl,global:wl,isContextDefined:Nl,ALPHABET:Ll,generateString:function(){for(var g=arguments.length>0&&void 0!==arguments[0]?arguments[0]:16,I=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Ll.ALPHA_DIGIT,e="",C=I.length;g--;)e+=I[Math.random()*C|0];return e},isSpecCompliantForm:function(g){return!!(g&&Gl(g.append)&&"FormData"===g[Symbol.toStringTag]&&g[Symbol.iterator])},toJSONObject:function(g){var I=new Array(10);return function g(e,C){if(hl(e)){if(I.indexOf(e)>=0)return;if(!("toJSON"in e)){I[C]=e;var l=sl(e)?[]:{};return Yl(e,(function(I,e){var n=g(I,C+1);!ml(n)&&(l[e]=n)})),I[C]=void 0,l}}return e}(g,0)},isAsyncFn:Dl,isThenable:function(g){return g&&(hl(g)||Gl(g))&&Gl(g.then)&&Gl(g.catch)},setImmediate:Tl,asap:jl};function Ol(g,I,e,C,l){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=(new Error).stack,this.message=g,this.name="AxiosError",I&&(this.code=I),e&&(this.config=e),C&&(this.request=C),l&&(this.response=l)}Pl.inherits(Ol,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:Pl.toJSONObject(this.config),code:this.code,status:this.response&&this.response.status?this.response.status:null}}});var ql=Ol.prototype,_l={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach((function(g){_l[g]={value:g}})),Object.defineProperties(Ol,_l),Object.defineProperty(ql,"isAxiosError",{value:!0}),Ol.from=function(g,I,e,C,l,n){var t=Object.create(ql);return Pl.toFlatObject(g,t,(function(g){return g!==Error.prototype}),(function(g){return"isAxiosError"!==g})),Ol.call(t,g.message,I,e,C,l),t.cause=g,t.name=g.name,n&&Object.assign(t,n),t};var $l=Ol;function gn(g){return Pl.isPlainObject(g)||Pl.isArray(g)}function In(g){return Pl.endsWith(g,"[]")?g.slice(0,-2):g}function en(g,I,e){return g?g.concat(I).map((function(g,I){return g=In(g),!e&&I?"["+g+"]":g})).join(e?".":""):I}var Cn=Pl.toFlatObject(Pl,{},null,(function(g){return/^is[A-Z]/.test(g)}));var ln=function(g,I,e){if(!Pl.isObject(g))throw new TypeError("target must be an object");I=I||new FormData;var C=(e=Pl.toFlatObject(e,{metaTokens:!0,dots:!1,indexes:!1},!1,(function(g,I){return!Pl.isUndefined(I[g])}))).metaTokens,l=e.visitor||A,n=e.dots,t=e.indexes,a=(e.Blob||"undefined"!==typeof Blob&&Blob)&&Pl.isSpecCompliantForm(I);if(!Pl.isFunction(l))throw new TypeError("visitor must be a function");function o(g){if(null===g)return"";if(Pl.isDate(g))return g.toISOString();if(!a&&Pl.isBlob(g))throw new $l("Blob is not supported. Use a Buffer instead.");return Pl.isArrayBuffer(g)||Pl.isTypedArray(g)?a&&"function"===typeof Blob?new Blob([g]):Buffer.from(g):g}function A(g,e,l){var a=g;if(g&&!l&&"object"===typeof g)if(Pl.endsWith(e,"{}"))e=C?e:e.slice(0,-2),g=JSON.stringify(g);else if(Pl.isArray(g)&&function(g){return Pl.isArray(g)&&!g.some(gn)}(g)||(Pl.isFileList(g)||Pl.endsWith(e,"[]"))&&(a=Pl.toArray(g)))return e=In(e),a.forEach((function(g,C){!Pl.isUndefined(g)&&null!==g&&I.append(!0===t?en([e],C,n):null===t?e:e+"[]",o(g))})),!1;return!!gn(g)||(I.append(en(l,e,n),o(g)),!1)}var r=[],c=Object.assign(Cn,{defaultVisitor:A,convertValue:o,isVisitable:gn});if(!Pl.isObject(g))throw new TypeError("data must be an object");return function g(e,C){if(!Pl.isUndefined(e)){if(-1!==r.indexOf(e))throw Error("Circular reference detected in "+C.join("."));r.push(e),Pl.forEach(e,(function(e,n){!0===(!(Pl.isUndefined(e)||null===e)&&l.call(I,e,Pl.isString(n)?n.trim():n,C,c))&&g(e,C?C.concat(n):[n])})),r.pop()}}(g),I};function nn(g){var I={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(g).replace(/[!'()~]|%20|%00/g,(function(g){return I[g]}))}function tn(g,I){this._pairs=[],g&&ln(g,this,I)}var an=tn.prototype;an.append=function(g,I){this._pairs.push([g,I])},an.toString=function(g){var I=g?function(I){return g.call(this,I,nn)}:nn;return this._pairs.map((function(g){return I(g[0])+"="+I(g[1])}),"").join("&")};var on=tn;function An(g){return encodeURIComponent(g).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function rn(g,I,e){if(!I)return g;var C,l=e&&e.encode||An,n=e&&e.serialize;if(C=n?n(I,e):Pl.isURLSearchParams(I)?I.toString():new on(I,e).toString(l)){var t=g.indexOf("#");-1!==t&&(g=g.slice(0,t)),g+=(-1===g.indexOf("?")?"?":"&")+C}return g}var cn,dn=function(){function g(){s(this,g),this.handlers=[]}return G(g,[{key:"use",value:function(g,I,e){return this.handlers.push({fulfilled:g,rejected:I,synchronous:!!e&&e.synchronous,runWhen:e?e.runWhen:null}),this.handlers.length-1}},{key:"eject",value:function(g){this.handlers[g]&&(this.handlers[g]=null)}},{key:"clear",value:function(){this.handlers&&(this.handlers=[])}},{key:"forEach",value:function(g){Pl.forEach(this.handlers,(function(I){null!==I&&g(I)}))}}]),g}(),un=dn,sn={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},mn={isBrowser:!0,classes:{URLSearchParams:"undefined"!==typeof URLSearchParams?URLSearchParams:on,FormData:"undefined"!==typeof FormData?FormData:null,Blob:"undefined"!==typeof Blob?Blob:null},protocols:["http","https","file","blob","url","data"]},bn="undefined"!==typeof window&&"undefined"!==typeof document,Zn=(cn="undefined"!==typeof navigator&&navigator.product,bn&&["ReactNative","NativeScript","NS"].indexOf(cn)<0),Gn="undefined"!==typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&"function"===typeof self.importScripts,yn=bn&&window.location.href||"http://localhost",hn=aI(aI({},g),mn);var Bn=function(g){function I(g,e,C,l){var n=g[l++];if("__proto__"===n)return!0;var t=Number.isFinite(+n),a=l>=g.length;return n=!n&&Pl.isArray(C)?C.length:n,a?(Pl.hasOwnProp(C,n)?C[n]=[C[n],e]:C[n]=e,!t):(C[n]&&Pl.isObject(C[n])||(C[n]=[]),I(g,e,C[n],l)&&Pl.isArray(C[n])&&(C[n]=function(g){var I,e,C={},l=Object.keys(g),n=l.length;for(I=0;I<n;I++)C[e=l[I]]=g[e];return C}(C[n])),!t)}if(Pl.isFormData(g)&&Pl.isFunction(g.entries)){var e={};return Pl.forEachEntry(g,(function(g,C){I(function(g){return Pl.matchAll(/\w+|\[(\w*)]/g,g).map((function(g){return"[]"===g[0]?"":g[1]||g[0]}))}(g),C,e,0)})),e}return null};var pn={transitional:sn,adapter:["xhr","http","fetch"],transformRequest:[function(g,I){var e,C=I.getContentType()||"",l=C.indexOf("application/json")>-1,n=Pl.isObject(g);if(n&&Pl.isHTMLForm(g)&&(g=new FormData(g)),Pl.isFormData(g))return l?JSON.stringify(Bn(g)):g;if(Pl.isArrayBuffer(g)||Pl.isBuffer(g)||Pl.isStream(g)||Pl.isFile(g)||Pl.isBlob(g)||Pl.isReadableStream(g))return g;if(Pl.isArrayBufferView(g))return g.buffer;if(Pl.isURLSearchParams(g))return I.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),g.toString();if(n){if(C.indexOf("application/x-www-form-urlencoded")>-1)return function(g,I){return ln(g,new hn.classes.URLSearchParams,Object.assign({visitor:function(g,I,e,C){return hn.isNode&&Pl.isBuffer(g)?(this.append(I,g.toString("base64")),!1):C.defaultVisitor.apply(this,arguments)}},I))}(g,this.formSerializer).toString();if((e=Pl.isFileList(g))||C.indexOf("multipart/form-data")>-1){var t=this.env&&this.env.FormData;return ln(e?{"files[]":g}:g,t&&new t,this.formSerializer)}}return n||l?(I.setContentType("application/json",!1),function(g,I,e){if(Pl.isString(g))try{return(I||JSON.parse)(g),Pl.trim(g)}catch($Z){if("SyntaxError"!==$Z.name)throw $Z}return(e||JSON.stringify)(g)}(g)):g}],transformResponse:[function(g){var I=this.transitional||pn.transitional,e=I&&I.forcedJSONParsing,C="json"===this.responseType;if(Pl.isResponse(g)||Pl.isReadableStream(g))return g;if(g&&Pl.isString(g)&&(e&&!this.responseType||C)){var l=!(I&&I.silentJSONParsing)&&C;try{return JSON.parse(g)}catch($Z){if(l){if("SyntaxError"===$Z.name)throw $l.from($Z,$l.ERR_BAD_RESPONSE,this,null,this.response);throw $Z}}}return g}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:hn.classes.FormData,Blob:hn.classes.Blob},validateStatus:function(g){return g>=200&&g<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};Pl.forEach(["delete","get","head","post","put","patch"],(function(g){pn.headers[g]={}}));var Wn=pn,Vn=Pl.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),Sn=Symbol("internals");function vn(g){return g&&String(g).trim().toLowerCase()}function fn(g){return!1===g||null==g?g:Pl.isArray(g)?g.map(fn):String(g)}function Rn(g,I,e,C,l){return Pl.isFunction(C)?C.call(this,I,e):(l&&(I=e),Pl.isString(I)?Pl.isString(C)?-1!==I.indexOf(C):Pl.isRegExp(C)?C.test(I):void 0:void 0)}var Xn=function(g,I){function e(g){s(this,e),g&&this.set(g)}return G(e,[{key:"set",value:function(g,I,e){var C=this;function l(g,I,e){var l=vn(I);if(!l)throw new Error("header name must be a non-empty string");var n=Pl.findKey(C,l);(!n||void 0===C[n]||!0===e||void 0===e&&!1!==C[n])&&(C[n||I]=fn(g))}var n=function(g,I){return Pl.forEach(g,(function(g,e){return l(g,e,I)}))};if(Pl.isPlainObject(g)||g instanceof this.constructor)n(g,I);else if(Pl.isString(g)&&(g=g.trim())&&!/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(g.trim()))n(function(g){var I,e,C,l={};return g&&g.split("\n").forEach((function(g){C=g.indexOf(":"),I=g.substring(0,C).trim().toLowerCase(),e=g.substring(C+1).trim(),!I||l[I]&&Vn[I]||("set-cookie"===I?l[I]?l[I].push(e):l[I]=[e]:l[I]=l[I]?l[I]+", "+e:e)})),l}(g),I);else if(Pl.isHeaders(g)){var t,a=X(g.entries());try{for(a.s();!(t=a.n()).done;){var o=A(t.value,2),r=o[0];l(o[1],r,e)}}catch(c){a.e(c)}finally{a.f()}}else null!=g&&l(I,g,e);return this}},{key:"get",value:function(g,I){if(g=vn(g)){var e=Pl.findKey(this,g);if(e){var C=this[e];if(!I)return C;if(!0===I)return function(g){for(var I,e=Object.create(null),C=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;I=C.exec(g);)e[I[1]]=I[2];return e}(C);if(Pl.isFunction(I))return I.call(this,C,e);if(Pl.isRegExp(I))return I.exec(C);throw new TypeError("parser must be boolean|regexp|function")}}}},{key:"has",value:function(g,I){if(g=vn(g)){var e=Pl.findKey(this,g);return!(!e||void 0===this[e]||I&&!Rn(0,this[e],e,I))}return!1}},{key:"delete",value:function(g,I){var e=this,C=!1;function l(g){if(g=vn(g)){var l=Pl.findKey(e,g);!l||I&&!Rn(0,e[l],l,I)||(delete e[l],C=!0)}}return Pl.isArray(g)?g.forEach(l):l(g),C}},{key:"clear",value:function(g){for(var I=Object.keys(this),e=I.length,C=!1;e--;){var l=I[e];g&&!Rn(0,this[l],l,g,!0)||(delete this[l],C=!0)}return C}},{key:"normalize",value:function(g){var I=this,e={};return Pl.forEach(this,(function(C,l){var n=Pl.findKey(e,l);if(n)return I[n]=fn(C),void delete I[l];var t=g?function(g){return g.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(function(g,I,e){return I.toUpperCase()+e}))}(l):String(l).trim();t!==l&&delete I[l],I[t]=fn(C),e[t]=!0})),this}},{key:"concat",value:function(){for(var g,I=arguments.length,e=new Array(I),C=0;C<I;C++)e[C]=arguments[C];return(g=this.constructor).concat.apply(g,[this].concat(e))}},{key:"toJSON",value:function(g){var I=Object.create(null);return Pl.forEach(this,(function(e,C){null!=e&&!1!==e&&(I[C]=g&&Pl.isArray(e)?e.join(", "):e)})),I}},{key:Symbol.iterator,value:function(){return Object.entries(this.toJSON())[Symbol.iterator]()}},{key:"toString",value:function(){return Object.entries(this.toJSON()).map((function(g){var I=A(g,2);return I[0]+": "+I[1]})).join("\n")}},{key:Symbol.toStringTag,get:function(){return"AxiosHeaders"}}],[{key:"from",value:function(g){return g instanceof this?g:new this(g)}},{key:"concat",value:function(g){for(var I=new this(g),e=arguments.length,C=new Array(e>1?e-1:0),l=1;l<e;l++)C[l-1]=arguments[l];return C.forEach((function(g){return I.set(g)})),I}},{key:"accessor",value:function(g){var I=(this[Sn]=this[Sn]={accessors:{}}).accessors,e=this.prototype;function C(g){var C=vn(g);I[C]||(!function(g,I){var e=Pl.toCamelCase(" "+I);["get","set","has"].forEach((function(C){Object.defineProperty(g,C+e,{value:function(g,e,l){return this[C].call(this,I,g,e,l)},configurable:!0})}))}(e,g),I[C]=!0)}return Pl.isArray(g)?g.forEach(C):C(g),this}}]),e}();Xn.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]),Pl.reduceDescriptors(Xn.prototype,(function(g,I){var e=g.value,C=I[0].toUpperCase()+I.slice(1);return{get:function(){return e},set:function(g){this[C]=g}}})),Pl.freezeMethods(Xn);var Jn=Xn;function kn(g,I){var e=this||Wn,C=I||e,l=Jn.from(C.headers),n=C.data;return Pl.forEach(g,(function(g){n=g.call(e,n,l.normalize(),I?I.status:void 0)})),l.normalize(),n}function Yn(g){return!(!g||!g.__CANCEL__)}function Hn(g,I,e){$l.call(this,null==g?"canceled":g,$l.ERR_CANCELED,I,e),this.name="CanceledError"}Pl.inherits(Hn,$l,{__CANCEL__:!0});var wn=Hn;function Nn(g,I,e){var C=e.config.validateStatus;e.status&&C&&!C(e.status)?I(new $l("Request failed with status code "+e.status,[$l.ERR_BAD_REQUEST,$l.ERR_BAD_RESPONSE][Math.floor(e.status/100)-4],e.config,e.request,e)):g(e)}var Fn=function(g,I){g=g||10;var e,C=new Array(g),l=new Array(g),n=0,t=0;return I=void 0!==I?I:1e3,function(a){var o=Date.now(),A=l[t];e||(e=o),C[n]=a,l[n]=o;for(var r=t,c=0;r!==n;)c+=C[r++],r%=g;if((n=(n+1)%g)===t&&(t=(t+1)%g),!(o-e<I)){var i=A&&o-A;return i?Math.round(1e3*c/i):void 0}}};var Kn=function(g,I){var e,C,l=0,n=1e3/I,t=function(I){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Date.now();l=n,e=null,C&&(clearTimeout(C),C=null),g.apply(null,I)};return[function(){for(var g=Date.now(),I=g-l,a=arguments.length,o=new Array(a),A=0;A<a;A++)o[A]=arguments[A];I>=n?t(o,g):(e=o,C||(C=setTimeout((function(){C=null,t(e)}),n-I)))},function(){return e&&t(e)}]},xn=function(g,I){var e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:3,C=0,l=Fn(50,250);return Kn((function(e){var n=e.loaded,t=e.lengthComputable?e.total:void 0,a=n-C,o=l(a);C=n;var A=nI({loaded:n,total:t,progress:t?n/t:void 0,bytes:a,rate:o||void 0,estimated:o&&t&&n<=t?(t-n)/o:void 0,event:e,lengthComputable:null!=t},I?"download":"upload",!0);g(A)}),e)},zn=function(g,I){var e=null!=g;return[function(C){return I[0]({lengthComputable:e,total:g,loaded:C})},I[1]]},En=function(g){return function(){for(var I=arguments.length,e=new Array(I),C=0;C<I;C++)e[C]=arguments[C];return Pl.asap((function(){return g.apply(void 0,e)}))}},Un=hn.hasStandardBrowserEnv?function(){var g,I=/(msie|trident)/i.test(navigator.userAgent),e=document.createElement("a");function C(g){var C=g;return I&&(e.setAttribute("href",C),C=e.href),e.setAttribute("href",C),{href:e.href,protocol:e.protocol?e.protocol.replace(/:$/,""):"",host:e.host,search:e.search?e.search.replace(/^\?/,""):"",hash:e.hash?e.hash.replace(/^#/,""):"",hostname:e.hostname,port:e.port,pathname:"/"===e.pathname.charAt(0)?e.pathname:"/"+e.pathname}}return g=C(window.location.href),function(I){var e=Pl.isString(I)?C(I):I;return e.protocol===g.protocol&&e.host===g.host}}():function(){return!0},Qn=hn.hasStandardBrowserEnv?{write:function(g,I,e,C,l,n){var t=[g+"="+encodeURIComponent(I)];Pl.isNumber(e)&&t.push("expires="+new Date(e).toGMTString()),Pl.isString(C)&&t.push("path="+C),Pl.isString(l)&&t.push("domain="+l),!0===n&&t.push("secure"),document.cookie=t.join("; ")},read:function(g){var I=document.cookie.match(new RegExp("(^|;\\s*)("+g+")=([^;]*)"));return I?decodeURIComponent(I[3]):null},remove:function(g){this.write(g,"",Date.now()-864e5)}}:{write:function(){},read:function(){return null},remove:function(){}};function Mn(g,I){return g&&!/^([a-z][a-z\d+\-.]*:)?\/\//i.test(I)?function(g,I){return I?g.replace(/\/?\/$/,"")+"/"+I.replace(/^\/+/,""):g}(g,I):I}var Ln=function(g){return g instanceof Jn?aI({},g):g};function Dn(g,I){I=I||{};var e={};function C(g,I,e){return Pl.isPlainObject(g)&&Pl.isPlainObject(I)?Pl.merge.call({caseless:e},g,I):Pl.isPlainObject(I)?Pl.merge({},I):Pl.isArray(I)?I.slice():I}function l(g,I,e){return Pl.isUndefined(I)?Pl.isUndefined(g)?void 0:C(void 0,g,e):C(g,I,e)}function n(g,I){if(!Pl.isUndefined(I))return C(void 0,I)}function t(g,I){return Pl.isUndefined(I)?Pl.isUndefined(g)?void 0:C(void 0,g):C(void 0,I)}function a(e,l,n){return n in I?C(e,l):n in g?C(void 0,e):void 0}var o={url:n,method:n,data:n,baseURL:t,transformRequest:t,transformResponse:t,paramsSerializer:t,timeout:t,timeoutMessage:t,withCredentials:t,withXSRFToken:t,adapter:t,responseType:t,xsrfCookieName:t,xsrfHeaderName:t,onUploadProgress:t,onDownloadProgress:t,decompress:t,maxContentLength:t,maxBodyLength:t,beforeRedirect:t,transport:t,httpAgent:t,httpsAgent:t,cancelToken:t,socketPath:t,responseEncoding:t,validateStatus:a,headers:function(g,I){return l(Ln(g),Ln(I),!0)}};return Pl.forEach(Object.keys(Object.assign({},g,I)),(function(C){var n=o[C]||l,t=n(g[C],I[C],C);Pl.isUndefined(t)&&n!==a||(e[C]=t)})),e}var Tn=function(g){var I,e=Dn({},g),C=e.data,l=e.withXSRFToken,n=e.xsrfHeaderName,t=e.xsrfCookieName,a=e.headers,o=e.auth;if(e.headers=a=Jn.from(a),e.url=rn(Mn(e.baseURL,e.url),g.params,g.paramsSerializer),o&&a.set("Authorization","Basic "+btoa((o.username||"")+":"+(o.password?unescape(encodeURIComponent(o.password)):""))),Pl.isFormData(C))if(hn.hasStandardBrowserEnv||hn.hasStandardBrowserWebWorkerEnv)a.setContentType(void 0);else if(!1!==(I=a.getContentType())){var A=R(I?I.split(";").map((function(g){return g.trim()})).filter(Boolean):[]),r=A[0],c=A.slice(1);a.setContentType([r||"multipart/form-data"].concat(u(c)).join("; "))}if(hn.hasStandardBrowserEnv&&(l&&Pl.isFunction(l)&&(l=l(e)),l||!1!==l&&Un(e.url))){var i=n&&t&&Qn.read(t);i&&a.set(n,i)}return e},jn="undefined"!==typeof XMLHttpRequest&&function(g){return new Promise((function(I,e){var C,l,n,t,a,o=Tn(g),r=o.data,c=Jn.from(o.headers).normalize(),i=o.responseType,d=o.onUploadProgress,u=o.onDownloadProgress;function s(){t&&t(),a&&a(),o.cancelToken&&o.cancelToken.unsubscribe(C),o.signal&&o.signal.removeEventListener("abort",C)}var m=new XMLHttpRequest;function b(){if(m){var C=Jn.from("getAllResponseHeaders"in m&&m.getAllResponseHeaders());Nn((function(g){I(g),s()}),(function(g){e(g),s()}),{data:i&&"text"!==i&&"json"!==i?m.response:m.responseText,status:m.status,statusText:m.statusText,headers:C,config:g,request:m}),m=null}}if(m.open(o.method.toUpperCase(),o.url,!0),m.timeout=o.timeout,"onloadend"in m?m.onloadend=b:m.onreadystatechange=function(){m&&4===m.readyState&&(0!==m.status||m.responseURL&&0===m.responseURL.indexOf("file:"))&&setTimeout(b)},m.onabort=function(){m&&(e(new $l("Request aborted",$l.ECONNABORTED,g,m)),m=null)},m.onerror=function(){e(new $l("Network Error",$l.ERR_NETWORK,g,m)),m=null},m.ontimeout=function(){var I=o.timeout?"timeout of "+o.timeout+"ms exceeded":"timeout exceeded",C=o.transitional||sn;o.timeoutErrorMessage&&(I=o.timeoutErrorMessage),e(new $l(I,C.clarifyTimeoutError?$l.ETIMEDOUT:$l.ECONNABORTED,g,m)),m=null},void 0===r&&c.setContentType(null),"setRequestHeader"in m&&Pl.forEach(c.toJSON(),(function(g,I){m.setRequestHeader(I,g)})),Pl.isUndefined(o.withCredentials)||(m.withCredentials=!!o.withCredentials),i&&"json"!==i&&(m.responseType=o.responseType),u){var Z=A(xn(u,!0),2);n=Z[0],a=Z[1],m.addEventListener("progress",n)}if(d&&m.upload){var G=A(xn(d),2);l=G[0],t=G[1],m.upload.addEventListener("progress",l),m.upload.addEventListener("loadend",t)}(o.cancelToken||o.signal)&&(C=function(I){m&&(e(!I||I.type?new wn(null,g,m):I),m.abort(),m=null)},o.cancelToken&&o.cancelToken.subscribe(C),o.signal&&(o.signal.aborted?C():o.signal.addEventListener("abort",C)));var y=function(g){var I=/^([-+\w]{1,25})(:?\/\/|:)/.exec(g);return I&&I[1]||""}(o.url);y&&-1===hn.protocols.indexOf(y)?e(new $l("Unsupported protocol "+y+":",$l.ERR_BAD_REQUEST,g)):m.send(r||null)}))},Pn=function(g,I){var e,C=new AbortController,l=function(g){if(!e){e=!0,t();var I=g instanceof Error?g:this.reason;C.abort(I instanceof $l?I:new wn(I instanceof Error?I.message:I))}},n=I&&setTimeout((function(){l(new $l("timeout ".concat(I," of ms exceeded"),$l.ETIMEDOUT))}),I),t=function(){g&&(n&&clearTimeout(n),n=null,g.forEach((function(g){g&&(g.removeEventListener?g.removeEventListener("abort",l):g.unsubscribe(l))})),g=null)};g.forEach((function(g){return g&&g.addEventListener&&g.addEventListener("abort",l)}));var a=C.signal;return a.unsubscribe=t,[a,function(){n&&clearTimeout(n),n=null}]};function On(g,I){this.v=g,this.k=I}function qn(g){var I,e;function C(I,e){try{var n=g[I](e),t=n.value,a=t instanceof On;Promise.resolve(a?t.v:t).then((function(e){if(a){var o="return"===I?"return":"next";if(!t.k||e.done)return C(o,e);e=g[o](e).value}l(n.done?"return":"normal",e)}),(function(g){C("throw",g)}))}catch(o){l("throw",o)}}function l(g,l){switch(g){case"return":I.resolve({value:l,done:!0});break;case"throw":I.reject(l);break;default:I.resolve({value:l,done:!1})}(I=I.next)?C(I.key,I.arg):e=null}this._invoke=function(g,l){return new Promise((function(n,t){var a={key:g,arg:l,resolve:n,reject:t,next:null};e?e=e.next=a:(I=e=a,C(g,l))}))},"function"!=typeof g.return&&(this.return=void 0)}function _n(g){return new On(g,0)}function $n(g){var I={},e=!1;function C(I,C){return e=!0,{done:!1,value:new On(C=new Promise((function(e){e(g[I](C))})),1)}}return I["undefined"!=typeof Symbol&&Symbol.iterator||"@@iterator"]=function(){return this},I.next=function(g){return e?(e=!1,g):C("next",g)},"function"==typeof g.throw&&(I.throw=function(g){if(e)throw e=!1,g;return C("throw",g)}),"function"==typeof g.return&&(I.return=function(g){return e?(e=!1,g):C("return",g)}),I}function gt(g){var I,e,C,l=2;for("undefined"!=typeof Symbol&&(e=Symbol.asyncIterator,C=Symbol.iterator);l--;){if(e&&null!=(I=g[e]))return I.call(g);if(C&&null!=(I=g[C]))return new It(I.call(g));e="@@asyncIterator",C="@@iterator"}throw new TypeError("Object is not async iterable")}function It(g){function I(g){if(Object(g)!==g)return Promise.reject(new TypeError(g+" is not an object."));var I=g.done;return Promise.resolve(g.value).then((function(g){return{value:g,done:I}}))}return It=function(g){this.s=g,this.n=g.next},It.prototype={s:null,n:null,next:function(){return I(this.n.apply(this.s,arguments))},return:function(g){var e=this.s.return;return void 0===e?Promise.resolve({value:g,done:!0}):I(e.apply(this.s,arguments))},throw:function(g){var e=this.s.return;return void 0===e?Promise.reject(g):I(e.apply(this.s,arguments))}},new It(g)}qn.prototype["function"==typeof Symbol&&Symbol.asyncIterator||"@@asyncIterator"]=function(){return this},qn.prototype.next=function(g){return this._invoke("next",g)},qn.prototype.throw=function(g){return this._invoke("throw",g)},qn.prototype.return=function(g){return this._invoke("return",g)};var et,Ct,lt=oI().mark((function g(I,e){var C,l,n;return oI().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:if(C=I.byteLength,e&&!(C<e)){g.next=5;break}return g.next=4,I;case 4:return g.abrupt("return");case 5:l=0;case 6:if(!(l<C)){g.next=13;break}return n=l+e,g.next=10,I.slice(l,n);case 10:l=n,g.next=6;break;case 13:case"end":return g.stop()}}),g)})),nt=function(){var g,I=(g=oI().mark((function g(I,e,C){var l,n,t,a,o,A;return oI().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:l=!1,n=!1,g.prev=2,a=gt(I);case 4:return g.next=6,_n(a.next());case 6:if(!(l=!(o=g.sent).done)){g.next=27;break}if(A=o.value,g.t0=$n,g.t1=gt,g.t2=lt,!ArrayBuffer.isView(A)){g.next=15;break}g.t3=A,g.next=18;break;case 15:return g.next=17,_n(C(String(A)));case 17:g.t3=g.sent;case 18:return g.t4=g.t3,g.t5=e,g.t6=(0,g.t2)(g.t4,g.t5),g.t7=(0,g.t1)(g.t6),g.t8=_n,g.delegateYield((0,g.t0)(g.t7,g.t8),"t9",24);case 24:l=!1,g.next=4;break;case 27:g.next=33;break;case 29:g.prev=29,g.t10=g.catch(2),n=!0,t=g.t10;case 33:if(g.prev=33,g.prev=34,!l||null==a.return){g.next=38;break}return g.next=38,_n(a.return());case 38:if(g.prev=38,!n){g.next=41;break}throw t;case 41:return g.finish(38);case 42:return g.finish(33);case 43:case"end":return g.stop()}}),g,null,[[2,29,33,43],[34,,38,42]])})),function(){return new qn(g.apply(this,arguments))});return function(g,e,C){return I.apply(this,arguments)}}(),tt=function(g,I,e,C,l){var n,t=nt(g,I,l),a=0,o=function(g){n||(n=!0,C&&C(g))};return new ReadableStream({pull:function(g){return rI(oI().mark((function I(){var C,l,n,A,r;return oI().wrap((function(I){for(;;)switch(I.prev=I.next){case 0:return I.prev=0,I.next=3,t.next();case 3:if(C=I.sent,l=C.done,n=C.value,!l){I.next=10;break}return o(),g.close(),I.abrupt("return");case 10:A=n.byteLength,e&&(r=a+=A,e(r)),g.enqueue(new Uint8Array(n)),I.next=19;break;case 15:throw I.prev=15,I.t0=I.catch(0),o(I.t0),I.t0;case 19:case"end":return I.stop()}}),I,null,[[0,15]])})))()},cancel:function(g){return o(g),t.return()}},{highWaterMark:2})},at="function"===typeof fetch&&"function"===typeof Request&&"function"===typeof Response,ot=at&&"function"===typeof ReadableStream,At=at&&("function"===typeof TextEncoder?(et=new TextEncoder,function(g){return et.encode(g)}):function(){var g=rI(oI().mark((function g(I){return oI().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:return g.t0=Uint8Array,g.next=3,new Response(I).arrayBuffer();case 3:return g.t1=g.sent,g.abrupt("return",new g.t0(g.t1));case 5:case"end":return g.stop()}}),g)})));return function(I){return g.apply(this,arguments)}}()),rt=function(g){try{for(var I=arguments.length,e=new Array(I>1?I-1:0),C=1;C<I;C++)e[C-1]=arguments[C];return!!g.apply(void 0,e)}catch($Z){return!1}},ct=ot&&rt((function(){var g=!1,I=new Request(hn.origin,{body:new ReadableStream,method:"POST",get duplex(){return g=!0,"half"}}).headers.has("Content-Type");return g&&!I})),it=ot&&rt((function(){return Pl.isReadableStream(new Response("").body)})),dt={stream:it&&function(g){return g.body}};at&&(Ct=new Response,["text","arrayBuffer","blob","formData","stream"].forEach((function(g){!dt[g]&&(dt[g]=Pl.isFunction(Ct[g])?function(I){return I[g]()}:function(I,e){throw new $l("Response type '".concat(g,"' is not supported"),$l.ERR_NOT_SUPPORT,e)})})));var ut=function(){var g=rI(oI().mark((function g(I){return oI().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:if(null!=I){g.next=2;break}return g.abrupt("return",0);case 2:if(!Pl.isBlob(I)){g.next=4;break}return g.abrupt("return",I.size);case 4:if(!Pl.isSpecCompliantForm(I)){g.next=8;break}return g.next=7,new Request(I).arrayBuffer();case 7:case 14:return g.abrupt("return",g.sent.byteLength);case 8:if(!Pl.isArrayBufferView(I)&&!Pl.isArrayBuffer(I)){g.next=10;break}return g.abrupt("return",I.byteLength);case 10:if(Pl.isURLSearchParams(I)&&(I+=""),!Pl.isString(I)){g.next=15;break}return g.next=14,At(I);case 15:case"end":return g.stop()}}),g)})));return function(I){return g.apply(this,arguments)}}(),st=function(){var g=rI(oI().mark((function g(I,e){var C;return oI().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:return C=Pl.toFiniteNumber(I.getContentLength()),g.abrupt("return",null==C?ut(e):C);case 2:case"end":return g.stop()}}),g)})));return function(I,e){return g.apply(this,arguments)}}(),mt=at&&function(){var g=rI(oI().mark((function g(I){var e,C,l,n,t,a,o,r,c,i,d,u,s,m,b,Z,G,y,h,B,p,W,V,S,v,f,R,X,J,k,Y,H,w,N,F,K,x;return oI().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:if(e=Tn(I),C=e.url,l=e.method,n=e.data,t=e.signal,a=e.cancelToken,o=e.timeout,r=e.onDownloadProgress,c=e.onUploadProgress,i=e.responseType,d=e.headers,u=e.withCredentials,s=void 0===u?"same-origin":u,m=e.fetchOptions,i=i?(i+"").toLowerCase():"text",b=t||a||o?Pn([t,a],o):[],Z=A(b,2),G=Z[0],y=Z[1],p=function(){!h&&setTimeout((function(){G&&G.unsubscribe()})),h=!0},g.prev=4,g.t0=c&&ct&&"get"!==l&&"head"!==l,!g.t0){g.next=11;break}return g.next=9,st(d,n);case 9:g.t1=W=g.sent,g.t0=0!==g.t1;case 11:if(!g.t0){g.next=15;break}V=new Request(C,{method:"POST",body:n,duplex:"half"}),Pl.isFormData(n)&&(S=V.headers.get("content-type"))&&d.setContentType(S),V.body&&(v=zn(W,xn(En(c))),f=A(v,2),R=f[0],X=f[1],n=tt(V.body,65536,R,X,At));case 15:return Pl.isString(s)||(s=s?"include":"omit"),B=new Request(C,aI(aI({},m),{},{signal:G,method:l.toUpperCase(),headers:d.normalize().toJSON(),body:n,duplex:"half",credentials:s})),g.next=19,fetch(B);case 19:return J=g.sent,k=it&&("stream"===i||"response"===i),it&&(r||k)&&(Y={},["status","statusText","headers"].forEach((function(g){Y[g]=J[g]})),H=Pl.toFiniteNumber(J.headers.get("content-length")),w=r&&zn(H,xn(En(r),!0))||[],N=A(w,2),F=N[0],K=N[1],J=new Response(tt(J.body,65536,F,(function(){K&&K(),k&&p()}),At),Y)),i=i||"text",g.next=25,dt[Pl.findKey(dt,i)||"text"](J,I);case 25:return x=g.sent,!k&&p(),y&&y(),g.next=30,new Promise((function(g,e){Nn(g,e,{data:x,headers:Jn.from(J.headers),status:J.status,statusText:J.statusText,config:I,request:B})}));case 30:return g.abrupt("return",g.sent);case 33:if(g.prev=33,g.t2=g.catch(4),p(),!g.t2||"TypeError"!==g.t2.name||!/fetch/i.test(g.t2.message)){g.next=38;break}throw Object.assign(new $l("Network Error",$l.ERR_NETWORK,I,B),{cause:g.t2.cause||g.t2});case 38:throw $l.from(g.t2,g.t2&&g.t2.code,I,B);case 39:case"end":return g.stop()}}),g,null,[[4,33]])})));return function(I){return g.apply(this,arguments)}}(),bt={http:null,xhr:jn,fetch:mt};Pl.forEach(bt,(function(g,I){if(g){try{Object.defineProperty(g,"name",{value:I})}catch($Z){}Object.defineProperty(g,"adapterName",{value:I})}}));var Zt=function(g){return"- ".concat(g)},Gt=function(g){return Pl.isFunction(g)||null===g||!1===g},yt=function(g){for(var I,e,C=(g=Pl.isArray(g)?g:[g]).length,l={},n=0;n<C;n++){var t=void 0;if(e=I=g[n],!Gt(I)&&void 0===(e=bt[(t=String(I)).toLowerCase()]))throw new $l("Unknown adapter '".concat(t,"'"));if(e)break;l[t||"#"+n]=e}if(!e){var a=Object.entries(l).map((function(g){var I=A(g,2),e=I[0],C=I[1];return"adapter ".concat(e," ")+(!1===C?"is not supported by the environment":"is not available in the build")})),o=C?a.length>1?"since :\n"+a.map(Zt).join("\n"):" "+Zt(a[0]):"as no adapter specified";throw new $l("There is no suitable adapter to dispatch the request "+o,"ERR_NOT_SUPPORT")}return e};function ht(g){if(g.cancelToken&&g.cancelToken.throwIfRequested(),g.signal&&g.signal.aborted)throw new wn(null,g)}function Bt(g){return ht(g),g.headers=Jn.from(g.headers),g.data=kn.call(g,g.transformRequest),-1!==["post","put","patch"].indexOf(g.method)&&g.headers.setContentType("application/x-www-form-urlencoded",!1),yt(g.adapter||Wn.adapter)(g).then((function(I){return ht(g),I.data=kn.call(g,g.transformResponse,I),I.headers=Jn.from(I.headers),I}),(function(I){return Yn(I)||(ht(g),I&&I.response&&(I.response.data=kn.call(g,g.transformResponse,I.response),I.response.headers=Jn.from(I.response.headers))),Promise.reject(I)}))}var pt="1.7.4",Wt={};["object","boolean","number","function","string","symbol"].forEach((function(g,I){Wt[g]=function(e){return typeof e===g||"a"+(I<1?"n ":" ")+g}}));var Vt={};Wt.transitional=function(g,I,e){function C(g,I){return"[Axios v1.7.4] Transitional option '"+g+"'"+I+(e?". "+e:"")}return function(e,l,n){if(!1===g)throw new $l(C(l," has been removed"+(I?" in "+I:"")),$l.ERR_DEPRECATED);return I&&!Vt[l]&&(Vt[l]=!0,console.warn(C(l," has been deprecated since v"+I+" and will be removed in the near future"))),!g||g(e,l,n)}};var St={assertOptions:function(g,I,e){if("object"!==typeof g)throw new $l("options must be an object",$l.ERR_BAD_OPTION_VALUE);for(var C=Object.keys(g),l=C.length;l-- >0;){var n=C[l],t=I[n];if(t){var a=g[n],o=void 0===a||t(a,n,g);if(!0!==o)throw new $l("option "+n+" must be "+o,$l.ERR_BAD_OPTION_VALUE)}else if(!0!==e)throw new $l("Unknown option "+n,$l.ERR_BAD_OPTION)}},validators:Wt},vt=St.validators,ft=function(){function g(I){s(this,g),this.defaults=I,this.interceptors={request:new un,response:new un}}return G(g,[{key:"request",value:function(){var g=rI(oI().mark((function g(I,e){var C,l;return oI().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:return g.prev=0,g.next=3,this._request(I,e);case 3:return g.abrupt("return",g.sent);case 6:if(g.prev=6,g.t0=g.catch(0),g.t0 instanceof Error){Error.captureStackTrace?Error.captureStackTrace(C={}):C=new Error,l=C.stack?C.stack.replace(/^.+\n/,""):"";try{g.t0.stack?l&&!String(g.t0.stack).endsWith(l.replace(/^.+\n.+\n/,""))&&(g.t0.stack+="\n"+l):g.t0.stack=l}catch($Z){}}throw g.t0;case 10:case"end":return g.stop()}}),g,this,[[0,6]])})));return function(I,e){return g.apply(this,arguments)}}()},{key:"_request",value:function(g,I){"string"===typeof g?(I=I||{}).url=g:I=g||{};var e=I=Dn(this.defaults,I),C=e.transitional,l=e.paramsSerializer,n=e.headers;void 0!==C&&St.assertOptions(C,{silentJSONParsing:vt.transitional(vt.boolean),forcedJSONParsing:vt.transitional(vt.boolean),clarifyTimeoutError:vt.transitional(vt.boolean)},!1),null!=l&&(Pl.isFunction(l)?I.paramsSerializer={serialize:l}:St.assertOptions(l,{encode:vt.function,serialize:vt.function},!0)),I.method=(I.method||this.defaults.method||"get").toLowerCase();var t=n&&Pl.merge(n.common,n[I.method]);n&&Pl.forEach(["delete","get","head","post","put","patch","common"],(function(g){delete n[g]})),I.headers=Jn.concat(t,n);var a=[],o=!0;this.interceptors.request.forEach((function(g){"function"===typeof g.runWhen&&!1===g.runWhen(I)||(o=o&&g.synchronous,a.unshift(g.fulfilled,g.rejected))}));var A,r=[];this.interceptors.response.forEach((function(g){r.push(g.fulfilled,g.rejected)}));var c,i=0;if(!o){var d=[Bt.bind(this),void 0];for(d.unshift.apply(d,a),d.push.apply(d,r),c=d.length,A=Promise.resolve(I);i<c;)A=A.then(d[i++],d[i++]);return A}c=a.length;var u=I;for(i=0;i<c;){var s=a[i++],m=a[i++];try{u=s(u)}catch(b){m.call(this,b);break}}try{A=Bt.call(this,u)}catch(b){return Promise.reject(b)}for(i=0,c=r.length;i<c;)A=A.then(r[i++],r[i++]);return A}},{key:"getUri",value:function(g){return rn(Mn((g=Dn(this.defaults,g)).baseURL,g.url),g.params,g.paramsSerializer)}}]),g}();Pl.forEach(["delete","get","head","options"],(function(g){ft.prototype[g]=function(I,e){return this.request(Dn(e||{},{method:g,url:I,data:(e||{}).data}))}})),Pl.forEach(["post","put","patch"],(function(g){function I(I){return function(e,C,l){return this.request(Dn(l||{},{method:g,headers:I?{"Content-Type":"multipart/form-data"}:{},url:e,data:C}))}}ft.prototype[g]=I(),ft.prototype[g+"Form"]=I(!0)}));var Rt=ft,Xt=function(){function g(I){if(s(this,g),"function"!==typeof I)throw new TypeError("executor must be a function.");var e;this.promise=new Promise((function(g){e=g}));var C=this;this.promise.then((function(g){if(C._listeners){for(var I=C._listeners.length;I-- >0;)C._listeners[I](g);C._listeners=null}})),this.promise.then=function(g){var I,e=new Promise((function(g){C.subscribe(g),I=g})).then(g);return e.cancel=function(){C.unsubscribe(I)},e},I((function(g,I,l){C.reason||(C.reason=new wn(g,I,l),e(C.reason))}))}return G(g,[{key:"throwIfRequested",value:function(){if(this.reason)throw this.reason}},{key:"subscribe",value:function(g){this.reason?g(this.reason):this._listeners?this._listeners.push(g):this._listeners=[g]}},{key:"unsubscribe",value:function(g){if(this._listeners){var I=this._listeners.indexOf(g);-1!==I&&this._listeners.splice(I,1)}}}],[{key:"source",value:function(){var I;return{token:new g((function(g){I=g})),cancel:I}}}]),g}(),Jt=Xt;var kt={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(kt).forEach((function(g){var I=A(g,2),e=I[0],C=I[1];kt[C]=e}));var Yt=kt;var Ht=function g(I){var e=new Rt(I),C=ol(Rt.prototype.request,e);return Pl.extend(C,Rt.prototype,e,{allOwnKeys:!0}),Pl.extend(C,e,null,{allOwnKeys:!0}),C.create=function(e){return g(Dn(I,e))},C}(Wn);Ht.Axios=Rt,Ht.CanceledError=wn,Ht.CancelToken=Jt,Ht.isCancel=Yn,Ht.VERSION=pt,Ht.toFormData=ln,Ht.AxiosError=$l,Ht.Cancel=Ht.CanceledError,Ht.all=function(g){return Promise.all(g)},Ht.spread=function(g){return function(I){return g.apply(null,I)}},Ht.isAxiosError=function(g){return Pl.isObject(g)&&!0===g.isAxiosError},Ht.mergeConfig=Dn,Ht.AxiosHeaders=Jn,Ht.formToJSON=function(g){return Bn(Pl.isHTMLForm(g)?new FormData(g):g)},Ht.getAdapter=yt,Ht.HttpStatusCode=Yt,Ht.default=Ht;var wt=Ht;function Nt(){return Nt=Object.assign?Object.assign.bind():function(g){for(var I=1;I<arguments.length;I++){var e=arguments[I];for(var C in e)Object.prototype.hasOwnProperty.call(e,C)&&(g[C]=e[C])}return g},Nt.apply(this,arguments)}function Ft(){for(var g=arguments.length,I=new Array(g),e=0;e<g;e++)I[e]=arguments[e];return function(g){return I.forEach((function(I){return function(g,I){"function"===typeof g?g(I):null!==g&&void 0!==g&&(g.current=I)}(I,g)}))}}var Kt=["children"],xt=["children"],zt=(0,I.forwardRef)((function(g,e){var C=g.children,l=cI(g,Kt),n=I.Children.toArray(C),t=n.find(Qt);if(t){var a=t.props.children,o=n.map((function(g){return g===t?I.Children.count(a)>1?I.Children.only(null):(0,I.isValidElement)(a)?a.props.children:null:g}));return(0,I.createElement)(Et,Nt({},l,{ref:e}),(0,I.isValidElement)(a)?(0,I.cloneElement)(a,void 0,o):null)}return(0,I.createElement)(Et,Nt({},l,{ref:e}),C)}));zt.displayName="Slot";var Et=(0,I.forwardRef)((function(g,e){var C=g.children,l=cI(g,xt);return(0,I.isValidElement)(C)?(0,I.cloneElement)(C,aI(aI({},function(g,I){var e=aI({},I),C=function(){var C=g[l],n=I[l];/^on[A-Z]/.test(l)?C&&n?e[l]=function(){n.apply(void 0,arguments),C.apply(void 0,arguments)}:C&&(e[l]=C):"style"===l?e[l]=aI(aI({},C),n):"className"===l&&(e[l]=[C,n].filter(Boolean).join(" "))};for(var l in I)C();return aI(aI({},g),e)}(l,C.props)),{},{ref:e?Ft(e,C.ref):C.ref})):I.Children.count(C)>1?I.Children.only(null):null}));Et.displayName="SlotClone";var Ut=function(g){var e=g.children;return(0,I.createElement)(I.Fragment,null,e)};function Qt(g){return(0,I.isValidElement)(g)&&g.type===Ut}function Mt(g){var I,e,C="";if("string"==typeof g||"number"==typeof g)C+=g;else if("object"==typeof g)if(Array.isArray(g))for(I=0;I<g.length;I++)g[I]&&(e=Mt(g[I]))&&(C&&(C+=" "),C+=e);else for(I in g)g[I]&&(C&&(C+=" "),C+=I);return C}function Lt(){for(var g,I,e=0,C="";e<arguments.length;)(g=arguments[e++])&&(I=Mt(g))&&(C&&(C+=" "),C+=I);return C}var Dt=["class","className"],Tt=function(g){return"boolean"===typeof g?"".concat(g):0===g?"0":g},jt=Lt,Pt=function(g,I){return function(e){var C;if(null==(null===I||void 0===I?void 0:I.variants))return jt(g,null===e||void 0===e?void 0:e.class,null===e||void 0===e?void 0:e.className);var l=I.variants,n=I.defaultVariants,t=Object.keys(l).map((function(g){var I=null===e||void 0===e?void 0:e[g],C=null===n||void 0===n?void 0:n[g];if(null===I)return null;var t=Tt(I)||Tt(C);return l[g][t]})),a=e&&Object.entries(e).reduce((function(g,I){var e=A(I,2),C=e[0],l=e[1];return void 0===l||(g[C]=l),g}),{}),o=null===I||void 0===I||null===(C=I.compoundVariants)||void 0===C?void 0:C.reduce((function(g,I){var e=I.class,C=I.className,l=cI(I,Dt);return Object.entries(l).every((function(g){var I=A(g,2),e=I[0],C=I[1];return Array.isArray(C)?C.includes(aI(aI({},n),a)[e]):aI(aI({},n),a)[e]===C}))?[].concat(u(g),[e,C]):g}),[]);return jt(g,t,o,null===e||void 0===e?void 0:e.class,null===e||void 0===e?void 0:e.className)}};function Ot(g){var I,e,C="";if("string"==typeof g||"number"==typeof g)C+=g;else if("object"==typeof g)if(Array.isArray(g)){var l=g.length;for(I=0;I<l;I++)g[I]&&(e=Ot(g[I]))&&(C&&(C+=" "),C+=e)}else for(e in g)g[e]&&(C&&(C+=" "),C+=e);return C}function qt(){for(var g,I,e=0,C="",l=arguments.length;e<l;e++)(g=arguments[e])&&(I=Ot(g))&&(C&&(C+=" "),C+=I);return C}var _t="-";function $t(g){var I=function(g){var I=g.theme,e=g.prefix,C={nextPart:new Map,validators:[]},l=function(g,I){if(!I)return g;return g.map((function(g){return[g[0],g[1].map((function(g){return"string"===typeof g?I+g:"object"===typeof g?Object.fromEntries(Object.entries(g).map((function(g){var e=g[0],C=g[1];return[I+e,C]}))):g}))]}))}(Object.entries(g.classGroups),e);return l.forEach((function(g){var e=g[0];ea(g[1],C,e,I)})),C}(g),e=g.conflictingClassGroups,C=g.conflictingClassGroupModifiers,l=void 0===C?{}:C;return{getClassGroupId:function(g){var e=g.split(_t);return""===e[0]&&1!==e.length&&e.shift(),ga(e,I)||function(g){if(Ia.test(g)){var I=Ia.exec(g)[1],e=null===I||void 0===I?void 0:I.substring(0,I.indexOf(":"));if(e)return"arbitrary.."+e}}(g)},getConflictingClassGroupIds:function(g,I){var C=e[g]||[];return I&&l[g]?[].concat(C,l[g]):C}}}function ga(g,I){var e;if(0===g.length)return I.classGroupId;var C=g[0],l=I.nextPart.get(C),n=l?ga(g.slice(1),l):void 0;if(n)return n;if(0!==I.validators.length){var t=g.join(_t);return null===(e=I.validators.find((function(g){return(0,g.validator)(t)})))||void 0===e?void 0:e.classGroupId}}var Ia=/^\[(.+)\]$/;function ea(g,I,e,C){g.forEach((function(g){if("string"!==typeof g){if("function"===typeof g)return g.isThemeGetter?void ea(g(C),I,e,C):void I.validators.push({validator:g,classGroupId:e});Object.entries(g).forEach((function(g){var l=g[0];ea(g[1],Ca(I,l),e,C)}))}else{(""===g?I:Ca(I,g)).classGroupId=e}}))}function Ca(g,I){var e=g;return I.split(_t).forEach((function(g){e.nextPart.has(g)||e.nextPart.set(g,{nextPart:new Map,validators:[]}),e=e.nextPart.get(g)})),e}function la(g){if(g<1)return{get:function(){},set:function(){}};var I=0,e=new Map,C=new Map;function l(l,n){e.set(l,n),++I>g&&(I=0,C=e,e=new Map)}return{get:function(g){var I=e.get(g);return void 0!==I?I:void 0!==(I=C.get(g))?(l(g,I),I):void 0},set:function(g,I){e.has(g)?e.set(g,I):l(g,I)}}}var na="!";function ta(g){var I=g.separator||":",e=1===I.length,C=I[0],l=I.length;return function(g){for(var n,t=[],a=0,o=0,A=0;A<g.length;A++){var r=g[A];if(0===a){if(r===C&&(e||g.slice(A,A+l)===I)){t.push(g.slice(o,A)),o=A+l;continue}if("/"===r){n=A;continue}}"["===r?a++:"]"===r&&a--}var c=0===t.length?g:g.substring(o),i=c.startsWith(na);return{modifiers:t,hasImportantModifier:i,baseClassName:i?c.substring(1):c,maybePostfixModifierPosition:n&&n>o?n-o:void 0}}}var aa=/\s+/;function oa(){for(var g,I,e=0,C="";e<arguments.length;)(g=arguments[e++])&&(I=Aa(g))&&(C&&(C+=" "),C+=I);return C}function Aa(g){if("string"===typeof g)return g;for(var I,e="",C=0;C<g.length;C++)g[C]&&(I=Aa(g[C]))&&(e&&(e+=" "),e+=I);return e}function ra(){for(var g=arguments.length,I=new Array(g),e=0;e<g;e++)I[e]=arguments[e];var C,l,n,t=function(g){var e=I[0],o=I.slice(1).reduce((function(g,I){return I(g)}),e());return C=function(g){return aI({cache:la(g.cacheSize),splitModifiers:ta(g)},$t(g))}(o),l=C.cache.get,n=C.cache.set,t=a,a(g)};function a(g){var I=l(g);if(I)return I;var e=function(g,I){var e=I.splitModifiers,C=I.getClassGroupId,l=I.getConflictingClassGroupIds,n=new Set;return g.trim().split(aa).map((function(g){var I=e(g),l=I.modifiers,n=I.hasImportantModifier,t=I.baseClassName,a=I.maybePostfixModifierPosition,o=C(a?t.substring(0,a):t),A=Boolean(a);if(!o){if(!a)return{isTailwindClass:!1,originalClassName:g};if(!(o=C(t)))return{isTailwindClass:!1,originalClassName:g};A=!1}var r=function(g){if(g.length<=1)return g;var I=[],e=[];return g.forEach((function(g){"["===g[0]?(I.push.apply(I,e.sort().concat([g])),e=[]):e.push(g)})),I.push.apply(I,e.sort()),I}(l).join(":");return{isTailwindClass:!0,modifierId:n?r+na:r,classGroupId:o,originalClassName:g,hasPostfixModifier:A}})).reverse().filter((function(g){if(!g.isTailwindClass)return!0;var I=g.modifierId,e=g.classGroupId,C=g.hasPostfixModifier,t=I+e;return!n.has(t)&&(n.add(t),l(e,C).forEach((function(g){return n.add(I+g)})),!0)})).reverse().map((function(g){return g.originalClassName})).join(" ")}(g,C);return n(g,e),e}return function(){return t(oa.apply(null,arguments))}}function ca(g){var I=function(I){return I[g]||[]};return I.isThemeGetter=!0,I}var ia=/^\[(?:([a-z-]+):)?(.+)\]$/i,da=/^\d+\/\d+$/,ua=new Set(["px","full","screen"]),sa=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,ma=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,ba=/^-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/;function Za(g){return Wa(g)||ua.has(g)||da.test(g)||Ga(g)}function Ga(g){return Ja(g,"length",ka)}function ya(g){return Ja(g,"size",Ya)}function ha(g){return Ja(g,"position",Ya)}function Ba(g){return Ja(g,"url",Ha)}function pa(g){return Ja(g,"number",Wa)}function Wa(g){return!Number.isNaN(Number(g))}function Va(g){return g.endsWith("%")&&Wa(g.slice(0,-1))}function Sa(g){return wa(g)||Ja(g,"number",wa)}function va(g){return ia.test(g)}function fa(){return!0}function Ra(g){return sa.test(g)}function Xa(g){return Ja(g,"",Na)}function Ja(g,I,e){var C=ia.exec(g);return!!C&&(C[1]?C[1]===I:e(C[2]))}function ka(g){return ma.test(g)}function Ya(){return!1}function Ha(g){return g.startsWith("url(")}function wa(g){return Number.isInteger(Number(g))}function Na(g){return ba.test(g)}function Fa(){var g=ca("colors"),I=ca("spacing"),e=ca("blur"),C=ca("brightness"),l=ca("borderColor"),n=ca("borderRadius"),t=ca("borderSpacing"),a=ca("borderWidth"),o=ca("contrast"),A=ca("grayscale"),r=ca("hueRotate"),c=ca("invert"),i=ca("gap"),d=ca("gradientColorStops"),u=ca("gradientColorStopPositions"),s=ca("inset"),m=ca("margin"),b=ca("opacity"),Z=ca("padding"),G=ca("saturate"),y=ca("scale"),h=ca("sepia"),B=ca("skew"),p=ca("space"),W=ca("translate"),V=function(){return["auto",va,I]},S=function(){return[va,I]},v=function(){return["",Za]},f=function(){return["auto",Wa,va]},R=function(){return["","0",va]},X=function(){return[Wa,pa]},J=function(){return[Wa,va]};return{cacheSize:500,theme:{colors:[fa],spacing:[Za],blur:["none","",Ra,va],brightness:X(),borderColor:[g],borderRadius:["none","","full",Ra,va],borderSpacing:S(),borderWidth:v(),contrast:X(),grayscale:R(),hueRotate:J(),invert:R(),gap:S(),gradientColorStops:[g],gradientColorStopPositions:[Va,Ga],inset:V(),margin:V(),opacity:X(),padding:S(),saturate:X(),scale:X(),sepia:R(),skew:J(),space:S(),translate:S()},classGroups:{aspect:[{aspect:["auto","square","video",va]}],container:["container"],columns:[{columns:[Ra]}],"break-after":[{"break-after":["auto","avoid","all","avoid-page","page","left","right","column"]}],"break-before":[{"break-before":["auto","avoid","all","avoid-page","page","left","right","column"]}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none"]}],clear:[{clear:["left","right","both","none"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[].concat(["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"],[va])}],overflow:[{overflow:["auto","hidden","clip","visible","scroll"]}],"overflow-x":[{"overflow-x":["auto","hidden","clip","visible","scroll"]}],"overflow-y":[{"overflow-y":["auto","hidden","clip","visible","scroll"]}],overscroll:[{overscroll:["auto","contain","none"]}],"overscroll-x":[{"overscroll-x":["auto","contain","none"]}],"overscroll-y":[{"overscroll-y":["auto","contain","none"]}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[s]}],"inset-x":[{"inset-x":[s]}],"inset-y":[{"inset-y":[s]}],start:[{start:[s]}],end:[{end:[s]}],top:[{top:[s]}],right:[{right:[s]}],bottom:[{bottom:[s]}],left:[{left:[s]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",Sa]}],basis:[{basis:V()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",va]}],grow:[{grow:R()}],shrink:[{shrink:R()}],order:[{order:["first","last","none",Sa]}],"grid-cols":[{"grid-cols":[fa]}],"col-start-end":[{col:["auto",{span:["full",Sa]},va]}],"col-start":[{"col-start":f()}],"col-end":[{"col-end":f()}],"grid-rows":[{"grid-rows":[fa]}],"row-start-end":[{row:["auto",{span:[Sa]},va]}],"row-start":[{"row-start":f()}],"row-end":[{"row-end":f()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",va]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",va]}],gap:[{gap:[i]}],"gap-x":[{"gap-x":[i]}],"gap-y":[{"gap-y":[i]}],"justify-content":[{justify:["normal"].concat(["start","end","center","between","around","evenly","stretch"])}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal"].concat(["start","end","center","between","around","evenly","stretch"],["baseline"])}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[].concat(["start","end","center","between","around","evenly","stretch"],["baseline"])}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[Z]}],px:[{px:[Z]}],py:[{py:[Z]}],ps:[{ps:[Z]}],pe:[{pe:[Z]}],pt:[{pt:[Z]}],pr:[{pr:[Z]}],pb:[{pb:[Z]}],pl:[{pl:[Z]}],m:[{m:[m]}],mx:[{mx:[m]}],my:[{my:[m]}],ms:[{ms:[m]}],me:[{me:[m]}],mt:[{mt:[m]}],mr:[{mr:[m]}],mb:[{mb:[m]}],ml:[{ml:[m]}],"space-x":[{"space-x":[p]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[p]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit",va,I]}],"min-w":[{"min-w":["min","max","fit",va,Za]}],"max-w":[{"max-w":["0","none","full","min","max","fit","prose",{screen:[Ra]},Ra,va]}],h:[{h:[va,I,"auto","min","max","fit"]}],"min-h":[{"min-h":["min","max","fit",va,Za]}],"max-h":[{"max-h":[va,I,"min","max","fit"]}],"font-size":[{text:["base",Ra,Ga]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",pa]}],"font-family":[{font:[fa]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractons"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",va]}],"line-clamp":[{"line-clamp":["none",Wa,pa]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",va,Za]}],"list-image":[{"list-image":["none",va]}],"list-style-type":[{list:["none","disc","decimal",va]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[g]}],"placeholder-opacity":[{"placeholder-opacity":[b]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[g]}],"text-opacity":[{"text-opacity":[b]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[].concat(["solid","dashed","dotted","double","none"],["wavy"])}],"text-decoration-thickness":[{decoration:["auto","from-font",Za]}],"underline-offset":[{"underline-offset":["auto",va,Za]}],"text-decoration-color":[{decoration:[g]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],indent:[{indent:S()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",va]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",va]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[b]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[].concat(["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"],[ha])}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",ya]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},Ba]}],"bg-color":[{bg:[g]}],"gradient-from-pos":[{from:[u]}],"gradient-via-pos":[{via:[u]}],"gradient-to-pos":[{to:[u]}],"gradient-from":[{from:[d]}],"gradient-via":[{via:[d]}],"gradient-to":[{to:[d]}],rounded:[{rounded:[n]}],"rounded-s":[{"rounded-s":[n]}],"rounded-e":[{"rounded-e":[n]}],"rounded-t":[{"rounded-t":[n]}],"rounded-r":[{"rounded-r":[n]}],"rounded-b":[{"rounded-b":[n]}],"rounded-l":[{"rounded-l":[n]}],"rounded-ss":[{"rounded-ss":[n]}],"rounded-se":[{"rounded-se":[n]}],"rounded-ee":[{"rounded-ee":[n]}],"rounded-es":[{"rounded-es":[n]}],"rounded-tl":[{"rounded-tl":[n]}],"rounded-tr":[{"rounded-tr":[n]}],"rounded-br":[{"rounded-br":[n]}],"rounded-bl":[{"rounded-bl":[n]}],"border-w":[{border:[a]}],"border-w-x":[{"border-x":[a]}],"border-w-y":[{"border-y":[a]}],"border-w-s":[{"border-s":[a]}],"border-w-e":[{"border-e":[a]}],"border-w-t":[{"border-t":[a]}],"border-w-r":[{"border-r":[a]}],"border-w-b":[{"border-b":[a]}],"border-w-l":[{"border-l":[a]}],"border-opacity":[{"border-opacity":[b]}],"border-style":[{border:[].concat(["solid","dashed","dotted","double","none"],["hidden"])}],"divide-x":[{"divide-x":[a]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[a]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[b]}],"divide-style":[{divide:["solid","dashed","dotted","double","none"]}],"border-color":[{border:[l]}],"border-color-x":[{"border-x":[l]}],"border-color-y":[{"border-y":[l]}],"border-color-t":[{"border-t":[l]}],"border-color-r":[{"border-r":[l]}],"border-color-b":[{"border-b":[l]}],"border-color-l":[{"border-l":[l]}],"divide-color":[{divide:[l]}],"outline-style":[{outline:[""].concat(["solid","dashed","dotted","double","none"])}],"outline-offset":[{"outline-offset":[va,Za]}],"outline-w":[{outline:[Za]}],"outline-color":[{outline:[g]}],"ring-w":[{ring:v()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[g]}],"ring-opacity":[{"ring-opacity":[b]}],"ring-offset-w":[{"ring-offset":[Za]}],"ring-offset-color":[{"ring-offset":[g]}],shadow:[{shadow:["","inner","none",Ra,Xa]}],"shadow-color":[{shadow:[fa]}],opacity:[{opacity:[b]}],"mix-blend":[{"mix-blend":["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity","plus-lighter"]}],"bg-blend":[{"bg-blend":["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity","plus-lighter"]}],filter:[{filter:["","none"]}],blur:[{blur:[e]}],brightness:[{brightness:[C]}],contrast:[{contrast:[o]}],"drop-shadow":[{"drop-shadow":["","none",Ra,va]}],grayscale:[{grayscale:[A]}],"hue-rotate":[{"hue-rotate":[r]}],invert:[{invert:[c]}],saturate:[{saturate:[G]}],sepia:[{sepia:[h]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[e]}],"backdrop-brightness":[{"backdrop-brightness":[C]}],"backdrop-contrast":[{"backdrop-contrast":[o]}],"backdrop-grayscale":[{"backdrop-grayscale":[A]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[r]}],"backdrop-invert":[{"backdrop-invert":[c]}],"backdrop-opacity":[{"backdrop-opacity":[b]}],"backdrop-saturate":[{"backdrop-saturate":[G]}],"backdrop-sepia":[{"backdrop-sepia":[h]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[t]}],"border-spacing-x":[{"border-spacing-x":[t]}],"border-spacing-y":[{"border-spacing-y":[t]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",va]}],duration:[{duration:J()}],ease:[{ease:["linear","in","out","in-out",va]}],delay:[{delay:J()}],animate:[{animate:["none","spin","ping","pulse","bounce",va]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[y]}],"scale-x":[{"scale-x":[y]}],"scale-y":[{"scale-y":[y]}],rotate:[{rotate:[Sa,va]}],"translate-x":[{"translate-x":[W]}],"translate-y":[{"translate-y":[W]}],"skew-x":[{"skew-x":[B]}],"skew-y":[{"skew-y":[B]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",va]}],accent:[{accent:["auto",g]}],appearance:["appearance-none"],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",va]}],"caret-color":[{caret:[g]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":S()}],"scroll-mx":[{"scroll-mx":S()}],"scroll-my":[{"scroll-my":S()}],"scroll-ms":[{"scroll-ms":S()}],"scroll-me":[{"scroll-me":S()}],"scroll-mt":[{"scroll-mt":S()}],"scroll-mr":[{"scroll-mr":S()}],"scroll-mb":[{"scroll-mb":S()}],"scroll-ml":[{"scroll-ml":S()}],"scroll-p":[{"scroll-p":S()}],"scroll-px":[{"scroll-px":S()}],"scroll-py":[{"scroll-py":S()}],"scroll-ps":[{"scroll-ps":S()}],"scroll-pe":[{"scroll-pe":S()}],"scroll-pt":[{"scroll-pt":S()}],"scroll-pr":[{"scroll-pr":S()}],"scroll-pb":[{"scroll-pb":S()}],"scroll-pl":[{"scroll-pl":S()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","pinch-zoom","manipulation",{pan:["x","left","right","y","up","down"]}]}],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",va]}],fill:[{fill:[g,"none"]}],"stroke-w":[{stroke:[Za,pa]}],stroke:[{stroke:[g,"none"]}],sr:["sr-only","not-sr-only"]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}}var Ka=ra(Fa);function xa(){for(var g=arguments.length,I=new Array(g),e=0;e<g;e++)I[e]=arguments[e];return Ka(qt(I))}var za=["className","variant","size","asChild"],Ea=Pt("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),Ua=I.forwardRef((function(g,I){var e=g.className,C=g.variant,l=g.size,n=g.asChild,t=void 0!==n&&n,a=cI(g,za),o=t?zt:"button";return(0,CI.jsx)(o,aI({className:xa(Ea({variant:C,size:l,className:e})),ref:I},a))}));Ua.displayName="Button";var Qa=["className","error"],Ma=I.forwardRef((function(g,I){var e=g.className,C=g.error,l=cI(g,Qa);return(0,CI.jsxs)("div",{children:[(0,CI.jsx)("input",aI({className:xa("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",C&&"border-red-500",e),ref:I},l)),C&&(0,CI.jsx)("p",{className:"mt-1 text-xs text-red-500",children:C})]})}));function La(){for(var g=arguments.length,I=new Array(g),e=0;e<g;e++)I[e]=arguments[e];return function(g){return I.forEach((function(I){return function(g,I){"function"===typeof g?g(I):null!==g&&void 0!==g&&(g.current=I)}(I,g)}))}}function Da(){for(var g=arguments.length,e=new Array(g),C=0;C<g;C++)e[C]=arguments[C];return I.useCallback(La.apply(void 0,e),e)}Ma.displayName="Input";var Ta=["children"],ja=["children"],Pa=I.forwardRef((function(g,e){var C=g.children,l=cI(g,Ta),n=I.Children.toArray(C),t=n.find(_a);if(t){var a=t.props.children,o=n.map((function(g){return g===t?I.Children.count(a)>1?I.Children.only(null):I.isValidElement(a)?a.props.children:null:g}));return(0,CI.jsx)(Oa,aI(aI({},l),{},{ref:e,children:I.isValidElement(a)?I.cloneElement(a,void 0,o):null}))}return(0,CI.jsx)(Oa,aI(aI({},l),{},{ref:e,children:C}))}));Pa.displayName="Slot";var Oa=I.forwardRef((function(g,e){var C=g.children,l=cI(g,ja);if(I.isValidElement(C)){var n=function(g){var I,e,C=null===(I=Object.getOwnPropertyDescriptor(g.props,"ref"))||void 0===I?void 0:I.get,l=C&&"isReactWarning"in C&&C.isReactWarning;if(l)return g.ref;if(C=null===(e=Object.getOwnPropertyDescriptor(g,"ref"))||void 0===e?void 0:e.get,l=C&&"isReactWarning"in C&&C.isReactWarning)return g.props.ref;return g.props.ref||g.ref}(C);return I.cloneElement(C,aI(aI({},function(g,I){var e=aI({},I),C=function(){var C=g[l],n=I[l];/^on[A-Z]/.test(l)?C&&n?e[l]=function(){n.apply(void 0,arguments),C.apply(void 0,arguments)}:C&&(e[l]=C):"style"===l?e[l]=aI(aI({},C),n):"className"===l&&(e[l]=[C,n].filter(Boolean).join(" "))};for(var l in I)C();return aI(aI({},g),e)}(l,C.props)),{},{ref:e?La(e,n):n}))}return I.Children.count(C)>1?I.Children.only(null):null}));Oa.displayName="SlotClone";var qa=function(g){var I=g.children;return(0,CI.jsx)(CI.Fragment,{children:I})};function _a(g){return I.isValidElement(g)&&g.type===qa}var $a=["asChild"],go=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","span","svg","ul"].reduce((function(g,e){var C=I.forwardRef((function(g,I){var C=g.asChild,l=cI(g,$a),n=C?Pa:e;return"undefined"!==typeof window&&(window[Symbol.for("radix-ui")]=!0),(0,CI.jsx)(n,aI(aI({},l),{},{ref:I}))}));return C.displayName="Primitive.".concat(e),aI(aI({},g),{},nI({},e,C))}),{});function Io(g,I){g&&c.flushSync((function(){return g.dispatchEvent(I)}))}var eo=I.forwardRef((function(g,I){return(0,CI.jsx)(go.label,aI(aI({},g),{},{ref:I,onMouseDown:function(I){var e;I.target.closest("button, input, select, textarea")||(null===(e=g.onMouseDown)||void 0===e||e.call(g,I),!I.defaultPrevented&&I.detail>1&&I.preventDefault())}}))}));eo.displayName="Label";var Co=eo,lo=["className"],no=Pt("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),to=I.forwardRef((function(g,I){var e=g.className,C=cI(g,lo);return(0,CI.jsx)(Co,aI({ref:I,className:xa(no(),e)},C))}));to.displayName=Co.displayName;var ao=["className"],oo=["className"],Ao=["className"],ro=["className"],co=["className"],io=["className"],uo=I.forwardRef((function(g,I){var e=g.className,C=cI(g,ao);return(0,CI.jsx)("div",aI({ref:I,className:xa("rounded-lg border bg-card text-card-foreground shadow-sm",e)},C))}));uo.displayName="Card";var so=I.forwardRef((function(g,I){var e=g.className,C=cI(g,oo);return(0,CI.jsx)("div",aI({ref:I,className:xa("flex flex-col space-y-1.5 p-6",e)},C))}));so.displayName="CardHeader";var mo=I.forwardRef((function(g,I){var e=g.className,C=cI(g,Ao);return(0,CI.jsx)("h3",aI({ref:I,className:xa("text-2xl font-semibold leading-none tracking-tight",e)},C))}));mo.displayName="CardTitle";var bo=I.forwardRef((function(g,I){var e=g.className,C=cI(g,ro);return(0,CI.jsx)("p",aI({ref:I,className:xa("text-sm text-muted-foreground",e)},C))}));bo.displayName="CardDescription";var Zo=I.forwardRef((function(g,I){var e=g.className,C=cI(g,co);return(0,CI.jsx)("div",aI({ref:I,className:xa("p-6 pt-0",e)},C))}));Zo.displayName="CardContent";var Go=I.forwardRef((function(g,I){var e=g.className,C=cI(g,io);return(0,CI.jsx)("div",aI({ref:I,className:xa("flex items-center p-6 pt-0",e)},C))}));Go.displayName="CardFooter";var yo={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"},ho=["color","size","strokeWidth","absoluteStrokeWidth","children"],Bo=function(g){return g.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()},po=function(g,e){var C=(0,I.forwardRef)((function(C,l){var n=C.color,t=void 0===n?"currentColor":n,a=C.size,o=void 0===a?24:a,r=C.strokeWidth,c=void 0===r?2:r,i=C.absoluteStrokeWidth,d=C.children,s=cI(C,ho);return(0,I.createElement)("svg",aI(aI({ref:l},yo),{},{width:o,height:o,stroke:t,strokeWidth:i?24*Number(c)/Number(o):c,className:"lucide lucide-".concat(Bo(g))},s),[].concat(u(e.map((function(g){var e=A(g,2),C=e[0],l=e[1];return(0,I.createElement)(C,l)}))),u((Array.isArray(d)?d:[d])||[])))}));return C.displayName="".concat(g),C},Wo=po("School",[["path",{d:"m4 6 8-4 8 4",key:"1q0ilc"}],["path",{d:"m18 10 4 2v8a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2v-8l4-2",key:"1vwozw"}],["path",{d:"M14 22v-4a2 2 0 0 0-2-2v0a2 2 0 0 0-2 2v4",key:"cpkuc4"}],["path",{d:"M18 5v17",key:"1sw6gf"}],["path",{d:"M6 5v17",key:"1xfsm0"}],["circle",{cx:"12",cy:"9",r:"2",key:"1092wv"}]]),Vo=po("Briefcase",[["rect",{width:"20",height:"14",x:"2",y:"7",rx:"2",ry:"2",key:"eto64e"}],["path",{d:"M16 21V5a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16",key:"zwj3tp"}]]),So={school:Wo,work:Vo};function vo(g,I){var e=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:{}).checkForDefaultPrevented,C=void 0===e||e;return function(e){if(null===g||void 0===g||g(e),!1===C||!e.defaultPrevented)return null===I||void 0===I?void 0:I(e)}}var fo=["children"],Ro=["scope","children"];function Xo(g){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],C=[];var l=function(){var e=C.map((function(g){return I.createContext(g)}));return function(C){var l=(null===C||void 0===C?void 0:C[g])||e;return I.useMemo((function(){return nI({},"__scope".concat(g),aI(aI({},C),{},nI({},g,l)))}),[C,l])}};return l.scopeName=g,[function(e,l){var n=I.createContext(l),t=C.length;function a(e){var C=e.scope,l=e.children,a=cI(e,Ro),o=(null===C||void 0===C?void 0:C[g][t])||n,A=I.useMemo((function(){return a}),Object.values(a));return(0,CI.jsx)(o.Provider,{value:A,children:l})}return C=[].concat(u(C),[l]),a.displayName=e+"Provider",[a,function(C,a){var o=(null===a||void 0===a?void 0:a[g][t])||n,A=I.useContext(o);if(A)return A;if(void 0!==l)return l;throw new Error("`".concat(C,"` must be used within `").concat(e,"`"))}]},Jo.apply(void 0,[l].concat(u(e)))]}function Jo(){for(var g=arguments.length,e=new Array(g),C=0;C<g;C++)e[C]=arguments[C];var l=e[0];if(1===e.length)return l;var n=function(){var g=e.map((function(g){return{useScope:g(),scopeName:g.scopeName}}));return function(e){var C=g.reduce((function(g,I){var C=I.useScope,l=I.scopeName,n=C(e)["__scope".concat(l)];return aI(aI({},g),n)}),{});return I.useMemo((function(){return nI({},"__scope".concat(l.scopeName),C)}),[C])}};return n.scopeName=l.scopeName,n}var ko=Boolean(null===globalThis||void 0===globalThis?void 0:globalThis.document)?I.useLayoutEffect:function(){},Yo=C["useId".toString()]||function(){},Ho=0;function wo(g){var e=A(I.useState(Yo()),2),C=e[0],l=e[1];return ko((function(){g||l((function(g){return null!==g&&void 0!==g?g:String(Ho++)}))}),[g]),g||(C?"radix-".concat(C):"")}function No(g){var e=I.useRef(g);return I.useEffect((function(){e.current=g})),I.useMemo((function(){return function(){for(var g,I=arguments.length,C=new Array(I),l=0;l<I;l++)C[l]=arguments[l];return null===(g=e.current)||void 0===g?void 0:g.call.apply(g,[e].concat(C))}}),[])}function Fo(g){var e=g.prop,C=g.defaultProp,l=g.onChange,n=void 0===l?function(){}:l,t=function(g){var e=g.defaultProp,C=g.onChange,l=I.useState(e),n=A(l,1)[0],t=I.useRef(n),a=No(C);return I.useEffect((function(){t.current!==n&&(a(n),t.current=n)}),[n,t,a]),l}({defaultProp:C,onChange:n}),a=A(t,2),o=a[0],r=a[1],c=void 0!==e,i=c?e:o,d=No(n);return[i,I.useCallback((function(g){if(c){var I="function"===typeof g?g(e):g;I!==e&&d(I)}else r(g)}),[c,e,r,d])]}var Ko,xo=["disableOutsidePointerEvents","onEscapeKeyDown","onPointerDownOutside","onFocusOutside","onInteractOutside","onDismiss"],zo="dismissableLayer.update",Eo="dismissableLayer.pointerDownOutside",Uo="dismissableLayer.focusOutside",Qo=I.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),Mo=I.forwardRef((function(g,e){var C,l=g.disableOutsidePointerEvents,n=void 0!==l&&l,t=g.onEscapeKeyDown,a=g.onPointerDownOutside,o=g.onFocusOutside,r=g.onInteractOutside,c=g.onDismiss,i=cI(g,xo),d=I.useContext(Qo),s=A(I.useState(null),2),m=s[0],b=s[1],Z=null!==(C=null===m||void 0===m?void 0:m.ownerDocument)&&void 0!==C?C:null===globalThis||void 0===globalThis?void 0:globalThis.document,G=A(I.useState({}),2)[1],y=Da(e,(function(g){return b(g)})),h=Array.from(d.layers),B=A(u(d.layersWithOutsidePointerEventsDisabled).slice(-1),1)[0],p=h.indexOf(B),W=m?h.indexOf(m):-1,V=d.layersWithOutsidePointerEventsDisabled.size>0,S=W>=p,v=function(g){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null===globalThis||void 0===globalThis?void 0:globalThis.document,C=No(g),l=I.useRef(!1),n=I.useRef((function(){}));return I.useEffect((function(){var g=function(g){if(g.target&&!l.current){var I=function(){To(Eo,C,t,{discrete:!0})},t={originalEvent:g};"touch"===g.pointerType?(e.removeEventListener("click",n.current),n.current=I,e.addEventListener("click",n.current,{once:!0})):I()}else e.removeEventListener("click",n.current);l.current=!1},I=window.setTimeout((function(){e.addEventListener("pointerdown",g)}),0);return function(){window.clearTimeout(I),e.removeEventListener("pointerdown",g),e.removeEventListener("click",n.current)}}),[e,C]),{onPointerDownCapture:function(){return l.current=!0}}}((function(g){var I=g.target,e=u(d.branches).some((function(g){return g.contains(I)}));S&&!e&&(null===a||void 0===a||a(g),null===r||void 0===r||r(g),g.defaultPrevented||null===c||void 0===c||c())}),Z),f=function(g){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null===globalThis||void 0===globalThis?void 0:globalThis.document,C=No(g),l=I.useRef(!1);return I.useEffect((function(){var g=function(g){g.target&&!l.current&&To(Uo,C,{originalEvent:g},{discrete:!1})};return e.addEventListener("focusin",g),function(){return e.removeEventListener("focusin",g)}}),[e,C]),{onFocusCapture:function(){return l.current=!0},onBlurCapture:function(){return l.current=!1}}}((function(g){var I=g.target;u(d.branches).some((function(g){return g.contains(I)}))||(null===o||void 0===o||o(g),null===r||void 0===r||r(g),g.defaultPrevented||null===c||void 0===c||c())}),Z);return function(g){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null===globalThis||void 0===globalThis?void 0:globalThis.document,C=No(g);I.useEffect((function(){var g=function(g){"Escape"===g.key&&C(g)};return e.addEventListener("keydown",g,{capture:!0}),function(){return e.removeEventListener("keydown",g,{capture:!0})}}),[C,e])}((function(g){W===d.layers.size-1&&(null===t||void 0===t||t(g),!g.defaultPrevented&&c&&(g.preventDefault(),c()))}),Z),I.useEffect((function(){if(m)return n&&(0===d.layersWithOutsidePointerEventsDisabled.size&&(Ko=Z.body.style.pointerEvents,Z.body.style.pointerEvents="none"),d.layersWithOutsidePointerEventsDisabled.add(m)),d.layers.add(m),Do(),function(){n&&1===d.layersWithOutsidePointerEventsDisabled.size&&(Z.body.style.pointerEvents=Ko)}}),[m,Z,n,d]),I.useEffect((function(){return function(){m&&(d.layers.delete(m),d.layersWithOutsidePointerEventsDisabled.delete(m),Do())}}),[m,d]),I.useEffect((function(){var g=function(){return G({})};return document.addEventListener(zo,g),function(){return document.removeEventListener(zo,g)}}),[]),(0,CI.jsx)(go.div,aI(aI({},i),{},{ref:y,style:aI({pointerEvents:V?S?"auto":"none":void 0},g.style),onFocusCapture:vo(g.onFocusCapture,f.onFocusCapture),onBlurCapture:vo(g.onBlurCapture,f.onBlurCapture),onPointerDownCapture:vo(g.onPointerDownCapture,v.onPointerDownCapture)}))}));Mo.displayName="DismissableLayer";var Lo=I.forwardRef((function(g,e){var C=I.useContext(Qo),l=I.useRef(null),n=Da(e,l);return I.useEffect((function(){var g=l.current;if(g)return C.branches.add(g),function(){C.branches.delete(g)}}),[C.branches]),(0,CI.jsx)(go.div,aI(aI({},g),{},{ref:n}))}));function Do(){var g=new CustomEvent(zo);document.dispatchEvent(g)}function To(g,I,e,C){var l=C.discrete,n=e.originalEvent.target,t=new CustomEvent(g,{bubbles:!1,cancelable:!0,detail:e});I&&n.addEventListener(g,I,{once:!0}),l?Io(n,t):n.dispatchEvent(t)}Lo.displayName="DismissableLayerBranch";var jo=Mo,Po=Lo,Oo=["loop","trapped","onMountAutoFocus","onUnmountAutoFocus"],qo="focusScope.autoFocusOnMount",_o="focusScope.autoFocusOnUnmount",$o={bubbles:!1,cancelable:!0},gA=I.forwardRef((function(g,e){var C=g.loop,l=void 0!==C&&C,n=g.trapped,t=void 0!==n&&n,a=g.onMountAutoFocus,o=g.onUnmountAutoFocus,r=cI(g,Oo),c=A(I.useState(null),2),i=c[0],d=c[1],u=No(a),s=No(o),m=I.useRef(null),b=Da(e,(function(g){return d(g)})),Z=I.useRef({paused:!1,pause:function(){this.paused=!0},resume:function(){this.paused=!1}}).current;I.useEffect((function(){if(t){var g=function(g){if(!Z.paused&&i){var I=g.target;i.contains(I)?m.current=I:lA(m.current,{select:!0})}},I=function(g){if(!Z.paused&&i){var I=g.relatedTarget;null!==I&&(i.contains(I)||lA(m.current,{select:!0}))}},e=function(g){if(document.activeElement===document.body){var I,e=X(g);try{for(e.s();!(I=e.n()).done;){I.value.removedNodes.length>0&&lA(i)}}catch(C){e.e(C)}finally{e.f()}}};document.addEventListener("focusin",g),document.addEventListener("focusout",I);var C=new MutationObserver(e);return i&&C.observe(i,{childList:!0,subtree:!0}),function(){document.removeEventListener("focusin",g),document.removeEventListener("focusout",I),C.disconnect()}}}),[t,i,Z.paused]),I.useEffect((function(){if(i){nA.add(Z);var g=document.activeElement;if(!i.contains(g)){var I=new CustomEvent(qo,$o);i.addEventListener(qo,u),i.dispatchEvent(I),I.defaultPrevented||(!function(g){var I,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},C=e.select,l=void 0!==C&&C,n=document.activeElement,t=X(g);try{for(t.s();!(I=t.n()).done;){if(lA(I.value,{select:l}),document.activeElement!==n)return}}catch(a){t.e(a)}finally{t.f()}}((e=IA(i),e.filter((function(g){return"A"!==g.tagName}))),{select:!0}),document.activeElement===g&&lA(i))}return function(){i.removeEventListener(qo,u),setTimeout((function(){var I=new CustomEvent(_o,$o);i.addEventListener(_o,s),i.dispatchEvent(I),I.defaultPrevented||lA(null!==g&&void 0!==g?g:document.body,{select:!0}),i.removeEventListener(_o,s),nA.remove(Z)}),0)}}var e}),[i,u,s,Z]);var G=I.useCallback((function(g){if((l||t)&&!Z.paused){var I="Tab"===g.key&&!g.altKey&&!g.ctrlKey&&!g.metaKey,e=document.activeElement;if(I&&e){var C=g.currentTarget,n=function(g){var I=IA(g),e=eA(I,g),C=eA(I.reverse(),g);return[e,C]}(C),a=A(n,2),o=a[0],r=a[1];o&&r?g.shiftKey||e!==r?g.shiftKey&&e===o&&(g.preventDefault(),l&&lA(r,{select:!0})):(g.preventDefault(),l&&lA(o,{select:!0})):e===C&&g.preventDefault()}}}),[l,t,Z.paused]);return(0,CI.jsx)(go.div,aI(aI({tabIndex:-1},r),{},{ref:b,onKeyDown:G}))}));function IA(g){for(var I=[],e=document.createTreeWalker(g,NodeFilter.SHOW_ELEMENT,{acceptNode:function(g){var I="INPUT"===g.tagName&&"hidden"===g.type;return g.disabled||g.hidden||I?NodeFilter.FILTER_SKIP:g.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});e.nextNode();)I.push(e.currentNode);return I}function eA(g,I){var e,C=X(g);try{for(C.s();!(e=C.n()).done;){var l=e.value;if(!CA(l,{upTo:I}))return l}}catch(n){C.e(n)}finally{C.f()}}function CA(g,I){var e=I.upTo;if("hidden"===getComputedStyle(g).visibility)return!0;for(;g;){if(void 0!==e&&g===e)return!1;if("none"===getComputedStyle(g).display)return!0;g=g.parentElement}return!1}function lA(g){var I=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).select,e=void 0!==I&&I;if(g&&g.focus){var C=document.activeElement;g.focus({preventScroll:!0}),g!==C&&function(g){return g instanceof HTMLInputElement&&"select"in g}(g)&&e&&g.select()}}gA.displayName="FocusScope";var nA=function(){var g=[];return{add:function(I){var e=g[0];I!==e&&(null===e||void 0===e||e.pause()),(g=tA(g,I)).unshift(I)},remove:function(I){var e;null===(e=(g=tA(g,I))[0])||void 0===e||e.resume()}}}();function tA(g,I){var e=u(g),C=e.indexOf(I);return-1!==C&&e.splice(C,1),e}var aA=["container"],oA=I.forwardRef((function(g,e){var C,l=g.container,n=cI(g,aA),t=A(I.useState(!1),2),a=t[0],o=t[1];ko((function(){return o(!0)}),[]);var r=l||a&&(null===globalThis||void 0===globalThis||null===(C=globalThis.document)||void 0===C?void 0:C.body);return r?c.createPortal((0,CI.jsx)(go.div,aI(aI({},n),{},{ref:e})),r):null}));oA.displayName="Portal";var AA=function(g){var e=g.present,C=g.children,l=function(g){var e=A(I.useState(),2),C=e[0],l=e[1],n=I.useRef({}),t=I.useRef(g),a=I.useRef("none"),o=g?"mounted":"unmounted",r=function(g,e){return I.useReducer((function(g,I){var C=e[g][I];return null!==C&&void 0!==C?C:g}),g)}(o,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}}),i=A(r,2),d=i[0],u=i[1];return I.useEffect((function(){var g=rA(n.current);a.current="mounted"===d?g:"none"}),[d]),ko((function(){var I=n.current,e=t.current;if(e!==g){var C=a.current,l=rA(I);if(g)u("MOUNT");else if("none"===l||"none"===(null===I||void 0===I?void 0:I.display))u("UNMOUNT");else{u(e&&C!==l?"ANIMATION_OUT":"UNMOUNT")}t.current=g}}),[g,u]),ko((function(){if(C){var g=function(g){var I=rA(n.current).includes(g.animationName);g.target===C&&I&&c.flushSync((function(){return u("ANIMATION_END")}))},I=function(g){g.target===C&&(a.current=rA(n.current))};return C.addEventListener("animationstart",I),C.addEventListener("animationcancel",g),C.addEventListener("animationend",g),function(){C.removeEventListener("animationstart",I),C.removeEventListener("animationcancel",g),C.removeEventListener("animationend",g)}}u("ANIMATION_END")}),[C,u]),{isPresent:["mounted","unmountSuspended"].includes(d),ref:I.useCallback((function(g){g&&(n.current=getComputedStyle(g)),l(g)}),[])}}(e),n="function"===typeof C?C({present:l.isPresent}):I.Children.only(C),t=Da(l.ref,function(g){var I,e,C=null===(I=Object.getOwnPropertyDescriptor(g.props,"ref"))||void 0===I?void 0:I.get,l=C&&"isReactWarning"in C&&C.isReactWarning;if(l)return g.ref;if(C=null===(e=Object.getOwnPropertyDescriptor(g,"ref"))||void 0===e?void 0:e.get,l=C&&"isReactWarning"in C&&C.isReactWarning)return g.props.ref;return g.props.ref||g.ref}(n));return"function"===typeof C||l.isPresent?I.cloneElement(n,{ref:t}):null};function rA(g){return(null===g||void 0===g?void 0:g.animationName)||"none"}AA.displayName="Presence";var cA=0;function iA(){I.useEffect((function(){var g,I,e=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",null!==(g=e[0])&&void 0!==g?g:dA()),document.body.insertAdjacentElement("beforeend",null!==(I=e[1])&&void 0!==I?I:dA()),cA++,function(){1===cA&&document.querySelectorAll("[data-radix-focus-guard]").forEach((function(g){return g.remove()})),cA--}}),[])}function dA(){var g=document.createElement("span");return g.setAttribute("data-radix-focus-guard",""),g.tabIndex=0,g.style.cssText="outline: none; opacity: 0; position: fixed; pointer-events: none",g}var uA=function(){return uA=Object.assign||function(g){for(var I,e=1,C=arguments.length;e<C;e++)for(var l in I=arguments[e])Object.prototype.hasOwnProperty.call(I,l)&&(g[l]=I[l]);return g},uA.apply(this,arguments)};function sA(g,I){var e={};for(var C in g)Object.prototype.hasOwnProperty.call(g,C)&&I.indexOf(C)<0&&(e[C]=g[C]);if(null!=g&&"function"===typeof Object.getOwnPropertySymbols){var l=0;for(C=Object.getOwnPropertySymbols(g);l<C.length;l++)I.indexOf(C[l])<0&&Object.prototype.propertyIsEnumerable.call(g,C[l])&&(e[C[l]]=g[C[l]])}return e}Object.create;function mA(g,I,e){if(e||2===arguments.length)for(var C,l=0,n=I.length;l<n;l++)!C&&l in I||(C||(C=Array.prototype.slice.call(I,0,l)),C[l]=I[l]);return g.concat(C||Array.prototype.slice.call(I))}Object.create;var bA="right-scroll-bar-position",ZA="width-before-scroll-bar";function GA(g,I){return"function"===typeof g?g(I):g&&(g.current=I),g}var yA="undefined"!==typeof window?I.useLayoutEffect:I.useEffect,hA=new WeakMap;function BA(g,e){var C=function(g,e){var C=(0,I.useState)((function(){return{value:g,callback:e,facade:{get current(){return C.value},set current(g){var I=C.value;I!==g&&(C.value=g,C.callback(g,I))}}}}))[0];return C.callback=e,C.facade}(e||null,(function(I){return g.forEach((function(g){return GA(g,I)}))}));return yA((function(){var I=hA.get(C);if(I){var e=new Set(I),l=new Set(g),n=C.current;e.forEach((function(g){l.has(g)||GA(g,null)})),l.forEach((function(g){e.has(g)||GA(g,n)}))}hA.set(C,g)}),[g]),C}function pA(g){return g}function WA(g,I){void 0===I&&(I=pA);var e=[],C=!1,l={read:function(){if(C)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return e.length?e[e.length-1]:g},useMedium:function(g){var l=I(g,C);return e.push(l),function(){e=e.filter((function(g){return g!==l}))}},assignSyncMedium:function(g){for(C=!0;e.length;){var I=e;e=[],I.forEach(g)}e={push:function(I){return g(I)},filter:function(){return e}}},assignMedium:function(g){C=!0;var I=[];if(e.length){var l=e;e=[],l.forEach(g),I=e}var n=function(){var e=I;I=[],e.forEach(g)},t=function(){return Promise.resolve().then(n)};t(),e={push:function(g){I.push(g),t()},filter:function(g){return I=I.filter(g),e}}}};return l}var VA=function(g){void 0===g&&(g={});var I=WA(null);return I.options=uA({async:!0,ssr:!1},g),I}(),SA=function(){},vA=I.forwardRef((function(g,e){var C=I.useRef(null),l=I.useState({onScrollCapture:SA,onWheelCapture:SA,onTouchMoveCapture:SA}),n=l[0],t=l[1],a=g.forwardProps,o=g.children,A=g.className,r=g.removeScrollBar,c=g.enabled,i=g.shards,d=g.sideCar,u=g.noIsolation,s=g.inert,m=g.allowPinchZoom,b=g.as,Z=void 0===b?"div":b,G=g.gapMode,y=sA(g,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noIsolation","inert","allowPinchZoom","as","gapMode"]),h=d,B=BA([C,e]),p=uA(uA({},y),n);return I.createElement(I.Fragment,null,c&&I.createElement(h,{sideCar:VA,removeScrollBar:r,shards:i,noIsolation:u,inert:s,setCallbacks:t,allowPinchZoom:!!m,lockRef:C,gapMode:G}),a?I.cloneElement(I.Children.only(o),uA(uA({},p),{ref:B})):I.createElement(Z,uA({},p,{className:A,ref:B}),o))}));vA.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1},vA.classNames={fullWidth:ZA,zeroRight:bA};var fA,RA=function(g){var e=g.sideCar,C=sA(g,["sideCar"]);if(!e)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var l=e.read();if(!l)throw new Error("Sidecar medium not found");return I.createElement(l,uA({},C))};RA.isSideCarExport=!0;function XA(){if(!document)return null;var g=document.createElement("style");g.type="text/css";var I=fA||e.nc;return I&&g.setAttribute("nonce",I),g}var JA=function(){var g=0,I=null;return{add:function(e){var C,l;0==g&&(I=XA())&&(l=e,(C=I).styleSheet?C.styleSheet.cssText=l:C.appendChild(document.createTextNode(l)),function(g){(document.head||document.getElementsByTagName("head")[0]).appendChild(g)}(I)),g++},remove:function(){!--g&&I&&(I.parentNode&&I.parentNode.removeChild(I),I=null)}}},kA=function(){var g=function(){var g=JA();return function(e,C){I.useEffect((function(){return g.add(e),function(){g.remove()}}),[e&&C])}}();return function(I){var e=I.styles,C=I.dynamic;return g(e,C),null}},YA={left:0,top:0,right:0,gap:0},HA=function(g){return parseInt(g||"",10)||0},wA=function(g){if(void 0===g&&(g="margin"),"undefined"===typeof window)return YA;var I=function(g){var I=window.getComputedStyle(document.body),e=I["padding"===g?"paddingLeft":"marginLeft"],C=I["padding"===g?"paddingTop":"marginTop"],l=I["padding"===g?"paddingRight":"marginRight"];return[HA(e),HA(C),HA(l)]}(g),e=document.documentElement.clientWidth,C=window.innerWidth;return{left:I[0],top:I[1],right:I[2],gap:Math.max(0,C-e+I[2]-I[0])}},NA=kA(),FA="data-scroll-locked",KA=function(g,I,e,C){var l=g.left,n=g.top,t=g.right,a=g.gap;return void 0===e&&(e="margin"),"\n  .".concat("with-scroll-bars-hidden"," {\n   overflow: hidden ").concat(C,";\n   padding-right: ").concat(a,"px ").concat(C,";\n  }\n  body[").concat(FA,"] {\n    overflow: hidden ").concat(C,";\n    overscroll-behavior: contain;\n    ").concat([I&&"position: relative ".concat(C,";"),"margin"===e&&"\n    padding-left: ".concat(l,"px;\n    padding-top: ").concat(n,"px;\n    padding-right: ").concat(t,"px;\n    margin-left:0;\n    margin-top:0;\n    margin-right: ").concat(a,"px ").concat(C,";\n    "),"padding"===e&&"padding-right: ".concat(a,"px ").concat(C,";")].filter(Boolean).join(""),"\n  }\n  \n  .").concat(bA," {\n    right: ").concat(a,"px ").concat(C,";\n  }\n  \n  .").concat(ZA," {\n    margin-right: ").concat(a,"px ").concat(C,";\n  }\n  \n  .").concat(bA," .").concat(bA," {\n    right: 0 ").concat(C,";\n  }\n  \n  .").concat(ZA," .").concat(ZA," {\n    margin-right: 0 ").concat(C,";\n  }\n  \n  body[").concat(FA,"] {\n    ").concat("--removed-body-scroll-bar-size",": ").concat(a,"px;\n  }\n")},xA=function(){var g=parseInt(document.body.getAttribute(FA)||"0",10);return isFinite(g)?g:0},zA=function(g){var e=g.noRelative,C=g.noImportant,l=g.gapMode,n=void 0===l?"margin":l;I.useEffect((function(){return document.body.setAttribute(FA,(xA()+1).toString()),function(){var g=xA()-1;g<=0?document.body.removeAttribute(FA):document.body.setAttribute(FA,g.toString())}}),[]);var t=I.useMemo((function(){return wA(n)}),[n]);return I.createElement(NA,{styles:KA(t,!e,n,C?"":"!important")})},EA=!1;if("undefined"!==typeof window)try{var UA=Object.defineProperty({},"passive",{get:function(){return EA=!0,!0}});window.addEventListener("test",UA,UA),window.removeEventListener("test",UA,UA)}catch(gG){EA=!1}var QA=!!EA&&{passive:!1},MA=function(g,I){var e=window.getComputedStyle(g);return"hidden"!==e[I]&&!(e.overflowY===e.overflowX&&!function(g){return"TEXTAREA"===g.tagName}(g)&&"visible"===e[I])},LA=function(g,I){var e=I.ownerDocument,C=I;do{if("undefined"!==typeof ShadowRoot&&C instanceof ShadowRoot&&(C=C.host),DA(g,C)){var l=TA(g,C);if(l[1]>l[2])return!0}C=C.parentNode}while(C&&C!==e.body);return!1},DA=function(g,I){return"v"===g?function(g){return MA(g,"overflowY")}(I):function(g){return MA(g,"overflowX")}(I)},TA=function(g,I){return"v"===g?[(e=I).scrollTop,e.scrollHeight,e.clientHeight]:function(g){return[g.scrollLeft,g.scrollWidth,g.clientWidth]}(I);var e},jA=function(g){return"changedTouches"in g?[g.changedTouches[0].clientX,g.changedTouches[0].clientY]:[0,0]},PA=function(g){return[g.deltaX,g.deltaY]},OA=function(g){return g&&"current"in g?g.current:g},qA=function(g){return"\n  .block-interactivity-".concat(g," {pointer-events: none;}\n  .allow-interactivity-").concat(g," {pointer-events: all;}\n")},_A=0,$A=[];function gr(g){for(var I=null;null!==g;)g instanceof ShadowRoot&&(I=g.host,g=g.host),g=g.parentNode;return I}var Ir,er=(Ir=function(g){var e=I.useRef([]),C=I.useRef([0,0]),l=I.useRef(),n=I.useState(_A++)[0],t=I.useState(kA)[0],a=I.useRef(g);I.useEffect((function(){a.current=g}),[g]),I.useEffect((function(){if(g.inert){document.body.classList.add("block-interactivity-".concat(n));var I=mA([g.lockRef.current],(g.shards||[]).map(OA),!0).filter(Boolean);return I.forEach((function(g){return g.classList.add("allow-interactivity-".concat(n))})),function(){document.body.classList.remove("block-interactivity-".concat(n)),I.forEach((function(g){return g.classList.remove("allow-interactivity-".concat(n))}))}}}),[g.inert,g.lockRef.current,g.shards]);var o=I.useCallback((function(g,I){if("touches"in g&&2===g.touches.length)return!a.current.allowPinchZoom;var e,n=jA(g),t=C.current,o="deltaX"in g?g.deltaX:t[0]-n[0],A="deltaY"in g?g.deltaY:t[1]-n[1],r=g.target,c=Math.abs(o)>Math.abs(A)?"h":"v";if("touches"in g&&"h"===c&&"range"===r.type)return!1;var i=LA(c,r);if(!i)return!0;if(i?e=c:(e="v"===c?"h":"v",i=LA(c,r)),!i)return!1;if(!l.current&&"changedTouches"in g&&(o||A)&&(l.current=e),!e)return!0;var d=l.current||e;return function(g,I,e,C,l){var n=function(g,I){return"h"===g&&"rtl"===I?-1:1}(g,window.getComputedStyle(I).direction),t=n*C,a=e.target,o=I.contains(a),A=!1,r=t>0,c=0,i=0;do{var d=TA(g,a),u=d[0],s=d[1]-d[2]-n*u;(u||s)&&DA(g,a)&&(c+=s,i+=u),a=a instanceof ShadowRoot?a.host:a.parentNode}while(!o&&a!==document.body||o&&(I.contains(a)||I===a));return(r&&(l&&Math.abs(c)<1||!l&&t>c)||!r&&(l&&Math.abs(i)<1||!l&&-t>i))&&(A=!0),A}(d,I,g,"h"===d?o:A,!0)}),[]),A=I.useCallback((function(g){var I=g;if($A.length&&$A[$A.length-1]===t){var C="deltaY"in I?PA(I):jA(I),l=e.current.filter((function(g){return g.name===I.type&&(g.target===I.target||I.target===g.shadowParent)&&(e=g.delta,l=C,e[0]===l[0]&&e[1]===l[1]);var e,l}))[0];if(l&&l.should)I.cancelable&&I.preventDefault();else if(!l){var n=(a.current.shards||[]).map(OA).filter(Boolean).filter((function(g){return g.contains(I.target)}));(n.length>0?o(I,n[0]):!a.current.noIsolation)&&I.cancelable&&I.preventDefault()}}}),[]),r=I.useCallback((function(g,I,C,l){var n={name:g,delta:I,target:C,should:l,shadowParent:gr(C)};e.current.push(n),setTimeout((function(){e.current=e.current.filter((function(g){return g!==n}))}),1)}),[]),c=I.useCallback((function(g){C.current=jA(g),l.current=void 0}),[]),i=I.useCallback((function(I){r(I.type,PA(I),I.target,o(I,g.lockRef.current))}),[]),d=I.useCallback((function(I){r(I.type,jA(I),I.target,o(I,g.lockRef.current))}),[]);I.useEffect((function(){return $A.push(t),g.setCallbacks({onScrollCapture:i,onWheelCapture:i,onTouchMoveCapture:d}),document.addEventListener("wheel",A,QA),document.addEventListener("touchmove",A,QA),document.addEventListener("touchstart",c,QA),function(){$A=$A.filter((function(g){return g!==t})),document.removeEventListener("wheel",A,QA),document.removeEventListener("touchmove",A,QA),document.removeEventListener("touchstart",c,QA)}}),[]);var u=g.removeScrollBar,s=g.inert;return I.createElement(I.Fragment,null,s?I.createElement(t,{styles:qA(n)}):null,u?I.createElement(zA,{gapMode:g.gapMode}):null)},VA.useMedium(Ir),RA),Cr=I.forwardRef((function(g,e){return I.createElement(vA,uA({},g,{ref:e,sideCar:er}))}));Cr.classNames=vA.classNames;var lr=Cr,nr=function(g){return"undefined"===typeof document?null:(Array.isArray(g)?g[0]:g).ownerDocument.body},tr=new WeakMap,ar=new WeakMap,or={},Ar=0,rr=function g(I){return I&&(I.host||g(I.parentNode))},cr=function(g,I,e,C){var l=function(g,I){return I.map((function(I){if(g.contains(I))return I;var e=rr(I);return e&&g.contains(e)?e:(console.error("aria-hidden",I,"in not contained inside",g,". Doing nothing"),null)})).filter((function(g){return Boolean(g)}))}(I,Array.isArray(g)?g:[g]);or[e]||(or[e]=new WeakMap);var n=or[e],t=[],a=new Set,o=new Set(l);l.forEach((function g(I){I&&!a.has(I)&&(a.add(I),g(I.parentNode))}));return function g(I){I&&!o.has(I)&&Array.prototype.forEach.call(I.children,(function(I){if(a.has(I))g(I);else try{var l=I.getAttribute(C),o=null!==l&&"false"!==l,A=(tr.get(I)||0)+1,r=(n.get(I)||0)+1;tr.set(I,A),n.set(I,r),t.push(I),1===A&&o&&ar.set(I,!0),1===r&&I.setAttribute(e,"true"),o||I.setAttribute(C,"true")}catch($Z){console.error("aria-hidden: cannot operate on ",I,$Z)}}))}(I),a.clear(),Ar++,function(){t.forEach((function(g){var I=tr.get(g)-1,l=n.get(g)-1;tr.set(g,I),n.set(g,l),I||(ar.has(g)||g.removeAttribute(C),ar.delete(g)),l||g.removeAttribute(e)})),--Ar||(tr=new WeakMap,tr=new WeakMap,ar=new WeakMap,or={})}},ir=function(g,I,e){void 0===e&&(e="data-aria-hidden");var C=Array.from(Array.isArray(g)?g:[g]),l=I||nr(g);return l?(C.push.apply(C,Array.from(l.querySelectorAll("[aria-live]"))),cr(C,l,e,"aria-hidden")):function(){return null}},dr=["__scopeDialog"],ur=["forceMount"],sr=["__scopeDialog"],mr=["forceMount"],br=["__scopeDialog","trapFocus","onOpenAutoFocus","onCloseAutoFocus"],Zr=["__scopeDialog"],Gr=["__scopeDialog"],yr=["__scopeDialog"],hr="Dialog",Br=A(Xo(hr),2),pr=Br[0],Wr=(Br[1],A(pr(hr),2)),Vr=Wr[0],Sr=Wr[1],vr=function(g){var e=g.__scopeDialog,C=g.children,l=g.open,n=g.defaultOpen,t=g.onOpenChange,a=g.modal,o=void 0===a||a,r=I.useRef(null),c=I.useRef(null),i=A(Fo({prop:l,defaultProp:n,onChange:t}),2),d=i[0],u=void 0!==d&&d,s=i[1];return(0,CI.jsx)(Vr,{scope:e,triggerRef:r,contentRef:c,contentId:wo(),titleId:wo(),descriptionId:wo(),open:u,onOpenChange:s,onOpenToggle:I.useCallback((function(){return s((function(g){return!g}))}),[s]),modal:o,children:C})};vr.displayName=hr;var fr="DialogTrigger",Rr=I.forwardRef((function(g,I){var e=g.__scopeDialog,C=cI(g,dr),l=Sr(fr,e),n=Da(I,l.triggerRef);return(0,CI.jsx)(go.button,aI(aI({type:"button","aria-haspopup":"dialog","aria-expanded":l.open,"aria-controls":l.contentId,"data-state":Pr(l.open)},C),{},{ref:n,onClick:vo(g.onClick,l.onOpenToggle)}))}));Rr.displayName=fr;var Xr="DialogPortal",Jr=A(pr(Xr,{forceMount:void 0}),2),kr=Jr[0],Yr=Jr[1],Hr=function(g){var e=g.__scopeDialog,C=g.forceMount,l=g.children,n=g.container,t=Sr(Xr,e);return(0,CI.jsx)(kr,{scope:e,forceMount:C,children:I.Children.map(l,(function(g){return(0,CI.jsx)(AA,{present:C||t.open,children:(0,CI.jsx)(oA,{asChild:!0,container:n,children:g})})}))})};Hr.displayName=Xr;var wr="DialogOverlay",Nr=I.forwardRef((function(g,I){var e=Yr(wr,g.__scopeDialog),C=g.forceMount,l=void 0===C?e.forceMount:C,n=cI(g,ur),t=Sr(wr,g.__scopeDialog);return t.modal?(0,CI.jsx)(AA,{present:l||t.open,children:(0,CI.jsx)(Fr,aI(aI({},n),{},{ref:I}))}):null}));Nr.displayName=wr;var Fr=I.forwardRef((function(g,I){var e=g.__scopeDialog,C=cI(g,sr),l=Sr(wr,e);return(0,CI.jsx)(lr,{as:Pa,allowPinchZoom:!0,shards:[l.contentRef],children:(0,CI.jsx)(go.div,aI(aI({"data-state":Pr(l.open)},C),{},{ref:I,style:aI({pointerEvents:"auto"},C.style)}))})})),Kr="DialogContent",xr=I.forwardRef((function(g,I){var e=Yr(Kr,g.__scopeDialog),C=g.forceMount,l=void 0===C?e.forceMount:C,n=cI(g,mr),t=Sr(Kr,g.__scopeDialog);return(0,CI.jsx)(AA,{present:l||t.open,children:t.modal?(0,CI.jsx)(zr,aI(aI({},n),{},{ref:I})):(0,CI.jsx)(Er,aI(aI({},n),{},{ref:I}))})}));xr.displayName=Kr;var zr=I.forwardRef((function(g,e){var C=Sr(Kr,g.__scopeDialog),l=I.useRef(null),n=Da(e,C.contentRef,l);return I.useEffect((function(){var g=l.current;if(g)return ir(g)}),[]),(0,CI.jsx)(Ur,aI(aI({},g),{},{ref:n,trapFocus:C.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:vo(g.onCloseAutoFocus,(function(g){var I;g.preventDefault(),null===(I=C.triggerRef.current)||void 0===I||I.focus()})),onPointerDownOutside:vo(g.onPointerDownOutside,(function(g){var I=g.detail.originalEvent,e=0===I.button&&!0===I.ctrlKey;(2===I.button||e)&&g.preventDefault()})),onFocusOutside:vo(g.onFocusOutside,(function(g){return g.preventDefault()}))}))})),Er=I.forwardRef((function(g,e){var C=Sr(Kr,g.__scopeDialog),l=I.useRef(!1),n=I.useRef(!1);return(0,CI.jsx)(Ur,aI(aI({},g),{},{ref:e,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:function(I){var e,t;(null===(e=g.onCloseAutoFocus)||void 0===e||e.call(g,I),I.defaultPrevented)||(l.current||null===(t=C.triggerRef.current)||void 0===t||t.focus(),I.preventDefault());l.current=!1,n.current=!1},onInteractOutside:function(I){var e,t;null===(e=g.onInteractOutside)||void 0===e||e.call(g,I),I.defaultPrevented||(l.current=!0,"pointerdown"===I.detail.originalEvent.type&&(n.current=!0));var a=I.target;(null===(t=C.triggerRef.current)||void 0===t?void 0:t.contains(a))&&I.preventDefault(),"focusin"===I.detail.originalEvent.type&&n.current&&I.preventDefault()}}))})),Ur=I.forwardRef((function(g,e){var C=g.__scopeDialog,l=g.trapFocus,n=g.onOpenAutoFocus,t=g.onCloseAutoFocus,a=cI(g,br),o=Sr(Kr,C),A=I.useRef(null),r=Da(e,A);return iA(),(0,CI.jsxs)(CI.Fragment,{children:[(0,CI.jsx)(gA,{asChild:!0,loop:!0,trapped:l,onMountAutoFocus:n,onUnmountAutoFocus:t,children:(0,CI.jsx)(Mo,aI(aI({role:"dialog",id:o.contentId,"aria-describedby":o.descriptionId,"aria-labelledby":o.titleId,"data-state":Pr(o.open)},a),{},{ref:r,onDismiss:function(){return o.onOpenChange(!1)}}))}),(0,CI.jsxs)(CI.Fragment,{children:[(0,CI.jsx)(gc,{titleId:o.titleId}),(0,CI.jsx)(Ic,{contentRef:A,descriptionId:o.descriptionId})]})]})})),Qr="DialogTitle",Mr=I.forwardRef((function(g,I){var e=g.__scopeDialog,C=cI(g,Zr),l=Sr(Qr,e);return(0,CI.jsx)(go.h2,aI(aI({id:l.titleId},C),{},{ref:I}))}));Mr.displayName=Qr;var Lr="DialogDescription",Dr=I.forwardRef((function(g,I){var e=g.__scopeDialog,C=cI(g,Gr),l=Sr(Lr,e);return(0,CI.jsx)(go.p,aI(aI({id:l.descriptionId},C),{},{ref:I}))}));Dr.displayName=Lr;var Tr="DialogClose",jr=I.forwardRef((function(g,I){var e=g.__scopeDialog,C=cI(g,yr),l=Sr(Tr,e);return(0,CI.jsx)(go.button,aI(aI({type:"button"},C),{},{ref:I,onClick:vo(g.onClick,(function(){return l.onOpenChange(!1)}))}))}));function Pr(g){return g?"open":"closed"}jr.displayName=Tr;var Or="DialogTitleWarning",qr=function(g,e){var C=I.createContext(e);function l(g){var e=g.children,l=cI(g,fo),n=I.useMemo((function(){return l}),Object.values(l));return(0,CI.jsx)(C.Provider,{value:n,children:e})}return l.displayName=g+"Provider",[l,function(l){var n=I.useContext(C);if(n)return n;if(void 0!==e)return e;throw new Error("`".concat(l,"` must be used within `").concat(g,"`"))}]}(Or,{contentName:Kr,titleName:Qr,docsSlug:"dialog"}),_r=A(qr,2),$r=(_r[0],_r[1]),gc=function(g){var e=g.titleId,C=$r(Or),l="`".concat(C.contentName,"` requires a `").concat(C.titleName,"` for the component to be accessible for screen reader users.\n\nIf you want to hide the `").concat(C.titleName,"`, you can wrap it with our VisuallyHidden component.\n\nFor more information, see https://radix-ui.com/primitives/docs/components/").concat(C.docsSlug);return I.useEffect((function(){e&&(document.getElementById(e)||console.error(l))}),[l,e]),null},Ic=function(g){var e=g.contentRef,C=g.descriptionId,l=$r("DialogDescriptionWarning"),n="Warning: Missing `Description` or `aria-describedby={undefined}` for {".concat(l.contentName,"}.");return I.useEffect((function(){var g,I=null===(g=e.current)||void 0===g?void 0:g.getAttribute("aria-describedby");C&&I&&(document.getElementById(C)||console.warn(n))}),[n,e,C]),null},ec=vr,Cc=Hr,lc=Nr,nc=xr,tc=Mr,ac=Dr,oc=jr,Ac=po("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),rc=["className"],cc=["className","children"],ic=["className"],dc=["className"],uc=["className"],sc=["className"],mc=ec,bc=Cc,Zc=I.forwardRef((function(g,I){var e=g.className,C=cI(g,rc);return(0,CI.jsx)(lc,aI({ref:I,className:xa("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",e)},C))}));Zc.displayName=lc.displayName;var Gc=I.forwardRef((function(g,I){var e=g.className,C=g.children,l=cI(g,cc);return(0,CI.jsxs)(bc,{children:[(0,CI.jsx)(Zc,{}),(0,CI.jsxs)(nc,aI(aI({ref:I,className:xa("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",e)},l),{},{children:[C,(0,CI.jsxs)(oc,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[(0,CI.jsx)(Ac,{className:"h-4 w-4"}),(0,CI.jsx)("span",{className:"sr-only",children:"Close"})]})]}))]})}));Gc.displayName=nc.displayName;var yc=function(g){var I=g.className,e=cI(g,ic);return(0,CI.jsx)("div",aI({className:xa("flex flex-col space-y-1.5 text-center sm:text-left",I)},e))};yc.displayName="DialogHeader";var hc=function(g){var I=g.className,e=cI(g,dc);return(0,CI.jsx)("div",aI({className:xa("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",I)},e))};hc.displayName="DialogFooter";var Bc=I.forwardRef((function(g,I){var e=g.className,C=cI(g,uc);return(0,CI.jsx)(tc,aI({ref:I,className:xa("text-lg font-semibold leading-none tracking-tight",e)},C))}));Bc.displayName=tc.displayName;var pc=I.forwardRef((function(g,I){var e=g.className,C=cI(g,sc);return(0,CI.jsx)(ac,aI({ref:I,className:xa("text-sm text-muted-foreground",e)},C))}));pc.displayName=ac.displayName;var Wc=0;var Vc=new Map,Sc=function(g){if(!Vc.has(g)){var I=setTimeout((function(){Vc.delete(g),Xc({type:"REMOVE_TOAST",toastId:g})}),1e6);Vc.set(g,I)}},vc=function(g,I){switch(I.type){case"ADD_TOAST":return aI(aI({},g),{},{toasts:[I.toast].concat(u(g.toasts)).slice(0,1)});case"UPDATE_TOAST":return aI(aI({},g),{},{toasts:g.toasts.map((function(g){return g.id===I.toast.id?aI(aI({},g),I.toast):g}))});case"DISMISS_TOAST":var e=I.toastId;return e?Sc(e):g.toasts.forEach((function(g){Sc(g.id)})),aI(aI({},g),{},{toasts:g.toasts.map((function(g){return g.id===e||void 0===e?aI(aI({},g),{},{open:!1}):g}))});case"REMOVE_TOAST":return void 0===I.toastId?aI(aI({},g),{},{toasts:[]}):aI(aI({},g),{},{toasts:g.toasts.filter((function(g){return g.id!==I.toastId}))})}},fc=[],Rc={toasts:[]};function Xc(g){Rc=vc(Rc,g),fc.forEach((function(g){g(Rc)}))}function Jc(g){var I=Object.assign({},(function(g){if(null==g)throw new TypeError("Cannot destructure "+g)}(g),g)),e=(Wc=(Wc+1)%Number.MAX_SAFE_INTEGER).toString(),C=function(){return Xc({type:"DISMISS_TOAST",toastId:e})};return Xc({type:"ADD_TOAST",toast:aI(aI({},I),{},{id:e,open:!0,onOpenChange:function(g){g||C()}})}),{id:e,dismiss:C,update:function(g){return Xc({type:"UPDATE_TOAST",toast:aI(aI({},g),{},{id:e})})}}}function kc(){var g=A(I.useState(Rc),2),e=g[0],C=g[1];return I.useEffect((function(){return fc.push(C),function(){var g=fc.indexOf(C);g>-1&&fc.splice(g,1)}}),[e]),aI(aI({},e),{},{toast:Jc,dismiss:function(g){return Xc({type:"DISMISS_TOAST",toastId:g})}})}var Yc,Hc,wc=function(g,I){localStorage.setItem("accessToken",g),localStorage.setItem("refreshToken",I)},Nc=function(){return localStorage.getItem("accessToken")},Fc=function(){return localStorage.getItem("userId")},Kc=function(){localStorage.removeItem("accessToken"),localStorage.removeItem("refreshToken"),localStorage.removeItem("userId"),localStorage.removeItem("role")},xc="https://hostelgo-production.up.railway.app",zc=po("Sun",[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]]),Ec=po("Moon",[["path",{d:"M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z",key:"a7tn18"}]]),Uc=ll().shape({role:DC().required("Role is required"),email:DC().email("Invalid email").required("Email is required"),password:DC().required("Password is required")}),Qc=function(){var g=kc().toast,e=Sg(),C=A((0,I.useState)(""),2),l=(C[0],C[1]),n=A((0,I.useState)(!1),2),t=n[0],a=n[1],o=A((0,I.useState)(0),2),r=o[0],c=o[1],i=A((0,I.useState)(!1),2),d=i[0],u=i[1],s=we({resolver:ze(Uc),defaultValues:{role:"",email:"",password:""}}),m=s.register,b=s.handleSubmit,Z=s.formState.errors,G=s.setValue,y=(0,s.watch)("role"),h=function(){var I=rI(oI().mark((function I(e){var C,l,n,t,a,o,A,r,c;return oI().wrap((function(I){for(;;)switch(I.prev=I.next){case 0:return I.prev=0,C="".concat(xc,"/auth/login"),console.log("Sending request to:",C),console.log("Request payload:",e),I.next=6,wt.post(C,e);case 6:l=I.sent,n=l.data,t=n.accessToken,a=n.refreshToken,o=n.role,A=n.userId,localStorage.setItem("role",o),localStorage.setItem("userId",A),wc(t,a),g({title:"Success",description:l.data.message||"Login successful!"}),B(o),I.next=20;break;case 15:I.prev=15,I.t0=I.catch(0),console.error("Login error:",I.t0),wt.isAxiosError(I.t0)&&(console.error("Response data:",null===(r=I.t0.response)||void 0===r?void 0:r.data),console.error("Response status:",null===(c=I.t0.response)||void 0===c?void 0:c.status)),g({title:"Error",description:"Login failed. Please try again.",variant:"destructive"});case 20:case"end":return I.stop()}}),I,null,[[0,15]])})));return function(g){return I.apply(this,arguments)}}(),B=function(g){switch(g){case"student":e("/student");break;case"staff":e("/staff");break;case"security":e("/security");break;default:e("/")}},p=function(g){G("role",g),l(g)},W=(0,I.useCallback)((function(){c((function(g){var I=g+1;return I>=10?(a(!0),0):I}))}),[]);return(0,I.useEffect)((function(){if(r>0&&r<6){var g=setTimeout((function(){return c(0)}),3e3);return function(){return clearTimeout(g)}}}),[r]),(0,I.useEffect)((function(){d?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark")}),[d]),(0,CI.jsxs)("div",{className:"min-h-screen flex items-center justify-center bg-gray-100 dark:bg-gray-900 transition-colors duration-200",children:[(0,CI.jsxs)(uo,{className:"w-full max-w-md shadow-lg dark:bg-gray-800",children:[(0,CI.jsxs)(so,{className:"space-y-1",children:[(0,CI.jsxs)("div",{className:"flex justify-between items-center",children:[(0,CI.jsx)(mo,{className:"text-2xl font-bold",children:"Welcome Back"}),(0,CI.jsx)(Ua,{variant:"ghost",size:"icon",onClick:function(){return u(!d)},className:"ml-auto",children:d?(0,CI.jsx)(zc,{className:"h-6 w-6"}):(0,CI.jsx)(Ec,{className:"h-6 w-6"})})]}),(0,CI.jsx)(bo,{className:"text-center",children:"Please log in to continue"})]}),(0,CI.jsxs)(Zo,{children:[(0,CI.jsxs)("form",{onSubmit:b(h),className:"space-y-4",children:[(0,CI.jsxs)("div",{className:"flex justify-around mb-4",children:[(0,CI.jsxs)(Ua,{type:"button",variant:"student"===y?"default":"outline",className:"flex flex-col items-center transition-all duration-200 ".concat("student"===y?"bg-primary text-primary-foreground":""),onClick:function(){return p("student")},children:[(0,CI.jsx)(So.school,{className:"h-6 w-6 mb-2"}),"Student"]}),(0,CI.jsxs)(Ua,{type:"button",variant:"staff"===y?"default":"outline",className:"flex flex-col items-center transition-all duration-200 ".concat("staff"===y?"bg-primary text-primary-foreground":""),onClick:function(){return p("staff")},children:[(0,CI.jsx)(So.work,{className:"h-6 w-6 mb-2"}),"Warden"]})]}),Z.role&&(0,CI.jsx)("p",{className:"text-sm text-red-500 dark:text-red-400",children:Z.role.message}),(0,CI.jsxs)("div",{className:"space-y-2",children:[(0,CI.jsx)(to,{htmlFor:"email",children:"Email"}),(0,CI.jsx)(Ma,aI(aI({id:"email",type:"email"},m("email")),{},{className:"".concat(Z.email?"border-red-500":""," dark:bg-gray-700 dark:text-white")})),Z.email&&(0,CI.jsx)("p",{className:"text-sm text-red-500 dark:text-red-400",children:Z.email.message})]}),(0,CI.jsxs)("div",{className:"space-y-2",children:[(0,CI.jsx)(to,{htmlFor:"password",children:"Password"}),(0,CI.jsx)(Ma,aI(aI({id:"password",type:"password"},m("password")),{},{className:"".concat(Z.password?"border-red-500":""," dark:bg-gray-700 dark:text-white")})),Z.password&&(0,CI.jsx)("p",{className:"text-sm text-red-500 dark:text-red-400",children:Z.password.message})]}),(0,CI.jsx)(Ua,{type:"submit",className:"w-full",children:"Log In"})]}),(0,CI.jsxs)("p",{className:"text-sm text-center mt-4 dark:text-gray-300",children:["Don't have an account?"," ",(0,CI.jsx)(gI,{to:"/register",className:"text-primary hover:underline",children:"Register here"})]}),(0,CI.jsx)("p",{className:"text-xs text-center mt-4 opacity-70 cursor-pointer dark:text-gray-400",onClick:W,children:"HostelGo \xa9 2024"})]})]}),(0,CI.jsx)(mc,{open:t,onOpenChange:a,children:(0,CI.jsxs)(Gc,{className:"dark:bg-gray-800",children:[(0,CI.jsxs)(yc,{children:[(0,CI.jsx)(Bc,{children:"Security Login"}),(0,CI.jsx)(pc,{children:"Enter your credentials to login as security."})]}),(0,CI.jsxs)("form",{onSubmit:b(h),className:"space-y-4",children:[(0,CI.jsxs)("div",{className:"space-y-2",children:[(0,CI.jsx)(to,{htmlFor:"security-email",children:"Email"}),(0,CI.jsx)(Ma,aI(aI({id:"security-email",type:"email"},m("email")),{},{className:"".concat(Z.email?"border-red-500":""," dark:bg-gray-700 dark:text-white")})),Z.email&&(0,CI.jsx)("p",{className:"text-sm text-red-500 dark:text-red-400",children:Z.email.message})]}),(0,CI.jsxs)("div",{className:"space-y-2",children:[(0,CI.jsx)(to,{htmlFor:"security-password",children:"Password"}),(0,CI.jsx)(Ma,aI(aI({id:"security-password",type:"password"},m("password")),{},{className:"".concat(Z.password?"border-red-500":""," dark:bg-gray-700 dark:text-white")})),Z.password&&(0,CI.jsx)("p",{className:"text-sm text-red-500 dark:text-red-400",children:Z.password.message})]}),(0,CI.jsx)(Ua,{type:"submit",className:"w-full",onClick:function(){return G("role","security")},children:"Login as Security"})]})]})})]})},Mc=function(){return(0,CI.jsx)("div",{children:"ErrorPage"})},Lc=ll().shape({role:DC().required("Role is required"),email:DC().email("Invalid email").required("Email is required"),password:DC().required("Password is required")}),Dc=function(){var g=kc().toast,e=Sg(),C=A((0,I.useState)(""),2),l=(C[0],C[1]),n=A((0,I.useState)(!1),2),t=n[0],a=n[1],o=A((0,I.useState)(0),2),r=o[0],c=o[1],i=A((0,I.useState)(!1),2),d=i[0],u=i[1],s=we({resolver:ze(Lc),defaultValues:{role:"",email:"",password:""}}),m=s.register,b=s.handleSubmit,Z=s.formState.errors,G=s.setValue,y=(0,s.watch)("role"),h=function(){var I=rI(oI().mark((function I(C){var l,n;return oI().wrap((function(I){for(;;)switch(I.prev=I.next){case 0:return I.prev=0,l="security"===C.role?"".concat(xc,"/auth/register/Security"):"student"===C.role?"".concat(xc,"/auth/register/user"):"".concat(xc,"/auth/register/staff"),I.next=4,wt.post(l,{email:C.email,password:C.password});case 4:n=I.sent,g({title:"Success",description:n.data.message||"Registration successful!"}),setTimeout((function(){return e("/login")}),2e3),I.next=13;break;case 9:I.prev=9,I.t0=I.catch(0),console.error("Error during registration:",I.t0),g({title:"Error",description:"Registration failed. Please try again.",variant:"destructive"});case 13:case"end":return I.stop()}}),I,null,[[0,9]])})));return function(g){return I.apply(this,arguments)}}(),B=function(g){G("role",g),l(g)},p=(0,I.useCallback)((function(){c((function(g){var I=g+1;return I>=10?(a(!0),0):I}))}),[]);return(0,I.useEffect)((function(){if(r>0&&r<6){var g=setTimeout((function(){return c(0)}),3e3);return function(){return clearTimeout(g)}}}),[r]),(0,I.useEffect)((function(){d?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark")}),[d]),(0,CI.jsxs)("div",{className:"min-h-screen flex items-center justify-center bg-gray-100 dark:bg-gray-900 transition-colors duration-200",children:[(0,CI.jsxs)(uo,{className:"w-full max-w-md shadow-lg dark:bg-gray-800",children:[(0,CI.jsxs)(so,{className:"space-y-1",children:[(0,CI.jsxs)("div",{className:"flex justify-between items-center",children:[(0,CI.jsx)(mo,{className:"text-2xl font-bold",children:"Create Account"}),(0,CI.jsx)(Ua,{variant:"ghost",size:"icon",onClick:function(){return u(!d)},className:"ml-auto",children:d?(0,CI.jsx)(zc,{className:"h-6 w-6"}):(0,CI.jsx)(Ec,{className:"h-6 w-6"})})]}),(0,CI.jsx)(bo,{className:"text-center",children:"Please fill in the details to register"})]}),(0,CI.jsxs)(Zo,{children:[(0,CI.jsxs)("form",{onSubmit:b(h),className:"space-y-4",children:[(0,CI.jsxs)("div",{className:"flex justify-around mb-4",children:[(0,CI.jsxs)(Ua,{type:"button",variant:"student"===y?"default":"outline",className:"flex flex-col items-center transition-all duration-200 ".concat("student"===y?"bg-primary text-primary-foreground":""),onClick:function(){return B("student")},children:[(0,CI.jsx)(Wo,{className:"h-6 w-6 mb-2"}),"Student"]}),(0,CI.jsxs)(Ua,{type:"button",variant:"staff"===y?"default":"outline",className:"flex flex-col items-center transition-all duration-200 ".concat("staff"===y?"bg-primary text-primary-foreground":""),onClick:function(){return B("staff")},children:[(0,CI.jsx)(Vo,{className:"h-6 w-6 mb-2"}),"Warden"]})]}),Z.role&&(0,CI.jsx)("p",{className:"text-sm text-red-500 dark:text-red-400",children:Z.role.message}),(0,CI.jsxs)("div",{className:"space-y-2",children:[(0,CI.jsx)(to,{htmlFor:"email",children:"Email"}),(0,CI.jsx)(Ma,aI(aI({id:"email",type:"email"},m("email")),{},{className:"".concat(Z.email?"border-red-500":""," dark:bg-gray-700 dark:text-white")})),Z.email&&(0,CI.jsx)("p",{className:"text-sm text-red-500 dark:text-red-400",children:Z.email.message})]}),(0,CI.jsxs)("div",{className:"space-y-2",children:[(0,CI.jsx)(to,{htmlFor:"password",children:"Password"}),(0,CI.jsx)(Ma,aI(aI({id:"password",type:"password"},m("password")),{},{className:"".concat(Z.password?"border-red-500":""," dark:bg-gray-700 dark:text-white")})),Z.password&&(0,CI.jsx)("p",{className:"text-sm text-red-500 dark:text-red-400",children:Z.password.message})]}),(0,CI.jsx)(Ua,{type:"submit",className:"w-full",children:"Register"})]}),(0,CI.jsxs)("p",{className:"text-sm text-center mt-4 dark:text-gray-300",children:["Already have an account?"," ",(0,CI.jsx)(gI,{to:"/login",className:"text-primary hover:underline",children:"Login here"})]}),(0,CI.jsx)("p",{className:"text-xs text-center mt-4 opacity-70 cursor-pointer dark:text-gray-400",onClick:p,children:"HostelGo \xa9 2024"})]})]}),(0,CI.jsx)(mc,{open:t,onOpenChange:a,children:(0,CI.jsxs)(Gc,{className:"dark:bg-gray-800",children:[(0,CI.jsxs)(yc,{children:[(0,CI.jsx)(Bc,{children:"Security Guard Registration"}),(0,CI.jsx)(pc,{children:"Enter your credentials to register as a security guard."})]}),(0,CI.jsxs)("form",{onSubmit:b(h),className:"space-y-4",children:[(0,CI.jsxs)("div",{className:"space-y-2",children:[(0,CI.jsx)(to,{htmlFor:"security-email",children:"Email"}),(0,CI.jsx)(Ma,aI(aI({id:"security-email",type:"email"},m("email")),{},{className:"".concat(Z.email?"border-red-500":""," dark:bg-gray-700 dark:text-white")})),Z.email&&(0,CI.jsx)("p",{className:"text-sm text-red-500 dark:text-red-400",children:Z.email.message})]}),(0,CI.jsxs)("div",{className:"space-y-2",children:[(0,CI.jsx)(to,{htmlFor:"security-password",children:"Password"}),(0,CI.jsx)(Ma,aI(aI({id:"security-password",type:"password"},m("password")),{},{className:"".concat(Z.password?"border-red-500":""," dark:bg-gray-700 dark:text-white")})),Z.password&&(0,CI.jsx)("p",{className:"text-sm text-red-500 dark:text-red-400",children:Z.password.message})]}),(0,CI.jsx)(Ua,{type:"submit",className:"w-full",onClick:function(){return G("role","security")},children:"Register as Security Guard"})]})]})})]})},Tc=Object.defineProperty,jc=Object.getOwnPropertySymbols,Pc=Object.prototype.hasOwnProperty,Oc=Object.prototype.propertyIsEnumerable,qc=function(g,I,e){return I in g?Tc(g,I,{enumerable:!0,configurable:!0,writable:!0,value:e}):g[I]=e},_c=function(g,I){for(var e in I||(I={}))Pc.call(I,e)&&qc(g,e,I[e]);if(jc){var C,l=X(jc(I));try{for(l.s();!(C=l.n()).done;){e=C.value;Oc.call(I,e)&&qc(g,e,I[e])}}catch(gG){l.e(gG)}finally{l.f()}}return g},$c=function(g,I){var e={};for(var C in g)Pc.call(g,C)&&I.indexOf(C)<0&&(e[C]=g[C]);if(null!=g&&jc){var l,n=X(jc(g));try{for(n.s();!(l=n.n()).done;){C=l.value;I.indexOf(C)<0&&Oc.call(g,C)&&(e[C]=g[C])}}catch(gG){n.e(gG)}finally{n.f()}}return e};!function(g){var I=function(){function I(g,e,C,l){if(s(this,I),this.version=g,this.errorCorrectionLevel=e,this.modules=[],this.isFunction=[],g<I.MIN_VERSION||g>I.MAX_VERSION)throw new RangeError("Version value out of range");if(l<-1||l>7)throw new RangeError("Mask value out of range");this.size=4*g+17;for(var t=[],a=0;a<this.size;a++)t.push(!1);for(var o=0;o<this.size;o++)this.modules.push(t.slice()),this.isFunction.push(t.slice());this.drawFunctionPatterns();var A=this.addEccAndInterleave(C);if(this.drawCodewords(A),-1==l)for(var r=1e9,c=0;c<8;c++){this.applyMask(c),this.drawFormatBits(c);var i=this.getPenaltyScore();i<r&&(l=c,r=i),this.applyMask(c)}n(0<=l&&l<=7),this.mask=l,this.applyMask(l),this.drawFormatBits(l),this.isFunction=[]}return G(I,[{key:"getModule",value:function(g,I){return 0<=g&&g<this.size&&0<=I&&I<this.size&&this.modules[I][g]}},{key:"getModules",value:function(){return this.modules}},{key:"drawFunctionPatterns",value:function(){for(var g=0;g<this.size;g++)this.setFunctionModule(6,g,g%2==0),this.setFunctionModule(g,6,g%2==0);this.drawFinderPattern(3,3),this.drawFinderPattern(this.size-4,3),this.drawFinderPattern(3,this.size-4);for(var I=this.getAlignmentPatternPositions(),e=I.length,C=0;C<e;C++)for(var l=0;l<e;l++)0==C&&0==l||0==C&&l==e-1||C==e-1&&0==l||this.drawAlignmentPattern(I[C],I[l]);this.drawFormatBits(0),this.drawVersion()}},{key:"drawFormatBits",value:function(g){for(var I=this.errorCorrectionLevel.formatBits<<3|g,e=I,C=0;C<10;C++)e=e<<1^1335*(e>>>9);var t=21522^(I<<10|e);n(t>>>15==0);for(var a=0;a<=5;a++)this.setFunctionModule(8,a,l(t,a));this.setFunctionModule(8,7,l(t,6)),this.setFunctionModule(8,8,l(t,7)),this.setFunctionModule(7,8,l(t,8));for(var o=9;o<15;o++)this.setFunctionModule(14-o,8,l(t,o));for(var A=0;A<8;A++)this.setFunctionModule(this.size-1-A,8,l(t,A));for(var r=8;r<15;r++)this.setFunctionModule(8,this.size-15+r,l(t,r));this.setFunctionModule(8,this.size-8,!0)}},{key:"drawVersion",value:function(){if(!(this.version<7)){for(var g=this.version,I=0;I<12;I++)g=g<<1^7973*(g>>>11);var e=this.version<<12|g;n(e>>>18==0);for(var C=0;C<18;C++){var t=l(e,C),a=this.size-11+C%3,o=Math.floor(C/3);this.setFunctionModule(a,o,t),this.setFunctionModule(o,a,t)}}}},{key:"drawFinderPattern",value:function(g,I){for(var e=-4;e<=4;e++)for(var C=-4;C<=4;C++){var l=Math.max(Math.abs(C),Math.abs(e)),n=g+C,t=I+e;0<=n&&n<this.size&&0<=t&&t<this.size&&this.setFunctionModule(n,t,2!=l&&4!=l)}}},{key:"drawAlignmentPattern",value:function(g,I){for(var e=-2;e<=2;e++)for(var C=-2;C<=2;C++)this.setFunctionModule(g+C,I+e,1!=Math.max(Math.abs(C),Math.abs(e)))}},{key:"setFunctionModule",value:function(g,I,e){this.modules[I][g]=e,this.isFunction[I][g]=!0}},{key:"addEccAndInterleave",value:function(g){var e=this.version,C=this.errorCorrectionLevel;if(g.length!=I.getNumDataCodewords(e,C))throw new RangeError("Invalid argument");for(var l=I.NUM_ERROR_CORRECTION_BLOCKS[C.ordinal][e],t=I.ECC_CODEWORDS_PER_BLOCK[C.ordinal][e],a=Math.floor(I.getNumRawDataModules(e)/8),o=l-a%l,A=Math.floor(a/l),r=[],c=I.reedSolomonComputeDivisor(t),i=0,d=0;i<l;i++){var u=g.slice(d,d+A-t+(i<o?0:1));d+=u.length;var s=I.reedSolomonComputeRemainder(u,c);i<o&&u.push(0),r.push(u.concat(s))}for(var m=[],b=function(g){r.forEach((function(I,e){(g!=A-t||e>=o)&&m.push(I[g])}))},Z=0;Z<r[0].length;Z++)b(Z);return n(m.length==a),m}},{key:"drawCodewords",value:function(g){if(g.length!=Math.floor(I.getNumRawDataModules(this.version)/8))throw new RangeError("Invalid argument");for(var e=0,C=this.size-1;C>=1;C-=2){6==C&&(C=5);for(var t=0;t<this.size;t++)for(var a=0;a<2;a++){var o=C-a,A=0==(C+1&2)?this.size-1-t:t;!this.isFunction[A][o]&&e<8*g.length&&(this.modules[A][o]=l(g[e>>>3],7-(7&e)),e++)}}n(e==8*g.length)}},{key:"applyMask",value:function(g){if(g<0||g>7)throw new RangeError("Mask value out of range");for(var I=0;I<this.size;I++)for(var e=0;e<this.size;e++){var C=void 0;switch(g){case 0:C=(e+I)%2==0;break;case 1:C=I%2==0;break;case 2:C=e%3==0;break;case 3:C=(e+I)%3==0;break;case 4:C=(Math.floor(e/3)+Math.floor(I/2))%2==0;break;case 5:C=e*I%2+e*I%3==0;break;case 6:C=(e*I%2+e*I%3)%2==0;break;case 7:C=((e+I)%2+e*I%3)%2==0;break;default:throw new Error("Unreachable")}!this.isFunction[I][e]&&C&&(this.modules[I][e]=!this.modules[I][e])}}},{key:"getPenaltyScore",value:function(){for(var g=0,e=0;e<this.size;e++){for(var C=!1,l=0,t=[0,0,0,0,0,0,0],a=0;a<this.size;a++)this.modules[e][a]==C?5==++l?g+=I.PENALTY_N1:l>5&&g++:(this.finderPenaltyAddHistory(l,t),C||(g+=this.finderPenaltyCountPatterns(t)*I.PENALTY_N3),C=this.modules[e][a],l=1);g+=this.finderPenaltyTerminateAndCount(C,l,t)*I.PENALTY_N3}for(var o=0;o<this.size;o++){for(var A=!1,r=0,c=[0,0,0,0,0,0,0],i=0;i<this.size;i++)this.modules[i][o]==A?5==++r?g+=I.PENALTY_N1:r>5&&g++:(this.finderPenaltyAddHistory(r,c),A||(g+=this.finderPenaltyCountPatterns(c)*I.PENALTY_N3),A=this.modules[i][o],r=1);g+=this.finderPenaltyTerminateAndCount(A,r,c)*I.PENALTY_N3}for(var d=0;d<this.size-1;d++)for(var u=0;u<this.size-1;u++){var s=this.modules[d][u];s==this.modules[d][u+1]&&s==this.modules[d+1][u]&&s==this.modules[d+1][u+1]&&(g+=I.PENALTY_N2)}var m,b=0,Z=X(this.modules);try{for(Z.s();!(m=Z.n()).done;){b=m.value.reduce((function(g,I){return g+(I?1:0)}),b)}}catch(gG){Z.e(gG)}finally{Z.f()}var G=this.size*this.size,y=Math.ceil(Math.abs(20*b-10*G)/G)-1;return n(0<=y&&y<=9),n(0<=(g+=y*I.PENALTY_N4)&&g<=2568888),g}},{key:"getAlignmentPatternPositions",value:function(){if(1==this.version)return[];for(var g=Math.floor(this.version/7)+2,I=32==this.version?26:2*Math.ceil((4*this.version+4)/(2*g-2)),e=[6],C=this.size-7;e.length<g;C-=I)e.splice(1,0,C);return e}},{key:"finderPenaltyCountPatterns",value:function(g){var I=g[1];n(I<=3*this.size);var e=I>0&&g[2]==I&&g[3]==3*I&&g[4]==I&&g[5]==I;return(e&&g[0]>=4*I&&g[6]>=I?1:0)+(e&&g[6]>=4*I&&g[0]>=I?1:0)}},{key:"finderPenaltyTerminateAndCount",value:function(g,I,e){return g&&(this.finderPenaltyAddHistory(I,e),I=0),I+=this.size,this.finderPenaltyAddHistory(I,e),this.finderPenaltyCountPatterns(e)}},{key:"finderPenaltyAddHistory",value:function(g,I){0==I[0]&&(g+=this.size),I.pop(),I.unshift(g)}}],[{key:"encodeText",value:function(e,C){var l=g.QrSegment.makeSegments(e);return I.encodeSegments(l,C)}},{key:"encodeBinary",value:function(e,C){var l=g.QrSegment.makeBytes(e);return I.encodeSegments([l],C)}},{key:"encodeSegments",value:function(g,e){var l,t,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,A=arguments.length>3&&void 0!==arguments[3]?arguments[3]:40,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:-1,c=!(arguments.length>5&&void 0!==arguments[5])||arguments[5];if(!(I.MIN_VERSION<=o&&o<=A&&A<=I.MAX_VERSION)||r<-1||r>7)throw new RangeError("Invalid value");for(l=o;;l++){var i=8*I.getNumDataCodewords(l,e),d=a.getTotalBits(g,l);if(d<=i){t=d;break}if(l>=A)throw new RangeError("Data too long")}for(var u=0,s=[I.Ecc.MEDIUM,I.Ecc.QUARTILE,I.Ecc.HIGH];u<s.length;u++){var m=s[u];c&&t<=8*I.getNumDataCodewords(l,m)&&(e=m)}var b,Z=[],G=X(g);try{for(G.s();!(b=G.n()).done;){var y=b.value;C(y.mode.modeBits,4,Z),C(y.numChars,y.mode.numCharCountBits(l),Z);var h,B=X(y.getData());try{for(B.s();!(h=B.n()).done;){var p=h.value;Z.push(p)}}catch(gG){B.e(gG)}finally{B.f()}}}catch(gG){G.e(gG)}finally{G.f()}n(Z.length==t);var W=8*I.getNumDataCodewords(l,e);n(Z.length<=W),C(0,Math.min(4,W-Z.length),Z),C(0,(8-Z.length%8)%8,Z),n(Z.length%8==0);for(var V=236;Z.length<W;V^=253)C(V,8,Z);for(var S=[];8*S.length<Z.length;)S.push(0);return Z.forEach((function(g,I){return S[I>>>3]|=g<<7-(7&I)})),new I(l,e,S,r)}},{key:"getNumRawDataModules",value:function(g){if(g<I.MIN_VERSION||g>I.MAX_VERSION)throw new RangeError("Version number out of range");var e=(16*g+128)*g+64;if(g>=2){var C=Math.floor(g/7)+2;e-=(25*C-10)*C-55,g>=7&&(e-=36)}return n(208<=e&&e<=29648),e}},{key:"getNumDataCodewords",value:function(g,e){return Math.floor(I.getNumRawDataModules(g)/8)-I.ECC_CODEWORDS_PER_BLOCK[e.ordinal][g]*I.NUM_ERROR_CORRECTION_BLOCKS[e.ordinal][g]}},{key:"reedSolomonComputeDivisor",value:function(g){if(g<1||g>255)throw new RangeError("Degree out of range");for(var e=[],C=0;C<g-1;C++)e.push(0);e.push(1);for(var l=1,n=0;n<g;n++){for(var t=0;t<e.length;t++)e[t]=I.reedSolomonMultiply(e[t],l),t+1<e.length&&(e[t]^=e[t+1]);l=I.reedSolomonMultiply(l,2)}return e}},{key:"reedSolomonComputeRemainder",value:function(g,e){var C,l=e.map((function(g){return 0})),n=X(g);try{var t=function(){var g=C.value^l.shift();l.push(0),e.forEach((function(e,C){return l[C]^=I.reedSolomonMultiply(e,g)}))};for(n.s();!(C=n.n()).done;)t()}catch(gG){n.e(gG)}finally{n.f()}return l}},{key:"reedSolomonMultiply",value:function(g,I){if(g>>>8!=0||I>>>8!=0)throw new RangeError("Byte out of range");for(var e=0,C=7;C>=0;C--)e=e<<1^285*(e>>>7),e^=(I>>>C&1)*g;return n(e>>>8==0),e}}]),I}(),e=I;function C(g,I,e){if(I<0||I>31||g>>>I!=0)throw new RangeError("Value out of range");for(var C=I-1;C>=0;C--)e.push(g>>>C&1)}function l(g,I){return 0!=(g>>>I&1)}function n(g){if(!g)throw new Error("Assertion error")}e.MIN_VERSION=1,e.MAX_VERSION=40,e.PENALTY_N1=3,e.PENALTY_N2=3,e.PENALTY_N3=40,e.PENALTY_N4=10,e.ECC_CODEWORDS_PER_BLOCK=[[-1,7,10,15,20,26,18,20,24,30,18,20,24,26,30,22,24,28,30,28,28,28,28,30,30,26,28,30,30,30,30,30,30,30,30,30,30,30,30,30,30],[-1,10,16,26,18,24,16,18,22,22,26,30,22,22,24,24,28,28,26,26,26,26,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28],[-1,13,22,18,26,18,24,18,22,20,24,28,26,24,20,30,24,28,28,26,30,28,30,30,30,30,28,30,30,30,30,30,30,30,30,30,30,30,30,30,30],[-1,17,28,22,16,22,28,26,26,24,28,24,28,22,24,24,30,28,28,26,28,30,24,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30]],e.NUM_ERROR_CORRECTION_BLOCKS=[[-1,1,1,1,1,1,2,2,2,2,4,4,4,4,4,6,6,6,6,7,8,8,9,9,10,12,12,12,13,14,15,16,17,18,19,19,20,21,22,24,25],[-1,1,1,1,2,2,4,4,4,5,5,5,8,9,9,10,10,11,13,14,16,17,17,18,20,21,23,25,26,28,29,31,33,35,37,38,40,43,45,47,49],[-1,1,1,2,2,4,4,6,6,8,8,8,10,12,16,12,17,16,18,21,20,23,23,25,27,29,34,34,35,38,40,43,45,48,51,53,56,59,62,65,68],[-1,1,1,2,4,4,4,5,6,8,8,11,11,16,16,18,16,19,21,25,25,25,34,30,32,35,37,40,42,45,48,51,54,57,60,63,66,70,74,77,81]],g.QrCode=e;var t=function(){function g(I,e,C){if(s(this,g),this.mode=I,this.numChars=e,this.bitData=C,e<0)throw new RangeError("Invalid argument");this.bitData=C.slice()}return G(g,[{key:"getData",value:function(){return this.bitData.slice()}}],[{key:"makeBytes",value:function(I){var e,l=[],n=X(I);try{for(n.s();!(e=n.n()).done;){C(e.value,8,l)}}catch(gG){n.e(gG)}finally{n.f()}return new g(g.Mode.BYTE,I.length,l)}},{key:"makeNumeric",value:function(I){if(!g.isNumeric(I))throw new RangeError("String contains non-numeric characters");for(var e=[],l=0;l<I.length;){var n=Math.min(I.length-l,3);C(parseInt(I.substr(l,n),10),3*n+1,e),l+=n}return new g(g.Mode.NUMERIC,I.length,e)}},{key:"makeAlphanumeric",value:function(I){if(!g.isAlphanumeric(I))throw new RangeError("String contains unencodable characters in alphanumeric mode");var e,l=[];for(e=0;e+2<=I.length;e+=2){var n=45*g.ALPHANUMERIC_CHARSET.indexOf(I.charAt(e));C(n+=g.ALPHANUMERIC_CHARSET.indexOf(I.charAt(e+1)),11,l)}return e<I.length&&C(g.ALPHANUMERIC_CHARSET.indexOf(I.charAt(e)),6,l),new g(g.Mode.ALPHANUMERIC,I.length,l)}},{key:"makeSegments",value:function(I){return""==I?[]:g.isNumeric(I)?[g.makeNumeric(I)]:g.isAlphanumeric(I)?[g.makeAlphanumeric(I)]:[g.makeBytes(g.toUtf8ByteArray(I))]}},{key:"makeEci",value:function(I){var e=[];if(I<0)throw new RangeError("ECI assignment value out of range");if(I<128)C(I,8,e);else if(I<16384)C(2,2,e),C(I,14,e);else{if(!(I<1e6))throw new RangeError("ECI assignment value out of range");C(6,3,e),C(I,21,e)}return new g(g.Mode.ECI,0,e)}},{key:"isNumeric",value:function(I){return g.NUMERIC_REGEX.test(I)}},{key:"isAlphanumeric",value:function(I){return g.ALPHANUMERIC_REGEX.test(I)}},{key:"getTotalBits",value:function(g,I){var e,C=0,l=X(g);try{for(l.s();!(e=l.n()).done;){var n=e.value,t=n.mode.numCharCountBits(I);if(n.numChars>=1<<t)return 1/0;C+=4+t+n.bitData.length}}catch(gG){l.e(gG)}finally{l.f()}return C}},{key:"toUtf8ByteArray",value:function(g){g=encodeURI(g);for(var I=[],e=0;e<g.length;e++)"%"!=g.charAt(e)?I.push(g.charCodeAt(e)):(I.push(parseInt(g.substr(e+1,2),16)),e+=2);return I}}]),g}(),a=t;a.NUMERIC_REGEX=/^[0-9]*$/,a.ALPHANUMERIC_REGEX=/^[A-Z0-9 $%*+.\/:-]*$/,a.ALPHANUMERIC_CHARSET="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ $%*+-./:",g.QrSegment=a}(Yc||(Yc={})),function(g){var I=G((function g(I,e){s(this,g),this.ordinal=I,this.formatBits=e})),e=I;e.LOW=new I(0,1),e.MEDIUM=new I(1,0),e.QUARTILE=new I(2,3),e.HIGH=new I(3,2),g.Ecc=e}((Hc=Yc||(Yc={})).QrCode||(Hc.QrCode={})),function(g){!function(g){var I=function(){function g(I,e){s(this,g),this.modeBits=I,this.numBitsCharCount=e}return G(g,[{key:"numCharCountBits",value:function(g){return this.numBitsCharCount[Math.floor((g+7)/17)]}}]),g}(),e=I;e.NUMERIC=new I(1,[10,12,14]),e.ALPHANUMERIC=new I(2,[9,11,13]),e.BYTE=new I(4,[8,16,16]),e.KANJI=new I(8,[8,10,12]),e.ECI=new I(7,[0,0,0]),g.Mode=e}(g.QrSegment||(g.QrSegment={}))}(Yc||(Yc={}));var gi=Yc,Ii={L:gi.QrCode.Ecc.LOW,M:gi.QrCode.Ecc.MEDIUM,Q:gi.QrCode.Ecc.QUARTILE,H:gi.QrCode.Ecc.HIGH},ei="#FFFFFF",Ci="#000000",li=4,ni=.1;function ti(g){var I=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,e=[];return g.forEach((function(g,C){var l=null;g.forEach((function(n,t){if(!n&&null!==l)return e.push("M".concat(l+I," ").concat(C+I,"h").concat(t-l,"v1H").concat(l+I,"z")),void(l=null);if(t!==g.length-1)n&&null===l&&(l=t);else{if(!n)return;null===l?e.push("M".concat(t+I,",").concat(C+I," h1v1H").concat(t+I,"z")):e.push("M".concat(l+I,",").concat(C+I," h").concat(t+1-l,"v1H").concat(l+I,"z"))}}))})),e.join("")}function ai(g,I){return g.slice().map((function(g,e){return e<I.y||e>=I.y+I.h?g:g.map((function(g,e){return(e<I.x||e>=I.x+I.w)&&g}))}))}function oi(g,I,e,C){if(null==C)return null;var l=e?li:0,n=g.length+2*l,t=Math.floor(I*ni),a=n/I,o=(C.width||t)*a,A=(C.height||t)*a,r=null==C.x?g.length/2-o/2:C.x*a,c=null==C.y?g.length/2-A/2:C.y*a,i=null;if(C.excavate){var d=Math.floor(r),u=Math.floor(c);i={x:d,y:u,w:Math.ceil(o+r-d),h:Math.ceil(A+c-u)}}return{x:r,y:c,h:A,w:o,excavation:i}}var Ai=function(){try{(new Path2D).addPath(new Path2D)}catch($Z){return!1}return!0}();function ri(g){var e=g,C=e.value,l=e.size,n=void 0===l?128:l,t=e.level,a=void 0===t?"L":t,o=e.bgColor,r=void 0===o?ei:o,c=e.fgColor,i=void 0===c?Ci:c,d=e.includeMargin,u=void 0!==d&&d,s=e.style,m=e.imageSettings,b=$c(e,["value","size","level","bgColor","fgColor","includeMargin","style","imageSettings"]),Z=null==m?void 0:m.src,G=(0,I.useRef)(null),y=(0,I.useRef)(null),h=A((0,I.useState)(!1),2),B=(h[0],h[1]);(0,I.useEffect)((function(){if(null!=G.current){var g=G.current,I=g.getContext("2d");if(!I)return;var e=gi.QrCode.encodeText(C,Ii[a]).getModules(),l=u?li:0,t=e.length+2*l,o=oi(e,n,u,m),A=y.current,c=null!=o&&null!==A&&A.complete&&0!==A.naturalHeight&&0!==A.naturalWidth;c&&null!=o.excavation&&(e=ai(e,o.excavation));var d=window.devicePixelRatio||1;g.height=g.width=n*d;var s=n/t*d;I.scale(s,s),I.fillStyle=r,I.fillRect(0,0,t,t),I.fillStyle=i,Ai?I.fill(new Path2D(ti(e,l))):e.forEach((function(g,e){g.forEach((function(g,C){g&&I.fillRect(C+l,e+l,1,1)}))})),c&&I.drawImage(A,o.x+l,o.y+l,o.w,o.h)}})),(0,I.useEffect)((function(){B(!1)}),[Z]);var p=_c({height:n,width:n},s),W=null;return null!=Z&&(W=I.createElement("img",{src:Z,key:Z,style:{display:"none"},onLoad:function(){B(!0)},ref:y})),I.createElement(I.Fragment,null,I.createElement("canvas",_c({style:p,height:n,width:n,ref:G},b)),W)}function ci(g){var e=g,C=e.value,l=e.size,n=void 0===l?128:l,t=e.level,a=void 0===t?"L":t,o=e.bgColor,A=void 0===o?ei:o,r=e.fgColor,c=void 0===r?Ci:r,i=e.includeMargin,d=void 0!==i&&i,u=e.imageSettings,s=$c(e,["value","size","level","bgColor","fgColor","includeMargin","imageSettings"]),m=gi.QrCode.encodeText(C,Ii[a]).getModules(),b=d?li:0,Z=m.length+2*b,G=oi(m,n,d,u),y=null;null!=u&&null!=G&&(null!=G.excavation&&(m=ai(m,G.excavation)),y=I.createElement("image",{xlinkHref:u.src,height:G.h,width:G.w,x:G.x+b,y:G.y+b,preserveAspectRatio:"none"}));var h=ti(m,b);return I.createElement("svg",_c({height:n,width:n,viewBox:"0 0 ".concat(Z," ").concat(Z)},s),I.createElement("path",{fill:A,d:"M0,0 h".concat(Z,"v").concat(Z,"H0z"),shapeRendering:"crispEdges"}),I.createElement("path",{fill:c,d:h,shapeRendering:"crispEdges"}),y)}var ii=function(g){var e=g,C=e.renderAs,l=$c(e,["renderAs"]);return"svg"===C?I.createElement(ci,_c({},l)):I.createElement(ri,_c({},l))},di=["__scopeAvatar"],ui=["__scopeAvatar","src","onLoadingStatusChange"],si=["__scopeAvatar","delayMs"],mi="Avatar",bi=A(Xo(mi),2),Zi=bi[0],Gi=(bi[1],A(Zi(mi),2)),yi=Gi[0],hi=Gi[1],Bi=I.forwardRef((function(g,e){var C=g.__scopeAvatar,l=cI(g,di),n=A(I.useState("idle"),2),t=n[0],a=n[1];return(0,CI.jsx)(yi,{scope:C,imageLoadingStatus:t,onImageLoadingStatusChange:a,children:(0,CI.jsx)(go.span,aI(aI({},l),{},{ref:e}))})}));Bi.displayName=mi;var pi="AvatarImage",Wi=I.forwardRef((function(g,e){var C=g.__scopeAvatar,l=g.src,n=g.onLoadingStatusChange,t=void 0===n?function(){}:n,a=cI(g,ui),o=hi(pi,C),r=function(g){var e=A(I.useState("idle"),2),C=e[0],l=e[1];return ko((function(){if(g){var I=!0,e=new window.Image,C=function(g){return function(){I&&l(g)}};return l("loading"),e.onload=C("loaded"),e.onerror=C("error"),e.src=g,function(){I=!1}}l("error")}),[g]),C}(l),c=No((function(g){t(g),o.onImageLoadingStatusChange(g)}));return ko((function(){"idle"!==r&&c(r)}),[r,c]),"loaded"===r?(0,CI.jsx)(go.img,aI(aI({},a),{},{ref:e,src:l})):null}));Wi.displayName=pi;var Vi="AvatarFallback",Si=I.forwardRef((function(g,e){var C=g.__scopeAvatar,l=g.delayMs,n=cI(g,si),t=hi(Vi,C),a=A(I.useState(void 0===l),2),o=a[0],r=a[1];return I.useEffect((function(){if(void 0!==l){var g=window.setTimeout((function(){return r(!0)}),l);return function(){return window.clearTimeout(g)}}}),[l]),o&&"loaded"!==t.imageLoadingStatus?(0,CI.jsx)(go.span,aI(aI({},n),{},{ref:e})):null}));Si.displayName=Vi;var vi=Bi,fi=Wi,Ri=Si,Xi=["className"],Ji=["className"],ki=["className"],Yi=I.forwardRef((function(g,I){var e=g.className,C=cI(g,Xi);return(0,CI.jsx)(vi,aI({ref:I,className:xa("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",e)},C))}));Yi.displayName=vi.displayName,I.forwardRef((function(g,I){var e=g.className,C=cI(g,Ji);return(0,CI.jsx)(fi,aI({ref:I,className:xa("aspect-square h-full w-full",e)},C))})).displayName=fi.displayName;var Hi=I.forwardRef((function(g,I){var e=g.className,C=cI(g,ki);return(0,CI.jsx)(Ri,aI({ref:I,className:xa("flex h-full w-full items-center justify-center rounded-full bg-muted",e)},C))}));Hi.displayName=Ri.displayName;var wi=["className","variant"],Ni=Pt("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function Fi(g){var I=g.className,e=g.variant,C=cI(g,wi);return(0,CI.jsx)("div",aI({className:xa(Ni({variant:e}),I)},C))}function Ki(g,I){var e=A(I,2),C=e[0],l=e[1];return Math.min(l,Math.max(C,g))}var xi=["scope","children"];function zi(g){var e=g+"CollectionProvider",C=A(Xo(e),2),l=C[0],n=C[1],t=A(l(e,{collectionRef:{current:null},itemMap:new Map}),2),a=t[0],o=t[1],r=function(g){var e=g.scope,C=g.children,l=I.useRef(null),n=I.useRef(new Map).current;return(0,CI.jsx)(a,{scope:e,itemMap:n,collectionRef:l,children:C})};r.displayName=e;var c=g+"CollectionSlot",i=I.forwardRef((function(g,I){var e=g.scope,C=g.children,l=Da(I,o(c,e).collectionRef);return(0,CI.jsx)(Pa,{ref:l,children:C})}));i.displayName=c;var d=g+"CollectionItemSlot",u="data-radix-collection-item",s=I.forwardRef((function(g,e){var C=g.scope,l=g.children,n=cI(g,xi),t=I.useRef(null),a=Da(e,t),A=o(d,C);return I.useEffect((function(){return A.itemMap.set(t,aI({ref:t},n)),function(){A.itemMap.delete(t)}})),(0,CI.jsx)(Pa,aI(aI({},nI({},u,"")),{},{ref:a,children:l}))}));return s.displayName=d,[{Provider:r,Slot:i,ItemSlot:s},function(e){var C=o(g+"CollectionConsumer",e);return I.useCallback((function(){var g=C.collectionRef.current;if(!g)return[];var I=Array.from(g.querySelectorAll("[".concat(u,"]")));return Array.from(C.itemMap.values()).sort((function(g,e){return I.indexOf(g.ref.current)-I.indexOf(e.ref.current)}))}),[C.collectionRef,C.itemMap])},n]}var Ei=I.createContext(void 0);var Ui=["top","right","bottom","left"],Qi=Math.min,Mi=Math.max,Li=Math.round,Di=Math.floor,Ti=function(g){return{x:g,y:g}},ji={left:"right",right:"left",bottom:"top",top:"bottom"},Pi={start:"end",end:"start"};function Oi(g,I,e){return Mi(g,Qi(I,e))}function qi(g,I){return"function"===typeof g?g(I):g}function _i(g){return g.split("-")[0]}function $i(g){return g.split("-")[1]}function gd(g){return"x"===g?"y":"x"}function Id(g){return"y"===g?"height":"width"}function ed(g){return["top","bottom"].includes(_i(g))?"y":"x"}function Cd(g){return gd(ed(g))}function ld(g,I,e){void 0===e&&(e=!1);var C=$i(g),l=Cd(g),n=Id(l),t="x"===l?C===(e?"end":"start")?"right":"left":"start"===C?"bottom":"top";return I.reference[n]>I.floating[n]&&(t=od(t)),[t,od(t)]}function nd(g){var I=od(g);return[td(g),I,td(I)]}function td(g){return g.replace(/start|end/g,(function(g){return Pi[g]}))}function ad(g,I,e,C){var l=$i(g),n=function(g,I,e){var C=["left","right"],l=["right","left"];switch(g){case"top":case"bottom":return e?I?l:C:I?C:l;case"left":case"right":return I?["top","bottom"]:["bottom","top"];default:return[]}}(_i(g),"start"===e,C);return l&&(n=n.map((function(g){return g+"-"+l})),I&&(n=n.concat(n.map(td)))),n}function od(g){return g.replace(/left|right|bottom|top/g,(function(g){return ji[g]}))}function Ad(g){return"number"!==typeof g?function(g){return aI({top:0,right:0,bottom:0,left:0},g)}(g):{top:g,right:g,bottom:g,left:g}}function rd(g){var I=g.x,e=g.y,C=g.width,l=g.height;return{width:C,height:l,top:e,left:I,right:I+C,bottom:e+l,x:I,y:e}}var cd=["mainAxis","crossAxis","fallbackPlacements","fallbackStrategy","fallbackAxisSideDirection","flipAlignment"],id=["strategy"],dd=["mainAxis","crossAxis","limiter"],ud=["apply"];function sd(g,I,e){var C,l=g.reference,n=g.floating,t=ed(I),a=Cd(I),o=Id(a),A=_i(I),r="y"===t,c=l.x+l.width/2-n.width/2,i=l.y+l.height/2-n.height/2,d=l[o]/2-n[o]/2;switch(A){case"top":C={x:c,y:l.y-n.height};break;case"bottom":C={x:c,y:l.y+l.height};break;case"right":C={x:l.x+l.width,y:i};break;case"left":C={x:l.x-n.width,y:i};break;default:C={x:l.x,y:l.y}}switch($i(I)){case"start":C[a]-=d*(e&&r?-1:1);break;case"end":C[a]+=d*(e&&r?-1:1)}return C}var md=function(){var g=rI(oI().mark((function g(I,e,C){var l,n,t,a,o,A,r,c,i,d,u,s,m,b,Z,G,y,h,B,p,W,V,S,v,f,R;return oI().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:return l=C.placement,n=void 0===l?"bottom":l,t=C.strategy,a=void 0===t?"absolute":t,o=C.middleware,A=void 0===o?[]:o,r=C.platform,c=A.filter(Boolean),g.next=4,null==r.isRTL?void 0:r.isRTL(e);case 4:return i=g.sent,g.next=7,r.getElementRects({reference:I,floating:e,strategy:a});case 7:d=g.sent,u=sd(d,n,i),s=u.x,m=u.y,b=n,Z={},G=0,y=0;case 13:if(!(y<c.length)){g.next=45;break}return h=c[y],B=h.name,p=h.fn,g.next=17,p({x:s,y:m,initialPlacement:n,placement:b,strategy:a,middlewareData:Z,rects:d,platform:r,elements:{reference:I,floating:e}});case 17:if(W=g.sent,V=W.x,S=W.y,v=W.data,f=W.reset,s=null!=V?V:s,m=null!=S?S:m,Z=aI(aI({},Z),{},nI({},B,aI(aI({},Z[B]),v))),!(f&&G<=50)){g.next=42;break}if(G++,"object"!==typeof f){g.next=41;break}if(f.placement&&(b=f.placement),!f.rects){g.next=38;break}if(!0!==f.rects){g.next=36;break}return g.next=33,r.getElementRects({reference:I,floating:e,strategy:a});case 33:g.t0=g.sent,g.next=37;break;case 36:g.t0=f.rects;case 37:d=g.t0;case 38:R=sd(d,b,i),s=R.x,m=R.y;case 41:y=-1;case 42:y++,g.next=13;break;case 45:return g.abrupt("return",{x:s,y:m,placement:b,strategy:a,middlewareData:Z});case 46:case"end":return g.stop()}}),g)})));return function(I,e,C){return g.apply(this,arguments)}}();function bd(g,I){return Zd.apply(this,arguments)}function Zd(){return Zd=rI(oI().mark((function g(I,e){var C,l,n,t,a,o,A,r,c,i,d,u,s,m,b,Z,G,y,h,B,p,W,V,S,v;return oI().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:return void 0===e&&(e={}),l=I.x,n=I.y,t=I.platform,a=I.rects,o=I.elements,A=I.strategy,r=qi(e,I),c=r.boundary,i=void 0===c?"clippingAncestors":c,d=r.rootBoundary,u=void 0===d?"viewport":d,s=r.elementContext,m=void 0===s?"floating":s,b=r.altBoundary,Z=void 0!==b&&b,G=r.padding,y=Ad(void 0===G?0:G),h="floating"===m?"reference":"floating",B=o[Z?h:m],g.t0=rd,g.t1=t,g.next=10,null==t.isElement?void 0:t.isElement(B);case 10:if(g.t2=C=g.sent,null==g.t2){g.next=15;break}g.t3=C,g.next=16;break;case 15:g.t3=!0;case 16:if(!g.t3){g.next=20;break}g.t4=B,g.next=26;break;case 20:if(g.t5=B.contextElement,g.t5){g.next=25;break}return g.next=24,null==t.getDocumentElement?void 0:t.getDocumentElement(o.floating);case 24:g.t5=g.sent;case 25:g.t4=g.t5;case 26:return g.t6=g.t4,g.t7=i,g.t8=u,g.t9=A,g.t10={element:g.t6,boundary:g.t7,rootBoundary:g.t8,strategy:g.t9},g.next=33,g.t1.getClippingRect.call(g.t1,g.t10);case 33:return g.t11=g.sent,p=(0,g.t0)(g.t11),W="floating"===m?{x:l,y:n,width:a.floating.width,height:a.floating.height}:a.reference,g.next=38,null==t.getOffsetParent?void 0:t.getOffsetParent(o.floating);case 38:return V=g.sent,g.next=41,null==t.isElement?void 0:t.isElement(V);case 41:if(!g.sent){g.next=50;break}return g.next=44,null==t.getScale?void 0:t.getScale(V);case 44:if(g.t13=g.sent,g.t13){g.next=47;break}g.t13={x:1,y:1};case 47:g.t12=g.t13,g.next=51;break;case 50:g.t12={x:1,y:1};case 51:if(S=g.t12,g.t14=rd,!t.convertOffsetParentRelativeRectToViewportRelativeRect){g.next=59;break}return g.next=56,t.convertOffsetParentRelativeRectToViewportRelativeRect({elements:o,rect:W,offsetParent:V,strategy:A});case 56:g.t15=g.sent,g.next=60;break;case 59:g.t15=W;case 60:return g.t16=g.t15,v=(0,g.t14)(g.t16),g.abrupt("return",{top:(p.top-v.top+y.top)/S.y,bottom:(v.bottom-p.bottom+y.bottom)/S.y,left:(p.left-v.left+y.left)/S.x,right:(v.right-p.right+y.right)/S.x});case 63:case"end":return g.stop()}}),g)}))),Zd.apply(this,arguments)}function Gd(g,I){return{top:g.top-I.height,right:g.right-I.width,bottom:g.bottom-I.height,left:g.left-I.width}}function yd(g){return Ui.some((function(I){return g[I]>=0}))}function hd(g,I){return Bd.apply(this,arguments)}function Bd(){return Bd=rI(oI().mark((function g(I,e){var C,l,n,t,a,o,A,r,c,i,d,u,s,m;return oI().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:return C=I.placement,l=I.platform,n=I.elements,g.next=3,null==l.isRTL?void 0:l.isRTL(n.floating);case 3:return t=g.sent,a=_i(C),o=$i(C),A="y"===ed(C),r=["left","top"].includes(a)?-1:1,c=t&&A?-1:1,i=qi(e,I),d="number"===typeof i?{mainAxis:i,crossAxis:0,alignmentAxis:null}:aI({mainAxis:0,crossAxis:0,alignmentAxis:null},i),u=d.mainAxis,s=d.crossAxis,m=d.alignmentAxis,o&&"number"===typeof m&&(s="end"===o?-1*m:m),g.abrupt("return",A?{x:s*c,y:u*r}:{x:u*r,y:s*c});case 13:case"end":return g.stop()}}),g)}))),Bd.apply(this,arguments)}function pd(g){return Sd(g)?(g.nodeName||"").toLowerCase():"#document"}function Wd(g){var I;return(null==g||null==(I=g.ownerDocument)?void 0:I.defaultView)||window}function Vd(g){var I;return null==(I=(Sd(g)?g.ownerDocument:g.document)||window.document)?void 0:I.documentElement}function Sd(g){return g instanceof Node||g instanceof Wd(g).Node}function vd(g){return g instanceof Element||g instanceof Wd(g).Element}function fd(g){return g instanceof HTMLElement||g instanceof Wd(g).HTMLElement}function Rd(g){return"undefined"!==typeof ShadowRoot&&(g instanceof ShadowRoot||g instanceof Wd(g).ShadowRoot)}function Xd(g){var I=Nd(g),e=I.overflow,C=I.overflowX,l=I.overflowY,n=I.display;return/auto|scroll|overlay|hidden|clip/.test(e+l+C)&&!["inline","contents"].includes(n)}function Jd(g){return["table","td","th"].includes(pd(g))}function kd(g){return[":popover-open",":modal"].some((function(I){try{return g.matches(I)}catch($Z){return!1}}))}function Yd(g){var I=Hd(),e=vd(g)?Nd(g):g;return"none"!==e.transform||"none"!==e.perspective||!!e.containerType&&"normal"!==e.containerType||!I&&!!e.backdropFilter&&"none"!==e.backdropFilter||!I&&!!e.filter&&"none"!==e.filter||["transform","perspective","filter"].some((function(g){return(e.willChange||"").includes(g)}))||["paint","layout","strict","content"].some((function(g){return(e.contain||"").includes(g)}))}function Hd(){return!("undefined"===typeof CSS||!CSS.supports)&&CSS.supports("-webkit-backdrop-filter","none")}function wd(g){return["html","body","#document"].includes(pd(g))}function Nd(g){return Wd(g).getComputedStyle(g)}function Fd(g){return vd(g)?{scrollLeft:g.scrollLeft,scrollTop:g.scrollTop}:{scrollLeft:g.scrollX,scrollTop:g.scrollY}}function Kd(g){if("html"===pd(g))return g;var I=g.assignedSlot||g.parentNode||Rd(g)&&g.host||Vd(g);return Rd(I)?I.host:I}function xd(g){var I=Kd(g);return wd(I)?g.ownerDocument?g.ownerDocument.body:g.body:fd(I)&&Xd(I)?I:xd(I)}function zd(g,I,e){var C;void 0===I&&(I=[]),void 0===e&&(e=!0);var l=xd(g),n=l===(null==(C=g.ownerDocument)?void 0:C.body),t=Wd(l);if(n){var a=Ed(t);return I.concat(t,t.visualViewport||[],Xd(l)?l:[],a&&e?zd(a):[])}return I.concat(l,zd(l,[],e))}function Ed(g){return g.parent&&Object.getPrototypeOf(g.parent)?g.frameElement:null}function Ud(g){var I=Nd(g),e=parseFloat(I.width)||0,C=parseFloat(I.height)||0,l=fd(g),n=l?g.offsetWidth:e,t=l?g.offsetHeight:C,a=Li(e)!==n||Li(C)!==t;return a&&(e=n,C=t),{width:e,height:C,$:a}}function Qd(g){return vd(g)?g:g.contextElement}function Md(g){var I=Qd(g);if(!fd(I))return Ti(1);var e=I.getBoundingClientRect(),C=Ud(I),l=C.width,n=C.height,t=C.$,a=(t?Li(e.width):e.width)/l,o=(t?Li(e.height):e.height)/n;return a&&Number.isFinite(a)||(a=1),o&&Number.isFinite(o)||(o=1),{x:a,y:o}}var Ld=Ti(0);function Dd(g){var I=Wd(g);return Hd()&&I.visualViewport?{x:I.visualViewport.offsetLeft,y:I.visualViewport.offsetTop}:Ld}function Td(g,I,e,C){void 0===I&&(I=!1),void 0===e&&(e=!1);var l=g.getBoundingClientRect(),n=Qd(g),t=Ti(1);I&&(C?vd(C)&&(t=Md(C)):t=Md(g));var a=function(g,I,e){return void 0===I&&(I=!1),!(!e||I&&e!==Wd(g))&&I}(n,e,C)?Dd(n):Ti(0),o=(l.left+a.x)/t.x,A=(l.top+a.y)/t.y,r=l.width/t.x,c=l.height/t.y;if(n)for(var i=Wd(n),d=C&&vd(C)?Wd(C):C,u=i,s=Ed(u);s&&C&&d!==u;){var m=Md(s),b=s.getBoundingClientRect(),Z=Nd(s),G=b.left+(s.clientLeft+parseFloat(Z.paddingLeft))*m.x,y=b.top+(s.clientTop+parseFloat(Z.paddingTop))*m.y;o*=m.x,A*=m.y,r*=m.x,c*=m.y,o+=G,A+=y,s=Ed(u=Wd(s))}return rd({width:r,height:c,x:o,y:A})}function jd(g){return Td(Vd(g)).left+Fd(g).scrollLeft}function Pd(g,I,e){var C;if("viewport"===I)C=function(g,I){var e=Wd(g),C=Vd(g),l=e.visualViewport,n=C.clientWidth,t=C.clientHeight,a=0,o=0;if(l){n=l.width,t=l.height;var A=Hd();(!A||A&&"fixed"===I)&&(a=l.offsetLeft,o=l.offsetTop)}return{width:n,height:t,x:a,y:o}}(g,e);else if("document"===I)C=function(g){var I=Vd(g),e=Fd(g),C=g.ownerDocument.body,l=Mi(I.scrollWidth,I.clientWidth,C.scrollWidth,C.clientWidth),n=Mi(I.scrollHeight,I.clientHeight,C.scrollHeight,C.clientHeight),t=-e.scrollLeft+jd(g),a=-e.scrollTop;return"rtl"===Nd(C).direction&&(t+=Mi(I.clientWidth,C.clientWidth)-l),{width:l,height:n,x:t,y:a}}(Vd(g));else if(vd(I))C=function(g,I){var e=Td(g,!0,"fixed"===I),C=e.top+g.clientTop,l=e.left+g.clientLeft,n=fd(g)?Md(g):Ti(1);return{width:g.clientWidth*n.x,height:g.clientHeight*n.y,x:l*n.x,y:C*n.y}}(I,e);else{var l=Dd(g);C=aI(aI({},I),{},{x:I.x-l.x,y:I.y-l.y})}return rd(C)}function Od(g,I){var e=Kd(g);return!(e===I||!vd(e)||wd(e))&&("fixed"===Nd(e).position||Od(e,I))}function qd(g,I,e){var C=fd(I),l=Vd(I),n="fixed"===e,t=Td(g,!0,n,I),a={scrollLeft:0,scrollTop:0},o=Ti(0);if(C||!C&&!n)if(("body"!==pd(I)||Xd(l))&&(a=Fd(I)),C){var A=Td(I,!0,n,I);o.x=A.x+I.clientLeft,o.y=A.y+I.clientTop}else l&&(o.x=jd(l));return{x:t.left+a.scrollLeft-o.x,y:t.top+a.scrollTop-o.y,width:t.width,height:t.height}}function _d(g){return"static"===Nd(g).position}function $d(g,I){return fd(g)&&"fixed"!==Nd(g).position?I?I(g):g.offsetParent:null}function gu(g,I){var e=Wd(g);if(kd(g))return e;if(!fd(g)){for(var C=Kd(g);C&&!wd(C);){if(vd(C)&&!_d(C))return C;C=Kd(C)}return e}for(var l=$d(g,I);l&&Jd(l)&&_d(l);)l=$d(l,I);return l&&wd(l)&&_d(l)&&!Yd(l)?e:l||function(g){for(var I=Kd(g);fd(I)&&!wd(I);){if(Yd(I))return I;if(kd(I))return null;I=Kd(I)}return null}(g)||e}var Iu=function(){var g=rI(oI().mark((function g(I){var e,C,l;return oI().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:return e=this.getOffsetParent||gu,C=this.getDimensions,g.next=4,C(I.floating);case 4:return l=g.sent,g.t0=qd,g.t1=I.reference,g.next=9,e(I.floating);case 9:return g.t2=g.sent,g.t3=I.strategy,g.t4=(0,g.t0)(g.t1,g.t2,g.t3),g.t5={x:0,y:0,width:l.width,height:l.height},g.abrupt("return",{reference:g.t4,floating:g.t5});case 14:case"end":return g.stop()}}),g,this)})));return function(I){return g.apply(this,arguments)}}();var eu={convertOffsetParentRelativeRectToViewportRelativeRect:function(g){var I=g.elements,e=g.rect,C=g.offsetParent,l="fixed"===g.strategy,n=Vd(C),t=!!I&&kd(I.floating);if(C===n||t&&l)return e;var a={scrollLeft:0,scrollTop:0},o=Ti(1),A=Ti(0),r=fd(C);if((r||!r&&!l)&&(("body"!==pd(C)||Xd(n))&&(a=Fd(C)),fd(C))){var c=Td(C);o=Md(C),A.x=c.x+C.clientLeft,A.y=c.y+C.clientTop}return{width:e.width*o.x,height:e.height*o.y,x:e.x*o.x-a.scrollLeft*o.x+A.x,y:e.y*o.y-a.scrollTop*o.y+A.y}},getDocumentElement:Vd,getClippingRect:function(g){var I=g.element,e=g.boundary,C=g.rootBoundary,l=g.strategy,n="clippingAncestors"===e?kd(I)?[]:function(g,I){var e=I.get(g);if(e)return e;for(var C=zd(g,[],!1).filter((function(g){return vd(g)&&"body"!==pd(g)})),l=null,n="fixed"===Nd(g).position,t=n?Kd(g):g;vd(t)&&!wd(t);){var a=Nd(t),o=Yd(t);o||"fixed"!==a.position||(l=null),(n?!o&&!l:!o&&"static"===a.position&&l&&["absolute","fixed"].includes(l.position)||Xd(t)&&!o&&Od(g,t))?C=C.filter((function(g){return g!==t})):l=a,t=Kd(t)}return I.set(g,C),C}(I,this._c):[].concat(e),t=[].concat(u(n),[C]),a=t[0],o=t.reduce((function(g,e){var C=Pd(I,e,l);return g.top=Mi(C.top,g.top),g.right=Qi(C.right,g.right),g.bottom=Qi(C.bottom,g.bottom),g.left=Mi(C.left,g.left),g}),Pd(I,a,l));return{width:o.right-o.left,height:o.bottom-o.top,x:o.left,y:o.top}},getOffsetParent:gu,getElementRects:Iu,getClientRects:function(g){return Array.from(g.getClientRects())},getDimensions:function(g){var I=Ud(g);return{width:I.width,height:I.height}},getScale:Md,isElement:vd,isRTL:function(g){return"rtl"===Nd(g).direction}};function Cu(g,I,e,C){void 0===C&&(C={});var l=C,n=l.ancestorScroll,t=void 0===n||n,a=l.ancestorResize,o=void 0===a||a,r=l.elementResize,c=void 0===r?"function"===typeof ResizeObserver:r,i=l.layoutShift,d=void 0===i?"function"===typeof IntersectionObserver:i,s=l.animationFrame,m=void 0!==s&&s,b=Qd(g),Z=t||o?[].concat(u(b?zd(b):[]),u(zd(I))):[];Z.forEach((function(g){t&&g.addEventListener("scroll",e,{passive:!0}),o&&g.addEventListener("resize",e)}));var G,y=b&&d?function(g,I){var e,C=null,l=Vd(g);function n(){var g;clearTimeout(e),null==(g=C)||g.disconnect(),C=null}return function t(a,o){void 0===a&&(a=!1),void 0===o&&(o=1),n();var A=g.getBoundingClientRect(),r=A.left,c=A.top,i=A.width,d=A.height;if(a||I(),i&&d){var u={rootMargin:-Di(c)+"px "+-Di(l.clientWidth-(r+i))+"px "+-Di(l.clientHeight-(c+d))+"px "+-Di(r)+"px",threshold:Mi(0,Qi(1,o))||1},s=!0;try{C=new IntersectionObserver(m,aI(aI({},u),{},{root:l.ownerDocument}))}catch($Z){C=new IntersectionObserver(m,u)}C.observe(g)}function m(g){var I=g[0].intersectionRatio;if(I!==o){if(!s)return t();I?t(!1,I):e=setTimeout((function(){t(!1,1e-7)}),1e3)}s=!1}}(!0),n}(b,e):null,h=-1,B=null;c&&(B=new ResizeObserver((function(g){var C=A(g,1)[0];C&&C.target===b&&B&&(B.unobserve(I),cancelAnimationFrame(h),h=requestAnimationFrame((function(){var g;null==(g=B)||g.observe(I)}))),e()})),b&&!m&&B.observe(b),B.observe(I));var p=m?Td(g):null;return m&&function I(){var C=Td(g);!p||C.x===p.x&&C.y===p.y&&C.width===p.width&&C.height===p.height||e();p=C,G=requestAnimationFrame(I)}(),e(),function(){var g;Z.forEach((function(g){t&&g.removeEventListener("scroll",e),o&&g.removeEventListener("resize",e)})),null==y||y(),null==(g=B)||g.disconnect(),B=null,m&&cancelAnimationFrame(G)}}var lu=function(g){return void 0===g&&(g=0),{name:"offset",options:g,fn:function(I){return rI(oI().mark((function e(){var C,l,n,t,a,o,A;return oI().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=I.x,t=I.y,a=I.placement,o=I.middlewareData,e.next=3,hd(I,g);case 3:if(A=e.sent,a!==(null==(C=o.offset)?void 0:C.placement)||null==(l=o.arrow)||!l.alignmentOffset){e.next=6;break}return e.abrupt("return",{});case 6:return e.abrupt("return",{x:n+A.x,y:t+A.y,data:aI(aI({},A),{},{placement:a})});case 7:case"end":return e.stop()}}),e)})))()}}},nu=function(g){return void 0===g&&(g={}),{name:"shift",options:g,fn:function(I){return rI(oI().mark((function e(){var C,l,n,t,a,o,A,r,c,i,d,u,s,m,b,Z,G,y,h,B,p,W,V,S,v;return oI().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return l=I.x,n=I.y,t=I.placement,a=qi(g,I),o=a.mainAxis,A=void 0===o||o,r=a.crossAxis,c=void 0!==r&&r,i=a.limiter,d=void 0===i?{fn:function(g){return{x:g.x,y:g.y}}}:i,u=cI(a,dd),s={x:l,y:n},e.next=5,bd(I,u);case 5:return m=e.sent,b=ed(_i(t)),Z=gd(b),G=s[Z],y=s[b],A&&(h="y"===Z?"bottom":"right",B=G+m["y"===Z?"top":"left"],p=G-m[h],G=Oi(B,G,p)),c&&(W="y"===b?"bottom":"right",V=y+m["y"===b?"top":"left"],S=y-m[W],y=Oi(V,y,S)),v=d.fn(aI(aI({},I),{},(nI(C={},Z,G),nI(C,b,y),C))),e.abrupt("return",aI(aI({},v),{},{data:{x:v.x-l,y:v.y-n}}));case 14:case"end":return e.stop()}}),e)})))()}}},tu=function(g){return void 0===g&&(g={}),{name:"flip",options:g,fn:function(I){return rI(oI().mark((function e(){var C,l,n,t,a,o,A,r,c,i,d,s,m,b,Z,G,y,h,B,p,W,V,S,v,f,R,X,J,k,Y,H,w,N,F,K,x,z,E,U;return oI().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=I.placement,t=I.middlewareData,a=I.rects,o=I.initialPlacement,A=I.platform,r=I.elements,c=qi(g,I),i=c.mainAxis,d=void 0===i||i,s=c.crossAxis,m=void 0===s||s,b=c.fallbackPlacements,Z=c.fallbackStrategy,G=void 0===Z?"bestFit":Z,y=c.fallbackAxisSideDirection,h=void 0===y?"none":y,B=c.flipAlignment,p=void 0===B||B,W=cI(c,cd),null==(C=t.arrow)||!C.alignmentOffset){e.next=4;break}return e.abrupt("return",{});case 4:return V=_i(n),S=ed(o),v=_i(o)===o,e.next=9,null==A.isRTL?void 0:A.isRTL(r.floating);case 9:return f=e.sent,R=b||(v||!p?[od(o)]:nd(o)),X="none"!==h,!b&&X&&R.push.apply(R,u(ad(o,p,h,f))),J=[o].concat(u(R)),e.next=16,bd(I,W);case 16:if(k=e.sent,Y=[],H=(null==(l=t.flip)?void 0:l.overflows)||[],d&&Y.push(k[V]),m&&(w=ld(n,a,f),Y.push(k[w[0]],k[w[1]])),H=[].concat(u(H),[{placement:n,overflows:Y}]),Y.every((function(g){return g<=0}))){e.next=39;break}if(K=((null==(N=t.flip)?void 0:N.index)||0)+1,!(x=J[K])){e.next=27;break}return e.abrupt("return",{data:{index:K,overflows:H},reset:{placement:x}});case 27:if(z=null==(F=H.filter((function(g){return g.overflows[0]<=0})).sort((function(g,I){return g.overflows[1]-I.overflows[1]}))[0])?void 0:F.placement){e.next=37;break}e.t0=G,e.next="bestFit"===e.t0?32:"initialPlacement"===e.t0?35:37;break;case 32:return U=null==(E=H.filter((function(g){if(X){var I=ed(g.placement);return I===S||"y"===I}return!0})).map((function(g){return[g.placement,g.overflows.filter((function(g){return g>0})).reduce((function(g,I){return g+I}),0)]})).sort((function(g,I){return g[1]-I[1]}))[0])?void 0:E[0],U&&(z=U),e.abrupt("break",37);case 35:return z=o,e.abrupt("break",37);case 37:if(n===z){e.next=39;break}return e.abrupt("return",{reset:{placement:z}});case 39:return e.abrupt("return",{});case 40:case"end":return e.stop()}}),e)})))()}}},au=function(g){return void 0===g&&(g={}),{name:"size",options:g,fn:function(I){return rI(oI().mark((function e(){var C,l,n,t,a,o,A,r,c,i,d,u,s,m,b,Z,G,y,h,B,p,W,V,S,v,f,R,X,J;return oI().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return C=I.placement,l=I.rects,n=I.platform,t=I.elements,a=qi(g,I),o=a.apply,A=void 0===o?function(){}:o,r=cI(a,ud),e.next=4,bd(I,r);case 4:if(c=e.sent,i=_i(C),d=$i(C),u="y"===ed(C),s=l.floating,m=s.width,b=s.height,"top"!==i&&"bottom"!==i){e.next=28;break}return Z=i,e.t0=d,e.next=14,null==n.isRTL?void 0:n.isRTL(t.floating);case 14:if(!e.sent){e.next=18;break}e.t1="start",e.next=19;break;case 18:e.t1="end";case 19:if(e.t2=e.t1,e.t0!==e.t2){e.next=24;break}e.t3="left",e.next=25;break;case 24:e.t3="right";case 25:G=e.t3,e.next=30;break;case 28:G=i,Z="end"===d?"top":"bottom";case 30:return y=b-c.top-c.bottom,h=m-c.left-c.right,B=Qi(b-c[Z],y),p=Qi(m-c[G],h),W=!I.middlewareData.shift,V=B,S=p,u?S=d||W?Qi(p,h):h:V=d||W?Qi(B,y):y,W&&!d&&(v=Mi(c.left,0),f=Mi(c.right,0),R=Mi(c.top,0),X=Mi(c.bottom,0),u?S=m-2*(0!==v||0!==f?v+f:Mi(c.left,c.right)):V=b-2*(0!==R||0!==X?R+X:Mi(c.top,c.bottom))),e.next=41,A(aI(aI({},I),{},{availableWidth:S,availableHeight:V}));case 41:return e.next=43,n.getDimensions(t.floating);case 43:if(J=e.sent,m===J.width&&b===J.height){e.next=46;break}return e.abrupt("return",{reset:{rects:!0}});case 46:return e.abrupt("return",{});case 47:case"end":return e.stop()}}),e)})))()}}},ou=function(g){return void 0===g&&(g={}),{name:"hide",options:g,fn:function(I){return rI(oI().mark((function e(){var C,l,n,t,a,o,A,r,c;return oI().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:C=I.rects,l=qi(g,I),n=l.strategy,t=void 0===n?"referenceHidden":n,a=cI(l,id),e.t0=t,e.next="referenceHidden"===e.t0?5:"escaped"===e.t0?10:15;break;case 5:return e.next=7,bd(I,aI(aI({},a),{},{elementContext:"reference"}));case 7:return o=e.sent,A=Gd(o,C.reference),e.abrupt("return",{data:{referenceHiddenOffsets:A,referenceHidden:yd(A)}});case 10:return e.next=12,bd(I,aI(aI({},a),{},{altBoundary:!0}));case 12:return r=e.sent,c=Gd(r,C.floating),e.abrupt("return",{data:{escapedOffsets:c,escaped:yd(c)}});case 15:return e.abrupt("return",{});case 16:case"end":return e.stop()}}),e)})))()}}},Au=function(g){return{name:"arrow",options:g,fn:function(I){return rI(oI().mark((function e(){var C,l,n,t,a,o,A,r,c,i,d,u,s,m,b,Z,G,y,h,B,p,W,V,S,v,f,R,X,J,k,Y,H,w,N,F,K;return oI().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=I.x,t=I.y,a=I.placement,o=I.rects,A=I.platform,r=I.elements,c=I.middlewareData,i=qi(g,I)||{},d=i.element,u=i.padding,s=void 0===u?0:u,null!=d){e.next=4;break}return e.abrupt("return",{});case 4:return m=Ad(s),b={x:n,y:t},Z=Cd(a),G=Id(Z),e.next=10,A.getDimensions(d);case 10:return y=e.sent,B=(h="y"===Z)?"top":"left",p=h?"bottom":"right",W=h?"clientHeight":"clientWidth",V=o.reference[G]+o.reference[Z]-b[Z]-o.floating[G],S=b[Z]-o.reference[Z],e.next=19,null==A.getOffsetParent?void 0:A.getOffsetParent(d);case 19:if(v=e.sent,f=v?v[W]:0,e.t0=!f,e.t0){e.next=26;break}return e.next=25,null==A.isElement?void 0:A.isElement(v);case 25:e.t0=!e.sent;case 26:if(!e.t0){e.next=28;break}f=r.floating[W]||o.floating[G];case 28:return R=V/2-S/2,X=f/2-y[G]/2-1,J=Qi(m[B],X),k=Qi(m[p],X),Y=J,H=f-y[G]-k,w=f/2-y[G]/2+R,N=Oi(Y,w,H),F=!c.arrow&&null!=$i(a)&&w!==N&&o.reference[G]/2-(w<Y?J:k)-y[G]/2<0,K=F?w<Y?w-Y:w-H:0,e.abrupt("return",(nI(l={},Z,b[Z]+K),nI(l,"data",aI((nI(C={},Z,N),nI(C,"centerOffset",w-N-K),C),F&&{alignmentOffset:K})),nI(l,"reset",F),l));case 39:case"end":return e.stop()}}),e)})))()}}},ru=function(g){return void 0===g&&(g={}),{options:g,fn:function(I){var e,C=I.x,l=I.y,n=I.placement,t=I.rects,a=I.middlewareData,o=qi(g,I),A=o.offset,r=void 0===A?0:A,c=o.mainAxis,i=void 0===c||c,d=o.crossAxis,u=void 0===d||d,s={x:C,y:l},m=ed(n),b=gd(m),Z=s[b],G=s[m],y=qi(r,I),h="number"===typeof y?{mainAxis:y,crossAxis:0}:aI({mainAxis:0,crossAxis:0},y);if(i){var B="y"===b?"height":"width",p=t.reference[b]-t.floating[B]+h.mainAxis,W=t.reference[b]+t.reference[B]-h.mainAxis;Z<p?Z=p:Z>W&&(Z=W)}if(u){var V,S,v="y"===b?"width":"height",f=["top","left"].includes(_i(n)),R=t.reference[m]-t.floating[v]+(f&&(null==(V=a.offset)?void 0:V[m])||0)+(f?0:h.crossAxis),X=t.reference[m]+t.reference[v]+(f?0:(null==(S=a.offset)?void 0:S[m])||0)-(f?h.crossAxis:0);G<R?G=R:G>X&&(G=X)}return nI(e={},b,Z),nI(e,m,G),e}}},cu="undefined"!==typeof document?I.useLayoutEffect:I.useEffect;function iu(g,I){if(g===I)return!0;if(typeof g!==typeof I)return!1;if("function"===typeof g&&g.toString()===I.toString())return!0;var e,C,l;if(g&&I&&"object"===typeof g){if(Array.isArray(g)){if((e=g.length)!==I.length)return!1;for(C=e;0!==C--;)if(!iu(g[C],I[C]))return!1;return!0}if((e=(l=Object.keys(g)).length)!==Object.keys(I).length)return!1;for(C=e;0!==C--;)if(!{}.hasOwnProperty.call(I,l[C]))return!1;for(C=e;0!==C--;){var n=l[C];if(("_owner"!==n||!g.$$typeof)&&!iu(g[n],I[n]))return!1}return!0}return g!==g&&I!==I}function du(g){return"undefined"===typeof window?1:(g.ownerDocument.defaultView||window).devicePixelRatio||1}function uu(g,I){var e=du(g);return Math.round(I*e)/e}function su(g){var e=I.useRef(g);return cu((function(){e.current=g})),e}function mu(g){void 0===g&&(g={});var e=g,C=e.placement,l=void 0===C?"bottom":C,n=e.strategy,t=void 0===n?"absolute":n,a=e.middleware,o=void 0===a?[]:a,r=e.platform,i=e.elements,d=void 0===i?{}:i,u=d.reference,s=d.floating,m=e.transform,b=void 0===m||m,Z=e.whileElementsMounted,G=e.open,y=A(I.useState({x:0,y:0,strategy:t,placement:l,middlewareData:{},isPositioned:!1}),2),h=y[0],B=y[1],p=A(I.useState(o),2),W=p[0],V=p[1];iu(W,o)||V(o);var S=A(I.useState(null),2),v=S[0],f=S[1],R=A(I.useState(null),2),X=R[0],J=R[1],k=I.useCallback((function(g){g!==N.current&&(N.current=g,f(g))}),[]),Y=I.useCallback((function(g){g!==F.current&&(F.current=g,J(g))}),[]),H=u||v,w=s||X,N=I.useRef(null),F=I.useRef(null),K=I.useRef(h),x=null!=Z,z=su(Z),E=su(r),U=I.useCallback((function(){if(N.current&&F.current){var g={placement:l,strategy:t,middleware:W};E.current&&(g.platform=E.current),function(g,I,e){var C=new Map,l=aI({platform:eu},e),n=aI(aI({},l.platform),{},{_c:C});return md(g,I,aI(aI({},l),{},{platform:n}))}(N.current,F.current,g).then((function(g){var I=aI(aI({},g),{},{isPositioned:!0});Q.current&&!iu(K.current,I)&&(K.current=I,c.flushSync((function(){B(I)})))}))}}),[W,l,t,E]);cu((function(){!1===G&&K.current.isPositioned&&(K.current.isPositioned=!1,B((function(g){return aI(aI({},g),{},{isPositioned:!1})})))}),[G]);var Q=I.useRef(!1);cu((function(){return Q.current=!0,function(){Q.current=!1}}),[]),cu((function(){if(H&&(N.current=H),w&&(F.current=w),H&&w){if(z.current)return z.current(H,w,U);U()}}),[H,w,U,z,x]);var M=I.useMemo((function(){return{reference:N,floating:F,setReference:k,setFloating:Y}}),[k,Y]),L=I.useMemo((function(){return{reference:H,floating:w}}),[H,w]),D=I.useMemo((function(){var g={position:t,left:0,top:0};if(!L.floating)return g;var I=uu(L.floating,h.x),e=uu(L.floating,h.y);return b?aI(aI({},g),{},{transform:"translate("+I+"px, "+e+"px)"},du(L.floating)>=1.5&&{willChange:"transform"}):{position:t,left:I,top:e}}),[t,b,L.floating,h.x,h.y]);return I.useMemo((function(){return aI(aI({},h),{},{update:U,refs:M,elements:L,floatingStyles:D})}),[h,U,M,L,D])}var bu=function(g,I){return aI(aI({},lu(g)),{},{options:[g,I]})},Zu=function(g,I){return aI(aI({},nu(g)),{},{options:[g,I]})},Gu=function(g,I){return aI(aI({},ru(g)),{},{options:[g,I]})},yu=function(g,I){return aI(aI({},tu(g)),{},{options:[g,I]})},hu=function(g,I){return aI(aI({},au(g)),{},{options:[g,I]})},Bu=function(g,I){return aI(aI({},ou(g)),{},{options:[g,I]})},pu=function(g,I){return aI(aI({},function(g){return{name:"arrow",options:g,fn:function(I){var e,C="function"===typeof g?g(I):g,l=C.element,n=C.padding;return l&&(e=l,{}.hasOwnProperty.call(e,"current"))?null!=l.current?Au({element:l.current,padding:n}).fn(I):{}:l?Au({element:l,padding:n}).fn(I):{}}}}(g)),{},{options:[g,I]})},Wu=["children","width","height"],Vu=I.forwardRef((function(g,I){var e=g.children,C=g.width,l=void 0===C?10:C,n=g.height,t=void 0===n?5:n,a=cI(g,Wu);return(0,CI.jsx)(go.svg,aI(aI({},a),{},{ref:I,width:l,height:t,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:g.asChild?e:(0,CI.jsx)("polygon",{points:"0,0 30,0 15,10"})}))}));Vu.displayName="Arrow";var Su=Vu;var vu=["__scopePopper","virtualRef"],fu=["__scopePopper","side","sideOffset","align","alignOffset","arrowPadding","avoidCollisions","collisionBoundary","collisionPadding","sticky","hideWhenDetached","updatePositionStrategy","onPlaced"],Ru=["__scopePopper"],Xu="Popper",Ju=A(Xo(Xu),2),ku=Ju[0],Yu=Ju[1],Hu=A(ku(Xu),2),wu=Hu[0],Nu=Hu[1],Fu=function(g){var e=g.__scopePopper,C=g.children,l=A(I.useState(null),2),n=l[0],t=l[1];return(0,CI.jsx)(wu,{scope:e,anchor:n,onAnchorChange:t,children:C})};Fu.displayName=Xu;var Ku="PopperAnchor",xu=I.forwardRef((function(g,e){var C=g.__scopePopper,l=g.virtualRef,n=cI(g,vu),t=Nu(Ku,C),a=I.useRef(null),o=Da(e,a);return I.useEffect((function(){t.onAnchorChange((null===l||void 0===l?void 0:l.current)||a.current)})),l?null:(0,CI.jsx)(go.div,aI(aI({},n),{},{ref:o}))}));xu.displayName=Ku;var zu="PopperContent",Eu=A(ku(zu),2),Uu=Eu[0],Qu=Eu[1],Mu=I.forwardRef((function(g,e){var C,l,n,t,a,o,r,c,i=g.__scopePopper,d=g.side,u=void 0===d?"bottom":d,s=g.sideOffset,m=void 0===s?0:s,b=g.align,Z=void 0===b?"center":b,G=g.alignOffset,y=void 0===G?0:G,h=g.arrowPadding,B=void 0===h?0:h,p=g.avoidCollisions,W=void 0===p||p,V=g.collisionBoundary,S=void 0===V?[]:V,v=g.collisionPadding,f=void 0===v?0:v,R=g.sticky,X=void 0===R?"partial":R,J=g.hideWhenDetached,k=void 0!==J&&J,Y=g.updatePositionStrategy,H=void 0===Y?"optimized":Y,w=g.onPlaced,N=cI(g,fu),F=Nu(zu,i),K=A(I.useState(null),2),x=K[0],z=K[1],E=Da(e,(function(g){return z(g)})),U=A(I.useState(null),2),Q=U[0],M=U[1],L=function(g){var e=A(I.useState(void 0),2),C=e[0],l=e[1];return ko((function(){if(g){l({width:g.offsetWidth,height:g.offsetHeight});var I=new ResizeObserver((function(I){if(Array.isArray(I)&&I.length){var e,C,n=I[0];if("borderBoxSize"in n){var t=n.borderBoxSize,a=Array.isArray(t)?t[0]:t;e=a.inlineSize,C=a.blockSize}else e=g.offsetWidth,C=g.offsetHeight;l({width:e,height:C})}}));return I.observe(g,{box:"border-box"}),function(){return I.unobserve(g)}}l(void 0)}),[g]),C}(Q),D=null!==(C=null===L||void 0===L?void 0:L.width)&&void 0!==C?C:0,T=null!==(l=null===L||void 0===L?void 0:L.height)&&void 0!==l?l:0,j=u+("center"!==Z?"-"+Z:""),P="number"===typeof f?f:aI({top:0,right:0,bottom:0,left:0},f),O=Array.isArray(S)?S:[S],q=O.length>0,_={padding:P,boundary:O.filter(ju),altBoundary:q},$=mu({strategy:"fixed",placement:j,whileElementsMounted:function(){for(var g=arguments.length,I=new Array(g),e=0;e<g;e++)I[e]=arguments[e];return Cu.apply(void 0,I.concat([{animationFrame:"always"===H}]))},elements:{reference:F.anchor},middleware:[bu({mainAxis:m+T,alignmentAxis:y}),W&&Zu(aI({mainAxis:!0,crossAxis:!1,limiter:"partial"===X?Gu():void 0},_)),W&&yu(aI({},_)),hu(aI(aI({},_),{},{apply:function(g){var I=g.elements,e=g.rects,C=g.availableWidth,l=g.availableHeight,n=e.reference,t=n.width,a=n.height,o=I.floating.style;o.setProperty("--radix-popper-available-width","".concat(C,"px")),o.setProperty("--radix-popper-available-height","".concat(l,"px")),o.setProperty("--radix-popper-anchor-width","".concat(t,"px")),o.setProperty("--radix-popper-anchor-height","".concat(a,"px"))}})),Q&&pu({element:Q,padding:B}),Pu({arrowWidth:D,arrowHeight:T}),k&&Bu(aI({strategy:"referenceHidden"},_))]}),gg=$.refs,Ig=$.floatingStyles,eg=$.placement,Cg=$.isPositioned,lg=$.middlewareData,ng=A(Ou(eg),2),tg=ng[0],ag=ng[1],og=No(w);ko((function(){Cg&&(null===og||void 0===og||og())}),[Cg,og]);var Ag=null===(n=lg.arrow)||void 0===n?void 0:n.x,rg=null===(t=lg.arrow)||void 0===t?void 0:t.y,cg=0!==(null===(a=lg.arrow)||void 0===a?void 0:a.centerOffset),ig=A(I.useState(),2),dg=ig[0],ug=ig[1];return ko((function(){x&&ug(window.getComputedStyle(x).zIndex)}),[x]),(0,CI.jsx)("div",{ref:gg.setFloating,"data-radix-popper-content-wrapper":"",style:aI(aI({},Ig),{},nI({transform:Cg?Ig.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:dg},"--radix-popper-transform-origin",[null===(o=lg.transformOrigin)||void 0===o?void 0:o.x,null===(r=lg.transformOrigin)||void 0===r?void 0:r.y].join(" ")),(null===(c=lg.hide)||void 0===c?void 0:c.referenceHidden)&&{visibility:"hidden",pointerEvents:"none"}),dir:g.dir,children:(0,CI.jsx)(Uu,{scope:i,placedSide:tg,onArrowChange:M,arrowX:Ag,arrowY:rg,shouldHideArrow:cg,children:(0,CI.jsx)(go.div,aI(aI({"data-side":tg,"data-align":ag},N),{},{ref:E,style:aI(aI({},N.style),{},{animation:Cg?void 0:"none"})}))})})}));Mu.displayName=zu;var Lu="PopperArrow",Du={top:"bottom",right:"left",bottom:"top",left:"right"},Tu=I.forwardRef((function(g,I){var e,C=g.__scopePopper,l=cI(g,Ru),n=Qu(Lu,C),t=Du[n.placedSide];return(0,CI.jsx)("span",{ref:n.onArrowChange,style:(e={position:"absolute",left:n.arrowX,top:n.arrowY},nI(e,t,0),nI(e,"transformOrigin",{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[n.placedSide]),nI(e,"transform",{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[n.placedSide]),nI(e,"visibility",n.shouldHideArrow?"hidden":void 0),e),children:(0,CI.jsx)(Su,aI(aI({},l),{},{ref:I,style:aI(aI({},l.style),{},{display:"block"})}))})}));function ju(g){return null!==g}Tu.displayName=Lu;var Pu=function(g){return{name:"transformOrigin",options:g,fn:function(I){var e,C,l,n,t,a=I.placement,o=I.rects,r=I.middlewareData,c=0!==(null===(e=r.arrow)||void 0===e?void 0:e.centerOffset),i=c?0:g.arrowWidth,d=c?0:g.arrowHeight,u=A(Ou(a),2),s=u[0],m={start:"0%",center:"50%",end:"100%"}[u[1]],b=(null!==(C=null===(l=r.arrow)||void 0===l?void 0:l.x)&&void 0!==C?C:0)+i/2,Z=(null!==(n=null===(t=r.arrow)||void 0===t?void 0:t.y)&&void 0!==n?n:0)+d/2,G="",y="";return"bottom"===s?(G=c?m:"".concat(b,"px"),y="".concat(-d,"px")):"top"===s?(G=c?m:"".concat(b,"px"),y="".concat(o.floating.height+d,"px")):"right"===s?(G="".concat(-d,"px"),y=c?m:"".concat(Z,"px")):"left"===s&&(G="".concat(o.floating.width+d,"px"),y=c?m:"".concat(Z,"px")),{data:{x:G,y:y}}}}};function Ou(g){var I=A(g.split("-"),2),e=I[0],C=I[1];return[e,void 0===C?"center":C]}var qu=Fu,_u=xu,$u=Mu,gs=Tu;var Is=I.forwardRef((function(g,I){return(0,CI.jsx)(go.span,aI(aI({},g),{},{ref:I,style:aI({position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal"},g.style)}))}));Is.displayName="VisuallyHidden";var es=["__scopeSelect","disabled"],Cs=["__scopeSelect","className","style","children","placeholder"],ls=["__scopeSelect","children"],ns=["__scopeSelect","position","onCloseAutoFocus","onEscapeKeyDown","onPointerDownOutside","side","sideOffset","align","alignOffset","arrowPadding","collisionBoundary","collisionPadding","sticky","hideWhenDetached","avoidCollisions"],ts=["__scopeSelect","onPlaced"],as=["__scopeSelect","align","collisionPadding"],os=["__scopeSelect","nonce"],As=["__scopeSelect"],rs=["__scopeSelect"],cs=["__scopeSelect","value","disabled","textValue"],is=["__scopeSelect","className","style"],ds=["__scopeSelect"],us=["__scopeSelect","onAutoScroll"],ss=["__scopeSelect"],ms=["__scopeSelect"],bs=["value"],Zs=[" ","Enter","ArrowUp","ArrowDown"],Gs=[" ","Enter"],ys="Select",hs=A(zi(ys),3),Bs=hs[0],ps=hs[1],Ws=A(Xo(ys,[hs[2],Yu]),2),Vs=Ws[0],Ss=(Ws[1],Yu()),vs=A(Vs(ys),2),fs=vs[0],Rs=vs[1],Xs=A(Vs(ys),2),Js=Xs[0],ks=Xs[1],Ys=function(g){var e=g.__scopeSelect,C=g.children,l=g.open,n=g.defaultOpen,t=g.onOpenChange,a=g.value,o=g.defaultValue,r=g.onValueChange,c=g.dir,i=g.name,d=g.autoComplete,u=g.disabled,s=g.required,m=Ss(e),b=A(I.useState(null),2),Z=b[0],G=b[1],y=A(I.useState(null),2),h=y[0],B=y[1],p=A(I.useState(!1),2),W=p[0],V=p[1],S=function(g){var e=I.useContext(Ei);return g||e||"ltr"}(c),v=A(Fo({prop:l,defaultProp:n,onChange:t}),2),f=v[0],R=void 0!==f&&f,X=v[1],J=A(Fo({prop:a,defaultProp:o,onChange:r}),2),k=J[0],Y=J[1],H=I.useRef(null),w=!Z||Boolean(Z.closest("form")),N=A(I.useState(new Set),2),F=N[0],K=N[1],x=Array.from(F).map((function(g){return g.props.value})).join(";");return(0,CI.jsx)(qu,aI(aI({},m),{},{children:(0,CI.jsxs)(fs,{required:s,scope:e,trigger:Z,onTriggerChange:G,valueNode:h,onValueNodeChange:B,valueNodeHasChildren:W,onValueNodeHasChildrenChange:V,contentId:wo(),value:k,onValueChange:Y,open:R,onOpenChange:X,dir:S,triggerPointerDownPosRef:H,disabled:u,children:[(0,CI.jsx)(Bs.Provider,{scope:e,children:(0,CI.jsx)(Js,{scope:g.__scopeSelect,onNativeOptionAdd:I.useCallback((function(g){K((function(I){return new Set(I).add(g)}))}),[]),onNativeOptionRemove:I.useCallback((function(g){K((function(I){var e=new Set(I);return e.delete(g),e}))}),[]),children:C})}),w?(0,CI.jsxs)(Vm,{"aria-hidden":!0,required:s,tabIndex:-1,name:i,autoComplete:d,value:k,onChange:function(g){return Y(g.target.value)},disabled:u,children:[void 0===k?(0,CI.jsx)("option",{value:""}):null,Array.from(F)]},x):null]})}))};Ys.displayName=ys;var Hs="SelectTrigger",ws=I.forwardRef((function(g,I){var e=g.__scopeSelect,C=g.disabled,l=void 0!==C&&C,n=cI(g,es),t=Ss(e),a=Rs(Hs,e),o=a.disabled||l,r=Da(I,a.onTriggerChange),c=ps(e),i=A(Sm((function(g){var I=c().filter((function(g){return!g.disabled})),e=I.find((function(g){return g.value===a.value})),C=vm(I,g,e);void 0!==C&&a.onValueChange(C.value)})),3),d=i[0],u=i[1],s=i[2],m=function(){o||(a.onOpenChange(!0),s())};return(0,CI.jsx)(_u,aI(aI({asChild:!0},t),{},{children:(0,CI.jsx)(go.button,aI(aI({type:"button",role:"combobox","aria-controls":a.contentId,"aria-expanded":a.open,"aria-required":a.required,"aria-autocomplete":"none",dir:a.dir,"data-state":a.open?"open":"closed",disabled:o,"data-disabled":o?"":void 0,"data-placeholder":Wm(a.value)?"":void 0},n),{},{ref:r,onClick:vo(n.onClick,(function(g){g.currentTarget.focus()})),onPointerDown:vo(n.onPointerDown,(function(g){var I=g.target;I.hasPointerCapture(g.pointerId)&&I.releasePointerCapture(g.pointerId),0===g.button&&!1===g.ctrlKey&&(m(),a.triggerPointerDownPosRef.current={x:Math.round(g.pageX),y:Math.round(g.pageY)},g.preventDefault())})),onKeyDown:vo(n.onKeyDown,(function(g){var I=""!==d.current;g.ctrlKey||g.altKey||g.metaKey||1!==g.key.length||u(g.key),I&&" "===g.key||Zs.includes(g.key)&&(m(),g.preventDefault())}))}))}))}));ws.displayName=Hs;var Ns="SelectValue",Fs=I.forwardRef((function(g,I){var e=g.__scopeSelect,C=(g.className,g.style,g.children),l=g.placeholder,n=void 0===l?"":l,t=cI(g,Cs),a=Rs(Ns,e),o=a.onValueNodeHasChildrenChange,A=void 0!==C,r=Da(I,a.onValueNodeChange);return ko((function(){o(A)}),[o,A]),(0,CI.jsx)(go.span,aI(aI({},t),{},{ref:r,style:{pointerEvents:"none"},children:Wm(a.value)?(0,CI.jsx)(CI.Fragment,{children:n}):C}))}));Fs.displayName=Ns;var Ks=I.forwardRef((function(g,I){g.__scopeSelect;var e=g.children,C=cI(g,ls);return(0,CI.jsx)(go.span,aI(aI({"aria-hidden":!0},C),{},{ref:I,children:e||"\u25bc"}))}));Ks.displayName="SelectIcon";var xs=function(g){return(0,CI.jsx)(oA,aI({asChild:!0},g))};xs.displayName="SelectPortal";var zs="SelectContent",Es=I.forwardRef((function(g,e){var C=Rs(zs,g.__scopeSelect),l=A(I.useState(),2),n=l[0],t=l[1];if(ko((function(){t(new DocumentFragment)}),[]),!C.open){var a=n;return a?c.createPortal((0,CI.jsx)(Ms,{scope:g.__scopeSelect,children:(0,CI.jsx)(Bs.Slot,{scope:g.__scopeSelect,children:(0,CI.jsx)("div",{children:g.children})})}),a):null}return(0,CI.jsx)(Ds,aI(aI({},g),{},{ref:e}))}));Es.displayName=zs;var Us=10,Qs=A(Vs(zs),2),Ms=Qs[0],Ls=Qs[1],Ds=I.forwardRef((function(g,e){var C=g.__scopeSelect,l=g.position,n=void 0===l?"item-aligned":l,t=g.onCloseAutoFocus,a=g.onEscapeKeyDown,o=g.onPointerDownOutside,r=g.side,c=g.sideOffset,i=g.align,d=g.alignOffset,u=g.arrowPadding,s=g.collisionBoundary,m=g.collisionPadding,b=g.sticky,Z=g.hideWhenDetached,G=g.avoidCollisions,y=cI(g,ns),h=Rs(zs,C),B=A(I.useState(null),2),p=B[0],W=B[1],V=A(I.useState(null),2),S=V[0],v=V[1],f=Da(e,(function(g){return W(g)})),J=A(I.useState(null),2),k=J[0],Y=J[1],H=A(I.useState(null),2),w=H[0],N=H[1],F=ps(C),K=A(I.useState(!1),2),x=K[0],z=K[1],E=I.useRef(!1);I.useEffect((function(){if(p)return ir(p)}),[p]),iA();var U=I.useCallback((function(g){var I,e=R(F().map((function(g){return g.ref.current}))),C=e[0],l=A(e.slice(1).slice(-1),1)[0],n=document.activeElement,t=X(g);try{for(t.s();!(I=t.n()).done;){var a=I.value;if(a===n)return;if(null===a||void 0===a||a.scrollIntoView({block:"nearest"}),a===C&&S&&(S.scrollTop=0),a===l&&S&&(S.scrollTop=S.scrollHeight),null===a||void 0===a||a.focus(),document.activeElement!==n)return}}catch(gG){t.e(gG)}finally{t.f()}}),[F,S]),Q=I.useCallback((function(){return U([k,p])}),[U,k,p]);I.useEffect((function(){x&&Q()}),[x,Q]);var M=h.onOpenChange,L=h.triggerPointerDownPosRef;I.useEffect((function(){if(p){var g={x:0,y:0},I=function(I){var e,C,l,n;g={x:Math.abs(Math.round(I.pageX)-(null!==(e=null===(C=L.current)||void 0===C?void 0:C.x)&&void 0!==e?e:0)),y:Math.abs(Math.round(I.pageY)-(null!==(l=null===(n=L.current)||void 0===n?void 0:n.y)&&void 0!==l?l:0))}},e=function(e){g.x<=10&&g.y<=10?e.preventDefault():p.contains(e.target)||M(!1),document.removeEventListener("pointermove",I),L.current=null};return null!==L.current&&(document.addEventListener("pointermove",I),document.addEventListener("pointerup",e,{capture:!0,once:!0})),function(){document.removeEventListener("pointermove",I),document.removeEventListener("pointerup",e,{capture:!0})}}}),[p,M,L]),I.useEffect((function(){var g=function(){return M(!1)};return window.addEventListener("blur",g),window.addEventListener("resize",g),function(){window.removeEventListener("blur",g),window.removeEventListener("resize",g)}}),[M]);var D=A(Sm((function(g){var I=F().filter((function(g){return!g.disabled})),e=I.find((function(g){return g.ref.current===document.activeElement})),C=vm(I,g,e);C&&setTimeout((function(){return C.ref.current.focus()}))})),2),T=D[0],j=D[1],P=I.useCallback((function(g,I,e){var C=!E.current&&!e;(void 0!==h.value&&h.value===I||C)&&(Y(g),C&&(E.current=!0))}),[h.value]),O=I.useCallback((function(){return null===p||void 0===p?void 0:p.focus()}),[p]),q=I.useCallback((function(g,I,e){var C=!E.current&&!e;(void 0!==h.value&&h.value===I||C)&&N(g)}),[h.value]),_="popper"===n?js:Ts,$=_===js?{side:r,sideOffset:c,align:i,alignOffset:d,arrowPadding:u,collisionBoundary:s,collisionPadding:m,sticky:b,hideWhenDetached:Z,avoidCollisions:G}:{};return(0,CI.jsx)(Ms,{scope:C,content:p,viewport:S,onViewportChange:v,itemRefCallback:P,selectedItem:k,onItemLeave:O,itemTextRefCallback:q,focusSelectedItem:Q,selectedItemText:w,position:n,isPositioned:x,searchRef:T,children:(0,CI.jsx)(lr,{as:Pa,allowPinchZoom:!0,children:(0,CI.jsx)(gA,{asChild:!0,trapped:h.open,onMountAutoFocus:function(g){g.preventDefault()},onUnmountAutoFocus:vo(t,(function(g){var I;null===(I=h.trigger)||void 0===I||I.focus({preventScroll:!0}),g.preventDefault()})),children:(0,CI.jsx)(Mo,{asChild:!0,disableOutsidePointerEvents:!0,onEscapeKeyDown:a,onPointerDownOutside:o,onFocusOutside:function(g){return g.preventDefault()},onDismiss:function(){return h.onOpenChange(!1)},children:(0,CI.jsx)(_,aI(aI(aI({role:"listbox",id:h.contentId,"data-state":h.open?"open":"closed",dir:h.dir,onContextMenu:function(g){return g.preventDefault()}},y),$),{},{onPlaced:function(){return z(!0)},ref:f,style:aI({display:"flex",flexDirection:"column",outline:"none"},y.style),onKeyDown:vo(y.onKeyDown,(function(g){var I=g.ctrlKey||g.altKey||g.metaKey;if("Tab"===g.key&&g.preventDefault(),I||1!==g.key.length||j(g.key),["ArrowUp","ArrowDown","Home","End"].includes(g.key)){var e=F().filter((function(g){return!g.disabled})).map((function(g){return g.ref.current}));if(["ArrowUp","End"].includes(g.key)&&(e=e.slice().reverse()),["ArrowUp","ArrowDown"].includes(g.key)){var C=g.target,l=e.indexOf(C);e=e.slice(l+1)}setTimeout((function(){return U(e)})),g.preventDefault()}}))}))})})})})}));Ds.displayName="SelectContentImpl";var Ts=I.forwardRef((function(g,e){var C=g.__scopeSelect,l=g.onPlaced,n=cI(g,ts),t=Rs(zs,C),a=Ls(zs,C),o=A(I.useState(null),2),r=o[0],c=o[1],i=A(I.useState(null),2),d=i[0],u=i[1],s=Da(e,(function(g){return u(g)})),m=ps(C),b=I.useRef(!1),Z=I.useRef(!0),G=a.viewport,y=a.selectedItem,h=a.selectedItemText,B=a.focusSelectedItem,p=I.useCallback((function(){if(t.trigger&&t.valueNode&&r&&d&&G&&y&&h){var g=t.trigger.getBoundingClientRect(),I=d.getBoundingClientRect(),e=t.valueNode.getBoundingClientRect(),C=h.getBoundingClientRect();if("rtl"!==t.dir){var n=C.left-I.left,a=e.left-n,o=g.left-a,A=g.width+o,c=Math.max(A,I.width),i=window.innerWidth-Us,u=Ki(a,[Us,i-c]);r.style.minWidth=A+"px",r.style.left=u+"px"}else{var s=I.right-C.right,Z=window.innerWidth-e.right-s,B=window.innerWidth-g.right-Z,p=g.width+B,W=Math.max(p,I.width),V=window.innerWidth-Us,S=Ki(Z,[Us,V-W]);r.style.minWidth=p+"px",r.style.right=S+"px"}var v=m(),f=window.innerHeight-20,R=G.scrollHeight,X=window.getComputedStyle(d),J=parseInt(X.borderTopWidth,10),k=parseInt(X.paddingTop,10),Y=parseInt(X.borderBottomWidth,10),H=J+k+R+parseInt(X.paddingBottom,10)+Y,w=Math.min(5*y.offsetHeight,H),N=window.getComputedStyle(G),F=parseInt(N.paddingTop,10),K=parseInt(N.paddingBottom,10),x=g.top+g.height/2-Us,z=f-x,E=y.offsetHeight/2,U=J+k+(y.offsetTop+E),Q=H-U;if(U<=x){var M=y===v[v.length-1].ref.current;r.style.bottom="0px";var L=d.clientHeight-G.offsetTop-G.offsetHeight,D=U+Math.max(z,E+(M?K:0)+L+Y);r.style.height=D+"px"}else{var T=y===v[0].ref.current;r.style.top="0px";var j=Math.max(x,J+G.offsetTop+(T?F:0)+E)+Q;r.style.height=j+"px",G.scrollTop=U-x+G.offsetTop}r.style.margin="".concat(Us,"px 0"),r.style.minHeight=w+"px",r.style.maxHeight=f+"px",null===l||void 0===l||l(),requestAnimationFrame((function(){return b.current=!0}))}}),[m,t.trigger,t.valueNode,r,d,G,y,h,t.dir,l]);ko((function(){return p()}),[p]);var W=A(I.useState(),2),V=W[0],S=W[1];ko((function(){d&&S(window.getComputedStyle(d).zIndex)}),[d]);var v=I.useCallback((function(g){g&&!0===Z.current&&(p(),null===B||void 0===B||B(),Z.current=!1)}),[p,B]);return(0,CI.jsx)(Os,{scope:C,contentWrapper:r,shouldExpandOnScrollRef:b,onScrollButtonChange:v,children:(0,CI.jsx)("div",{ref:c,style:{display:"flex",flexDirection:"column",position:"fixed",zIndex:V},children:(0,CI.jsx)(go.div,aI(aI({},n),{},{ref:s,style:aI({boxSizing:"border-box",maxHeight:"100%"},n.style)}))})})}));Ts.displayName="SelectItemAlignedPosition";var js=I.forwardRef((function(g,I){var e=g.__scopeSelect,C=g.align,l=void 0===C?"start":C,n=g.collisionPadding,t=void 0===n?Us:n,a=cI(g,as),o=Ss(e);return(0,CI.jsx)($u,aI(aI(aI({},o),a),{},{ref:I,align:l,collisionPadding:t,style:aI(aI({boxSizing:"border-box"},a.style),{"--radix-select-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-select-content-available-width":"var(--radix-popper-available-width)","--radix-select-content-available-height":"var(--radix-popper-available-height)","--radix-select-trigger-width":"var(--radix-popper-anchor-width)","--radix-select-trigger-height":"var(--radix-popper-anchor-height)"})}))}));js.displayName="SelectPopperPosition";var Ps=A(Vs(zs,{}),2),Os=Ps[0],qs=Ps[1],_s="SelectViewport",$s=I.forwardRef((function(g,e){var C=g.__scopeSelect,l=g.nonce,n=cI(g,os),t=Ls(_s,C),a=qs(_s,C),o=Da(e,t.onViewportChange),A=I.useRef(0);return(0,CI.jsxs)(CI.Fragment,{children:[(0,CI.jsx)("style",{dangerouslySetInnerHTML:{__html:"[data-radix-select-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-select-viewport]::-webkit-scrollbar{display:none}"},nonce:l}),(0,CI.jsx)(Bs.Slot,{scope:C,children:(0,CI.jsx)(go.div,aI(aI({"data-radix-select-viewport":"",role:"presentation"},n),{},{ref:o,style:aI({position:"relative",flex:1,overflow:"auto"},n.style),onScroll:vo(n.onScroll,(function(g){var I=g.currentTarget,e=a.contentWrapper,C=a.shouldExpandOnScrollRef;if(null!==C&&void 0!==C&&C.current&&e){var l=Math.abs(A.current-I.scrollTop);if(l>0){var n=window.innerHeight-20,t=parseFloat(e.style.minHeight),o=parseFloat(e.style.height),r=Math.max(t,o);if(r<n){var c=r+l,i=Math.min(n,c),d=c-i;e.style.height=i+"px","0px"===e.style.bottom&&(I.scrollTop=d>0?d:0,e.style.justifyContent="flex-end")}}}A.current=I.scrollTop}))}))})]})}));$s.displayName=_s;var gm="SelectGroup",Im=A(Vs(gm),2),em=Im[0],Cm=Im[1],lm=I.forwardRef((function(g,I){var e=g.__scopeSelect,C=cI(g,As),l=wo();return(0,CI.jsx)(em,{scope:e,id:l,children:(0,CI.jsx)(go.div,aI(aI({role:"group","aria-labelledby":l},C),{},{ref:I}))})}));lm.displayName=gm;var nm="SelectLabel",tm=I.forwardRef((function(g,I){var e=g.__scopeSelect,C=cI(g,rs),l=Cm(nm,e);return(0,CI.jsx)(go.div,aI(aI({id:l.id},C),{},{ref:I}))}));tm.displayName=nm;var am="SelectItem",om=A(Vs(am),2),Am=om[0],rm=om[1],cm=I.forwardRef((function(g,e){var C=g.__scopeSelect,l=g.value,n=g.disabled,t=void 0!==n&&n,a=g.textValue,o=cI(g,cs),r=Rs(am,C),c=Ls(am,C),i=r.value===l,d=A(I.useState(null!==a&&void 0!==a?a:""),2),u=d[0],s=d[1],m=A(I.useState(!1),2),b=m[0],Z=m[1],G=Da(e,(function(g){var I;return null===(I=c.itemRefCallback)||void 0===I?void 0:I.call(c,g,l,t)})),y=wo(),h=function(){t||(r.onValueChange(l),r.onOpenChange(!1))};if(""===l)throw new Error("A <Select.Item /> must have a value prop that is not an empty string. This is because the Select value can be set to an empty string to clear the selection and show the placeholder.");return(0,CI.jsx)(Am,{scope:C,value:l,disabled:t,textId:y,isSelected:i,onItemTextChange:I.useCallback((function(g){s((function(I){var e;return I||(null!==(e=null===g||void 0===g?void 0:g.textContent)&&void 0!==e?e:"").trim()}))}),[]),children:(0,CI.jsx)(Bs.ItemSlot,{scope:C,value:l,disabled:t,textValue:u,children:(0,CI.jsx)(go.div,aI(aI({role:"option","aria-labelledby":y,"data-highlighted":b?"":void 0,"aria-selected":i&&b,"data-state":i?"checked":"unchecked","aria-disabled":t||void 0,"data-disabled":t?"":void 0,tabIndex:t?void 0:-1},o),{},{ref:G,onFocus:vo(o.onFocus,(function(){return Z(!0)})),onBlur:vo(o.onBlur,(function(){return Z(!1)})),onPointerUp:vo(o.onPointerUp,h),onPointerMove:vo(o.onPointerMove,(function(g){var I;t?null===(I=c.onItemLeave)||void 0===I||I.call(c):g.currentTarget.focus({preventScroll:!0})})),onPointerLeave:vo(o.onPointerLeave,(function(g){var I;g.currentTarget===document.activeElement&&(null===(I=c.onItemLeave)||void 0===I||I.call(c))})),onKeyDown:vo(o.onKeyDown,(function(g){var I;""!==(null===(I=c.searchRef)||void 0===I?void 0:I.current)&&" "===g.key||(Gs.includes(g.key)&&h()," "===g.key&&g.preventDefault())}))}))})})}));cm.displayName=am;var im="SelectItemText",dm=I.forwardRef((function(g,e){var C=g.__scopeSelect,l=(g.className,g.style,cI(g,is)),n=Rs(im,C),t=Ls(im,C),a=rm(im,C),o=ks(im,C),r=A(I.useState(null),2),i=r[0],d=r[1],u=Da(e,(function(g){return d(g)}),a.onItemTextChange,(function(g){var I;return null===(I=t.itemTextRefCallback)||void 0===I?void 0:I.call(t,g,a.value,a.disabled)})),s=null===i||void 0===i?void 0:i.textContent,m=I.useMemo((function(){return(0,CI.jsx)("option",{value:a.value,disabled:a.disabled,children:s},a.value)}),[a.disabled,a.value,s]),b=o.onNativeOptionAdd,Z=o.onNativeOptionRemove;return ko((function(){return b(m),function(){return Z(m)}}),[b,Z,m]),(0,CI.jsxs)(CI.Fragment,{children:[(0,CI.jsx)(go.span,aI(aI({id:a.textId},l),{},{ref:u})),a.isSelected&&n.valueNode&&!n.valueNodeHasChildren?c.createPortal(l.children,n.valueNode):null]})}));dm.displayName=im;var um="SelectItemIndicator",sm=I.forwardRef((function(g,I){var e=g.__scopeSelect,C=cI(g,ds);return rm(um,e).isSelected?(0,CI.jsx)(go.span,aI(aI({"aria-hidden":!0},C),{},{ref:I})):null}));sm.displayName=um;var mm="SelectScrollUpButton",bm=I.forwardRef((function(g,e){var C=Ls(mm,g.__scopeSelect),l=qs(mm,g.__scopeSelect),n=A(I.useState(!1),2),t=n[0],a=n[1],o=Da(e,l.onScrollButtonChange);return ko((function(){if(C.viewport&&C.isPositioned){var g=function(){var g=I.scrollTop>0;a(g)},I=C.viewport;return g(),I.addEventListener("scroll",g),function(){return I.removeEventListener("scroll",g)}}}),[C.viewport,C.isPositioned]),t?(0,CI.jsx)(ym,aI(aI({},g),{},{ref:o,onAutoScroll:function(){var g=C.viewport,I=C.selectedItem;g&&I&&(g.scrollTop=g.scrollTop-I.offsetHeight)}})):null}));bm.displayName=mm;var Zm="SelectScrollDownButton",Gm=I.forwardRef((function(g,e){var C=Ls(Zm,g.__scopeSelect),l=qs(Zm,g.__scopeSelect),n=A(I.useState(!1),2),t=n[0],a=n[1],o=Da(e,l.onScrollButtonChange);return ko((function(){if(C.viewport&&C.isPositioned){var g=function(){var g=I.scrollHeight-I.clientHeight,e=Math.ceil(I.scrollTop)<g;a(e)},I=C.viewport;return g(),I.addEventListener("scroll",g),function(){return I.removeEventListener("scroll",g)}}}),[C.viewport,C.isPositioned]),t?(0,CI.jsx)(ym,aI(aI({},g),{},{ref:o,onAutoScroll:function(){var g=C.viewport,I=C.selectedItem;g&&I&&(g.scrollTop=g.scrollTop+I.offsetHeight)}})):null}));Gm.displayName=Zm;var ym=I.forwardRef((function(g,e){var C=g.__scopeSelect,l=g.onAutoScroll,n=cI(g,us),t=Ls("SelectScrollButton",C),a=I.useRef(null),o=ps(C),A=I.useCallback((function(){null!==a.current&&(window.clearInterval(a.current),a.current=null)}),[]);return I.useEffect((function(){return function(){return A()}}),[A]),ko((function(){var g,I=o().find((function(g){return g.ref.current===document.activeElement}));null===I||void 0===I||null===(g=I.ref.current)||void 0===g||g.scrollIntoView({block:"nearest"})}),[o]),(0,CI.jsx)(go.div,aI(aI({"aria-hidden":!0},n),{},{ref:e,style:aI({flexShrink:0},n.style),onPointerDown:vo(n.onPointerDown,(function(){null===a.current&&(a.current=window.setInterval(l,50))})),onPointerMove:vo(n.onPointerMove,(function(){var g;null===(g=t.onItemLeave)||void 0===g||g.call(t),null===a.current&&(a.current=window.setInterval(l,50))})),onPointerLeave:vo(n.onPointerLeave,(function(){A()}))}))})),hm=I.forwardRef((function(g,I){g.__scopeSelect;var e=cI(g,ss);return(0,CI.jsx)(go.div,aI(aI({"aria-hidden":!0},e),{},{ref:I}))}));hm.displayName="SelectSeparator";var Bm="SelectArrow",pm=I.forwardRef((function(g,I){var e=g.__scopeSelect,C=cI(g,ms),l=Ss(e),n=Rs(Bm,e),t=Ls(Bm,e);return n.open&&"popper"===t.position?(0,CI.jsx)(gs,aI(aI(aI({},l),C),{},{ref:I})):null}));function Wm(g){return""===g||void 0===g}pm.displayName=Bm;var Vm=I.forwardRef((function(g,e){var C=g.value,l=cI(g,bs),n=I.useRef(null),t=Da(e,n),a=function(g){var e=I.useRef({value:g,previous:g});return I.useMemo((function(){return e.current.value!==g&&(e.current.previous=e.current.value,e.current.value=g),e.current.previous}),[g])}(C);return I.useEffect((function(){var g=n.current,I=window.HTMLSelectElement.prototype,e=Object.getOwnPropertyDescriptor(I,"value").set;if(a!==C&&e){var l=new Event("change",{bubbles:!0});e.call(g,C),g.dispatchEvent(l)}}),[a,C]),(0,CI.jsx)(Is,{asChild:!0,children:(0,CI.jsx)("select",aI(aI({},l),{},{ref:t,defaultValue:C}))})}));function Sm(g){var e=No(g),C=I.useRef(""),l=I.useRef(0),n=I.useCallback((function(g){var I=C.current+g;e(I),function g(I){C.current=I,window.clearTimeout(l.current),""!==I&&(l.current=window.setTimeout((function(){return g("")}),1e3))}(I)}),[e]),t=I.useCallback((function(){C.current="",window.clearTimeout(l.current)}),[]);return I.useEffect((function(){return function(){return window.clearTimeout(l.current)}}),[]),[C,n,t]}function vm(g,I,e){var C=I.length>1&&Array.from(I).every((function(g){return g===I[0]}))?I[0]:I,l=e?g.indexOf(e):-1,n=function(g,I){return g.map((function(e,C){return g[(I+C)%g.length]}))}(g,Math.max(l,0));1===C.length&&(n=n.filter((function(g){return g!==e})));var t=n.find((function(g){return g.textValue.toLowerCase().startsWith(C.toLowerCase())}));return t!==e?t:void 0}Vm.displayName="BubbleSelect";var fm=Ys,Rm=ws,Xm=Fs,Jm=Ks,km=xs,Ym=Es,Hm=$s,wm=tm,Nm=cm,Fm=dm,Km=sm,xm=bm,zm=Gm,Em=hm,Um=po("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]),Qm=po("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]),Mm=po("Check",[["polyline",{points:"20 6 9 17 4 12",key:"10jjfj"}]]),Lm=["className","children"],Dm=["className"],Tm=["className"],jm=["className","children","position"],Pm=["className"],Om=["className","children"],qm=["className"],_m=fm,$m=Xm,gb=I.forwardRef((function(g,I){var e=g.className,C=g.children,l=cI(g,Lm);return(0,CI.jsxs)(Rm,aI(aI({ref:I,className:xa("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",e)},l),{},{children:[C,(0,CI.jsx)(Jm,{asChild:!0,children:(0,CI.jsx)(Um,{className:"h-4 w-4 opacity-50"})})]}))}));gb.displayName=Rm.displayName;var Ib=I.forwardRef((function(g,I){var e=g.className,C=cI(g,Dm);return(0,CI.jsx)(xm,aI(aI({ref:I,className:xa("flex cursor-default items-center justify-center py-1",e)},C),{},{children:(0,CI.jsx)(Qm,{className:"h-4 w-4"})}))}));Ib.displayName=xm.displayName;var eb=I.forwardRef((function(g,I){var e=g.className,C=cI(g,Tm);return(0,CI.jsx)(zm,aI(aI({ref:I,className:xa("flex cursor-default items-center justify-center py-1",e)},C),{},{children:(0,CI.jsx)(Um,{className:"h-4 w-4"})}))}));eb.displayName=zm.displayName;var Cb=I.forwardRef((function(g,I){var e=g.className,C=g.children,l=g.position,n=void 0===l?"popper":l,t=cI(g,jm);return(0,CI.jsx)(km,{children:(0,CI.jsxs)(Ym,aI(aI({ref:I,className:xa("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2","popper"===n&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",e),position:n},t),{},{children:[(0,CI.jsx)(Ib,{}),(0,CI.jsx)(Hm,{className:xa("p-1","popper"===n&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:C}),(0,CI.jsx)(eb,{})]}))})}));Cb.displayName=Ym.displayName,I.forwardRef((function(g,I){var e=g.className,C=cI(g,Pm);return(0,CI.jsx)(wm,aI({ref:I,className:xa("py-1.5 pl-8 pr-2 text-sm font-semibold",e)},C))})).displayName=wm.displayName;var lb=I.forwardRef((function(g,I){var e=g.className,C=g.children,l=cI(g,Om);return(0,CI.jsxs)(Nm,aI(aI({ref:I,className:xa("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e)},l),{},{children:[(0,CI.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,CI.jsx)(Km,{children:(0,CI.jsx)(Mm,{className:"h-4 w-4"})})}),(0,CI.jsx)(Fm,{children:C})]}))}));lb.displayName=Nm.displayName,I.forwardRef((function(g,I){var e=g.className,C=cI(g,qm);return(0,CI.jsx)(Em,aI({ref:I,className:xa("-mx-1 my-1 h-px bg-muted",e)},C))})).displayName=Em.displayName;var nb=["className","error"],tb=I.forwardRef((function(g,I){var e=g.className,C=g.error,l=cI(g,nb);return(0,CI.jsxs)("div",{children:[(0,CI.jsx)("textarea",aI({className:xa("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",C&&"border-red-500",e),ref:I},l)),C&&(0,CI.jsx)("p",{className:"mt-1 text-xs text-red-500",children:C})]})}));tb.displayName="Textarea";var ab=po("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]),ob=po("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]),Ab=po("Calendar",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}]]),rb=po("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]),cb=po("MapPin",[["path",{d:"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z",key:"2oe9fu"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]),ib=po("FileText",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["line",{x1:"16",x2:"8",y1:"13",y2:"13",key:"14keom"}],["line",{x1:"16",x2:"8",y1:"17",y2:"17",key:"17nazh"}],["line",{x1:"10",x2:"8",y1:"9",y2:"9",key:"1a5vjj"}]]),db=ll().shape({name:DC().required("Name is required"),department:DC().required("Department is required"),rollno:DC().required("Roll Number is required"),year:DC().required("Year is required"),dateFrom:OC().required("Date From is required"),dateTo:OC().required("Date To is required"),timeFrom:DC().required("Time From is required"),timeTo:DC().required("Time To is required"),phNo:DC().required("Phone Number is required"),parentPhNo:DC().required("Parent Phone Number is required"),reason:DC().required("Reason is required"),city:DC().required("City is required")}),ub=function(){var g,e,C,l,n,t,a,o,r,c,i,d,u=Sg(),s=kc().toast,m=A((0,I.useState)([]),2),b=m[0],Z=m[1],G=A((0,I.useState)([]),2),y=G[0],h=G[1],B=A((0,I.useState)(!1),2),p=B[0],W=B[1],V=A((0,I.useState)(!1),2),S=V[0],v=V[1],f=A((0,I.useState)(null),2),R=f[0],X=f[1],J=A((0,I.useState)(!1),2),k=J[0],Y=J[1],H=A((0,I.useState)(""),2),w=H[0],N=H[1],F=A((0,I.useState)(!1),2),K=F[0],x=F[1],z=we({resolver:ze(db)}),E=z.register,U=z.handleSubmit,Q=z.formState.errors,M=z.reset;(0,I.useEffect)((function(){Nc()?(L(),D()):u("/login")}),[u]),(0,I.useEffect)((function(){K?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark")}),[K]);var L=function(){var g=rI(oI().mark((function g(){var I,e;return oI().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:return g.prev=0,I=Nc(),g.next=4,wt.get("".concat(xc,"/auth/getStaff"),{headers:{"x-auth-token":I}});case 4:e=g.sent,Z(e.data.data),g.next=12;break;case 8:g.prev=8,g.t0=g.catch(0),console.error("Error fetching staff list:",g.t0),s({title:"Error",description:"Failed to fetch staff list.",variant:"destructive"});case 12:case"end":return g.stop()}}),g,null,[[0,8]])})));return function(){return g.apply(this,arguments)}}(),D=function(){var g=rI(oI().mark((function g(){var I,e;return oI().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:return g.prev=0,I=Nc(),g.next=4,wt.get("".concat(xc,"/opDetails/user/").concat(Fc()),{headers:{"x-auth-token":I}});case 4:e=g.sent,h(e.data.data),g.next=12;break;case 8:g.prev=8,g.t0=g.catch(0),console.error("Error fetching user details:",g.t0),s({title:"Error",description:"Failed to fetch user details.",variant:"destructive"});case 12:case"end":return g.stop()}}),g,null,[[0,8]])})));return function(){return g.apply(this,arguments)}}(),T=function(){var g=rI(oI().mark((function g(I){var e,C;return oI().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:return g.prev=0,e=Nc(),C=aI(aI({},I),{},{userId:Fc()}),g.next=5,wt.post("".concat(xc,"/opDetails"),C,{headers:{"x-auth-token":e}});case 5:s({title:"Success",description:"Details submitted successfully!"}),D(),M(),W(!1),g.next=15;break;case 11:g.prev=11,g.t0=g.catch(0),console.error("Error submitting details:",g.t0),s({title:"Error",description:"Failed to submit details.",variant:"destructive"});case 15:case"end":return g.stop()}}),g,null,[[0,11]])})));return function(I){return g.apply(this,arguments)}}(),j=function(){var g=rI(oI().mark((function g(){var I;return oI().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:return g.prev=0,I=Nc(),g.next=4,wt.post("".concat(xc,"/opDetails/assign"),{id:null===R||void 0===R?void 0:R._id,staffId:w},{headers:{"x-auth-token":I}});case 4:s({title:"Success",description:"Assigned to Warden successfully!"}),D(),v(!1),g.next=13;break;case 9:g.prev=9,g.t0=g.catch(0),console.error("Error assigning to staff:",g.t0),s({title:"Error",description:"Failed to assign to Warden.",variant:"destructive"});case 13:case"end":return g.stop()}}),g,null,[[0,9]])})));return function(){return g.apply(this,arguments)}}();return(0,CI.jsxs)("div",{className:"min-h-screen bg-gray-100 dark:bg-gray-900 transition-colors duration-200",children:[(0,CI.jsx)("header",{className:"bg-white dark:bg-gray-800 shadow-sm",children:(0,CI.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4 flex justify-between items-center",children:[(0,CI.jsx)("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Student Dashboard"}),(0,CI.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,CI.jsxs)(Ua,{onClick:function(){return W(!0)},children:[(0,CI.jsx)(ab,{className:"mr-2 h-4 w-4"})," New OP Form"]}),(0,CI.jsxs)(Ua,{variant:"outline",onClick:function(){Kc(),u("/login")},children:[(0,CI.jsx)(ob,{className:"mr-2 h-4 w-4"})," Logout"]}),(0,CI.jsx)(Ua,{variant:"ghost",size:"icon",onClick:function(){return x(!K)},children:K?(0,CI.jsx)(zc,{className:"h-6 w-6"}):(0,CI.jsx)(Ec,{className:"h-6 w-6"})})]})]})}),(0,CI.jsx)("main",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:(0,CI.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:y.map((function(g){return(0,CI.jsxs)(uo,{className:"hover:shadow-lg transition-shadow dark:bg-gray-800",children:[(0,CI.jsxs)(Zo,{className:"p-6",children:[(0,CI.jsxs)("div",{className:"flex items-center mb-4",children:[(0,CI.jsx)(Yi,{className:"mr-4",children:(0,CI.jsx)(Hi,{children:g.name.charAt(0)})}),(0,CI.jsxs)("div",{children:[(0,CI.jsx)("h3",{className:"font-semibold dark:text-white",children:g.name}),(0,CI.jsxs)("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:[g.department," - ",g.rollno]})]})]}),(0,CI.jsxs)("div",{className:"space-y-2",children:[(0,CI.jsxs)("div",{className:"flex items-center",children:[(0,CI.jsx)(Ab,{className:"mr-2 h-4 w-4 dark:text-gray-400"}),(0,CI.jsxs)("span",{className:"text-sm dark:text-gray-300",children:["From: ",new Date(g.dateFrom).toLocaleDateString()]})]}),(0,CI.jsxs)("div",{className:"flex items-center",children:[(0,CI.jsx)(rb,{className:"mr-2 h-4 w-4 dark:text-gray-400"}),(0,CI.jsxs)("span",{className:"text-sm dark:text-gray-300",children:[g.timeFrom," - ",g.timeTo]})]}),(0,CI.jsxs)("div",{className:"flex items-center",children:[(0,CI.jsx)(cb,{className:"mr-2 h-4 w-4 dark:text-gray-400"}),(0,CI.jsx)("span",{className:"text-sm dark:text-gray-300",children:g.city})]}),(0,CI.jsxs)("div",{className:"flex items-start",children:[(0,CI.jsx)(ib,{className:"mr-2 h-4 w-4 mt-1 dark:text-gray-400"}),(0,CI.jsx)("span",{className:"text-sm dark:text-gray-300",children:g.reason})]})]}),(0,CI.jsxs)("div",{className:"mt-4 flex justify-between items-center",children:[(0,CI.jsx)(Fi,{variant:!0===(null===g||void 0===g?void 0:g.isAccept)?"default":!1===(null===g||void 0===g?void 0:g.isAccept)?"destructive":"outline",children:!0===g.isAccept?"Accepted":!1===g.isAccept?"Rejected":"Pending"}),!g.staffId&&(0,CI.jsx)(Ua,{size:"sm",variant:"outline",onClick:function(){X(g),v(!0)},children:"Assign to Warden"})]})]}),(0,CI.jsx)(Go,{children:g.isAccept&&(0,CI.jsx)(Ua,{variant:"link",onClick:function(){X(g),Y(!0)},children:"View Ticket"})})]},g._id)}))})}),(0,CI.jsx)(mc,{open:p,onOpenChange:W,children:(0,CI.jsxs)(Gc,{className:"sm:max-w-[425px]",children:[(0,CI.jsx)(yc,{children:(0,CI.jsx)(Bc,{children:"New OP Form"})}),(0,CI.jsxs)("form",{onSubmit:U(T),children:[(0,CI.jsxs)("div",{className:"grid gap-4 py-4",children:[(0,CI.jsxs)("div",{className:"grid grid-cols-4 items-center gap-4",children:[(0,CI.jsx)(to,{htmlFor:"name",className:"text-right",children:"Name"}),(0,CI.jsx)(Ma,aI(aI({id:"name",className:"col-span-3"},E("name")),{},{error:null===(g=Q.name)||void 0===g?void 0:g.message}))]}),(0,CI.jsxs)("div",{className:"grid grid-cols-4 items-center gap-4",children:[(0,CI.jsx)(to,{htmlFor:"department",className:"text-right",children:"Department"}),(0,CI.jsx)(Ma,aI(aI({id:"department",className:"col-span-3"},E("department")),{},{error:null===(e=Q.department)||void 0===e?void 0:e.message}))]}),(0,CI.jsxs)("div",{className:"grid grid-cols-4 items-center gap-4",children:[(0,CI.jsx)(to,{htmlFor:"rollno",className:"text-right",children:"Roll Number"}),(0,CI.jsx)(Ma,aI(aI({id:"rollno",className:"col-span-3"},E("rollno")),{},{error:null===(C=Q.rollno)||void 0===C?void 0:C.message}))]}),(0,CI.jsxs)("div",{className:"grid grid-cols-4 items-center gap-4",children:[(0,CI.jsx)(to,{htmlFor:"year",className:"text-right",children:"Year"}),(0,CI.jsx)(Ma,aI(aI({id:"year",className:"col-span-3"},E("year")),{},{error:null===(l=Q.year)||void 0===l?void 0:l.message}))]}),(0,CI.jsxs)("div",{className:"grid grid-cols-4 items-center gap-4",children:[(0,CI.jsx)(to,{htmlFor:"dateFrom",className:"text-right",children:"Date From"}),(0,CI.jsx)(Ma,aI(aI({id:"dateFrom",type:"date",className:"col-span-3"},E("dateFrom")),{},{error:null===(n=Q.dateFrom)||void 0===n?void 0:n.message}))]}),(0,CI.jsxs)("div",{className:"grid grid-cols-4 items-center gap-4",children:[(0,CI.jsx)(to,{htmlFor:"dateTo",className:"text-right",children:"Date To"}),(0,CI.jsx)(Ma,aI(aI({id:"dateTo",type:"date",className:"col-span-3"},E("dateTo")),{},{error:null===(t=Q.dateTo)||void 0===t?void 0:t.message}))]}),(0,CI.jsxs)("div",{className:"grid grid-cols-4 items-center gap-4",children:[(0,CI.jsx)(to,{htmlFor:"timeFrom",className:"text-right",children:"Time From"}),(0,CI.jsx)(Ma,aI(aI({id:"timeFrom",type:"time",className:"col-span-3"},E("timeFrom")),{},{error:null===(a=Q.timeFrom)||void 0===a?void 0:a.message}))]}),(0,CI.jsxs)("div",{className:"grid grid-cols-4 items-center gap-4",children:[(0,CI.jsx)(to,{htmlFor:"timeTo",className:"text-right",children:"Time To"}),(0,CI.jsx)(Ma,aI(aI({id:"timeTo",type:"time",className:"col-span-3"},E("timeTo")),{},{error:null===(o=Q.timeTo)||void 0===o?void 0:o.message}))]}),(0,CI.jsxs)("div",{className:"grid grid-cols-4 items-center gap-4",children:[(0,CI.jsx)(to,{htmlFor:"phNo",className:"text-right",children:"Phone Number"}),(0,CI.jsx)(Ma,aI(aI({id:"phNo",className:"col-span-3"},E("phNo")),{},{error:null===(r=Q.phNo)||void 0===r?void 0:r.message}))]}),(0,CI.jsxs)("div",{className:"grid grid-cols-4 items-center gap-4",children:[(0,CI.jsx)(to,{htmlFor:"parentPhNo",className:"text-right",children:"Parent Phone"}),(0,CI.jsx)(Ma,aI(aI({id:"parentPhNo",className:"col-span-3"},E("parentPhNo")),{},{error:null===(c=Q.parentPhNo)||void 0===c?void 0:c.message}))]}),(0,CI.jsxs)("div",{className:"grid grid-cols-4 items-center gap-4",children:[(0,CI.jsx)(to,{htmlFor:"city",className:"text-right",children:"City"}),(0,CI.jsx)(Ma,aI(aI({id:"city",className:"col-span-3"},E("city")),{},{error:null===(i=Q.city)||void 0===i?void 0:i.message}))]}),(0,CI.jsxs)("div",{className:"grid grid-cols-4 items-center gap-4",children:[(0,CI.jsx)(to,{htmlFor:"reason",className:"text-right",children:"Reason"}),(0,CI.jsx)(tb,aI(aI({id:"reason",className:"col-span-3"},E("reason")),{},{error:null===(d=Q.reason)||void 0===d?void 0:d.message}))]})]}),(0,CI.jsx)(hc,{children:(0,CI.jsx)(Ua,{type:"submit",children:"Submit"})})]})]})}),(0,CI.jsx)(mc,{open:S,onOpenChange:v,children:(0,CI.jsxs)(Gc,{className:"sm:max-w-[425px]",children:[(0,CI.jsx)(yc,{children:(0,CI.jsx)(Bc,{children:"Assign to Warden"})}),(0,CI.jsxs)(_m,{onValueChange:N,children:[(0,CI.jsx)(gb,{className:"w-full",children:(0,CI.jsx)($m,{placeholder:"Select a warden"})}),(0,CI.jsx)(Cb,{children:b.map((function(g){return(0,CI.jsx)(lb,{value:g._id,children:g.email},g._id)}))})]}),(0,CI.jsx)(hc,{children:(0,CI.jsx)(Ua,{onClick:j,children:"Assign"})})]})}),(0,CI.jsx)(mc,{open:k,onOpenChange:Y,children:(0,CI.jsxs)(Gc,{className:"sm:max-w-[425px]",children:[(0,CI.jsx)(yc,{children:(0,CI.jsx)(Bc,{children:"Outpass QR Code"})}),R&&(0,CI.jsxs)("div",{className:"flex flex-col items-center",children:[(0,CI.jsx)(ii,{value:R._id,size:256}),(0,CI.jsx)("h3",{className:"mt-4 font-semibold",children:R.name}),(0,CI.jsxs)("p",{className:"text-sm",children:["Roll No: ",R.rollno]}),(0,CI.jsxs)("p",{className:"text-sm",children:["Valid from:"," ",new Date(R.dateFrom).toLocaleDateString()," to"," ",new Date(R.dateTo).toLocaleDateString()]})]})]})})]})},sb=function(){var g=Sg(),e=A((0,I.useState)([]),2),C=e[0],l=e[1],n=A((0,I.useState)(null),2),t=n[0],a=n[1],o=A((0,I.useState)(!1),2),r=o[0],c=o[1],i=A((0,I.useState)(!1),2),d=i[0],u=i[1],s=A((0,I.useState)(!1),2),m=s[0],b=s[1];(0,I.useEffect)((function(){Nc()?Z():g("/login")}),[g]),(0,I.useEffect)((function(){m?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark")}),[m]);var Z=function(){var g=Nc();wt.get("".concat(xc,"/opDetails/staff/").concat(localStorage.getItem("userId")),{headers:{"x-auth-token":g}}).then((function(g){var I;l((null===(I=g.data)||void 0===I?void 0:I.data)||[])})).catch((function(g){console.error("Error fetching operation details:",g)}))},G=function(){c(!1),u(!1),a(null)};return(0,CI.jsxs)("div",{className:"min-h-screen bg-gray-100 dark:bg-gray-900 transition-colors duration-200",children:[(0,CI.jsx)("header",{className:"bg-white dark:bg-gray-800 shadow",children:(0,CI.jsxs)("div",{className:"max-w-7xl mx-auto py-6 px-4 sm:px-6 lg:px-8 flex justify-between items-center",children:[(0,CI.jsx)("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:"Warden Dashboard"}),(0,CI.jsxs)("div",{className:"flex items-center",children:[(0,CI.jsx)(Ua,{variant:"ghost",size:"icon",onClick:function(){return b(!m)},className:"mr-4",children:m?(0,CI.jsx)(zc,{className:"h-6 w-6"}):(0,CI.jsx)(Ec,{className:"h-6 w-6"})}),(0,CI.jsx)(Ua,{variant:"ghost",size:"icon",onClick:function(){Kc(),g("/login")},children:(0,CI.jsx)(ob,{className:"h-6 w-6"})})]})]})}),(0,CI.jsxs)("main",{className:"max-w-7xl mx-auto py-6 sm:px-6 lg:px-8",children:[(0,CI.jsx)("h2",{className:"text-2xl font-semibold mb-6 text-gray-900 dark:text-white",children:"Outpass Requests"}),(0,CI.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6",children:C.map((function(g){return(0,CI.jsxs)(uo,{className:"hover:shadow-lg transition-shadow duration-300",children:[(0,CI.jsxs)(Zo,{className:"p-6",children:[(0,CI.jsxs)("div",{className:"flex items-center mb-4",children:[(0,CI.jsx)(Yi,{className:"mr-4",children:(0,CI.jsx)(Hi,{children:g.name.charAt(0)})}),(0,CI.jsxs)("div",{children:[(0,CI.jsx)("h3",{className:"text-lg font-semibold",children:g.name}),(0,CI.jsxs)("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:["Request ID: ",g.id]})]})]}),(0,CI.jsxs)("div",{className:"space-y-2",children:[(0,CI.jsxs)("p",{className:"text-sm",children:[(0,CI.jsx)("span",{className:"font-medium",children:"From:"})," ",new Date(g.dateFrom).toLocaleDateString()]}),(0,CI.jsxs)("p",{className:"text-sm",children:[(0,CI.jsx)("span",{className:"font-medium",children:"Time:"})," ",g.timeFrom," ","- ",g.timeTo]}),(0,CI.jsxs)("p",{className:"text-sm",children:[(0,CI.jsx)("span",{className:"font-medium",children:"Reason:"})," ",g.reason]})]}),(0,CI.jsx)("div",{className:"mt-4",children:(0,CI.jsxs)(Fi,{variant:!0===g.isAccept?"default":!1===g.isAccept?"destructive":"secondary",className:"flex items-center",children:[!0===g.isAccept?(0,CI.jsx)(Mm,{className:"w-4 h-4 mr-1"}):!1===g.isAccept?(0,CI.jsx)(Ac,{className:"w-4 h-4 mr-1"}):(0,CI.jsx)(rb,{className:"w-4 h-4 mr-1"}),!0===g.isAccept?"Accepted":!1===g.isAccept?"Rejected":"Pending"]})})]}),(0,CI.jsxs)(Go,{className:"flex justify-end space-x-2 p-4",children:[(0,CI.jsx)(Ua,{variant:"outline",onClick:function(){return a(g),void c(!0)},disabled:null!==g.isAccept,children:"Accept"}),(0,CI.jsx)(Ua,{variant:"outline",onClick:function(){return a(g),void u(!0)},disabled:null!==g.isAccept,children:"Reject"})]})]},g.id)}))})]}),(0,CI.jsx)(mc,{open:r,onOpenChange:G,children:(0,CI.jsxs)(Gc,{children:[(0,CI.jsxs)(yc,{children:[(0,CI.jsx)(Bc,{children:"Confirm Accept"}),(0,CI.jsx)(pc,{children:"Are you sure you want to accept this request?"})]}),(0,CI.jsxs)(hc,{children:[(0,CI.jsx)(Ua,{variant:"outline",onClick:G,children:"Cancel"}),(0,CI.jsx)(Ua,{onClick:function(){if(t){var g=Nc();wt.post("".concat(xc,"/opDetails/accept"),{id:t._id},{headers:{"x-auth-token":g}}).then((function(){Z(),G()})).catch((function(g){console.error("Error accepting request:",g)}))}},children:"Confirm"})]})]})}),(0,CI.jsx)(mc,{open:d,onOpenChange:G,children:(0,CI.jsxs)(Gc,{children:[(0,CI.jsxs)(yc,{children:[(0,CI.jsx)(Bc,{children:"Confirm Reject"}),(0,CI.jsx)(pc,{children:"Are you sure you want to reject this request?"})]}),(0,CI.jsxs)(hc,{children:[(0,CI.jsx)(Ua,{variant:"outline",onClick:G,children:"Cancel"}),(0,CI.jsx)(Ua,{variant:"destructive",onClick:function(){if(t){var g=Nc();wt.post("".concat(xc,"/opDetails/reject"),{id:t._id},{headers:{"x-auth-token":g}}).then((function(){Z(),G()})).catch((function(g){console.error("Error rejecting request:",g)}))}},children:"Confirm"})]})]})})]})},mb=e(966),bb=e.n(mb),Zb=po("QrCode",[["rect",{width:"5",height:"5",x:"3",y:"3",rx:"1",key:"1tu5fj"}],["rect",{width:"5",height:"5",x:"16",y:"3",rx:"1",key:"1v8r4q"}],["rect",{width:"5",height:"5",x:"3",y:"16",rx:"1",key:"1x03jg"}],["path",{d:"M21 16h-3a2 2 0 0 0-2 2v3",key:"177gqh"}],["path",{d:"M21 21v.01",key:"ents32"}],["path",{d:"M12 7v3a2 2 0 0 1-2 2H7",key:"8crl2c"}],["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M12 3h.01",key:"n36tog"}],["path",{d:"M12 16v.01",key:"133mhm"}],["path",{d:"M16 12h1",key:"1slzba"}],["path",{d:"M21 12v.01",key:"1lwtk9"}],["path",{d:"M12 21v-1",key:"1880an"}]]),Gb=["className"],yb=["className"],hb=["className"],Bb=["className"],pb=["className"],Wb=["className"],Vb=["className"],Sb=["className"],vb=I.forwardRef((function(g,I){var e=g.className,C=cI(g,Gb);return(0,CI.jsx)("div",{className:"relative w-full overflow-auto",children:(0,CI.jsx)("table",aI({ref:I,className:xa("w-full caption-bottom text-sm",e)},C))})}));vb.displayName="Table";var fb=I.forwardRef((function(g,I){var e=g.className,C=cI(g,yb);return(0,CI.jsx)("thead",aI({ref:I,className:xa("[&_tr]:border-b",e)},C))}));fb.displayName="TableHeader";var Rb=I.forwardRef((function(g,I){var e=g.className,C=cI(g,hb);return(0,CI.jsx)("tbody",aI({ref:I,className:xa("[&_tr:last-child]:border-0",e)},C))}));Rb.displayName="TableBody",I.forwardRef((function(g,I){var e=g.className,C=cI(g,Bb);return(0,CI.jsx)("tfoot",aI({ref:I,className:xa("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",e)},C))})).displayName="TableFooter";var Xb=I.forwardRef((function(g,I){var e=g.className,C=cI(g,pb);return(0,CI.jsx)("tr",aI({ref:I,className:xa("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",e)},C))}));Xb.displayName="TableRow";var Jb=I.forwardRef((function(g,I){var e=g.className,C=cI(g,Wb);return(0,CI.jsx)("th",aI({ref:I,className:xa("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",e)},C))}));Jb.displayName="TableHead";var kb=I.forwardRef((function(g,I){var e=g.className,C=cI(g,Vb);return(0,CI.jsx)("td",aI({ref:I,className:xa("p-4 align-middle [&:has([role=checkbox])]:pr-0",e)},C))}));kb.displayName="TableCell",I.forwardRef((function(g,I){var e=g.className,C=cI(g,Sb);return(0,CI.jsx)("caption",aI({ref:I,className:xa("mt-4 text-sm text-muted-foreground",e)},C))})).displayName="TableCaption";var Yb=function(){var g=A((0,I.useState)(!1),2),e=g[0],C=g[1],l=Sg(),n=A((0,I.useState)(null),2),t=n[0],a=n[1],o=A((0,I.useState)(null),2),r=o[0],c=o[1],i=A((0,I.useState)(!1),2),d=i[0],u=i[1],s=A((0,I.useState)([]),2),m=s[0],b=s[1],Z=A((0,I.useState)(!1),2),G=Z[0],y=Z[1],h=kc().toast;(0,I.useEffect)((function(){B()}),[]),(0,I.useEffect)((function(){G?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark")}),[G]);var B=function(){var g=rI(oI().mark((function g(){var I,e;return oI().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:return g.prev=0,I=Nc(),g.next=4,wt.get("".concat(xc,"/guard/All"),{headers:{"x-auth-token":I}});case 4:e=g.sent,b(e.data.data),g.next=11;break;case 8:g.prev=8,g.t0=g.catch(0),console.error("Error fetching guard register:",g.t0);case 11:case"end":return g.stop()}}),g,null,[[0,8]])})));return function(){return g.apply(this,arguments)}}(),p=function(){var g=rI(oI().mark((function g(I){var e,C;return oI().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:if(!I||!I.text){g.next=17;break}return a(I.text),u(!0),g.prev=3,e=Nc(),g.next=7,wt.get("".concat(xc,"/opDetails/verifyOutpass/").concat(I.text),{headers:{"x-auth-token":e}});case 7:C=g.sent,c(C.data.data),g.next=14;break;case 11:g.prev=11,g.t0=g.catch(3),console.error("Error verifying outpass:",g.t0);case 14:return g.prev=14,u(!1),g.finish(14);case 17:case"end":return g.stop()}}),g,null,[[3,11,14,17]])})));return function(I){return g.apply(this,arguments)}}(),W=function(){var g=rI(oI().mark((function g(){var I;return oI().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:if(!r||!r._id){g.next=15;break}return g.prev=1,I=Nc(),g.next=5,wt.post("".concat(xc,"/guard/registerDetails/").concat(r._id),{},{headers:{"x-auth-token":I}});case 5:C(!1),a(null),c(null),h({title:"Entry Approved!",duration:3e3}),B(),g.next=15;break;case 12:g.prev=12,g.t0=g.catch(1),console.error("Error approving entry:",g.t0);case 15:case"end":return g.stop()}}),g,null,[[1,12]])})));return function(){return g.apply(this,arguments)}}();return(0,CI.jsxs)("div",{className:"min-h-screen bg-gray-100 dark:bg-gray-900 transition-colors duration-200",children:[(0,CI.jsx)("header",{className:"bg-white dark:bg-gray-800 shadow",children:(0,CI.jsxs)("div",{className:"max-w-7xl mx-auto py-6 px-4 sm:px-6 lg:px-8 flex justify-between items-center",children:[(0,CI.jsx)("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:"Security Dashboard"}),(0,CI.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,CI.jsx)(Ua,{variant:"ghost",size:"icon",onClick:function(){return C(!0)},children:(0,CI.jsx)(Zb,{className:"h-6 w-6"})}),(0,CI.jsx)(Ua,{variant:"ghost",size:"icon",onClick:function(){return y(!G)},children:G?(0,CI.jsx)(zc,{className:"h-6 w-6"}):(0,CI.jsx)(Ec,{className:"h-6 w-6"})}),(0,CI.jsx)(Ua,{variant:"ghost",size:"icon",onClick:function(){Kc(),l("/login")},children:(0,CI.jsx)(ob,{className:"h-6 w-6"})})]})]})}),(0,CI.jsx)("main",{className:"max-w-7xl mx-auto py-6 sm:px-6 lg:px-8",children:(0,CI.jsxs)(uo,{children:[(0,CI.jsx)(so,{children:(0,CI.jsx)(mo,{children:"Guard Register"})}),(0,CI.jsx)(Zo,{children:(0,CI.jsxs)(vb,{children:[(0,CI.jsx)(fb,{children:(0,CI.jsxs)(Xb,{children:[(0,CI.jsx)(Jb,{children:"Name"}),(0,CI.jsx)(Jb,{children:"Approved By"}),(0,CI.jsx)(Jb,{children:"Scanned Date"}),(0,CI.jsx)(Jb,{children:"Personal Phone No."}),(0,CI.jsx)(Jb,{children:"Parent Phone No."}),(0,CI.jsx)(Jb,{children:"Address"}),(0,CI.jsx)(Jb,{children:"Reason"})]})}),(0,CI.jsx)(Rb,{children:m.map((function(g,I){return(0,CI.jsxs)(Xb,{children:[(0,CI.jsx)(kb,{children:g.name}),(0,CI.jsx)(kb,{children:g.ApprovedBy}),(0,CI.jsx)(kb,{children:g.ScannedDate}),(0,CI.jsx)(kb,{children:g.PhoneNo}),(0,CI.jsx)(kb,{children:g.ParentPhoneNo}),(0,CI.jsx)(kb,{children:g.Address}),(0,CI.jsx)(kb,{children:g.reason})]},I)}))})]})})]})}),(0,CI.jsx)(mc,{open:e,onOpenChange:C,children:(0,CI.jsxs)(Gc,{children:[(0,CI.jsx)(yc,{children:(0,CI.jsx)(Bc,{children:"Scan QR Code"})}),!t&&(0,CI.jsx)("div",{className:"w-full max-w-sm mx-auto",children:(0,CI.jsx)(bb(),{delay:300,onError:function(g){console.error(g)},onScan:p,style:{width:"100%"}})}),d&&(0,CI.jsx)("div",{className:"flex justify-center my-4",children:(0,CI.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-gray-900 dark:border-white"})}),r&&(0,CI.jsxs)("div",{className:"mt-4",children:[(0,CI.jsx)("h3",{className:"text-lg font-semibold mb-2",children:"Verification Result:"}),r.error?(0,CI.jsx)("p",{className:"text-red-500",children:r.error}):(0,CI.jsxs)(CI.Fragment,{children:[(0,CI.jsxs)("p",{children:["Name: ",r.name]}),(0,CI.jsxs)("p",{children:["Roll No: ",r.rollno]}),(0,CI.jsxs)("p",{children:["Valid: ",r.isValid?"Yes":"No"]}),(0,CI.jsxs)("p",{children:["From:"," ",new Date(r.dateFrom).toLocaleDateString()]}),(0,CI.jsxs)("p",{children:["To:"," ",new Date(r.dateTo).toLocaleDateString()]}),r.isValid&&(0,CI.jsx)(Ua,{onClick:W,className:"w-full mt-4",children:"Approve Entry"})]})]}),(0,CI.jsx)(hc,{children:(0,CI.jsx)(Ua,{onClick:function(){C(!1),a(null),c(null)},children:"Close Scanner"})})]})})]})};function Hb(){var g=Sg(),e=Wg(),C=localStorage.getItem("role");return(0,I.useEffect)((function(){"/"===e.pathname&&g("student"===C?"/student":"staff"===C?"/staff":"/login")}),[e.pathname,g,C]),(0,CI.jsx)("div",{className:"container mx-auto p-4",children:(0,CI.jsxs)(Qg,{children:[(0,CI.jsx)(Eg,{path:"/student",element:"student"===C?(0,CI.jsx)(ub,{}):(0,CI.jsx)(zg,{to:"/login"})}),(0,CI.jsx)(Eg,{path:"/staff",element:"staff"===C?(0,CI.jsx)(sb,{}):(0,CI.jsx)(zg,{to:"/login"})}),(0,CI.jsx)(Eg,{path:"/security",element:"security"===C?(0,CI.jsx)(Yb,{}):(0,CI.jsx)(zg,{to:"/login"})}),(0,CI.jsx)(Eg,{path:"/about",element:(0,CI.jsx)(lI,{})}),(0,CI.jsx)(Eg,{path:"/login",element:(0,CI.jsx)(Qc,{})}),(0,CI.jsx)(Eg,{path:"/register",element:(0,CI.jsx)(Dc,{})}),(0,CI.jsx)(Eg,{path:"*",element:(0,CI.jsx)(Mc,{})})]})})}var wb=function(){return(0,CI.jsx)(qg,{children:(0,CI.jsx)(Hb,{})})},Nb=["children","defaultTheme","storageKey"],Fb={theme:"system",setTheme:function(){return null}},Kb=(0,I.createContext)(Fb);function xb(g){var e=g.children,C=g.defaultTheme,l=void 0===C?"system":C,n=g.storageKey,t=void 0===n?"react-ui-theme":n,a=cI(g,Nb),o=A((0,I.useState)((function(){return localStorage.getItem(t)||l})),2),r=o[0],c=o[1];(0,I.useEffect)((function(){var g=window.document.documentElement;if(g.classList.remove("light","dark"),"system"!==r)g.classList.add(r);else{var I=window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light";g.classList.add(I)}}),[r]);var i={theme:r,setTheme:function(g){localStorage.setItem(t,g),c(g)}};return(0,CI.jsx)(Kb.Provider,aI(aI({},a),{},{value:i,children:e}))}var zb=["__scopeToast","hotkey","label"],Eb=["__scopeToast","onFocusFromOutsideViewport"],Ub=["forceMount","open","defaultOpen","onOpenChange"],Qb=["__scopeToast","type","duration","open","onClose","onEscapeKeyDown","onPause","onResume","onSwipeStart","onSwipeMove","onSwipeCancel","onSwipeEnd"],Mb=["__scopeToast","children"],Lb=["__scopeToast"],Db=["__scopeToast"],Tb=["altText"],jb=["__scopeToast"],Pb=["__scopeToast","altText"],Ob="ToastProvider",qb=A(zi("Toast"),3),_b=qb[0],$b=qb[1],gZ=A(Xo("Toast",[qb[2]]),2),IZ=gZ[0],eZ=(gZ[1],A(IZ(Ob),2)),CZ=eZ[0],lZ=eZ[1],nZ=function(g){var e=g.__scopeToast,C=g.label,l=void 0===C?"Notification":C,n=g.duration,t=void 0===n?5e3:n,a=g.swipeDirection,o=void 0===a?"right":a,r=g.swipeThreshold,c=void 0===r?50:r,i=g.children,d=A(I.useState(null),2),u=d[0],s=d[1],m=A(I.useState(0),2),b=m[0],Z=m[1],G=I.useRef(!1),y=I.useRef(!1);return l.trim()||console.error("Invalid prop `label` supplied to `".concat(Ob,"`. Expected non-empty `string`.")),(0,CI.jsx)(_b.Provider,{scope:e,children:(0,CI.jsx)(CZ,{scope:e,label:l,duration:t,swipeDirection:o,swipeThreshold:c,toastCount:b,viewport:u,onViewportChange:s,onToastAdd:I.useCallback((function(){return Z((function(g){return g+1}))}),[]),onToastRemove:I.useCallback((function(){return Z((function(g){return g-1}))}),[]),isFocusedToastEscapeKeyDownRef:G,isClosePausedRef:y,children:i})})};nZ.displayName=Ob;var tZ="ToastViewport",aZ=["F8"],oZ="toast.viewportPause",AZ="toast.viewportResume",rZ=I.forwardRef((function(g,e){var C=g.__scopeToast,l=g.hotkey,n=void 0===l?aZ:l,t=g.label,a=void 0===t?"Notifications ({hotkey})":t,o=cI(g,zb),A=lZ(tZ,C),r=$b(C),c=I.useRef(null),i=I.useRef(null),d=I.useRef(null),s=I.useRef(null),m=Da(e,s,A.onViewportChange),b=n.join("+").replace(/Key/g,"").replace(/Digit/g,""),Z=A.toastCount>0;I.useEffect((function(){var g=function(g){var I;n.every((function(I){return g[I]||g.code===I}))&&(null===(I=s.current)||void 0===I||I.focus())};return document.addEventListener("keydown",g),function(){return document.removeEventListener("keydown",g)}}),[n]),I.useEffect((function(){var g=c.current,I=s.current;if(Z&&g&&I){var e=function(){if(!A.isClosePausedRef.current){var g=new CustomEvent(oZ);I.dispatchEvent(g),A.isClosePausedRef.current=!0}},C=function(){if(A.isClosePausedRef.current){var g=new CustomEvent(AZ);I.dispatchEvent(g),A.isClosePausedRef.current=!1}},l=function(I){!g.contains(I.relatedTarget)&&C()},n=function(){g.contains(document.activeElement)||C()};return g.addEventListener("focusin",e),g.addEventListener("focusout",l),g.addEventListener("pointermove",e),g.addEventListener("pointerleave",n),window.addEventListener("blur",e),window.addEventListener("focus",C),function(){g.removeEventListener("focusin",e),g.removeEventListener("focusout",l),g.removeEventListener("pointermove",e),g.removeEventListener("pointerleave",n),window.removeEventListener("blur",e),window.removeEventListener("focus",C)}}}),[Z,A.isClosePausedRef]);var G=I.useCallback((function(g){var I=g.tabbingDirection,e=r().map((function(g){var e=g.ref.current,C=[e].concat(u(function(g){var I=[],e=document.createTreeWalker(g,NodeFilter.SHOW_ELEMENT,{acceptNode:function(g){var I="INPUT"===g.tagName&&"hidden"===g.type;return g.disabled||g.hidden||I?NodeFilter.FILTER_SKIP:g.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;e.nextNode();)I.push(e.currentNode);return I}(e)));return"forwards"===I?C:C.reverse()}));return("forwards"===I?e.reverse():e).flat()}),[r]);return I.useEffect((function(){var g=s.current;if(g){var I=function(I){var e=I.altKey||I.ctrlKey||I.metaKey;if("Tab"===I.key&&!e){var C,l=document.activeElement,n=I.shiftKey;if(I.target===g&&n)return void(null===(C=i.current)||void 0===C||C.focus());var t,a,o=G({tabbingDirection:n?"backwards":"forwards"}),A=o.findIndex((function(g){return g===l}));if(XZ(o.slice(A+1)))I.preventDefault();else n?null===(t=i.current)||void 0===t||t.focus():null===(a=d.current)||void 0===a||a.focus()}};return g.addEventListener("keydown",I),function(){return g.removeEventListener("keydown",I)}}}),[r,G]),(0,CI.jsxs)(Po,{ref:c,role:"region","aria-label":a.replace("{hotkey}",b),tabIndex:-1,style:{pointerEvents:Z?void 0:"none"},children:[Z&&(0,CI.jsx)(iZ,{ref:i,onFocusFromOutsideViewport:function(){XZ(G({tabbingDirection:"forwards"}))}}),(0,CI.jsx)(_b.Slot,{scope:C,children:(0,CI.jsx)(go.ol,aI(aI({tabIndex:-1},o),{},{ref:m}))}),Z&&(0,CI.jsx)(iZ,{ref:d,onFocusFromOutsideViewport:function(){XZ(G({tabbingDirection:"backwards"}))}})]})}));rZ.displayName=tZ;var cZ="ToastFocusProxy",iZ=I.forwardRef((function(g,I){var e=g.__scopeToast,C=g.onFocusFromOutsideViewport,l=cI(g,Eb),n=lZ(cZ,e);return(0,CI.jsx)(Is,aI(aI({"aria-hidden":!0,tabIndex:0},l),{},{ref:I,style:{position:"fixed"},onFocus:function(g){var I,e=g.relatedTarget;!(null!==(I=n.viewport)&&void 0!==I&&I.contains(e))&&C()}}))}));iZ.displayName=cZ;var dZ="Toast",uZ=I.forwardRef((function(g,I){var e=g.forceMount,C=g.open,l=g.defaultOpen,n=g.onOpenChange,t=cI(g,Ub),a=A(Fo({prop:C,defaultProp:l,onChange:n}),2),o=a[0],r=void 0===o||o,c=a[1];return(0,CI.jsx)(AA,{present:e||r,children:(0,CI.jsx)(ZZ,aI(aI({open:r},t),{},{ref:I,onClose:function(){return c(!1)},onPause:No(g.onPause),onResume:No(g.onResume),onSwipeStart:vo(g.onSwipeStart,(function(g){g.currentTarget.setAttribute("data-swipe","start")})),onSwipeMove:vo(g.onSwipeMove,(function(g){var I=g.detail.delta,e=I.x,C=I.y;g.currentTarget.setAttribute("data-swipe","move"),g.currentTarget.style.setProperty("--radix-toast-swipe-move-x","".concat(e,"px")),g.currentTarget.style.setProperty("--radix-toast-swipe-move-y","".concat(C,"px"))})),onSwipeCancel:vo(g.onSwipeCancel,(function(g){g.currentTarget.setAttribute("data-swipe","cancel"),g.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),g.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),g.currentTarget.style.removeProperty("--radix-toast-swipe-end-x"),g.currentTarget.style.removeProperty("--radix-toast-swipe-end-y")})),onSwipeEnd:vo(g.onSwipeEnd,(function(g){var I=g.detail.delta,e=I.x,C=I.y;g.currentTarget.setAttribute("data-swipe","end"),g.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),g.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),g.currentTarget.style.setProperty("--radix-toast-swipe-end-x","".concat(e,"px")),g.currentTarget.style.setProperty("--radix-toast-swipe-end-y","".concat(C,"px")),c(!1)}))}))})}));uZ.displayName=dZ;var sZ=A(IZ(dZ,{onClose:function(){}}),2),mZ=sZ[0],bZ=sZ[1],ZZ=I.forwardRef((function(g,e){var C=g.__scopeToast,l=g.type,n=void 0===l?"foreground":l,t=g.duration,a=g.open,o=g.onClose,r=g.onEscapeKeyDown,i=g.onPause,d=g.onResume,u=g.onSwipeStart,s=g.onSwipeMove,m=g.onSwipeCancel,b=g.onSwipeEnd,Z=cI(g,Qb),G=lZ(dZ,C),y=A(I.useState(null),2),h=y[0],B=y[1],p=Da(e,(function(g){return B(g)})),W=I.useRef(null),V=I.useRef(null),S=t||G.duration,v=I.useRef(0),f=I.useRef(S),R=I.useRef(0),X=G.onToastAdd,J=G.onToastRemove,k=No((function(){var g;(null===h||void 0===h?void 0:h.contains(document.activeElement))&&(null===(g=G.viewport)||void 0===g||g.focus()),o()})),Y=I.useCallback((function(g){g&&g!==1/0&&(window.clearTimeout(R.current),v.current=(new Date).getTime(),R.current=window.setTimeout(k,g))}),[k]);I.useEffect((function(){var g=G.viewport;if(g){var I=function(){Y(f.current),null===d||void 0===d||d()},e=function(){var g=(new Date).getTime()-v.current;f.current=f.current-g,window.clearTimeout(R.current),null===i||void 0===i||i()};return g.addEventListener(oZ,e),g.addEventListener(AZ,I),function(){g.removeEventListener(oZ,e),g.removeEventListener(AZ,I)}}}),[G.viewport,S,i,d,Y]),I.useEffect((function(){a&&!G.isClosePausedRef.current&&Y(S)}),[a,S,G.isClosePausedRef,Y]),I.useEffect((function(){return X(),function(){return J()}}),[X,J]);var H=I.useMemo((function(){return h?vZ(h):null}),[h]);return G.viewport?(0,CI.jsxs)(CI.Fragment,{children:[H&&(0,CI.jsx)(GZ,{__scopeToast:C,role:"status","aria-live":"foreground"===n?"assertive":"polite","aria-atomic":!0,children:H}),(0,CI.jsx)(mZ,{scope:C,onClose:k,children:c.createPortal((0,CI.jsx)(_b.ItemSlot,{scope:C,children:(0,CI.jsx)(jo,{asChild:!0,onEscapeKeyDown:vo(r,(function(){G.isFocusedToastEscapeKeyDownRef.current||k(),G.isFocusedToastEscapeKeyDownRef.current=!1})),children:(0,CI.jsx)(go.li,aI(aI({role:"status","aria-live":"off","aria-atomic":!0,tabIndex:0,"data-state":a?"open":"closed","data-swipe-direction":G.swipeDirection},Z),{},{ref:p,style:aI({userSelect:"none",touchAction:"none"},g.style),onKeyDown:vo(g.onKeyDown,(function(g){"Escape"===g.key&&(null===r||void 0===r||r(g.nativeEvent),g.nativeEvent.defaultPrevented||(G.isFocusedToastEscapeKeyDownRef.current=!0,k()))})),onPointerDown:vo(g.onPointerDown,(function(g){0===g.button&&(W.current={x:g.clientX,y:g.clientY})})),onPointerMove:vo(g.onPointerMove,(function(g){if(W.current){var I=g.clientX-W.current.x,e=g.clientY-W.current.y,C=Boolean(V.current),l=["left","right"].includes(G.swipeDirection),n=["left","up"].includes(G.swipeDirection)?Math.min:Math.max,t=l?n(0,I):0,a=l?0:n(0,e),o="touch"===g.pointerType?10:2,A={x:t,y:a},r={originalEvent:g,delta:A};C?(V.current=A,fZ("toast.swipeMove",s,r,{discrete:!1})):RZ(A,G.swipeDirection,o)?(V.current=A,fZ("toast.swipeStart",u,r,{discrete:!1}),g.target.setPointerCapture(g.pointerId)):(Math.abs(I)>o||Math.abs(e)>o)&&(W.current=null)}})),onPointerUp:vo(g.onPointerUp,(function(g){var I=V.current,e=g.target;if(e.hasPointerCapture(g.pointerId)&&e.releasePointerCapture(g.pointerId),V.current=null,W.current=null,I){var C=g.currentTarget,l={originalEvent:g,delta:I};RZ(I,G.swipeDirection,G.swipeThreshold)?fZ("toast.swipeEnd",b,l,{discrete:!0}):fZ("toast.swipeCancel",m,l,{discrete:!0}),C.addEventListener("click",(function(g){return g.preventDefault()}),{once:!0})}}))}))})}),G.viewport)})]}):null})),GZ=function(g){var e=g.__scopeToast,C=g.children,l=cI(g,Mb),n=lZ(dZ,e),t=A(I.useState(!1),2),a=t[0],o=t[1],r=A(I.useState(!1),2),c=r[0],i=r[1];return function(){var g=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(){},I=No(g);ko((function(){var g=0,e=0;return g=window.requestAnimationFrame((function(){return e=window.requestAnimationFrame(I)})),function(){window.cancelAnimationFrame(g),window.cancelAnimationFrame(e)}}),[I])}((function(){return o(!0)})),I.useEffect((function(){var g=window.setTimeout((function(){return i(!0)}),1e3);return function(){return window.clearTimeout(g)}}),[]),c?null:(0,CI.jsx)(oA,{asChild:!0,children:(0,CI.jsx)(Is,aI(aI({},l),{},{children:a&&(0,CI.jsxs)(CI.Fragment,{children:[n.label," ",C]})}))})},yZ=I.forwardRef((function(g,I){g.__scopeToast;var e=cI(g,Lb);return(0,CI.jsx)(go.div,aI(aI({},e),{},{ref:I}))}));yZ.displayName="ToastTitle";var hZ=I.forwardRef((function(g,I){g.__scopeToast;var e=cI(g,Db);return(0,CI.jsx)(go.div,aI(aI({},e),{},{ref:I}))}));hZ.displayName="ToastDescription";var BZ="ToastAction",pZ=I.forwardRef((function(g,I){var e=g.altText,C=cI(g,Tb);return e.trim()?(0,CI.jsx)(SZ,{altText:e,asChild:!0,children:(0,CI.jsx)(VZ,aI(aI({},C),{},{ref:I}))}):(console.error("Invalid prop `altText` supplied to `".concat(BZ,"`. Expected non-empty `string`.")),null)}));pZ.displayName=BZ;var WZ="ToastClose",VZ=I.forwardRef((function(g,I){var e=g.__scopeToast,C=cI(g,jb),l=bZ(WZ,e);return(0,CI.jsx)(SZ,{asChild:!0,children:(0,CI.jsx)(go.button,aI(aI({type:"button"},C),{},{ref:I,onClick:vo(g.onClick,l.onClose)}))})}));VZ.displayName=WZ;var SZ=I.forwardRef((function(g,I){g.__scopeToast;var e=g.altText,C=cI(g,Pb);return(0,CI.jsx)(go.div,aI(aI({"data-radix-toast-announce-exclude":"","data-radix-toast-announce-alt":e||void 0},C),{},{ref:I}))}));function vZ(g){var I=[];return Array.from(g.childNodes).forEach((function(g){if(g.nodeType===g.TEXT_NODE&&g.textContent&&I.push(g.textContent),function(g){return g.nodeType===g.ELEMENT_NODE}(g)){var e=g.ariaHidden||g.hidden||"none"===g.style.display,C=""===g.dataset.radixToastAnnounceExclude;if(!e)if(C){var l=g.dataset.radixToastAnnounceAlt;l&&I.push(l)}else I.push.apply(I,u(vZ(g)))}})),I}function fZ(g,I,e,C){var l=C.discrete,n=e.originalEvent.currentTarget,t=new CustomEvent(g,{bubbles:!0,cancelable:!0,detail:e});I&&n.addEventListener(g,I,{once:!0}),l?Io(n,t):n.dispatchEvent(t)}var RZ=function(g,I){var e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,C=Math.abs(g.x),l=Math.abs(g.y),n=C>l;return"left"===I||"right"===I?n&&C>e:!n&&l>e};function XZ(g){var I=document.activeElement;return g.some((function(g){return g===I||(g.focus(),document.activeElement!==I)}))}var JZ=rZ,kZ=uZ,YZ=yZ,HZ=hZ,wZ=pZ,NZ=VZ,FZ=["className"],KZ=["className","variant"],xZ=["className"],zZ=["className"],EZ=["className"],UZ=["className"],QZ=nZ,MZ=I.forwardRef((function(g,I){var e=g.className,C=cI(g,FZ);return(0,CI.jsx)(JZ,aI({ref:I,className:xa("fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]",e)},C))}));MZ.displayName=JZ.displayName;var LZ=Pt("group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full",{variants:{variant:{default:"border bg-background text-foreground",destructive:"destructive group border-destructive bg-destructive text-destructive-foreground"}},defaultVariants:{variant:"default"}}),DZ=I.forwardRef((function(g,I){var e=g.className,C=g.variant,l=cI(g,KZ);return(0,CI.jsx)(kZ,aI({ref:I,className:xa(LZ({variant:C}),e)},l))}));DZ.displayName=kZ.displayName,I.forwardRef((function(g,I){var e=g.className,C=cI(g,xZ);return(0,CI.jsx)(wZ,aI({ref:I,className:xa("inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-muted/40 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive",e)},C))})).displayName=wZ.displayName;var TZ=I.forwardRef((function(g,I){var e=g.className,C=cI(g,zZ);return(0,CI.jsx)(NZ,aI(aI({ref:I,className:xa("absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:outline-none focus:ring-2 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600",e),"toast-close":""},C),{},{children:(0,CI.jsx)(Ac,{className:"h-4 w-4"})}))}));TZ.displayName=NZ.displayName;var jZ=I.forwardRef((function(g,I){var e=g.className,C=cI(g,EZ);return(0,CI.jsx)(YZ,aI({ref:I,className:xa("text-sm font-semibold",e)},C))}));jZ.displayName=YZ.displayName;var PZ=I.forwardRef((function(g,I){var e=g.className,C=cI(g,UZ);return(0,CI.jsx)(HZ,aI({ref:I,className:xa("text-sm opacity-90",e)},C))}));PZ.displayName=HZ.displayName;var OZ=["id","title","description","action"];function qZ(){var g=kc().toasts;return(0,CI.jsxs)(QZ,{children:[g.map((function(g){var I=g.id,e=g.title,C=g.description,l=g.action,n=cI(g,OZ);return(0,CI.jsxs)(DZ,aI(aI({},n),{},{children:[(0,CI.jsxs)("div",{className:"grid gap-1",children:[e&&(0,CI.jsx)(jZ,{children:e}),C&&(0,CI.jsx)(PZ,{children:C})]}),l,(0,CI.jsx)(TZ,{})]}),I)})),(0,CI.jsx)(MZ,{})]})}function _Z(){return(0,CI.jsx)(qZ,{})}l.createRoot(document.getElementById("root")).render((0,CI.jsx)(I.StrictMode,{children:(0,CI.jsxs)(xb,{children:[(0,CI.jsx)(wb,{}),(0,CI.jsx)(_Z,{})]})}))}()}();
//# sourceMappingURL=main.b523acf0.js.map